<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Main</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Markup">\begin{code}</a>
<a id="14" class="Keyword">module</a> <a id="21" href="Main.html" class="Module">Main</a> <a id="26" class="Keyword">where</a>
<a id="32" class="Keyword">open</a> <a id="37" class="Keyword">import</a> <a id="44" href="Agda.Builtin.IO.html" class="Module">Agda.Builtin.IO</a>
<a id="60" class="Keyword">import</a> <a id="67" href="IO.Primitive.html" class="Module">IO.Primitive</a> <a id="80" class="Symbol">as</a> <a id="83" class="Module">IO</a> <a id="86" class="Keyword">using</a> <a id="92" class="Symbol">(</a><a id="93" href="IO.Primitive.html#610" class="Postulate">return</a><a id="99" class="Symbol">;</a><a id="100" href="IO.Primitive.html#650" class="Postulate Operator">_&gt;&gt;=_</a><a id="105" class="Symbol">)</a>
<a id="107" class="Keyword">open</a> <a id="112" class="Keyword">import</a> <a id="119" href="Agda.Builtin.Unit.html" class="Module">Agda.Builtin.Unit</a>
<a id="137" class="Keyword">open</a> <a id="142" class="Keyword">import</a> <a id="149" href="Agda.Builtin.String.html" class="Module">Agda.Builtin.String</a>
<a id="169" class="Keyword">open</a> <a id="174" class="Keyword">import</a> <a id="181" href="Function.html" class="Module">Function</a>
<a id="190" class="Keyword">open</a> <a id="195" class="Keyword">import</a> <a id="202" href="Data.Sum.html" class="Module">Data.Sum</a>
<a id="211" class="Keyword">open</a> <a id="216" class="Keyword">import</a> <a id="223" href="Data.String.html" class="Module">Data.String</a>
<a id="235" class="Keyword">open</a> <a id="240" class="Keyword">import</a> <a id="247" href="Agda.Builtin.TrustMe.html" class="Module">Agda.Builtin.TrustMe</a>
<a id="268" class="Keyword">open</a> <a id="273" class="Keyword">import</a> <a id="280" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>
<a id="318" class="Keyword">open</a> <a id="323" class="Keyword">import</a> <a id="330" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a>
<a id="347" class="Keyword">open</a> <a id="352" class="Keyword">import</a> <a id="359" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="368" class="Keyword">open</a> <a id="373" class="Keyword">import</a> <a id="380" href="Agda.Builtin.Int.html" class="Module">Agda.Builtin.Int</a>
<a id="397" class="Keyword">open</a> <a id="402" class="Keyword">import</a> <a id="409" href="Data.Integer.html" class="Module">Data.Integer</a>
<a id="422" class="Keyword">open</a> <a id="427" class="Keyword">import</a> <a id="434" href="Data.Product.html" class="Module">Data.Product</a> <a id="447" class="Keyword">renaming</a> <a id="456" class="Symbol">(</a><a id="457" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="461" class="Symbol">to</a> <a id="Builtin.Sigma._,_"></a><a id="464" href="Main.html#464" class="InductiveConstructor Operator">_,,_</a><a id="468" class="Symbol">)</a>
<a id="470" class="Keyword">open</a> <a id="475" class="Keyword">import</a> <a id="482" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="492" class="Keyword">open</a> <a id="497" class="Keyword">import</a> <a id="504" href="Data.Fin.html" class="Module">Data.Fin</a>
<a id="513" class="Keyword">open</a> <a id="518" class="Keyword">import</a> <a id="525" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="534" class="Keyword">hiding</a> <a id="541" class="Symbol">(</a><a id="542" href="Data.Vec.Base.html#4317" class="Function Operator">_&gt;&gt;=_</a><a id="547" class="Symbol">;</a><a id="548" href="Data.Vec.Base.html#2670" class="Function Operator">_++_</a><a id="552" class="Symbol">)</a>
<a id="554" class="Keyword">open</a> <a id="559" class="Keyword">import</a> <a id="566" href="Data.List.html" class="Module">Data.List</a> <a id="576" class="Keyword">hiding</a> <a id="583" class="Symbol">(</a><a id="584" href="Data.List.Base.html#1763" class="Function Operator">_++_</a><a id="588" class="Symbol">)</a>

<a id="591" class="Keyword">open</a> <a id="596" class="Keyword">import</a> <a id="603" href="Type.html" class="Module">Type</a>
<a id="608" class="Keyword">open</a> <a id="613" class="Keyword">import</a> <a id="620" href="Builtin.html" class="Module">Builtin</a>
<a id="628" class="Keyword">open</a> <a id="633" class="Keyword">import</a> <a id="640" href="Builtin.Constant.Type.html" class="Module">Builtin.Constant.Type</a> <a id="662" class="Keyword">hiding</a> <a id="669" class="Symbol">(</a><a id="670" href="Builtin.Constant.Type.html#616" class="Postulate">ByteString</a><a id="680" class="Symbol">)</a>
<a id="682" class="Keyword">open</a> <a id="687" class="Keyword">import</a> <a id="694" href="Builtin.Constant.Term.html" class="Module">Builtin.Constant.Term</a> <a id="716" href="Type.html#962" class="Datatype">Ctx⋆</a> <a id="721" href="Type.html#596" class="Datatype">Kind</a> <a id="726" href="Type.html#615" class="InductiveConstructor">*</a> <a id="728" href="Type.html#2041" class="Datatype Operator">_⊢⋆_</a> <a id="733" href="Type.html#2503" class="InductiveConstructor">con</a>
<a id="737" class="Keyword">open</a> <a id="742" class="Keyword">import</a> <a id="749" href="Builtin.Signature.html" class="Module">Builtin.Signature</a>
<a id="767" class="Keyword">open</a> <a id="772" class="Keyword">import</a> <a id="779" href="Check.html" class="Module">Check</a>
<a id="785" class="Keyword">open</a> <a id="790" class="Keyword">import</a> <a id="797" href="Scoped.Extrication.html" class="Module">Scoped.Extrication</a>
<a id="816" class="Keyword">open</a> <a id="821" class="Keyword">import</a> <a id="828" href="Type.BetaNBE.html" class="Module">Type.BetaNBE</a>
<a id="841" class="Keyword">open</a> <a id="846" class="Keyword">import</a> <a id="853" href="Type.BetaNormal.html" class="Module">Type.BetaNormal</a>
<a id="869" class="Keyword">open</a> <a id="874" class="Keyword">import</a> <a id="881" href="Untyped.html" class="Module">Untyped</a> <a id="889" class="Symbol">as</a> <a id="892" class="Module">U</a>
<a id="894" class="Keyword">import</a> <a id="901" href="Untyped.Reduction.html" class="Module">Untyped.Reduction</a> <a id="919" class="Symbol">as</a> <a id="922" class="Module">U</a>
<a id="924" class="Keyword">import</a> <a id="931" href="Scoped.html" class="Module">Scoped</a> <a id="938" class="Symbol">as</a> <a id="941" class="Module">S</a>
<a id="943" class="Keyword">import</a> <a id="950" href="Scoped.Reduction.html" class="Module">Scoped.Reduction</a> <a id="967" class="Symbol">as</a> <a id="970" class="Module">S</a>
<a id="972" class="Keyword">open</a> <a id="977" class="Keyword">import</a> <a id="984" href="Raw.html" class="Module">Raw</a>
<a id="988" class="Keyword">open</a> <a id="993" class="Keyword">import</a> <a id="1000" href="Scoped.html" class="Module">Scoped</a>
<a id="1007" class="Keyword">open</a> <a id="1012" class="Keyword">import</a> <a id="1019" href="Utils.html" class="Module">Utils</a>
<a id="1025" class="Keyword">open</a> <a id="1030" class="Keyword">import</a> <a id="1037" href="Untyped.html" class="Module">Untyped</a>
<a id="1045" class="Keyword">open</a> <a id="1050" class="Keyword">import</a> <a id="1057" href="Scoped.CK.html" class="Module">Scoped.CK</a>
<a id="1067" class="Keyword">open</a> <a id="1072" class="Keyword">import</a> <a id="1079" href="Algorithmic.html" class="Module">Algorithmic</a>
<a id="1091" class="Keyword">open</a> <a id="1096" class="Keyword">import</a> <a id="1103" href="Algorithmic.Reduction.html" class="Module">Algorithmic.Reduction</a>
<a id="1125" class="Keyword">open</a> <a id="1130" class="Keyword">import</a> <a id="1137" href="Algorithmic.CK.html" class="Module">Algorithmic.CK</a>
<a id="1152" class="Keyword">open</a> <a id="1157" class="Keyword">import</a> <a id="1164" href="Algorithmic.CEKV.html" class="Module">Algorithmic.CEKV</a>
<a id="1181" class="Keyword">open</a> <a id="1186" class="Keyword">import</a> <a id="1193" href="Scoped.Erasure.html" class="Module">Scoped.Erasure</a>


<a id="1210" class="Comment">-- There&#39;s a long prelude here that could go in a different file but</a>
<a id="1279" class="Comment">-- currently it&#39;s only used here</a>

<a id="1313" class="Comment">-- Text Stuff</a>

<a id="1328" class="Keyword">postulate</a>
  <a id="putStrLn"></a><a id="1340" href="Main.html#1340" class="Postulate">putStrLn</a> <a id="1349" class="Symbol">:</a> <a id="1351" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="1358" class="Symbol">→</a> <a id="1360" href="Agda.Builtin.IO.html#138" class="Postulate">IO</a> <a id="1363" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>

<a id="1366" class="Symbol">{-#</a> <a id="1370" class="Keyword">FOREIGN</a> <a id="1378" class="Pragma">GHC</a> <a id="1382" class="Pragma">import</a> <a id="1389" class="Pragma">qualified</a> <a id="1399" class="Pragma">Data.Text</a> <a id="1409" class="Pragma">as</a> <a id="1412" class="Pragma">T</a> <a id="1414" class="Symbol">#-}</a>
<a id="1418" class="Symbol">{-#</a> <a id="1422" class="Keyword">FOREIGN</a> <a id="1430" class="Pragma">GHC</a> <a id="1434" class="Pragma">import</a> <a id="1441" class="Pragma">qualified</a> <a id="1451" class="Pragma">Data.Text.IO</a> <a id="1464" class="Pragma">as</a> <a id="1467" class="Pragma">TextIO</a> <a id="1474" class="Symbol">#-}</a>
<a id="1478" class="Symbol">{-#</a> <a id="1482" class="Keyword">COMPILE</a> <a id="1490" class="Keyword">GHC</a> <a id="1494" href="Main.html#1340" class="Postulate">putStrLn</a> <a id="1503" class="Pragma">=</a> <a id="1505" class="Pragma">TextIO.putStrLn</a> <a id="1521" class="Symbol">#-}</a>

<a id="1526" class="Comment">-- IO Stuff</a>

<a id="1539" class="Keyword">instance</a>
  <a id="IOMonad"></a><a id="1550" href="Main.html#1550" class="Function">IOMonad</a> <a id="1558" class="Symbol">:</a> <a id="1560" href="Utils.html#3246" class="Record">Monad</a> <a id="1566" href="Agda.Builtin.IO.html#138" class="Postulate">IO</a>
  <a id="1571" href="Main.html#1550" class="Function">IOMonad</a> <a id="1579" class="Symbol">=</a> <a id="1581" class="Keyword">record</a> <a id="1588" class="Symbol">{</a> <a id="1590" href="Utils.html#3293" class="Field">return</a> <a id="1597" class="Symbol">=</a> <a id="1599" href="IO.Primitive.html#610" class="Postulate">IO.return</a><a id="1608" class="Symbol">;</a> <a id="1610" href="Utils.html#3321" class="Field Operator">_&gt;&gt;=_</a> <a id="1616" class="Symbol">=</a> <a id="1618" href="IO.Primitive.html#650" class="Postulate Operator">IO._&gt;&gt;=_</a> <a id="1627" class="Symbol">}</a>

<a id="1630" class="Comment">-- Bytestring stuff</a>

<a id="1651" class="Keyword">postulate</a>
  <a id="ByteString"></a><a id="1663" href="Main.html#1663" class="Postulate">ByteString</a> <a id="1674" class="Symbol">:</a> <a id="1676" class="PrimitiveType">Set</a>
  <a id="getContents"></a><a id="1682" href="Main.html#1682" class="Postulate">getContents</a> <a id="1694" class="Symbol">:</a> <a id="1696" href="Agda.Builtin.IO.html#138" class="Postulate">IO</a> <a id="1699" href="Main.html#1663" class="Postulate">ByteString</a>
  <a id="readFile"></a><a id="1712" href="Main.html#1712" class="Postulate">readFile</a> <a id="1721" class="Symbol">:</a> <a id="1723" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="1730" class="Symbol">→</a> <a id="1732" href="Agda.Builtin.IO.html#138" class="Postulate">IO</a> <a id="1735" href="Main.html#1663" class="Postulate">ByteString</a>

<a id="1747" class="Symbol">{-#</a> <a id="1751" class="Keyword">FOREIGN</a> <a id="1759" class="Pragma">GHC</a> <a id="1763" class="Pragma">import</a> <a id="1770" class="Pragma">qualified</a> <a id="1780" class="Pragma">Data.ByteString.Lazy</a> <a id="1801" class="Pragma">as</a> <a id="1804" class="Pragma">BSL</a> <a id="1808" class="Symbol">#-}</a>
<a id="1812" class="Symbol">{-#</a> <a id="1816" class="Keyword">COMPILE</a> <a id="1824" class="Keyword">GHC</a> <a id="1828" href="Main.html#1663" class="Postulate">ByteString</a> <a id="1839" class="Pragma">=</a> <a id="1841" class="Pragma">type</a> <a id="1846" class="Pragma">BSL.ByteString</a> <a id="1861" class="Symbol">#-}</a>
<a id="1865" class="Symbol">{-#</a> <a id="1869" class="Keyword">COMPILE</a> <a id="1877" class="Keyword">GHC</a> <a id="1881" href="Main.html#1712" class="Postulate">readFile</a> <a id="1890" class="Pragma">=</a> <a id="1892" class="Pragma">\</a> <a id="1894" class="Pragma">s</a> <a id="1896" class="Pragma">-&gt;</a> <a id="1899" class="Pragma">BSL.readFile</a> <a id="1912" class="Pragma">(T.unpack</a> <a id="1922" class="Pragma">s)</a> <a id="1925" class="Symbol">#-}</a>
<a id="1929" class="Symbol">{-#</a> <a id="1933" class="Keyword">COMPILE</a> <a id="1941" class="Keyword">GHC</a> <a id="1945" href="Main.html#1682" class="Postulate">getContents</a> <a id="1957" class="Pragma">=</a> <a id="1959" class="Pragma">BSL.getContents</a> <a id="1975" class="Symbol">#-}</a>

<a id="1980" class="Comment">-- System.Exit stuff</a>

<a id="2002" class="Keyword">postulate</a>
  <a id="exitFailure"></a><a id="2014" href="Main.html#2014" class="Postulate">exitFailure</a> <a id="2026" class="Symbol">:</a> <a id="2028" href="Agda.Builtin.IO.html#138" class="Postulate">IO</a> <a id="2031" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
  <a id="exitSuccess"></a><a id="2035" href="Main.html#2035" class="Postulate">exitSuccess</a> <a id="2047" class="Symbol">:</a> <a id="2049" href="Agda.Builtin.IO.html#138" class="Postulate">IO</a> <a id="2052" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>

<a id="2055" class="Symbol">{-#</a> <a id="2059" class="Keyword">FOREIGN</a> <a id="2067" class="Pragma">GHC</a> <a id="2071" class="Pragma">import</a> <a id="2078" class="Pragma">System.Exit</a> <a id="2090" class="Symbol">#-}</a>
<a id="2094" class="Symbol">{-#</a> <a id="2098" class="Keyword">COMPILE</a> <a id="2106" class="Keyword">GHC</a> <a id="2110" href="Main.html#2035" class="Postulate">exitSuccess</a> <a id="2122" class="Pragma">=</a> <a id="2124" class="Pragma">exitSuccess</a> <a id="2136" class="Symbol">#-}</a>
<a id="2140" class="Symbol">{-#</a> <a id="2144" class="Keyword">COMPILE</a> <a id="2152" class="Keyword">GHC</a> <a id="2156" href="Main.html#2014" class="Postulate">exitFailure</a> <a id="2168" class="Pragma">=</a> <a id="2170" class="Pragma">exitFailure</a> <a id="2182" class="Symbol">#-}</a>

<a id="2187" class="Comment">-- System.Environment stuff</a>

<a id="2216" class="Keyword">postulate</a>
  <a id="getArgs"></a><a id="2228" href="Main.html#2228" class="Postulate">getArgs</a> <a id="2236" class="Symbol">:</a> <a id="2238" href="Agda.Builtin.IO.html#138" class="Postulate">IO</a> <a id="2241" class="Symbol">(</a><a id="2242" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2247" href="Agda.Builtin.String.html#274" class="Postulate">String</a><a id="2253" class="Symbol">)</a>

<a id="2256" class="Symbol">{-#</a> <a id="2260" class="Keyword">FOREIGN</a> <a id="2268" class="Pragma">GHC</a> <a id="2272" class="Pragma">import</a> <a id="2279" class="Pragma">System.Environment</a> <a id="2298" class="Symbol">#-}</a>
<a id="2302" class="Symbol">{-#</a> <a id="2306" class="Keyword">COMPILE</a> <a id="2314" class="Keyword">GHC</a> <a id="2318" href="Main.html#2228" class="Postulate">getArgs</a> <a id="2326" class="Pragma">=</a> <a id="2328" class="Pragma">(fmap</a> <a id="2334" class="Pragma">.</a> <a id="2336" class="Pragma">fmap)</a> <a id="2342" class="Pragma">T.pack</a> <a id="2349" class="Pragma">$</a> <a id="2351" class="Pragma">getArgs</a> <a id="2359" class="Symbol">#-}</a>

<a id="2364" class="Comment">-- Misc stuff</a>

<a id="2379" class="Symbol">{-#</a> <a id="2383" class="Keyword">FOREIGN</a> <a id="2391" class="Pragma">GHC</a> <a id="2395" class="Pragma">import</a> <a id="2402" class="Pragma">Data.Either</a> <a id="2414" class="Symbol">#-}</a>
<a id="2418" class="Symbol">{-#</a> <a id="2422" class="Keyword">FOREIGN</a> <a id="2430" class="Pragma">GHC</a> <a id="2434" class="Pragma">import</a> <a id="2441" class="Pragma">Control.Monad.Trans.Except</a> <a id="2468" class="Symbol">#-}</a>

<a id="2473" class="Keyword">postulate</a>
  <a id="TermN"></a><a id="2485" href="Main.html#2485" class="Postulate">TermN</a> <a id="2491" class="Symbol">:</a> <a id="2493" class="PrimitiveType">Set</a> <a id="2497" class="Comment">-- term with names</a>
  <a id="Term"></a><a id="2518" href="Main.html#2518" class="Postulate">Term</a> <a id="2523" class="Symbol">:</a> <a id="2525" class="PrimitiveType">Set</a>  <a id="2530" class="Comment">-- DeBruijn term</a>
  <a id="TypeN"></a><a id="2549" href="Main.html#2549" class="Postulate">TypeN</a> <a id="2555" class="Symbol">:</a> <a id="2557" class="PrimitiveType">Set</a>
  <a id="Type"></a><a id="2563" href="Main.html#2563" class="Postulate">Type</a> <a id="2568" class="Symbol">:</a> <a id="2570" class="PrimitiveType">Set</a>
  <a id="ProgramN"></a><a id="2576" href="Main.html#2576" class="Postulate">ProgramN</a> <a id="2585" class="Symbol">:</a> <a id="2587" class="PrimitiveType">Set</a>
  <a id="Program"></a><a id="2593" href="Main.html#2593" class="Postulate">Program</a> <a id="2601" class="Symbol">:</a> <a id="2603" class="PrimitiveType">Set</a>
  <a id="convTm"></a><a id="2609" href="Main.html#2609" class="Postulate">convTm</a> <a id="2616" class="Symbol">:</a> <a id="2618" href="Main.html#2518" class="Postulate">Term</a> <a id="2623" class="Symbol">→</a> <a id="2625" href="Raw.html#1138" class="Datatype">RawTm</a>
  <a id="convTy"></a><a id="2633" href="Main.html#2633" class="Postulate">convTy</a> <a id="2640" class="Symbol">:</a> <a id="2642" href="Main.html#2563" class="Postulate">Type</a> <a id="2647" class="Symbol">→</a> <a id="2649" href="Raw.html#694" class="Datatype">RawTy</a>
  <a id="unconvTy"></a><a id="2657" href="Main.html#2657" class="Postulate">unconvTy</a> <a id="2666" class="Symbol">:</a> <a id="2668" href="Raw.html#694" class="Datatype">RawTy</a> <a id="2674" class="Symbol">→</a> <a id="2676" href="Main.html#2563" class="Postulate">Type</a>
  <a id="unconvTm"></a><a id="2683" href="Main.html#2683" class="Postulate">unconvTm</a> <a id="2692" class="Symbol">:</a> <a id="2694" href="Raw.html#1138" class="Datatype">RawTm</a> <a id="2700" class="Symbol">→</a> <a id="2702" href="Main.html#2518" class="Postulate">Term</a>
  <a id="convP"></a><a id="2709" href="Main.html#2709" class="Postulate">convP</a> <a id="2715" class="Symbol">:</a> <a id="2717" href="Main.html#2593" class="Postulate">Program</a> <a id="2725" class="Symbol">→</a> <a id="2727" href="Raw.html#1138" class="Datatype">RawTm</a>
  <a id="ParseError"></a><a id="2735" href="Main.html#2735" class="Postulate">ParseError</a> <a id="2746" class="Symbol">:</a> <a id="2748" class="PrimitiveType">Set</a>
  <a id="parse"></a><a id="2754" href="Main.html#2754" class="Postulate">parse</a> <a id="2760" class="Symbol">:</a> <a id="2762" href="Main.html#1663" class="Postulate">ByteString</a> <a id="2773" class="Symbol">→</a> <a id="2775" href="Utils.html#904" class="Datatype">Either</a> <a id="2782" href="Main.html#2735" class="Postulate">ParseError</a> <a id="2793" href="Main.html#2576" class="Postulate">ProgramN</a>
  <a id="parseTm"></a><a id="2804" href="Main.html#2804" class="Postulate">parseTm</a> <a id="2812" class="Symbol">:</a> <a id="2814" href="Main.html#1663" class="Postulate">ByteString</a> <a id="2825" class="Symbol">→</a> <a id="2827" href="Utils.html#904" class="Datatype">Either</a> <a id="2834" href="Main.html#2735" class="Postulate">ParseError</a> <a id="2845" href="Main.html#2485" class="Postulate">TermN</a>
  <a id="parseTy"></a><a id="2853" href="Main.html#2853" class="Postulate">parseTy</a> <a id="2861" class="Symbol">:</a> <a id="2863" href="Main.html#1663" class="Postulate">ByteString</a> <a id="2874" class="Symbol">→</a> <a id="2876" href="Utils.html#904" class="Datatype">Either</a> <a id="2883" href="Main.html#2735" class="Postulate">ParseError</a> <a id="2894" href="Main.html#2549" class="Postulate">TypeN</a>
  <a id="showTerm"></a><a id="2902" href="Main.html#2902" class="Postulate">showTerm</a> <a id="2911" class="Symbol">:</a> <a id="2913" href="Raw.html#1138" class="Datatype">RawTm</a> <a id="2919" class="Symbol">→</a> <a id="2921" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
  <a id="deBruijnify"></a><a id="2930" href="Main.html#2930" class="Postulate">deBruijnify</a> <a id="2942" class="Symbol">:</a> <a id="2944" href="Main.html#2576" class="Postulate">ProgramN</a> <a id="2953" class="Symbol">→</a> <a id="2955" href="Utils.html#904" class="Datatype">Either</a> <a id="2962" href="Scoped.html#7345" class="Postulate">FreeVariableError</a> <a id="2980" href="Main.html#2593" class="Postulate">Program</a>
  <a id="deBruijnifyTm"></a><a id="2990" href="Main.html#2990" class="Postulate">deBruijnifyTm</a> <a id="3004" class="Symbol">:</a> <a id="3006" href="Main.html#2485" class="Postulate">TermN</a> <a id="3012" class="Symbol">→</a> <a id="3014" href="Utils.html#486" class="Datatype">Maybe</a> <a id="3020" href="Main.html#2518" class="Postulate">Term</a>
  <a id="deBruijnifyTy"></a><a id="3027" href="Main.html#3027" class="Postulate">deBruijnifyTy</a> <a id="3041" class="Symbol">:</a> <a id="3043" href="Main.html#2549" class="Postulate">TypeN</a> <a id="3049" class="Symbol">→</a> <a id="3051" href="Utils.html#486" class="Datatype">Maybe</a> <a id="3057" href="Main.html#2563" class="Postulate">Type</a>

<a id="3063" class="Symbol">{-#</a> <a id="3067" class="Keyword">FOREIGN</a> <a id="3075" class="Pragma">GHC</a> <a id="3079" class="Pragma">import</a> <a id="3086" class="Pragma">Language.PlutusCore.Name</a> <a id="3111" class="Symbol">#-}</a>
<a id="3115" class="Symbol">{-#</a> <a id="3119" class="Keyword">FOREIGN</a> <a id="3127" class="Pragma">GHC</a> <a id="3131" class="Pragma">import</a> <a id="3138" class="Pragma">Language.PlutusCore.Lexer</a> <a id="3164" class="Symbol">#-}</a>
<a id="3168" class="Symbol">{-#</a> <a id="3172" class="Keyword">FOREIGN</a> <a id="3180" class="Pragma">GHC</a> <a id="3184" class="Pragma">import</a> <a id="3191" class="Pragma">Language.PlutusCore.Parser</a> <a id="3218" class="Symbol">#-}</a>
<a id="3222" class="Symbol">{-#</a> <a id="3226" class="Keyword">FOREIGN</a> <a id="3234" class="Pragma">GHC</a> <a id="3238" class="Pragma">import</a> <a id="3245" class="Pragma">Language.PlutusCore.Pretty</a> <a id="3272" class="Symbol">#-}</a>
<a id="3276" class="Symbol">{-#</a> <a id="3280" class="Keyword">FOREIGN</a> <a id="3288" class="Pragma">GHC</a> <a id="3292" class="Pragma">import</a> <a id="3299" class="Pragma">Language.PlutusCore.DeBruijn</a> <a id="3328" class="Symbol">#-}</a>
<a id="3332" class="Symbol">{-#</a> <a id="3336" class="Keyword">FOREIGN</a> <a id="3344" class="Pragma">GHC</a> <a id="3348" class="Pragma">import</a> <a id="3355" class="Pragma">Raw</a> <a id="3359" class="Symbol">#-}</a>
<a id="3363" class="Symbol">{-#</a> <a id="3367" class="Keyword">COMPILE</a> <a id="3375" class="Keyword">GHC</a> <a id="3379" href="Main.html#2709" class="Postulate">convP</a> <a id="3385" class="Pragma">=</a> <a id="3387" class="Pragma">convP</a> <a id="3393" class="Symbol">#-}</a>
<a id="3397" class="Symbol">{-#</a> <a id="3401" class="Keyword">COMPILE</a> <a id="3409" class="Keyword">GHC</a> <a id="3413" href="Main.html#2609" class="Postulate">convTm</a> <a id="3420" class="Pragma">=</a> <a id="3422" class="Pragma">conv</a> <a id="3427" class="Symbol">#-}</a>
<a id="3431" class="Symbol">{-#</a> <a id="3435" class="Keyword">COMPILE</a> <a id="3443" class="Keyword">GHC</a> <a id="3447" href="Main.html#2633" class="Postulate">convTy</a> <a id="3454" class="Pragma">=</a> <a id="3456" class="Pragma">convT</a> <a id="3462" class="Symbol">#-}</a>
<a id="3466" class="Symbol">{-#</a> <a id="3470" class="Keyword">COMPILE</a> <a id="3478" class="Keyword">GHC</a> <a id="3482" href="Main.html#2657" class="Postulate">unconvTy</a> <a id="3491" class="Pragma">=</a> <a id="3493" class="Pragma">unconvT</a> <a id="3501" class="Pragma">0</a> <a id="3503" class="Symbol">#-}</a>
<a id="3507" class="Symbol">{-#</a> <a id="3511" class="Keyword">COMPILE</a> <a id="3519" class="Keyword">GHC</a> <a id="3523" href="Main.html#2683" class="Postulate">unconvTm</a> <a id="3532" class="Pragma">=</a> <a id="3534" class="Pragma">unconv</a> <a id="3541" class="Pragma">0</a> <a id="3543" class="Symbol">#-}</a>
<a id="3547" class="Symbol">{-#</a> <a id="3551" class="Keyword">FOREIGN</a> <a id="3559" class="Pragma">GHC</a> <a id="3563" class="Pragma">import</a> <a id="3570" class="Pragma">Data.Bifunctor</a> <a id="3585" class="Symbol">#-}</a>

<a id="3590" class="Symbol">{-#</a> <a id="3594" class="Keyword">COMPILE</a> <a id="3602" class="Keyword">GHC</a> <a id="3606" href="Main.html#2735" class="Postulate">ParseError</a> <a id="3617" class="Pragma">=</a> <a id="3619" class="Pragma">type</a> <a id="3624" class="Pragma">ParseError</a> <a id="3635" class="Pragma">()</a> <a id="3638" class="Symbol">#-}</a>
<a id="3642" class="Symbol">{-#</a> <a id="3646" class="Keyword">COMPILE</a> <a id="3654" class="Keyword">GHC</a> <a id="3658" href="Main.html#2754" class="Postulate">parse</a> <a id="3664" class="Pragma">=</a> <a id="3666" class="Pragma">first</a> <a id="3672" class="Pragma">(()</a> <a id="3676" class="Pragma">&lt;$)</a> <a id="3680" class="Pragma">.</a> <a id="3682" class="Pragma">runQuote</a> <a id="3691" class="Pragma">.</a> <a id="3693" class="Pragma">runExceptT</a> <a id="3704" class="Pragma">.</a> <a id="3706" class="Pragma">parseProgram</a>  <a id="3720" class="Symbol">#-}</a>
<a id="3724" class="Symbol">{-#</a> <a id="3728" class="Keyword">COMPILE</a> <a id="3736" class="Keyword">GHC</a> <a id="3740" href="Main.html#2804" class="Postulate">parseTm</a> <a id="3748" class="Pragma">=</a> <a id="3750" class="Pragma">first</a> <a id="3756" class="Pragma">(()</a> <a id="3760" class="Pragma">&lt;$)</a> <a id="3764" class="Pragma">.</a> <a id="3766" class="Pragma">runQuote.</a> <a id="3776" class="Pragma">runExceptT</a> <a id="3787" class="Pragma">.</a> <a id="3789" class="Pragma">parseTerm</a>  <a id="3800" class="Symbol">#-}</a>
<a id="3804" class="Symbol">{-#</a> <a id="3808" class="Keyword">COMPILE</a> <a id="3816" class="Keyword">GHC</a> <a id="3820" href="Main.html#2853" class="Postulate">parseTy</a> <a id="3828" class="Pragma">=</a> <a id="3830" class="Pragma">first</a> <a id="3836" class="Pragma">(()</a> <a id="3840" class="Pragma">&lt;$)</a> <a id="3844" class="Pragma">.</a> <a id="3846" class="Pragma">runQuote</a> <a id="3855" class="Pragma">.</a> <a id="3857" class="Pragma">runExceptT</a> <a id="3868" class="Pragma">.</a> <a id="3870" class="Pragma">parseType</a>  <a id="3881" class="Symbol">#-}</a>
<a id="3885" class="Symbol">{-#</a> <a id="3889" class="Keyword">COMPILE</a> <a id="3897" class="Keyword">GHC</a> <a id="3901" href="Main.html#2930" class="Postulate">deBruijnify</a> <a id="3913" class="Pragma">=</a> <a id="3915" class="Pragma">second</a> <a id="3922" class="Pragma">(()</a> <a id="3926" class="Pragma">&lt;$)</a> <a id="3930" class="Pragma">.</a> <a id="3932" class="Pragma">runExcept</a> <a id="3942" class="Pragma">.</a> <a id="3944" class="Pragma">deBruijnProgram</a> <a id="3960" class="Symbol">#-}</a>
<a id="3964" class="Symbol">{-#</a> <a id="3968" class="Keyword">COMPILE</a> <a id="3976" class="Keyword">GHC</a> <a id="3980" href="Main.html#2990" class="Postulate">deBruijnifyTm</a> <a id="3994" class="Pragma">=</a> <a id="3996" class="Pragma">either</a> <a id="4003" class="Pragma">(\_</a> <a id="4007" class="Pragma">-&gt;</a> <a id="4010" class="Pragma">Nothing)</a> <a id="4019" class="Pragma">Just</a> <a id="4024" class="Pragma">.</a> <a id="4026" class="Pragma">runExcept</a> <a id="4036" class="Pragma">.</a> <a id="4038" class="Pragma">deBruijnTerm</a> <a id="4051" class="Pragma">.</a> <a id="4053" class="Pragma">(()</a> <a id="4057" class="Pragma">&lt;$)</a> <a id="4061" class="Symbol">#-}</a>
<a id="4065" class="Symbol">{-#</a> <a id="4069" class="Keyword">COMPILE</a> <a id="4077" class="Keyword">GHC</a> <a id="4081" href="Main.html#3027" class="Postulate">deBruijnifyTy</a> <a id="4095" class="Pragma">=</a> <a id="4097" class="Pragma">either</a> <a id="4104" class="Pragma">(\_</a> <a id="4108" class="Pragma">-&gt;</a> <a id="4111" class="Pragma">Nothing)</a> <a id="4120" class="Pragma">Just</a> <a id="4125" class="Pragma">.</a> <a id="4127" class="Pragma">runExcept</a> <a id="4137" class="Pragma">.</a> <a id="4139" class="Pragma">deBruijnTy</a> <a id="4150" class="Pragma">.</a> <a id="4152" class="Pragma">(()</a> <a id="4156" class="Pragma">&lt;$)</a> <a id="4160" class="Symbol">#-}</a>
<a id="4164" class="Symbol">{-#</a> <a id="4168" class="Keyword">FOREIGN</a> <a id="4176" class="Pragma">GHC</a> <a id="4180" class="Pragma">import</a> <a id="4187" class="Pragma">Language.PlutusCore</a> <a id="4207" class="Symbol">#-}</a>
<a id="4211" class="Symbol">{-#</a> <a id="4215" class="Keyword">COMPILE</a> <a id="4223" class="Keyword">GHC</a> <a id="4227" href="Main.html#2576" class="Postulate">ProgramN</a> <a id="4236" class="Pragma">=</a> <a id="4238" class="Pragma">type</a> <a id="4243" class="Pragma">Language.PlutusCore.Program</a> <a id="4271" class="Pragma">TyName</a> <a id="4278" class="Pragma">Name</a> <a id="4283" class="Pragma">DefaultUni</a> <a id="4294" class="Pragma">DefaultFun</a> <a id="4305" class="Pragma">Language.PlutusCore.Lexer.AlexPosn</a> <a id="4340" class="Symbol">#-}</a>
<a id="4344" class="Symbol">{-#</a> <a id="4348" class="Keyword">COMPILE</a> <a id="4356" class="Keyword">GHC</a> <a id="4360" href="Main.html#2593" class="Postulate">Program</a> <a id="4368" class="Pragma">=</a> <a id="4370" class="Pragma">type</a> <a id="4375" class="Pragma">Language.PlutusCore.Program</a> <a id="4403" class="Pragma">NamedTyDeBruijn</a> <a id="4419" class="Pragma">NamedDeBruijn</a> <a id="4433" class="Pragma">DefaultUni</a> <a id="4444" class="Pragma">DefaultFun</a> <a id="4455" class="Pragma">()</a> <a id="4458" class="Symbol">#-}</a>
<a id="4462" class="Symbol">{-#</a> <a id="4466" class="Keyword">COMPILE</a> <a id="4474" class="Keyword">GHC</a> <a id="4478" href="Main.html#2485" class="Postulate">TermN</a> <a id="4484" class="Pragma">=</a> <a id="4486" class="Pragma">type</a> <a id="4491" class="Pragma">Language.PlutusCore.Term</a> <a id="4516" class="Pragma">TyName</a> <a id="4523" class="Pragma">Name</a> <a id="4528" class="Pragma">DefaultUni</a> <a id="4539" class="Pragma">DefaultFun</a> <a id="4550" class="Pragma">Language.PlutusCore.Lexer.AlexPosn</a> <a id="4585" class="Symbol">#-}</a>
<a id="4589" class="Symbol">{-#</a> <a id="4593" class="Keyword">COMPILE</a> <a id="4601" class="Keyword">GHC</a> <a id="4605" href="Main.html#2518" class="Postulate">Term</a> <a id="4610" class="Pragma">=</a> <a id="4612" class="Pragma">type</a> <a id="4617" class="Pragma">Language.PlutusCore.Term</a> <a id="4642" class="Pragma">NamedTyDeBruijn</a> <a id="4658" class="Pragma">NamedDeBruijn</a> <a id="4672" class="Pragma">DefaultUni</a> <a id="4683" class="Pragma">DefaultFun</a> <a id="4694" class="Pragma">()</a> <a id="4697" class="Symbol">#-}</a>
<a id="4701" class="Symbol">{-#</a> <a id="4705" class="Keyword">COMPILE</a> <a id="4713" class="Keyword">GHC</a> <a id="4717" href="Main.html#2549" class="Postulate">TypeN</a> <a id="4723" class="Pragma">=</a> <a id="4725" class="Pragma">type</a> <a id="4730" class="Pragma">Language.PlutusCore.Type</a> <a id="4755" class="Pragma">TyName</a> <a id="4762" class="Pragma">DefaultUni</a> <a id="4773" class="Pragma">Language.PlutusCore.Lexer.AlexPosn</a> <a id="4808" class="Symbol">#-}</a>
<a id="4812" class="Symbol">{-#</a> <a id="4816" class="Keyword">COMPILE</a> <a id="4824" class="Keyword">GHC</a> <a id="4828" href="Main.html#2563" class="Postulate">Type</a> <a id="4833" class="Pragma">=</a> <a id="4835" class="Pragma">type</a> <a id="4840" class="Pragma">Language.PlutusCore.Type</a> <a id="4865" class="Pragma">NamedTyDeBruijn</a> <a id="4881" class="Pragma">DefaultUni</a> <a id="4892" class="Pragma">()</a> <a id="4895" class="Symbol">#-}</a>

<a id="4900" class="Symbol">{-#</a> <a id="4904" class="Keyword">COMPILE</a> <a id="4912" class="Keyword">GHC</a> <a id="4916" href="Main.html#2902" class="Postulate">showTerm</a> <a id="4925" class="Pragma">=</a> <a id="4927" class="Pragma">T.pack</a> <a id="4934" class="Pragma">.</a> <a id="4936" class="Pragma">show</a> <a id="4941" class="Symbol">#-}</a>

<a id="4946" class="Keyword">postulate</a>
  <a id="prettyPrintTm"></a><a id="4958" href="Main.html#4958" class="Postulate">prettyPrintTm</a> <a id="4972" class="Symbol">:</a> <a id="4974" href="Raw.html#1138" class="Datatype">RawTm</a> <a id="4980" class="Symbol">→</a> <a id="4982" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
  <a id="prettyPrintTy"></a><a id="4991" href="Main.html#4991" class="Postulate">prettyPrintTy</a> <a id="5005" class="Symbol">:</a> <a id="5007" href="Raw.html#694" class="Datatype">RawTy</a> <a id="5013" class="Symbol">→</a> <a id="5015" href="Agda.Builtin.String.html#274" class="Postulate">String</a>

<a id="5023" class="Symbol">{-#</a> <a id="5027" class="Keyword">FOREIGN</a> <a id="5035" class="Pragma">GHC</a> <a id="5039" class="Symbol">{-#</a> <a id="5043" class="Pragma">LANGUAGE</a> <a id="5052" class="Pragma">TypeApplications</a> <a id="5069" class="Symbol">#-}</a> <a id="5073" class="Symbol">#-}</a>
<a id="5077" class="Symbol">{-#</a> <a id="5081" class="Keyword">COMPILE</a> <a id="5089" class="Keyword">GHC</a> <a id="5093" href="Main.html#4958" class="Postulate">prettyPrintTm</a> <a id="5107" class="Pragma">=</a> <a id="5109" class="Pragma">display</a> <a id="5117" class="Pragma">@T.Text</a> <a id="5125" class="Pragma">.</a> <a id="5127" class="Pragma">unconv</a> <a id="5134" class="Pragma">0</a> <a id="5136" class="Symbol">#-}</a>
<a id="5140" class="Symbol">{-#</a> <a id="5144" class="Keyword">COMPILE</a> <a id="5152" class="Keyword">GHC</a> <a id="5156" href="Main.html#4991" class="Postulate">prettyPrintTy</a> <a id="5170" class="Pragma">=</a> <a id="5172" class="Pragma">display</a> <a id="5180" class="Pragma">@T.Text</a> <a id="5188" class="Pragma">.</a> <a id="5190" class="Pragma">unconvT</a> <a id="5198" class="Pragma">0</a> <a id="5200" class="Symbol">#-}</a>

<a id="5205" class="Keyword">data</a> <a id="EvalMode"></a><a id="5210" href="Main.html#5210" class="Datatype">EvalMode</a> <a id="5219" class="Symbol">:</a> <a id="5221" class="PrimitiveType">Set</a> <a id="5225" class="Keyword">where</a>
  <a id="EvalMode.U"></a><a id="5233" href="Main.html#5233" class="InductiveConstructor">U</a> <a id="EvalMode.TL"></a><a id="5235" href="Main.html#5235" class="InductiveConstructor">TL</a> <a id="EvalMode.L"></a><a id="5238" href="Main.html#5238" class="InductiveConstructor">L</a> <a id="EvalMode.TCK"></a><a id="5240" href="Main.html#5240" class="InductiveConstructor">TCK</a> <a id="EvalMode.CK"></a><a id="5244" href="Main.html#5244" class="InductiveConstructor">CK</a> <a id="EvalMode.TCEK"></a><a id="5247" href="Main.html#5247" class="InductiveConstructor">TCEK</a> <a id="5252" class="Symbol">:</a> <a id="5254" href="Main.html#5210" class="Datatype">EvalMode</a>

<a id="5264" class="Symbol">{-#</a> <a id="5268" class="Keyword">COMPILE</a> <a id="5276" class="Keyword">GHC</a> <a id="5280" href="Main.html#5210" class="Datatype">EvalMode</a> <a id="5289" class="Pragma">=</a> <a id="5291" class="Pragma">data</a> <a id="5296" class="Pragma">EvalMode</a> <a id="5305" class="Pragma">(U</a> <a id="5308" class="Pragma">|</a> <a id="5310" class="Pragma">TL</a> <a id="5313" class="Pragma">|</a> <a id="5315" class="Pragma">L</a> <a id="5317" class="Pragma">|</a> <a id="5319" class="Pragma">TCK</a> <a id="5323" class="Pragma">|</a> <a id="5325" class="Pragma">CK</a> <a id="5328" class="Pragma">|</a> <a id="5330" class="Pragma">TCEK)</a> <a id="5336" class="Symbol">#-}</a>

<a id="5341" class="Comment">-- the Error&#39;s returned by `plc-agda` and the haskell interface to `metatheory`.</a>

<a id="5423" class="Keyword">data</a> <a id="ERROR"></a><a id="5428" href="Main.html#5428" class="Datatype">ERROR</a> <a id="5434" class="Symbol">:</a> <a id="5436" class="PrimitiveType">Set</a> <a id="5440" class="Keyword">where</a>
  <a id="ERROR.typeError"></a><a id="5448" href="Main.html#5448" class="InductiveConstructor">typeError</a> <a id="5458" class="Symbol">:</a> <a id="5460" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="5467" class="Symbol">→</a> <a id="5469" href="Main.html#5428" class="Datatype">ERROR</a>
  <a id="ERROR.parseError"></a><a id="5477" href="Main.html#5477" class="InductiveConstructor">parseError</a> <a id="5488" class="Symbol">:</a> <a id="5490" href="Main.html#2735" class="Postulate">ParseError</a> <a id="5501" class="Symbol">→</a> <a id="5503" href="Main.html#5428" class="Datatype">ERROR</a>
  <a id="ERROR.scopeError"></a><a id="5511" href="Main.html#5511" class="InductiveConstructor">scopeError</a> <a id="5522" class="Symbol">:</a> <a id="5524" href="Scoped.html#7440" class="Datatype">ScopeError</a> <a id="5535" class="Symbol">→</a> <a id="5537" href="Main.html#5428" class="Datatype">ERROR</a>
  <a id="ERROR.runtimeError"></a><a id="5545" href="Main.html#5545" class="InductiveConstructor">runtimeError</a> <a id="5558" class="Symbol">:</a> <a id="5560" href="Utils.html#4236" class="Datatype">RuntimeError</a> <a id="5573" class="Symbol">→</a> <a id="5575" href="Main.html#5428" class="Datatype">ERROR</a>


<a id="uglyTypeError"></a><a id="5583" href="Main.html#5583" class="Function">uglyTypeError</a> <a id="5597" class="Symbol">:</a> <a id="5599" href="Check.html#1105" class="Datatype">TypeError</a> <a id="5609" class="Symbol">→</a> <a id="5611" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="5618" href="Main.html#5583" class="Function">uglyTypeError</a> <a id="5632" class="Symbol">(</a><a id="5633" href="Check.html#1129" class="InductiveConstructor">kindMismatch</a> <a id="5646" href="Main.html#5646" class="Bound">K</a> <a id="5648" href="Main.html#5648" class="Bound">K&#39;</a> <a id="5651" href="Main.html#5651" class="Bound">x</a><a id="5652" class="Symbol">)</a> <a id="5654" class="Symbol">=</a> <a id="5656" class="String">&quot;kindMismatch&quot;</a>
<a id="5671" href="Main.html#5583" class="Function">uglyTypeError</a> <a id="5685" class="Symbol">(</a><a id="5686" href="Check.html#1185" class="InductiveConstructor">notStar</a> <a id="5694" href="Main.html#5694" class="Bound">K</a> <a id="5696" href="Main.html#5696" class="Bound">x</a><a id="5697" class="Symbol">)</a> <a id="5699" class="Symbol">=</a> <a id="5701" class="String">&quot;notStar&quot;</a>
<a id="5711" href="Main.html#5583" class="Function">uglyTypeError</a> <a id="5725" class="Symbol">(</a><a id="5726" href="Check.html#1232" class="InductiveConstructor">notFunKind</a> <a id="5737" href="Main.html#5737" class="Bound">K</a> <a id="5739" href="Main.html#5739" class="Bound">x</a><a id="5740" class="Symbol">)</a> <a id="5742" class="Symbol">=</a> <a id="5744" class="String">&quot;NotFunKind&quot;</a>
<a id="5757" href="Main.html#5583" class="Function">uglyTypeError</a> <a id="5771" class="Symbol">(</a><a id="5772" href="Check.html#1299" class="InductiveConstructor">notPat</a> <a id="5779" href="Main.html#5779" class="Bound">K</a> <a id="5781" href="Main.html#5781" class="Bound">x</a><a id="5782" class="Symbol">)</a> <a id="5784" class="Symbol">=</a> <a id="5786" class="String">&quot;notPat&quot;</a>
<a id="5795" href="Main.html#5583" class="Function">uglyTypeError</a> <a id="5809" href="Check.html#1373" class="InductiveConstructor">UnknownType</a> <a id="5821" class="Symbol">=</a> <a id="5823" class="String">&quot;UnknownType&quot;</a>
<a id="5837" href="Main.html#5583" class="Function">uglyTypeError</a> <a id="5851" class="Symbol">(</a><a id="5852" href="Check.html#1399" class="InductiveConstructor">notPi</a> <a id="5858" href="Main.html#5858" class="Bound">A</a> <a id="5860" href="Main.html#5860" class="Bound">x</a><a id="5861" class="Symbol">)</a> <a id="5863" class="Symbol">=</a> <a id="5865" class="String">&quot;notPi&quot;</a>
<a id="5873" href="Main.html#5583" class="Function">uglyTypeError</a> <a id="5887" class="Symbol">(</a><a id="5888" href="Check.html#1489" class="InductiveConstructor">notMu</a> <a id="5894" href="Main.html#5894" class="Bound">A</a> <a id="5896" href="Main.html#5896" class="Bound">x</a><a id="5897" class="Symbol">)</a> <a id="5899" class="Symbol">=</a> <a id="5901" class="String">&quot;notMu&quot;</a>
<a id="5909" href="Main.html#5583" class="Function">uglyTypeError</a> <a id="5923" class="Symbol">(</a><a id="5924" href="Check.html#1589" class="InductiveConstructor">notFunType</a> <a id="5935" href="Main.html#5935" class="Bound">A</a> <a id="5937" href="Main.html#5937" class="Bound">x</a><a id="5938" class="Symbol">)</a> <a id="5940" class="Symbol">=</a> <a id="5942" class="String">&quot;notFunType&quot;</a>
<a id="5955" href="Main.html#5583" class="Function">uglyTypeError</a> <a id="5969" class="Symbol">(</a><a id="5970" href="Check.html#1674" class="InductiveConstructor">typeMismatch</a> <a id="5983" href="Main.html#5983" class="Bound">A</a> <a id="5985" href="Main.html#5985" class="Bound">A&#39;</a> <a id="5988" href="Main.html#5988" class="Bound">x</a><a id="5989" class="Symbol">)</a> <a id="5991" class="Symbol">=</a>
  <a id="5995" href="Main.html#4991" class="Postulate">prettyPrintTy</a> <a id="6009" class="Symbol">(</a><a id="6010" href="Scoped.html#10165" class="Function">extricateScopeTy</a> <a id="6027" class="Symbol">(</a><a id="6028" href="Scoped.Extrication.html#876" class="Function">extricateNf⋆</a> <a id="6041" href="Main.html#5983" class="Bound">A</a><a id="6042" class="Symbol">))</a>
  <a id="6047" href="Data.String.Base.html#2077" class="Function Operator">++</a>
  <a id="6052" class="String">&quot; doesn&#39;t match &quot;</a>
  <a id="6072" href="Data.String.Base.html#2077" class="Function Operator">++</a>
  <a id="6077" href="Main.html#4991" class="Postulate">prettyPrintTy</a> <a id="6091" class="Symbol">(</a><a id="6092" href="Scoped.html#10165" class="Function">extricateScopeTy</a> <a id="6109" class="Symbol">(</a><a id="6110" href="Scoped.Extrication.html#876" class="Function">extricateNf⋆</a> <a id="6123" href="Main.html#5985" class="Bound">A&#39;</a><a id="6125" class="Symbol">))</a>
<a id="6128" href="Main.html#5583" class="Function">uglyTypeError</a> <a id="6142" href="Check.html#1740" class="InductiveConstructor">builtinError</a> <a id="6155" class="Symbol">=</a> <a id="6157" class="String">&quot;builtinError&quot;</a>

<a id="6173" class="Comment">-- the haskell version of Error is defined in Raw</a>
<a id="6223" class="Symbol">{-#</a> <a id="6227" class="Keyword">FOREIGN</a> <a id="6235" class="Pragma">GHC</a> <a id="6239" class="Pragma">import</a> <a id="6246" class="Pragma">Raw</a> <a id="6250" class="Symbol">#-}</a>

<a id="6255" class="Symbol">{-#</a> <a id="6259" class="Keyword">COMPILE</a> <a id="6267" class="Keyword">GHC</a> <a id="6271" href="Main.html#5428" class="Datatype">ERROR</a> <a id="6277" class="Pragma">=</a> <a id="6279" class="Pragma">data</a> <a id="6284" class="Pragma">ERROR</a> <a id="6290" class="Pragma">(TypeError</a> <a id="6301" class="Pragma">|</a> <a id="6303" class="Pragma">ParseError</a> <a id="6314" class="Pragma">|</a> <a id="6316" class="Pragma">ScopeError</a> <a id="6327" class="Pragma">|</a> <a id="6329" class="Pragma">RuntimeError)</a> <a id="6343" class="Symbol">#-}</a>


<a id="parsePLC"></a><a id="6349" href="Main.html#6349" class="Function">parsePLC</a> <a id="6358" class="Symbol">:</a> <a id="6360" href="Main.html#1663" class="Postulate">ByteString</a> <a id="6371" class="Symbol">→</a> <a id="6373" href="Utils.html#904" class="Datatype">Either</a> <a id="6380" href="Main.html#5428" class="Datatype">ERROR</a> <a id="6386" class="Symbol">(</a><a id="6387" href="Scoped.html#6299" class="Datatype">ScopedTm</a> <a id="6396" href="Scoped.html#1963" class="InductiveConstructor">Z</a><a id="6397" class="Symbol">)</a>
<a id="6399" href="Main.html#6349" class="Function">parsePLC</a> <a id="6408" href="Main.html#6408" class="Bound">plc</a> <a id="6412" class="Symbol">=</a> <a id="6414" class="Keyword">do</a>
  <a id="6419" href="Main.html#6419" class="Bound">namedprog</a> <a id="6429" href="Utils.html#3321" class="Field Operator">←</a> <a id="6431" href="Utils.html#4084" class="Function">withE</a> <a id="6437" href="Main.html#5477" class="InductiveConstructor">parseError</a> <a id="6448" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="6450" href="Main.html#2754" class="Postulate">parse</a> <a id="6456" href="Main.html#6408" class="Bound">plc</a>
  <a id="6462" href="Main.html#6462" class="Bound">prog</a> <a id="6467" href="Utils.html#3321" class="Field Operator">←</a> <a id="6469" href="Utils.html#4084" class="Function">withE</a> <a id="6475" class="Symbol">(</a><a id="6476" href="Main.html#5511" class="InductiveConstructor">ERROR.scopeError</a> <a id="6493" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="6495" href="Scoped.html#7489" class="InductiveConstructor">freeVariableError</a><a id="6512" class="Symbol">)</a> <a id="6514" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="6516" href="Main.html#2930" class="Postulate">deBruijnify</a> <a id="6528" href="Main.html#6419" class="Bound">namedprog</a>
  <a id="6540" href="Utils.html#4084" class="Function">withE</a> <a id="6546" href="Main.html#5511" class="InductiveConstructor">scopeError</a> <a id="6557" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="6559" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="6572" class="Symbol">{</a><a id="6573" class="Number">0</a><a id="6574" class="Symbol">}{</a><a id="6576" href="Scoped.html#1963" class="InductiveConstructor">Z</a><a id="6577" class="Symbol">}</a> <a id="6579" class="Symbol">(</a><a id="6580" href="Scoped.html#4478" class="Function">shifter</a> <a id="6588" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="6590" class="Symbol">(</a><a id="6591" href="Main.html#2709" class="Postulate">convP</a> <a id="6597" href="Main.html#6462" class="Bound">prog</a><a id="6601" class="Symbol">))</a>
  <a id="6606" class="Comment">-- ^ FIXME: this should have an interface that guarantees that the</a>
  <a id="6675" class="Comment">-- shifter is run</a>


<a id="typeCheckPLC"></a><a id="6695" href="Main.html#6695" class="Function">typeCheckPLC</a> <a id="6708" class="Symbol">:</a> <a id="6710" href="Scoped.html#6299" class="Datatype">ScopedTm</a> <a id="6719" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="6721" class="Symbol">→</a> <a id="6723" href="Utils.html#904" class="Datatype">Either</a> <a id="6730" href="Check.html#1105" class="Datatype">TypeError</a> <a id="6740" class="Symbol">(</a><a id="6741" href="Agda.Builtin.Sigma.html#166" class="Record">Σ</a> <a id="6743" class="Symbol">(</a><a id="6744" href="Type.html#981" class="InductiveConstructor">∅</a> <a id="6746" href="Type.BetaNormal.html#860" class="Datatype Operator">⊢Nf⋆</a> <a id="6751" href="Type.html#615" class="InductiveConstructor">*</a><a id="6752" class="Symbol">)</a> <a id="6754" class="Symbol">(</a><a id="6755" href="Algorithmic.html#1249" class="InductiveConstructor">∅</a> <a id="6757" href="Algorithmic.html#5489" class="Datatype Operator">⊢_</a><a id="6759" class="Symbol">))</a>
<a id="6762" href="Main.html#6695" class="Function">typeCheckPLC</a> <a id="6775" href="Main.html#6775" class="Bound">t</a> <a id="6777" class="Symbol">=</a> <a id="6779" href="Check.html#10572" class="Function">inferType</a> <a id="6789" class="Symbol">_</a> <a id="6791" href="Main.html#6775" class="Bound">t</a>


<a id="maxsteps"></a><a id="6795" href="Main.html#6795" class="Function">maxsteps</a> <a id="6804" class="Symbol">=</a> <a id="6806" class="Number">10000000000</a>

<a id="6819" class="Keyword">open</a> <a id="6824" class="Keyword">import</a> <a id="6831" href="Data.String.html" class="Module">Data.String</a>

<a id="reportError"></a><a id="6844" href="Main.html#6844" class="Function">reportError</a> <a id="6856" class="Symbol">:</a> <a id="6858" href="Main.html#5428" class="Datatype">ERROR</a> <a id="6864" class="Symbol">→</a> <a id="6866" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="6873" href="Main.html#6844" class="Function">reportError</a> <a id="6885" class="Symbol">(</a><a id="6886" href="Main.html#5477" class="InductiveConstructor">parseError</a> <a id="6897" class="Symbol">_)</a> <a id="6900" class="Symbol">=</a> <a id="6902" class="String">&quot;parseError&quot;</a>
<a id="6915" href="Main.html#6844" class="Function">reportError</a> <a id="6927" class="Symbol">(</a><a id="6928" href="Main.html#5448" class="InductiveConstructor">typeError</a> <a id="6938" href="Main.html#6938" class="Bound">s</a><a id="6939" class="Symbol">)</a> <a id="6941" class="Symbol">=</a> <a id="6943" class="String">&quot;typeError: &quot;</a> <a id="6957" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="6960" href="Main.html#6938" class="Bound">s</a>
<a id="6962" href="Main.html#6844" class="Function">reportError</a> <a id="6974" class="Symbol">(</a><a id="6975" href="Main.html#5511" class="InductiveConstructor">scopeError</a> <a id="6986" class="Symbol">_)</a> <a id="6989" class="Symbol">=</a> <a id="6991" class="String">&quot;scopeError&quot;</a>
<a id="7004" href="Main.html#6844" class="Function">reportError</a> <a id="7016" class="Symbol">(</a><a id="7017" href="Main.html#5545" class="InductiveConstructor">runtimeError</a> <a id="7030" class="Symbol">_)</a> <a id="7033" class="Symbol">=</a> <a id="7035" class="String">&quot;gasError&quot;</a>


<a id="executePLC"></a><a id="7048" href="Main.html#7048" class="Function">executePLC</a> <a id="7059" class="Symbol">:</a> <a id="7061" href="Main.html#5210" class="Datatype">EvalMode</a> <a id="7070" class="Symbol">→</a> <a id="7072" href="Scoped.html#6299" class="Datatype">ScopedTm</a> <a id="7081" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="7083" class="Symbol">→</a> <a id="7085" href="Utils.html#904" class="Datatype">Either</a> <a id="7092" href="Main.html#5428" class="Datatype">ERROR</a> <a id="7098" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="7105" href="Main.html#7048" class="Function">executePLC</a> <a id="7116" href="Main.html#5233" class="InductiveConstructor">U</a> <a id="7118" href="Main.html#7118" class="Bound">t</a> <a id="7120" class="Symbol">=</a> <a id="7122" href="Utils.html#937" class="InductiveConstructor">inj₁</a> <a id="7127" class="Symbol">(</a><a id="7128" href="Main.html#5545" class="InductiveConstructor">runtimeError</a> <a id="7141" href="Utils.html#4263" class="InductiveConstructor">gasError</a><a id="7149" class="Symbol">)</a>
<a id="7151" href="Main.html#7048" class="Function">executePLC</a> <a id="7162" href="Main.html#5235" class="InductiveConstructor">TL</a> <a id="7165" href="Main.html#7165" class="Bound">t</a> <a id="7167" class="Symbol">=</a> <a id="7169" class="Keyword">do</a>
  <a id="7174" class="Symbol">(</a><a id="7175" href="Main.html#7175" class="Bound">A</a> <a id="7177" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="7180" href="Main.html#7180" class="Bound">t</a><a id="7181" class="Symbol">)</a> <a id="7183" href="Utils.html#3321" class="Field Operator">←</a> <a id="7185" href="Utils.html#4084" class="Function">withE</a> <a id="7191" class="Symbol">(λ</a> <a id="7194" href="Main.html#7194" class="Bound">e</a> <a id="7196" class="Symbol">→</a> <a id="7198" href="Main.html#5448" class="InductiveConstructor">typeError</a> <a id="7208" class="Symbol">(</a><a id="7209" href="Main.html#5583" class="Function">uglyTypeError</a> <a id="7223" href="Main.html#7194" class="Bound">e</a><a id="7224" class="Symbol">))</a> <a id="7227" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="7229" href="Main.html#6695" class="Function">typeCheckPLC</a> <a id="7242" href="Main.html#7165" class="Bound">t</a>
  <a id="7246" href="Utils.html#516" class="InductiveConstructor">just</a> <a id="7251" href="Main.html#7251" class="Bound">t&#39;</a> <a id="7254" href="Utils.html#3321" class="Field Operator">←</a> <a id="7256" href="Utils.html#4084" class="Function">withE</a> <a id="7262" href="Main.html#5545" class="InductiveConstructor">runtimeError</a> <a id="7275" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="7277" href="Algorithmic.Reduction.html#18417" class="Function">Algorithmic.Reduction.progressor</a> <a id="7310" href="Main.html#6795" class="Function">maxsteps</a> <a id="7319" href="Main.html#7180" class="Bound">t</a>
    <a id="7325" class="Keyword">where</a> <a id="7331" href="Utils.html#537" class="InductiveConstructor">nothing</a> <a id="7339" class="Symbol">→</a> <a id="7341" href="Utils.html#961" class="InductiveConstructor">inj₂</a> <a id="7346" class="String">&quot;ERROR&quot;</a>
  <a id="7356" href="Utils.html#3293" class="Field">return</a> <a id="7363" class="Symbol">(</a><a id="7364" href="Main.html#4958" class="Postulate">prettyPrintTm</a> <a id="7378" class="Symbol">(</a><a id="7379" href="Scoped.html#5468" class="Function">unshifter</a> <a id="7389" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="7391" class="Symbol">(</a><a id="7392" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="7407" class="Symbol">(</a><a id="7408" href="Scoped.Extrication.html#3921" class="Function">extricate</a> <a id="7418" href="Main.html#7251" class="Bound">t&#39;</a><a id="7420" class="Symbol">))))</a>

<a id="7426" href="Main.html#7048" class="Function">executePLC</a> <a id="7437" href="Main.html#5238" class="InductiveConstructor">L</a> <a id="7439" href="Main.html#7439" class="Bound">t</a> <a id="7441" class="Keyword">with</a> <a id="7446" href="Scoped.Reduction.html#15752" class="Function">S.run</a> <a id="7452" href="Main.html#7439" class="Bound">t</a> <a id="7454" href="Main.html#6795" class="Function">maxsteps</a>
<a id="7463" class="Symbol">...</a> <a id="7467" class="Symbol">|</a> <a id="7469" href="Main.html#7469" class="Bound">t&#39;</a> <a id="7472" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="7475" href="Main.html#7475" class="Bound">p</a> <a id="7477" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="7480" href="Data.Sum.Base.html#778" class="InductiveConstructor">inj₁</a> <a id="7485" class="Symbol">(</a><a id="7486" href="Utils.html#516" class="InductiveConstructor">just</a> <a id="7491" href="Main.html#7491" class="Bound">v</a><a id="7492" class="Symbol">)</a> <a id="7494" class="Symbol">=</a> <a id="7496" href="Utils.html#961" class="InductiveConstructor">inj₂</a> <a id="7501" class="Symbol">(</a><a id="7502" href="Main.html#4958" class="Postulate">prettyPrintTm</a> <a id="7516" class="Symbol">(</a><a id="7517" href="Scoped.html#5468" class="Function">unshifter</a> <a id="7527" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="7529" class="Symbol">(</a><a id="7530" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="7545" href="Main.html#7469" class="Bound">t&#39;</a><a id="7547" class="Symbol">)))</a>
<a id="7551" class="Symbol">...</a> <a id="7555" class="Symbol">|</a> <a id="7557" href="Main.html#7557" class="Bound">t&#39;</a> <a id="7560" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="7563" href="Main.html#7563" class="Bound">p</a> <a id="7565" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="7568" href="Data.Sum.Base.html#778" class="InductiveConstructor">inj₁</a> <a id="7573" href="Utils.html#537" class="InductiveConstructor">nothing</a>  <a id="7582" class="Symbol">=</a> <a id="7584" href="Utils.html#937" class="InductiveConstructor">inj₁</a> <a id="7589" class="Symbol">(</a><a id="7590" href="Main.html#5545" class="InductiveConstructor">runtimeError</a> <a id="7603" href="Utils.html#4263" class="InductiveConstructor">gasError</a><a id="7611" class="Symbol">)</a>
<a id="7613" class="Symbol">...</a> <a id="7617" class="Symbol">|</a> <a id="7619" href="Main.html#7619" class="Bound">t&#39;</a> <a id="7622" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="7625" href="Main.html#7625" class="Bound">p</a> <a id="7627" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="7630" href="Data.Sum.Base.html#803" class="InductiveConstructor">inj₂</a> <a id="7635" href="Main.html#7635" class="Bound">e</a>        <a id="7644" class="Symbol">=</a> <a id="7646" href="Utils.html#961" class="InductiveConstructor">inj₂</a> <a id="7651" class="String">&quot;ERROR&quot;</a>
<a id="7659" href="Main.html#7048" class="Function">executePLC</a> <a id="7670" href="Main.html#5244" class="InductiveConstructor">CK</a> <a id="7673" href="Main.html#7673" class="Bound">t</a> <a id="7675" class="Symbol">=</a> <a id="7677" class="Keyword">do</a>
  <a id="7682" href="Scoped.CK.html#1061" class="InductiveConstructor">□</a> <a id="7684" class="Symbol">{</a><a id="7685" class="Argument">t</a> <a id="7687" class="Symbol">=</a> <a id="7689" href="Main.html#7689" class="Bound">t</a><a id="7690" class="Symbol">}</a> <a id="7692" href="Main.html#7692" class="Bound">v</a> <a id="7694" href="Utils.html#3321" class="Field Operator">←</a> <a id="7696" href="Utils.html#4084" class="Function">withE</a> <a id="7702" href="Main.html#5545" class="InductiveConstructor">runtimeError</a> <a id="7715" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="7717" href="Scoped.CK.html#3273" class="Function">Scoped.CK.stepper</a> <a id="7735" href="Main.html#6795" class="Function">maxsteps</a> <a id="7744" class="Symbol">(</a><a id="7745" href="Scoped.CK.html#907" class="InductiveConstructor">ε</a> <a id="7747" href="Scoped.CK.html#975" class="InductiveConstructor Operator">▻</a> <a id="7749" href="Main.html#7673" class="Bound">t</a><a id="7750" class="Symbol">)</a>
    <a id="7756" class="Keyword">where</a> <a id="7762" href="Scoped.CK.html#1105" class="CatchallClause InductiveConstructor">◆</a><a id="7763" class="CatchallClause">  </a><a id="7765" class="CatchallClause Symbol">→</a><a id="7766" class="CatchallClause"> </a><a id="7767" href="Utils.html#961" class="CatchallClause InductiveConstructor">inj₂</a><a id="7771" class="CatchallClause"> </a><a id="7772" class="CatchallClause String">&quot;ERROR&quot;</a>
          <a id="7790" class="CatchallClause Symbol">_</a><a id="7791" class="CatchallClause">  </a><a id="7793" class="CatchallClause Symbol">→</a><a id="7794" class="CatchallClause"> </a><a id="7795" href="Utils.html#937" class="CatchallClause InductiveConstructor">inj₁</a><a id="7799" class="CatchallClause"> </a><a id="7800" class="CatchallClause Symbol">(</a><a id="7801" href="Main.html#5545" class="CatchallClause InductiveConstructor">runtimeError</a><a id="7813" class="CatchallClause"> </a><a id="7814" href="Utils.html#4263" class="CatchallClause InductiveConstructor">gasError</a><a id="7822" class="CatchallClause Symbol">)</a>
  <a id="7826" href="Utils.html#3293" class="Field">return</a> <a id="7833" class="Symbol">(</a><a id="7834" href="Main.html#4958" class="Postulate">prettyPrintTm</a> <a id="7848" class="Symbol">(</a><a id="7849" href="Scoped.html#5468" class="Function">unshifter</a> <a id="7859" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="7861" class="Symbol">(</a><a id="7862" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="7877" href="Main.html#7689" class="Bound">t</a><a id="7878" class="Symbol">)))</a>
<a id="7882" href="Main.html#7048" class="Function">executePLC</a> <a id="7893" href="Main.html#5240" class="InductiveConstructor">TCK</a> <a id="7897" href="Main.html#7897" class="Bound">t</a> <a id="7899" class="Symbol">=</a> <a id="7901" class="Keyword">do</a>
  <a id="7906" class="Symbol">(</a><a id="7907" href="Main.html#7907" class="Bound">A</a> <a id="7909" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="7912" href="Main.html#7912" class="Bound">t</a><a id="7913" class="Symbol">)</a> <a id="7915" href="Utils.html#3321" class="Field Operator">←</a> <a id="7917" href="Utils.html#4084" class="Function">withE</a> <a id="7923" class="Symbol">(λ</a> <a id="7926" href="Main.html#7926" class="Bound">e</a> <a id="7928" class="Symbol">→</a> <a id="7930" href="Main.html#5448" class="InductiveConstructor">typeError</a> <a id="7940" class="Symbol">(</a><a id="7941" href="Main.html#5583" class="Function">uglyTypeError</a> <a id="7955" href="Main.html#7926" class="Bound">e</a><a id="7956" class="Symbol">))</a> <a id="7959" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="7961" href="Main.html#6695" class="Function">typeCheckPLC</a> <a id="7974" href="Main.html#7897" class="Bound">t</a>
  <a id="7978" href="Algorithmic.CK.html#1840" class="InductiveConstructor">□</a> <a id="7980" class="Symbol">{</a><a id="7981" class="Argument">t</a> <a id="7983" class="Symbol">=</a> <a id="7985" href="Main.html#7985" class="Bound">t</a><a id="7986" class="Symbol">}</a> <a id="7988" href="Main.html#7988" class="Bound">v</a> <a id="7990" href="Utils.html#3321" class="Field Operator">←</a> <a id="7992" href="Utils.html#4084" class="Function">withE</a> <a id="7998" href="Main.html#5545" class="InductiveConstructor">runtimeError</a> <a id="8011" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="8013" href="Algorithmic.CK.html#4585" class="Function">Algorithmic.CK.stepper</a> <a id="8036" href="Main.html#6795" class="Function">maxsteps</a> <a id="8045" class="Symbol">(</a><a id="8046" href="Algorithmic.CK.html#1547" class="InductiveConstructor">ε</a> <a id="8048" href="Algorithmic.CK.html#1718" class="InductiveConstructor Operator">▻</a> <a id="8050" href="Main.html#7912" class="Bound">t</a><a id="8051" class="Symbol">)</a>
    <a id="8057" class="Keyword">where</a> <a id="8063" href="Algorithmic.CK.html#1880" class="CatchallClause InductiveConstructor">◆</a><a id="8064" class="CatchallClause"> </a><a id="8065" class="CatchallClause Symbol">_</a><a id="8066" class="CatchallClause">  </a><a id="8068" class="CatchallClause Symbol">→</a><a id="8069" class="CatchallClause"> </a><a id="8070" href="Utils.html#961" class="CatchallClause InductiveConstructor">inj₂</a><a id="8074" class="CatchallClause"> </a><a id="8075" class="CatchallClause String">&quot;ERROR&quot;</a>
          <a id="8093" class="CatchallClause Symbol">_</a><a id="8094" class="CatchallClause">    </a><a id="8098" class="CatchallClause Symbol">→</a><a id="8099" class="CatchallClause"> </a><a id="8100" href="Utils.html#937" class="CatchallClause InductiveConstructor">inj₁</a><a id="8104" class="CatchallClause"> </a><a id="8105" class="CatchallClause Symbol">(</a><a id="8106" href="Main.html#5545" class="CatchallClause InductiveConstructor">runtimeError</a><a id="8118" class="CatchallClause"> </a><a id="8119" href="Utils.html#4263" class="CatchallClause InductiveConstructor">gasError</a><a id="8127" class="CatchallClause Symbol">)</a>
  <a id="8131" href="Utils.html#3293" class="Field">return</a> <a id="8138" class="Symbol">(</a><a id="8139" href="Main.html#4958" class="Postulate">prettyPrintTm</a> <a id="8153" class="Symbol">(</a><a id="8154" href="Scoped.html#5468" class="Function">unshifter</a> <a id="8164" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="8166" class="Symbol">(</a><a id="8167" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="8182" class="Symbol">(</a><a id="8183" href="Scoped.Extrication.html#3921" class="Function">extricate</a> <a id="8193" href="Main.html#7985" class="Bound">t</a><a id="8194" class="Symbol">))))</a>
<a id="8199" href="Main.html#7048" class="CatchallClause Function">executePLC</a><a id="8209" class="CatchallClause"> </a><a id="8210" href="Main.html#8210" class="CatchallClause Bound">TCEKV</a><a id="8215" class="CatchallClause"> </a><a id="8216" href="Main.html#8216" class="CatchallClause Bound">t</a> <a id="8218" class="Symbol">=</a> <a id="8220" class="Keyword">do</a>
  <a id="8225" class="Symbol">(</a><a id="8226" href="Main.html#8226" class="Bound">A</a> <a id="8228" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="8231" href="Main.html#8231" class="Bound">t</a><a id="8232" class="Symbol">)</a> <a id="8234" href="Utils.html#3321" class="Field Operator">←</a> <a id="8236" href="Utils.html#4084" class="Function">withE</a> <a id="8242" class="Symbol">(λ</a> <a id="8245" href="Main.html#8245" class="Bound">e</a> <a id="8247" class="Symbol">→</a> <a id="8249" href="Main.html#5448" class="InductiveConstructor">typeError</a> <a id="8259" class="Symbol">(</a><a id="8260" href="Main.html#5583" class="Function">uglyTypeError</a> <a id="8274" href="Main.html#8245" class="Bound">e</a><a id="8275" class="Symbol">))</a> <a id="8278" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="8280" href="Main.html#6695" class="Function">typeCheckPLC</a> <a id="8293" href="Main.html#8216" class="Bound">t</a>
  <a id="8297" href="Algorithmic.CEKV.html#8570" class="InductiveConstructor">□</a> <a id="8299" href="Main.html#8299" class="Bound">V</a> <a id="8301" href="Utils.html#3321" class="Field Operator">←</a> <a id="8303" href="Utils.html#4084" class="Function">withE</a> <a id="8309" href="Main.html#5545" class="InductiveConstructor">runtimeError</a> <a id="8322" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="8324" href="Algorithmic.CEKV.html#18832" class="Function">Algorithmic.CEKV.stepper</a> <a id="8349" href="Main.html#6795" class="Function">maxsteps</a> <a id="8358" class="Symbol">(</a><a id="8359" href="Algorithmic.CEKV.html#8334" class="InductiveConstructor">ε</a> <a id="8361" href="Algorithmic.CEKV.html#8448" class="InductiveConstructor Operator">;</a> <a id="8363" href="Algorithmic.CEKV.html#2762" class="InductiveConstructor">[]</a> <a id="8366" href="Algorithmic.CEKV.html#8448" class="InductiveConstructor Operator">▻</a> <a id="8368" href="Main.html#8231" class="Bound">t</a><a id="8369" class="Symbol">)</a>
    <a id="8375" class="Keyword">where</a> <a id="8381" href="Algorithmic.CEKV.html#8598" class="CatchallClause InductiveConstructor">◆</a><a id="8382" class="CatchallClause"> </a><a id="8383" class="CatchallClause Symbol">_</a><a id="8384" class="CatchallClause">  </a><a id="8386" class="CatchallClause Symbol">→</a><a id="8387" class="CatchallClause"> </a><a id="8388" href="Utils.html#961" class="CatchallClause InductiveConstructor">inj₂</a><a id="8392" class="CatchallClause"> </a><a id="8393" class="CatchallClause String">&quot;ERROR&quot;</a>
          <a id="8411" class="CatchallClause Symbol">_</a><a id="8412" class="CatchallClause">    </a><a id="8416" class="CatchallClause Symbol">→</a><a id="8417" class="CatchallClause"> </a><a id="8418" href="Utils.html#937" class="CatchallClause InductiveConstructor">inj₁</a><a id="8422" class="CatchallClause"> </a><a id="8423" class="CatchallClause Symbol">(</a><a id="8424" href="Main.html#5545" class="CatchallClause InductiveConstructor">runtimeError</a><a id="8436" class="CatchallClause"> </a><a id="8437" href="Utils.html#4263" class="CatchallClause InductiveConstructor">gasError</a><a id="8445" class="CatchallClause Symbol">)</a>
  <a id="8449" href="Utils.html#3293" class="Field">return</a> <a id="8456" class="Symbol">(</a><a id="8457" href="Main.html#4958" class="Postulate">prettyPrintTm</a> <a id="8471" class="Symbol">(</a><a id="8472" href="Scoped.html#5468" class="Function">unshifter</a> <a id="8482" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="8484" class="Symbol">(</a><a id="8485" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="8500" class="Symbol">(</a><a id="8501" href="Scoped.Extrication.html#3921" class="Function">extricate</a> <a id="8511" class="Symbol">(</a><a id="8512" href="Algorithmic.CEKV.html#3096" class="Function">Algorithmic.CEKV.discharge</a> <a id="8539" href="Main.html#8299" class="Bound">V</a><a id="8540" class="Symbol">)))))</a>

<a id="evalByteString"></a><a id="8547" href="Main.html#8547" class="Function">evalByteString</a> <a id="8562" class="Symbol">:</a> <a id="8564" href="Main.html#5210" class="Datatype">EvalMode</a> <a id="8573" class="Symbol">→</a> <a id="8575" href="Main.html#1663" class="Postulate">ByteString</a> <a id="8586" class="Symbol">→</a> <a id="8588" href="Utils.html#904" class="Datatype">Either</a> <a id="8595" href="Main.html#5428" class="Datatype">ERROR</a> <a id="8601" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="8608" href="Main.html#8547" class="Function">evalByteString</a> <a id="8623" href="Main.html#8623" class="Bound">m</a> <a id="8625" href="Main.html#8625" class="Bound">b</a> <a id="8627" class="Symbol">=</a> <a id="8629" class="Keyword">do</a>
<a id="8632" class="Comment">{-
  -- some debugging code
  namedprog ← withE parseError $ parse b
  prog ← withE (ERROR.scopeError ∘ freeVariableError) $ deBruijnify namedprog
  let shiftedprog = shifter Z (convP prog)
  scopedprog ← withE scopeError $ scopeCheckTm {0}{Z} shiftedprog
  let extricatedprog = extricateScope scopedprog
  let unshiftedprog = unshifter Z extricatedprog
  return (&quot;orginal: &quot; ++ rawPrinter (convP prog) ++ &quot;\n&quot; ++
          &quot;shifted: &quot; ++ rawPrinter shiftedprog ++ &quot;\n&quot; ++
          &quot;instrinsically scoped: &quot; ++ Scoped.ugly scopedprog ++ &quot;\n&quot; ++
          &quot;extricated: &quot; ++ rawPrinter extricatedprog ++ &quot;\n&quot; ++
          &quot;unshifted: &quot; ++ rawPrinter unshiftedprog ++ &quot;\n&quot; ++
          &quot;unconved: &quot; ++ prettyPrintTm unshiftedprog ++ &quot;\n&quot;)
-}</a>
  <a id="9374" href="Main.html#9374" class="Bound">t</a> <a id="9376" href="Utils.html#3321" class="Field Operator">←</a> <a id="9378" href="Main.html#6349" class="Function">parsePLC</a> <a id="9387" href="Main.html#8625" class="Bound">b</a>
  <a id="9391" href="Main.html#7048" class="Function">executePLC</a> <a id="9402" href="Main.html#8623" class="Bound">m</a> <a id="9404" href="Main.html#9374" class="Bound">t</a>

<a id="typeCheckByteString"></a><a id="9407" href="Main.html#9407" class="Function">typeCheckByteString</a> <a id="9427" class="Symbol">:</a> <a id="9429" href="Main.html#1663" class="Postulate">ByteString</a> <a id="9440" class="Symbol">→</a> <a id="9442" href="Utils.html#904" class="Datatype">Either</a> <a id="9449" href="Main.html#5428" class="Datatype">ERROR</a> <a id="9455" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="9462" href="Main.html#9407" class="Function">typeCheckByteString</a> <a id="9482" href="Main.html#9482" class="Bound">b</a> <a id="9484" class="Symbol">=</a> <a id="9486" class="Keyword">do</a>
  <a id="9491" href="Main.html#9491" class="Bound">t</a> <a id="9493" href="Utils.html#3321" class="Field Operator">←</a> <a id="9495" href="Main.html#6349" class="Function">parsePLC</a> <a id="9504" href="Main.html#9482" class="Bound">b</a>
  <a id="9508" class="Symbol">(</a><a id="9509" href="Main.html#9509" class="Bound">A</a> <a id="9511" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="9514" class="Symbol">_)</a> <a id="9517" href="Utils.html#3321" class="Field Operator">←</a> <a id="9519" href="Utils.html#4084" class="Function">withE</a> <a id="9525" class="Symbol">(λ</a> <a id="9528" href="Main.html#9528" class="Bound">e</a> <a id="9530" class="Symbol">→</a> <a id="9532" href="Main.html#5448" class="InductiveConstructor">typeError</a> <a id="9542" class="Symbol">(</a><a id="9543" href="Main.html#5583" class="Function">uglyTypeError</a> <a id="9557" href="Main.html#9528" class="Bound">e</a><a id="9558" class="Symbol">)</a> <a id="9560" class="Symbol">)</a> <a id="9562" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="9564" href="Main.html#6695" class="Function">typeCheckPLC</a> <a id="9577" href="Main.html#9491" class="Bound">t</a>
<a id="9579" class="Comment">{-
  -- some debugging code
  let extricatedtype = extricateScopeTy (extricateNf⋆ A)
  let unshiftedtype = unshifterTy Z extricatedtype
  return (&quot;original: &quot; ++ &quot;???&quot; ++ &quot;\n&quot; ++
          &quot;extricated: &quot; ++ rawTyPrinter extricatedtype ++ &quot;\n&quot; ++
          &quot;unshifted: &quot; ++ rawTyPrinter unshiftedtype ++ &quot;\n&quot; ++
          &quot;unconved: &quot; ++ prettyPrintTy unshiftedtype ++ &quot;\n&quot;)
-}</a>
  <a id="9958" href="Utils.html#3293" class="Field">return</a> <a id="9965" class="Symbol">(</a><a id="9966" href="Main.html#4991" class="Postulate">prettyPrintTy</a> <a id="9980" class="Symbol">(</a><a id="9981" href="Scoped.html#5021" class="Function">unshifterTy</a> <a id="9993" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="9995" class="Symbol">(</a><a id="9996" href="Scoped.html#10165" class="Function">extricateScopeTy</a> <a id="10013" class="Symbol">(</a><a id="10014" href="Scoped.Extrication.html#876" class="Function">extricateNf⋆</a> <a id="10027" href="Main.html#9509" class="Bound">A</a><a id="10028" class="Symbol">))))</a>

<a id="junk"></a><a id="10034" href="Main.html#10034" class="Function">junk</a> <a id="10039" class="Symbol">:</a> <a id="10041" class="Symbol">∀{</a><a id="10043" href="Main.html#10043" class="Bound">n</a><a id="10044" class="Symbol">}</a> <a id="10046" class="Symbol">→</a> <a id="10048" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="10052" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="10059" href="Main.html#10043" class="Bound">n</a>
<a id="10061" href="Main.html#10034" class="Function">junk</a> <a id="10066" class="Symbol">{</a><a id="10067" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="10071" class="Symbol">}</a>      <a id="10078" class="Symbol">=</a> <a id="10080" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a>
<a id="10083" href="Main.html#10034" class="Function">junk</a> <a id="10088" class="Symbol">{</a><a id="10089" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">Nat.suc</a> <a id="10097" href="Main.html#10097" class="Bound">n</a><a id="10098" class="Symbol">}</a> <a id="10100" class="Symbol">=</a> <a id="10102" href="Data.Integer.html#784" class="Function">Data.Integer.show</a> <a id="10120" class="Symbol">(</a><a id="10121" href="Agda.Builtin.Int.html#264" class="InductiveConstructor">pos</a> <a id="10125" href="Main.html#10097" class="Bound">n</a><a id="10126" class="Symbol">)</a> <a id="10128" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="10130" href="Main.html#10034" class="Function">junk</a>

<a id="alphaTm"></a><a id="10136" href="Main.html#10136" class="Function">alphaTm</a> <a id="10144" class="Symbol">:</a> <a id="10146" href="Main.html#1663" class="Postulate">ByteString</a> <a id="10157" class="Symbol">→</a> <a id="10159" href="Main.html#1663" class="Postulate">ByteString</a> <a id="10170" class="Symbol">→</a> <a id="10172" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="10177" href="Main.html#10136" class="Function">alphaTm</a> <a id="10185" href="Main.html#10185" class="Bound">plc1</a> <a id="10190" href="Main.html#10190" class="Bound">plc2</a> <a id="10195" class="Keyword">with</a> <a id="10200" href="Main.html#2804" class="Postulate">parseTm</a> <a id="10208" href="Main.html#10185" class="Bound">plc1</a> <a id="10213" class="Symbol">|</a> <a id="10215" href="Main.html#2804" class="Postulate">parseTm</a> <a id="10223" href="Main.html#10190" class="Bound">plc2</a>
<a id="10228" href="Main.html#10136" class="Function">alphaTm</a> <a id="10236" href="Main.html#10236" class="Bound">plc1</a> <a id="10241" href="Main.html#10241" class="Bound">plc2</a> <a id="10246" class="Symbol">|</a> <a id="10248" href="Utils.html#961" class="InductiveConstructor">inj₂</a> <a id="10253" href="Main.html#10253" class="Bound">plc1&#39;</a> <a id="10259" class="Symbol">|</a> <a id="10261" href="Utils.html#961" class="InductiveConstructor">inj₂</a> <a id="10266" href="Main.html#10266" class="Bound">plc2&#39;</a> <a id="10272" class="Keyword">with</a> <a id="10277" href="Main.html#2990" class="Postulate">deBruijnifyTm</a> <a id="10291" href="Main.html#10253" class="Bound">plc1&#39;</a> <a id="10297" class="Symbol">|</a> <a id="10299" href="Main.html#2990" class="Postulate">deBruijnifyTm</a> <a id="10313" href="Main.html#10266" class="Bound">plc2&#39;</a>
<a id="10319" href="Main.html#10136" class="Function">alphaTm</a> <a id="10327" href="Main.html#10327" class="Bound">plc1</a> <a id="10332" href="Main.html#10332" class="Bound">plc2</a> <a id="10337" class="Symbol">|</a> <a id="10339" class="InductiveConstructor">inj₂</a> <a id="10344" href="Main.html#10344" class="Bound">plc1&#39;</a> <a id="10350" class="Symbol">|</a> <a id="10352" class="InductiveConstructor">inj₂</a> <a id="10357" href="Main.html#10357" class="Bound">plc2&#39;</a> <a id="10363" class="Symbol">|</a> <a id="10365" href="Utils.html#516" class="InductiveConstructor">just</a> <a id="10370" href="Main.html#10370" class="Bound">plc1&#39;&#39;</a> <a id="10377" class="Symbol">|</a> <a id="10379" href="Utils.html#516" class="InductiveConstructor">just</a> <a id="10384" href="Main.html#10384" class="Bound">plc2&#39;&#39;</a> <a id="10391" class="Symbol">=</a> <a id="10393" href="Raw.html#6123" class="Function">decRTm</a> <a id="10400" class="Symbol">(</a><a id="10401" href="Main.html#2609" class="Postulate">convTm</a> <a id="10408" href="Main.html#10370" class="Bound">plc1&#39;&#39;</a><a id="10414" class="Symbol">)</a> <a id="10416" class="Symbol">(</a><a id="10417" href="Main.html#2609" class="Postulate">convTm</a> <a id="10424" href="Main.html#10384" class="Bound">plc2&#39;&#39;</a><a id="10430" class="Symbol">)</a>
<a id="10432" href="Main.html#10136" class="CatchallClause Function">alphaTm</a><a id="10439" class="CatchallClause"> </a><a id="10440" href="Main.html#10440" class="CatchallClause Bound">plc1</a><a id="10444" class="CatchallClause"> </a><a id="10445" href="Main.html#10445" class="CatchallClause Bound">plc2</a><a id="10449" class="CatchallClause"> </a><a id="10450" class="CatchallClause Symbol">|</a><a id="10451" class="CatchallClause"> </a><a id="10452" class="CatchallClause InductiveConstructor">inj₂</a><a id="10456" class="CatchallClause"> </a><a id="10457" href="Main.html#10457" class="CatchallClause Bound">plc1&#39;</a><a id="10462" class="CatchallClause"> </a><a id="10463" class="CatchallClause Symbol">|</a><a id="10464" class="CatchallClause"> </a><a id="10465" class="CatchallClause InductiveConstructor">inj₂</a><a id="10469" class="CatchallClause"> </a><a id="10470" href="Main.html#10470" class="CatchallClause Bound">plc2&#39;</a><a id="10475" class="CatchallClause"> </a><a id="10476" class="CatchallClause Symbol">|</a><a id="10477" class="CatchallClause"> </a><a id="10478" class="CatchallClause Symbol">_</a><a id="10479" class="CatchallClause"> </a><a id="10480" class="CatchallClause Symbol">|</a><a id="10481" class="CatchallClause"> </a><a id="10482" class="CatchallClause Symbol">_</a> <a id="10484" class="Symbol">=</a> <a id="10486" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">Bool.false</a>
<a id="10497" href="Main.html#10136" class="CatchallClause Function">alphaTm</a><a id="10504" class="CatchallClause"> </a><a id="10505" href="Main.html#10505" class="CatchallClause Bound">plc1</a><a id="10509" class="CatchallClause"> </a><a id="10510" href="Main.html#10510" class="CatchallClause Bound">plc2</a><a id="10514" class="CatchallClause"> </a><a id="10515" class="CatchallClause Symbol">|</a><a id="10516" class="CatchallClause"> </a><a id="10517" class="CatchallClause Symbol">_</a><a id="10518" class="CatchallClause"> </a><a id="10519" class="CatchallClause Symbol">|</a><a id="10520" class="CatchallClause"> </a><a id="10521" class="CatchallClause Symbol">_</a> <a id="10523" class="Symbol">=</a> <a id="10525" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">Bool.false</a>

<a id="10537" class="Symbol">{-#</a> <a id="10541" class="Keyword">COMPILE</a> <a id="10549" class="Keyword">GHC</a> <a id="10553" href="Main.html#10136" class="Function">alphaTm</a> <a id="10561" class="Pragma">as</a> <a id="10564" class="Pragma">alphaTm</a> <a id="10572" class="Symbol">#-}</a>

<a id="blah"></a><a id="10577" href="Main.html#10577" class="Function">blah</a> <a id="10582" class="Symbol">:</a> <a id="10584" href="Main.html#1663" class="Postulate">ByteString</a> <a id="10595" class="Symbol">→</a> <a id="10597" href="Main.html#1663" class="Postulate">ByteString</a> <a id="10608" class="Symbol">→</a> <a id="10610" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="10617" href="Main.html#10577" class="Function">blah</a> <a id="10622" href="Main.html#10622" class="Bound">plc1</a> <a id="10627" href="Main.html#10627" class="Bound">plc2</a> <a id="10632" class="Keyword">with</a> <a id="10637" href="Main.html#2804" class="Postulate">parseTm</a> <a id="10645" href="Main.html#10622" class="Bound">plc1</a> <a id="10650" class="Symbol">|</a> <a id="10652" href="Main.html#2804" class="Postulate">parseTm</a> <a id="10660" href="Main.html#10627" class="Bound">plc2</a>
<a id="10665" href="Main.html#10577" class="Function">blah</a> <a id="10670" href="Main.html#10670" class="Bound">plc1</a> <a id="10675" href="Main.html#10675" class="Bound">plc2</a> <a id="10680" class="Symbol">|</a> <a id="10682" href="Utils.html#961" class="InductiveConstructor">inj₂</a> <a id="10687" href="Main.html#10687" class="Bound">plc1&#39;</a> <a id="10693" class="Symbol">|</a> <a id="10695" href="Utils.html#961" class="InductiveConstructor">inj₂</a> <a id="10700" href="Main.html#10700" class="Bound">plc2&#39;</a> <a id="10706" class="Keyword">with</a> <a id="10711" href="Main.html#2990" class="Postulate">deBruijnifyTm</a> <a id="10725" href="Main.html#10687" class="Bound">plc1&#39;</a> <a id="10731" class="Symbol">|</a> <a id="10733" href="Main.html#2990" class="Postulate">deBruijnifyTm</a> <a id="10747" href="Main.html#10700" class="Bound">plc2&#39;</a>
<a id="10753" href="Main.html#10577" class="Function">blah</a> <a id="10758" href="Main.html#10758" class="Bound">plc1</a> <a id="10763" href="Main.html#10763" class="Bound">plc2</a> <a id="10768" class="Symbol">|</a> <a id="10770" class="InductiveConstructor">inj₂</a> <a id="10775" href="Main.html#10775" class="Bound">plc1&#39;</a> <a id="10781" class="Symbol">|</a> <a id="10783" class="InductiveConstructor">inj₂</a> <a id="10788" href="Main.html#10788" class="Bound">plc2&#39;</a> <a id="10794" class="Symbol">|</a> <a id="10796" href="Utils.html#516" class="InductiveConstructor">just</a> <a id="10801" href="Main.html#10801" class="Bound">plc1&#39;&#39;</a> <a id="10808" class="Symbol">|</a> <a id="10810" href="Utils.html#516" class="InductiveConstructor">just</a> <a id="10815" href="Main.html#10815" class="Bound">plc2&#39;&#39;</a> <a id="10822" class="Symbol">=</a> <a id="10824" href="Raw.html#8337" class="Function">rawPrinter</a> <a id="10835" class="Symbol">(</a><a id="10836" href="Main.html#2609" class="Postulate">convTm</a> <a id="10843" href="Main.html#10801" class="Bound">plc1&#39;&#39;</a><a id="10849" class="Symbol">)</a> <a id="10851" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="10854" class="String">&quot; || &quot;</a> <a id="10861" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="10864" href="Raw.html#8337" class="Function">rawPrinter</a> <a id="10875" class="Symbol">(</a><a id="10876" href="Main.html#2609" class="Postulate">convTm</a> <a id="10883" href="Main.html#10815" class="Bound">plc2&#39;&#39;</a><a id="10889" class="Symbol">)</a>
<a id="10891" href="Main.html#10577" class="CatchallClause Function">blah</a><a id="10895" class="CatchallClause"> </a><a id="10896" href="Main.html#10896" class="CatchallClause Bound">plc1</a><a id="10900" class="CatchallClause"> </a><a id="10901" href="Main.html#10901" class="CatchallClause Bound">plc2</a><a id="10905" class="CatchallClause"> </a><a id="10906" class="CatchallClause Symbol">|</a><a id="10907" class="CatchallClause"> </a><a id="10908" class="CatchallClause InductiveConstructor">inj₂</a><a id="10912" class="CatchallClause"> </a><a id="10913" href="Main.html#10913" class="CatchallClause Bound">plc1&#39;</a><a id="10918" class="CatchallClause"> </a><a id="10919" class="CatchallClause Symbol">|</a><a id="10920" class="CatchallClause"> </a><a id="10921" class="CatchallClause InductiveConstructor">inj₂</a><a id="10925" class="CatchallClause"> </a><a id="10926" href="Main.html#10926" class="CatchallClause Bound">plc2&#39;</a><a id="10931" class="CatchallClause"> </a><a id="10932" class="CatchallClause Symbol">|</a><a id="10933" class="CatchallClause"> </a><a id="10934" class="CatchallClause Symbol">_</a><a id="10935" class="CatchallClause"> </a><a id="10936" class="CatchallClause Symbol">|</a><a id="10937" class="CatchallClause"> </a><a id="10938" class="CatchallClause Symbol">_</a> <a id="10940" class="Symbol">=</a> <a id="10942" class="String">&quot;deBruijnifying failed&quot;</a>
<a id="10966" href="Main.html#10577" class="CatchallClause Function">blah</a><a id="10970" class="CatchallClause"> </a><a id="10971" href="Main.html#10971" class="CatchallClause Bound">plc1</a><a id="10975" class="CatchallClause"> </a><a id="10976" href="Main.html#10976" class="CatchallClause Bound">plc2</a><a id="10980" class="CatchallClause"> </a><a id="10981" class="CatchallClause Symbol">|</a><a id="10982" class="CatchallClause"> </a><a id="10983" class="CatchallClause Symbol">_</a><a id="10984" class="CatchallClause"> </a><a id="10985" class="CatchallClause Symbol">|</a><a id="10986" class="CatchallClause"> </a><a id="10987" class="CatchallClause Symbol">_</a> <a id="10989" class="Symbol">=</a> <a id="10991" class="String">&quot;parsing failed&quot;</a>

<a id="11009" class="Symbol">{-#</a> <a id="11013" class="Keyword">COMPILE</a> <a id="11021" class="Keyword">GHC</a> <a id="11025" href="Main.html#10577" class="Function">blah</a> <a id="11030" class="Pragma">as</a> <a id="11033" class="Pragma">blah</a> <a id="11038" class="Symbol">#-}</a>

<a id="printTy"></a><a id="11043" href="Main.html#11043" class="Function">printTy</a> <a id="11051" class="Symbol">:</a> <a id="11053" href="Main.html#1663" class="Postulate">ByteString</a> <a id="11064" class="Symbol">→</a> <a id="11066" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="11073" href="Main.html#11043" class="Function">printTy</a> <a id="11081" href="Main.html#11081" class="Bound">b</a> <a id="11083" class="Keyword">with</a> <a id="11088" href="Main.html#2853" class="Postulate">parseTy</a> <a id="11096" href="Main.html#11081" class="Bound">b</a>
<a id="11098" class="Symbol">...</a> <a id="11102" class="Symbol">|</a> <a id="11104" href="Utils.html#937" class="InductiveConstructor">inj₁</a> <a id="11109" class="Symbol">_</a> <a id="11111" class="Symbol">=</a> <a id="11113" class="String">&quot;parseTy error&quot;</a>
<a id="11129" class="Symbol">...</a> <a id="11133" class="Symbol">|</a> <a id="11135" href="Utils.html#961" class="InductiveConstructor">inj₂</a> <a id="11140" href="Main.html#11140" class="Bound">A</a>  <a id="11143" class="Keyword">with</a> <a id="11148" href="Main.html#3027" class="Postulate">deBruijnifyTy</a> <a id="11162" href="Main.html#11140" class="Bound">A</a>
<a id="11164" class="Symbol">...</a> <a id="11168" class="Symbol">|</a> <a id="11170" href="Utils.html#537" class="InductiveConstructor">nothing</a> <a id="11178" class="Symbol">=</a> <a id="11180" class="String">&quot;deBruinjifyTy error&quot;</a>
<a id="11202" class="Symbol">...</a> <a id="11206" class="Symbol">|</a> <a id="11208" href="Utils.html#516" class="InductiveConstructor">just</a> <a id="11213" href="Main.html#11213" class="Bound">A&#39;</a> <a id="11216" class="Symbol">=</a> <a id="11218" href="Raw.html#7873" class="Function">rawTyPrinter</a> <a id="11231" class="Symbol">(</a><a id="11232" href="Main.html#2633" class="Postulate">convTy</a> <a id="11239" href="Main.html#11213" class="Bound">A&#39;</a><a id="11241" class="Symbol">)</a>

<a id="11244" class="Symbol">{-#</a> <a id="11248" class="Keyword">COMPILE</a> <a id="11256" class="Keyword">GHC</a> <a id="11260" href="Main.html#11043" class="Function">printTy</a> <a id="11268" class="Pragma">as</a> <a id="11271" class="Pragma">printTy</a> <a id="11279" class="Symbol">#-}</a>

<a id="alphaTy"></a><a id="11284" href="Main.html#11284" class="Function">alphaTy</a> <a id="11292" class="Symbol">:</a> <a id="11294" href="Main.html#1663" class="Postulate">ByteString</a> <a id="11305" class="Symbol">→</a> <a id="11307" href="Main.html#1663" class="Postulate">ByteString</a> <a id="11318" class="Symbol">→</a> <a id="11320" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="11325" href="Main.html#11284" class="Function">alphaTy</a> <a id="11333" href="Main.html#11333" class="Bound">plc1</a> <a id="11338" href="Main.html#11338" class="Bound">plc2</a> <a id="11343" class="Keyword">with</a> <a id="11348" href="Main.html#2853" class="Postulate">parseTy</a> <a id="11356" href="Main.html#11333" class="Bound">plc1</a> <a id="11361" class="Symbol">|</a> <a id="11363" href="Main.html#2853" class="Postulate">parseTy</a> <a id="11371" href="Main.html#11338" class="Bound">plc2</a>
<a id="11376" href="Main.html#11284" class="Function">alphaTy</a> <a id="11384" href="Main.html#11384" class="Bound">plc1</a> <a id="11389" href="Main.html#11389" class="Bound">plc2</a> <a id="11394" class="Symbol">|</a> <a id="11396" href="Utils.html#961" class="InductiveConstructor">inj₂</a> <a id="11401" href="Main.html#11401" class="Bound">plc1&#39;</a> <a id="11407" class="Symbol">|</a> <a id="11409" href="Utils.html#961" class="InductiveConstructor">inj₂</a> <a id="11414" href="Main.html#11414" class="Bound">plc2&#39;</a> <a id="11420" class="Keyword">with</a> <a id="11425" href="Main.html#3027" class="Postulate">deBruijnifyTy</a> <a id="11439" href="Main.html#11401" class="Bound">plc1&#39;</a> <a id="11445" class="Symbol">|</a> <a id="11447" href="Main.html#3027" class="Postulate">deBruijnifyTy</a> <a id="11461" href="Main.html#11414" class="Bound">plc2&#39;</a>
<a id="11467" href="Main.html#11284" class="Function">alphaTy</a> <a id="11475" href="Main.html#11475" class="Bound">plc1</a> <a id="11480" href="Main.html#11480" class="Bound">plc2</a> <a id="11485" class="Symbol">|</a> <a id="11487" class="InductiveConstructor">inj₂</a> <a id="11492" href="Main.html#11492" class="Bound">plc1&#39;</a> <a id="11498" class="Symbol">|</a> <a id="11500" class="InductiveConstructor">inj₂</a> <a id="11505" href="Main.html#11505" class="Bound">plc2&#39;</a> <a id="11511" class="Symbol">|</a> <a id="11513" href="Utils.html#516" class="InductiveConstructor">just</a> <a id="11518" href="Main.html#11518" class="Bound">plc1&#39;&#39;</a> <a id="11525" class="Symbol">|</a> <a id="11527" href="Utils.html#516" class="InductiveConstructor">just</a> <a id="11532" href="Main.html#11532" class="Bound">plc2&#39;&#39;</a> <a id="11539" class="Symbol">=</a> <a id="11541" href="Raw.html#3942" class="Function">decRTy</a> <a id="11548" class="Symbol">(</a><a id="11549" href="Main.html#2633" class="Postulate">convTy</a> <a id="11556" href="Main.html#11518" class="Bound">plc1&#39;&#39;</a><a id="11562" class="Symbol">)</a> <a id="11564" class="Symbol">(</a><a id="11565" href="Main.html#2633" class="Postulate">convTy</a> <a id="11572" href="Main.html#11532" class="Bound">plc2&#39;&#39;</a><a id="11578" class="Symbol">)</a>
<a id="11580" href="Main.html#11284" class="CatchallClause Function">alphaTy</a><a id="11587" class="CatchallClause"> </a><a id="11588" href="Main.html#11588" class="CatchallClause Bound">plc1</a><a id="11592" class="CatchallClause"> </a><a id="11593" href="Main.html#11593" class="CatchallClause Bound">plc2</a><a id="11597" class="CatchallClause"> </a><a id="11598" class="CatchallClause Symbol">|</a><a id="11599" class="CatchallClause"> </a><a id="11600" class="CatchallClause InductiveConstructor">inj₂</a><a id="11604" class="CatchallClause"> </a><a id="11605" href="Main.html#11605" class="CatchallClause Bound">plc1&#39;</a><a id="11610" class="CatchallClause"> </a><a id="11611" class="CatchallClause Symbol">|</a><a id="11612" class="CatchallClause"> </a><a id="11613" class="CatchallClause InductiveConstructor">inj₂</a><a id="11617" class="CatchallClause"> </a><a id="11618" href="Main.html#11618" class="CatchallClause Bound">plc2&#39;</a><a id="11623" class="CatchallClause"> </a><a id="11624" class="CatchallClause Symbol">|</a><a id="11625" class="CatchallClause"> </a><a id="11626" class="CatchallClause Symbol">_</a><a id="11627" class="CatchallClause"> </a><a id="11628" class="CatchallClause Symbol">|</a><a id="11629" class="CatchallClause"> </a><a id="11630" class="CatchallClause Symbol">_</a> <a id="11632" class="Symbol">=</a> <a id="11634" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">Bool.false</a>
<a id="11645" href="Main.html#11284" class="CatchallClause Function">alphaTy</a><a id="11652" class="CatchallClause"> </a><a id="11653" href="Main.html#11653" class="CatchallClause Bound">plc1</a><a id="11657" class="CatchallClause"> </a><a id="11658" href="Main.html#11658" class="CatchallClause Bound">plc2</a><a id="11662" class="CatchallClause"> </a><a id="11663" class="CatchallClause Symbol">|</a><a id="11664" class="CatchallClause"> </a><a id="11665" class="CatchallClause Symbol">_</a><a id="11666" class="CatchallClause"> </a><a id="11667" class="CatchallClause Symbol">|</a><a id="11668" class="CatchallClause"> </a><a id="11669" class="CatchallClause Symbol">_</a> <a id="11671" class="Symbol">=</a> <a id="11673" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">Bool.false</a>

<a id="11685" class="Symbol">{-#</a> <a id="11689" class="Keyword">COMPILE</a> <a id="11697" class="Keyword">GHC</a> <a id="11701" href="Main.html#11284" class="Function">alphaTy</a> <a id="11709" class="Pragma">as</a> <a id="11712" class="Pragma">alphaTy</a> <a id="11720" class="Symbol">#-}</a>

<a id="11725" class="Comment">-- Opt stuff</a>

<a id="11739" class="Symbol">{-#</a> <a id="11743" class="Keyword">FOREIGN</a> <a id="11751" class="Pragma">GHC</a> <a id="11755" class="Pragma">import</a> <a id="11762" class="Pragma">Opts</a> <a id="11767" class="Symbol">#-}</a>

<a id="11772" class="Keyword">data</a> <a id="Input"></a><a id="11777" href="Main.html#11777" class="Datatype">Input</a> <a id="11783" class="Symbol">:</a> <a id="11785" class="PrimitiveType">Set</a> <a id="11789" class="Keyword">where</a>
  <a id="Input.FileInput"></a><a id="11797" href="Main.html#11797" class="InductiveConstructor">FileInput</a> <a id="11807" class="Symbol">:</a> <a id="11809" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="11816" class="Symbol">→</a> <a id="11818" href="Main.html#11777" class="Datatype">Input</a>
  <a id="Input.StdInput"></a><a id="11826" href="Main.html#11826" class="InductiveConstructor">StdInput</a> <a id="11835" class="Symbol">:</a> <a id="11837" href="Main.html#11777" class="Datatype">Input</a>

<a id="11844" class="Symbol">{-#</a> <a id="11848" class="Keyword">COMPILE</a> <a id="11856" class="Keyword">GHC</a> <a id="11860" href="Main.html#11777" class="Datatype">Input</a> <a id="11866" class="Pragma">=</a> <a id="11868" class="Pragma">data</a> <a id="11873" class="Pragma">Input</a> <a id="11879" class="Pragma">(FileInput</a> <a id="11890" class="Pragma">|</a> <a id="11892" class="Pragma">StdInput)</a> <a id="11902" class="Symbol">#-}</a>

<a id="11907" class="Keyword">data</a> <a id="EvalOptions"></a><a id="11912" href="Main.html#11912" class="Datatype">EvalOptions</a> <a id="11924" class="Symbol">:</a> <a id="11926" class="PrimitiveType">Set</a> <a id="11930" class="Keyword">where</a>
  <a id="EvalOptions.EvalOpts"></a><a id="11938" href="Main.html#11938" class="InductiveConstructor">EvalOpts</a> <a id="11947" class="Symbol">:</a> <a id="11949" href="Main.html#11777" class="Datatype">Input</a> <a id="11955" class="Symbol">→</a> <a id="11957" href="Main.html#5210" class="Datatype">EvalMode</a> <a id="11966" class="Symbol">→</a> <a id="11968" href="Main.html#11912" class="Datatype">EvalOptions</a>

<a id="11981" class="Symbol">{-#</a> <a id="11985" class="Keyword">COMPILE</a> <a id="11993" class="Keyword">GHC</a> <a id="11997" href="Main.html#11912" class="Datatype">EvalOptions</a> <a id="12009" class="Pragma">=</a> <a id="12011" class="Pragma">data</a> <a id="12016" class="Pragma">EvalOptions</a> <a id="12028" class="Pragma">(EvalOpts)</a> <a id="12039" class="Symbol">#-}</a>

<a id="12044" class="Keyword">data</a> <a id="TCOptions"></a><a id="12049" href="Main.html#12049" class="Datatype">TCOptions</a> <a id="12059" class="Symbol">:</a> <a id="12061" class="PrimitiveType">Set</a> <a id="12065" class="Keyword">where</a>
  <a id="TCOptions.TCOpts"></a><a id="12073" href="Main.html#12073" class="InductiveConstructor">TCOpts</a> <a id="12080" class="Symbol">:</a> <a id="12082" href="Main.html#11777" class="Datatype">Input</a> <a id="12088" class="Symbol">→</a> <a id="12090" href="Main.html#12049" class="Datatype">TCOptions</a>

<a id="12101" class="Symbol">{-#</a> <a id="12105" class="Keyword">COMPILE</a> <a id="12113" class="Keyword">GHC</a> <a id="12117" href="Main.html#12049" class="Datatype">TCOptions</a> <a id="12127" class="Pragma">=</a> <a id="12129" class="Pragma">data</a> <a id="12134" class="Pragma">TCOptions</a> <a id="12144" class="Pragma">(TCOpts)</a> <a id="12153" class="Symbol">#-}</a>

<a id="12158" class="Keyword">data</a> <a id="Command"></a><a id="12163" href="Main.html#12163" class="Datatype">Command</a> <a id="12171" class="Symbol">:</a> <a id="12173" class="PrimitiveType">Set</a> <a id="12177" class="Keyword">where</a>
  <a id="Command.Evaluate"></a><a id="12185" href="Main.html#12185" class="InductiveConstructor">Evaluate</a>  <a id="12195" class="Symbol">:</a> <a id="12197" href="Main.html#11912" class="Datatype">EvalOptions</a> <a id="12209" class="Symbol">→</a> <a id="12211" href="Main.html#12163" class="Datatype">Command</a>
  <a id="Command.TypeCheck"></a><a id="12221" href="Main.html#12221" class="InductiveConstructor">TypeCheck</a> <a id="12231" class="Symbol">:</a> <a id="12233" href="Main.html#12049" class="Datatype">TCOptions</a> <a id="12243" class="Symbol">→</a> <a id="12245" href="Main.html#12163" class="Datatype">Command</a>

<a id="12254" class="Symbol">{-#</a> <a id="12258" class="Keyword">COMPILE</a> <a id="12266" class="Keyword">GHC</a> <a id="12270" href="Main.html#12163" class="Datatype">Command</a> <a id="12278" class="Pragma">=</a> <a id="12280" class="Pragma">data</a> <a id="12285" class="Pragma">Command</a> <a id="12293" class="Pragma">(Evaluate</a> <a id="12303" class="Pragma">|</a> <a id="12305" class="Pragma">TypeCheck)</a> <a id="12316" class="Symbol">#-}</a>

<a id="12321" class="Keyword">postulate</a> <a id="execP"></a><a id="12331" href="Main.html#12331" class="Postulate">execP</a> <a id="12337" class="Symbol">:</a> <a id="12339" href="Agda.Builtin.IO.html#138" class="Postulate">IO</a> <a id="12342" href="Main.html#12163" class="Datatype">Command</a>

<a id="12351" class="Symbol">{-#</a> <a id="12355" class="Keyword">COMPILE</a> <a id="12363" class="Keyword">GHC</a> <a id="12367" href="Main.html#12331" class="Postulate">execP</a> <a id="12373" class="Pragma">=</a> <a id="12375" class="Pragma">execP</a> <a id="12381" class="Symbol">#-}</a>

<a id="evalInput"></a><a id="12386" href="Main.html#12386" class="Function">evalInput</a> <a id="12396" class="Symbol">:</a> <a id="12398" href="Main.html#5210" class="Datatype">EvalMode</a> <a id="12407" class="Symbol">→</a> <a id="12409" href="Main.html#11777" class="Datatype">Input</a> <a id="12415" class="Symbol">→</a> <a id="12417" href="Agda.Builtin.IO.html#138" class="Postulate">IO</a> <a id="12420" class="Symbol">(</a><a id="12421" href="Utils.html#904" class="Datatype">Either</a> <a id="12428" href="Main.html#5428" class="Datatype">ERROR</a> <a id="12434" href="Agda.Builtin.String.html#274" class="Postulate">String</a><a id="12440" class="Symbol">)</a>
<a id="12442" href="Main.html#12386" class="Function">evalInput</a> <a id="12452" href="Main.html#12452" class="Bound">m</a> <a id="12454" class="Symbol">(</a><a id="12455" href="Main.html#11797" class="InductiveConstructor">FileInput</a> <a id="12465" href="Main.html#12465" class="Bound">fn</a><a id="12467" class="Symbol">)</a> <a id="12469" class="Symbol">=</a> <a id="12471" href="Utils.html#3433" class="Function">fmap</a> <a id="12476" class="Symbol">(</a><a id="12477" href="Main.html#8547" class="Function">evalByteString</a> <a id="12492" href="Main.html#12452" class="Bound">m</a><a id="12493" class="Symbol">)</a> <a id="12495" class="Symbol">(</a><a id="12496" href="Main.html#1712" class="Postulate">readFile</a> <a id="12505" href="Main.html#12465" class="Bound">fn</a><a id="12507" class="Symbol">)</a>
<a id="12509" href="Main.html#12386" class="Function">evalInput</a> <a id="12519" href="Main.html#12519" class="Bound">m</a> <a id="12521" href="Main.html#11826" class="InductiveConstructor">StdInput</a>       <a id="12536" class="Symbol">=</a> <a id="12538" href="Utils.html#3433" class="Function">fmap</a> <a id="12543" class="Symbol">(</a><a id="12544" href="Main.html#8547" class="Function">evalByteString</a> <a id="12559" href="Main.html#12519" class="Bound">m</a><a id="12560" class="Symbol">)</a> <a id="12562" href="Main.html#1682" class="Postulate">getContents</a>

<a id="tcInput"></a><a id="12575" href="Main.html#12575" class="Function">tcInput</a> <a id="12583" class="Symbol">:</a> <a id="12585" href="Main.html#11777" class="Datatype">Input</a> <a id="12591" class="Symbol">→</a> <a id="12593" href="Agda.Builtin.IO.html#138" class="Postulate">IO</a> <a id="12596" class="Symbol">(</a><a id="12597" href="Utils.html#904" class="Datatype">Either</a> <a id="12604" href="Main.html#5428" class="Datatype">ERROR</a> <a id="12610" href="Agda.Builtin.String.html#274" class="Postulate">String</a><a id="12616" class="Symbol">)</a>
<a id="12618" href="Main.html#12575" class="Function">tcInput</a> <a id="12626" class="Symbol">(</a><a id="12627" href="Main.html#11797" class="InductiveConstructor">FileInput</a> <a id="12637" href="Main.html#12637" class="Bound">fn</a><a id="12639" class="Symbol">)</a> <a id="12641" class="Symbol">=</a> <a id="12643" href="Utils.html#3433" class="Function">fmap</a> <a id="12648" href="Main.html#9407" class="Function">typeCheckByteString</a> <a id="12668" class="Symbol">(</a><a id="12669" href="Main.html#1712" class="Postulate">readFile</a> <a id="12678" href="Main.html#12637" class="Bound">fn</a><a id="12680" class="Symbol">)</a>
<a id="12682" href="Main.html#12575" class="Function">tcInput</a> <a id="12690" href="Main.html#11826" class="InductiveConstructor">StdInput</a>       <a id="12705" class="Symbol">=</a> <a id="12707" href="Utils.html#3433" class="Function">fmap</a> <a id="12712" href="Main.html#9407" class="Function">typeCheckByteString</a> <a id="12732" href="Main.html#1682" class="Postulate">getContents</a>


<a id="main&#39;"></a><a id="12746" href="Main.html#12746" class="Function">main&#39;</a> <a id="12752" class="Symbol">:</a> <a id="12754" href="Main.html#12163" class="Datatype">Command</a> <a id="12762" class="Symbol">→</a> <a id="12764" href="Agda.Builtin.IO.html#138" class="Postulate">IO</a> <a id="12767" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="12769" href="Main.html#12746" class="Function">main&#39;</a> <a id="12775" class="Symbol">(</a><a id="12776" href="Main.html#12185" class="InductiveConstructor">Evaluate</a> <a id="12785" class="Symbol">(</a><a id="12786" href="Main.html#11938" class="InductiveConstructor">EvalOpts</a> <a id="12795" href="Main.html#12795" class="Bound">i</a> <a id="12797" href="Main.html#12797" class="Bound">m</a><a id="12798" class="Symbol">))</a> <a id="12801" class="Symbol">=</a> <a id="12803" class="Keyword">do</a>
  <a id="12808" href="Utils.html#961" class="InductiveConstructor">inj₂</a> <a id="12813" href="Main.html#12813" class="Bound">s</a> <a id="12815" href="Utils.html#3321" class="Field Operator">←</a> <a id="12817" href="Main.html#12386" class="Function">evalInput</a> <a id="12827" href="Main.html#12797" class="Bound">m</a> <a id="12829" href="Main.html#12795" class="Bound">i</a>
    <a id="12835" class="Keyword">where</a>
    <a id="12845" href="Utils.html#937" class="InductiveConstructor">inj₁</a> <a id="12850" href="Main.html#12850" class="Bound">e</a> <a id="12852" class="Symbol">→</a> <a id="12854" href="Main.html#1340" class="Postulate">putStrLn</a> <a id="12863" class="Symbol">(</a><a id="12864" href="Main.html#6844" class="Function">reportError</a> <a id="12876" href="Main.html#12850" class="Bound">e</a><a id="12877" class="Symbol">)</a> <a id="12879" href="Utils.html#3369" class="Function Operator">&gt;&gt;</a> <a id="12882" href="Main.html#2014" class="Postulate">exitFailure</a>
  <a id="12896" href="Main.html#1340" class="Postulate">putStrLn</a> <a id="12905" href="Main.html#12813" class="Bound">s</a> <a id="12907" href="Utils.html#3369" class="Function Operator">&gt;&gt;</a> <a id="12910" href="Main.html#2035" class="Postulate">exitSuccess</a>
<a id="12922" href="Main.html#12746" class="Function">main&#39;</a> <a id="12928" class="Symbol">(</a><a id="12929" href="Main.html#12221" class="InductiveConstructor">TypeCheck</a> <a id="12939" class="Symbol">(</a><a id="12940" href="Main.html#12073" class="InductiveConstructor">TCOpts</a> <a id="12947" href="Main.html#12947" class="Bound">i</a><a id="12948" class="Symbol">))</a>    <a id="12954" class="Symbol">=</a> <a id="12956" class="Keyword">do</a>
  <a id="12961" href="Utils.html#961" class="InductiveConstructor">inj₂</a> <a id="12966" href="Main.html#12966" class="Bound">s</a> <a id="12968" href="Utils.html#3321" class="Field Operator">←</a> <a id="12970" href="Main.html#12575" class="Function">tcInput</a> <a id="12978" href="Main.html#12947" class="Bound">i</a>
    <a id="12984" class="Keyword">where</a>
    <a id="12994" href="Utils.html#937" class="InductiveConstructor">inj₁</a> <a id="12999" href="Main.html#12999" class="Bound">e</a> <a id="13001" class="Symbol">→</a> <a id="13003" href="Main.html#1340" class="Postulate">putStrLn</a> <a id="13012" class="Symbol">(</a><a id="13013" href="Main.html#6844" class="Function">reportError</a> <a id="13025" href="Main.html#12999" class="Bound">e</a><a id="13026" class="Symbol">)</a> <a id="13028" href="Utils.html#3369" class="Function Operator">&gt;&gt;</a> <a id="13031" href="Main.html#2014" class="Postulate">exitFailure</a>
  <a id="13045" href="Main.html#1340" class="Postulate">putStrLn</a> <a id="13054" href="Main.html#12966" class="Bound">s</a> <a id="13056" href="Utils.html#3369" class="Function Operator">&gt;&gt;</a> <a id="13059" href="Main.html#2035" class="Postulate">exitSuccess</a>

<a id="main"></a><a id="13072" href="Main.html#13072" class="Function">main</a> <a id="13077" class="Symbol">:</a> <a id="13079" href="Agda.Builtin.IO.html#138" class="Postulate">IO</a> <a id="13082" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="13084" href="Main.html#13072" class="Function">main</a> <a id="13089" class="Symbol">=</a> <a id="13091" href="Main.html#12331" class="Postulate">execP</a> <a id="13097" href="Utils.html#3321" class="Field Operator">&gt;&gt;=</a> <a id="13101" href="Main.html#12746" class="Function">main&#39;</a>

<a id="liftSum"></a><a id="13108" href="Main.html#13108" class="Function">liftSum</a> <a id="13116" class="Symbol">:</a> <a id="13118" class="Symbol">{</a><a id="13119" href="Main.html#13119" class="Bound">A</a> <a id="13121" class="Symbol">:</a> <a id="13123" class="PrimitiveType">Set</a><a id="13126" class="Symbol">}</a> <a id="13128" class="Symbol">→</a> <a id="13130" href="Utils.html#904" class="Datatype">Either</a> <a id="13137" href="Main.html#5428" class="Datatype">ERROR</a> <a id="13143" href="Main.html#13119" class="Bound">A</a> <a id="13145" class="Symbol">→</a> <a id="13147" href="Utils.html#486" class="Datatype">Maybe</a> <a id="13153" href="Main.html#13119" class="Bound">A</a>
<a id="13155" href="Main.html#13108" class="Function">liftSum</a> <a id="13163" class="Symbol">(</a><a id="13164" href="Utils.html#961" class="InductiveConstructor">inj₂</a> <a id="13169" href="Main.html#13169" class="Bound">a</a><a id="13170" class="Symbol">)</a> <a id="13172" class="Symbol">=</a> <a id="13174" href="Utils.html#516" class="InductiveConstructor">just</a> <a id="13179" href="Main.html#13169" class="Bound">a</a>
<a id="13181" href="Main.html#13108" class="Function">liftSum</a> <a id="13189" class="Symbol">(</a><a id="13190" href="Utils.html#937" class="InductiveConstructor">inj₁</a> <a id="13195" href="Main.html#13195" class="Bound">e</a><a id="13196" class="Symbol">)</a> <a id="13198" class="Symbol">=</a> <a id="13200" href="Utils.html#537" class="InductiveConstructor">nothing</a>


<a id="13210" class="Comment">-- a Haskell interface to the kindchecker:</a>
<a id="checkKindX"></a><a id="13253" href="Main.html#13253" class="Function">checkKindX</a> <a id="13264" class="Symbol">:</a> <a id="13266" href="Main.html#2563" class="Postulate">Type</a> <a id="13271" class="Symbol">→</a> <a id="13273" href="Type.html#596" class="Datatype">Kind</a> <a id="13278" class="Symbol">→</a> <a id="13280" href="Utils.html#904" class="Datatype">Either</a> <a id="13287" href="Main.html#5428" class="Datatype">ERROR</a> <a id="13293" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="13295" href="Main.html#13253" class="Function">checkKindX</a> <a id="13306" href="Main.html#13306" class="Bound">ty</a> <a id="13309" href="Main.html#13309" class="Bound">k</a> <a id="13311" class="Symbol">=</a> <a id="13313" class="Keyword">do</a>
  <a id="13318" href="Main.html#13318" class="Bound">ty</a>        <a id="13328" href="Utils.html#3321" class="Field Operator">←</a> <a id="13330" href="Utils.html#4084" class="Function">withE</a> <a id="13336" href="Main.html#5511" class="InductiveConstructor">scopeError</a> <a id="13347" class="Symbol">(</a><a id="13348" href="Scoped.html#8181" class="Function">scopeCheckTy</a> <a id="13361" class="Symbol">(</a><a id="13362" href="Scoped.html#4082" class="Function">shifterTy</a> <a id="13372" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="13374" class="Symbol">(</a><a id="13375" href="Main.html#2633" class="Postulate">convTy</a> <a id="13382" href="Main.html#13306" class="Bound">ty</a><a id="13384" class="Symbol">)))</a>
  <a id="13390" class="Symbol">(</a><a id="13391" href="Main.html#13391" class="Bound">k&#39;</a> <a id="13394" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="13397" class="Symbol">_)</a> <a id="13400" href="Utils.html#3321" class="Field Operator">←</a> <a id="13402" href="Utils.html#4084" class="Function">withE</a> <a id="13408" class="Symbol">(λ</a> <a id="13411" href="Main.html#13411" class="Bound">e</a> <a id="13413" class="Symbol">→</a> <a id="13415" href="Main.html#5448" class="InductiveConstructor">typeError</a> <a id="13425" class="Symbol">(</a><a id="13426" href="Main.html#5583" class="Function">uglyTypeError</a> <a id="13440" href="Main.html#13411" class="Bound">e</a><a id="13441" class="Symbol">))</a> <a id="13444" class="Symbol">(</a><a id="13445" href="Check.html#4385" class="Function">inferKind</a> <a id="13455" href="Type.html#981" class="InductiveConstructor">∅</a> <a id="13457" href="Main.html#13318" class="Bound">ty</a><a id="13459" class="Symbol">)</a>
  <a id="13463" class="Symbol">_</a>         <a id="13473" href="Utils.html#3321" class="Field Operator">←</a> <a id="13475" href="Utils.html#4084" class="Function">withE</a> <a id="13481" class="Symbol">((λ</a> <a id="13485" href="Main.html#13485" class="Bound">e</a> <a id="13487" class="Symbol">→</a> <a id="13489" href="Main.html#5448" class="InductiveConstructor">typeError</a> <a id="13499" class="Symbol">(</a><a id="13500" href="Main.html#5583" class="Function">uglyTypeError</a> <a id="13514" href="Main.html#13485" class="Bound">e</a><a id="13515" class="Symbol">))</a> <a id="13518" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="13520" href="Check.html#1129" class="InductiveConstructor">kindMismatch</a> <a id="13533" class="Symbol">_</a> <a id="13535" class="Symbol">_)</a> <a id="13538" class="Symbol">(</a><a id="13539" href="Check.html#1766" class="Function">meqKind</a> <a id="13547" href="Main.html#13309" class="Bound">k</a> <a id="13549" href="Main.html#13391" class="Bound">k&#39;</a><a id="13551" class="Symbol">)</a>
  <a id="13555" href="Utils.html#3293" class="Field">return</a> <a id="13562" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>

<a id="13566" class="Symbol">{-#</a> <a id="13570" class="Keyword">COMPILE</a> <a id="13578" class="Keyword">GHC</a> <a id="13582" href="Main.html#13253" class="Function">checkKindX</a> <a id="13593" class="Pragma">as</a> <a id="13596" class="Pragma">checkKindAgda</a> <a id="13610" class="Symbol">#-}</a>


<a id="13616" class="Comment">-- a Haskell interface to kind inference:</a>

<a id="inferKind∅"></a><a id="13659" href="Main.html#13659" class="Function">inferKind∅</a> <a id="13670" class="Symbol">:</a> <a id="13672" href="Main.html#2563" class="Postulate">Type</a> <a id="13677" class="Symbol">→</a> <a id="13679" href="Utils.html#904" class="Datatype">Either</a> <a id="13686" href="Main.html#5428" class="Datatype">ERROR</a> <a id="13692" href="Type.html#596" class="Datatype">Kind</a>
<a id="13697" href="Main.html#13659" class="Function">inferKind∅</a> <a id="13708" href="Main.html#13708" class="Bound">ty</a> <a id="13711" class="Symbol">=</a> <a id="13713" class="Keyword">do</a>
  <a id="13718" href="Main.html#13718" class="Bound">ty</a>       <a id="13727" href="Utils.html#3321" class="Field Operator">←</a> <a id="13729" href="Utils.html#4084" class="Function">withE</a> <a id="13735" href="Main.html#5511" class="InductiveConstructor">scopeError</a> <a id="13746" class="Symbol">(</a><a id="13747" href="Scoped.html#8181" class="Function">scopeCheckTy</a> <a id="13760" class="Symbol">(</a><a id="13761" href="Scoped.html#4082" class="Function">shifterTy</a> <a id="13771" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="13773" class="Symbol">(</a><a id="13774" href="Main.html#2633" class="Postulate">convTy</a> <a id="13781" href="Main.html#13708" class="Bound">ty</a><a id="13783" class="Symbol">)))</a>
  <a id="13789" class="Symbol">(</a><a id="13790" href="Main.html#13790" class="Bound">k</a> <a id="13792" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="13795" class="Symbol">_)</a> <a id="13798" href="Utils.html#3321" class="Field Operator">←</a> <a id="13800" href="Utils.html#4084" class="Function">withE</a> <a id="13806" class="Symbol">(λ</a> <a id="13809" href="Main.html#13809" class="Bound">e</a> <a id="13811" class="Symbol">→</a> <a id="13813" href="Main.html#5448" class="InductiveConstructor">typeError</a> <a id="13823" class="Symbol">(</a><a id="13824" href="Main.html#5583" class="Function">uglyTypeError</a> <a id="13838" href="Main.html#13809" class="Bound">e</a><a id="13839" class="Symbol">))</a> <a id="13842" class="Symbol">(</a><a id="13843" href="Check.html#4385" class="Function">inferKind</a> <a id="13853" href="Type.html#981" class="InductiveConstructor">∅</a> <a id="13855" href="Main.html#13718" class="Bound">ty</a><a id="13857" class="Symbol">)</a>
  <a id="13861" href="Utils.html#3293" class="Field">return</a> <a id="13868" href="Main.html#13790" class="Bound">k</a>

<a id="13871" class="Symbol">{-#</a> <a id="13875" class="Keyword">COMPILE</a> <a id="13883" class="Keyword">GHC</a> <a id="13887" href="Main.html#13659" class="Function">inferKind∅</a> <a id="13898" class="Pragma">as</a> <a id="13901" class="Pragma">inferKindAgda</a> <a id="13915" class="Symbol">#-}</a>

<a id="13920" class="Keyword">open</a> <a id="13925" class="Keyword">import</a> <a id="13932" href="Type.BetaNormal.html" class="Module">Type.BetaNormal</a>

<a id="13949" class="Comment">-- a Haskell interface to the type normalizer:</a>
<a id="normalizeType"></a><a id="13996" href="Main.html#13996" class="Function">normalizeType</a> <a id="14010" class="Symbol">:</a> <a id="14012" href="Main.html#2563" class="Postulate">Type</a> <a id="14017" class="Symbol">→</a> <a id="14019" href="Utils.html#904" class="Datatype">Either</a> <a id="14026" href="Main.html#5428" class="Datatype">ERROR</a> <a id="14032" href="Main.html#2563" class="Postulate">Type</a>
<a id="14037" href="Main.html#13996" class="Function">normalizeType</a> <a id="14051" href="Main.html#14051" class="Bound">ty</a> <a id="14054" class="Symbol">=</a> <a id="14056" class="Keyword">do</a>
  <a id="14061" href="Main.html#14061" class="Bound">ty&#39;</a>    <a id="14068" href="Utils.html#3321" class="Field Operator">←</a> <a id="14070" href="Utils.html#4084" class="Function">withE</a> <a id="14076" href="Main.html#5511" class="InductiveConstructor">scopeError</a> <a id="14087" class="Symbol">(</a><a id="14088" href="Scoped.html#8181" class="Function">scopeCheckTy</a> <a id="14101" class="Symbol">(</a><a id="14102" href="Scoped.html#4082" class="Function">shifterTy</a> <a id="14112" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="14114" class="Symbol">(</a><a id="14115" href="Main.html#2633" class="Postulate">convTy</a> <a id="14122" href="Main.html#14051" class="Bound">ty</a><a id="14124" class="Symbol">)))</a>
  <a id="14130" class="Symbol">_</a> <a id="14132" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="14135" href="Main.html#14135" class="Bound">n</a> <a id="14137" href="Utils.html#3321" class="Field Operator">←</a> <a id="14139" href="Utils.html#4084" class="Function">withE</a> <a id="14145" class="Symbol">(λ</a> <a id="14148" href="Main.html#14148" class="Bound">e</a> <a id="14150" class="Symbol">→</a> <a id="14152" href="Main.html#5448" class="InductiveConstructor">typeError</a> <a id="14162" class="Symbol">(</a><a id="14163" href="Main.html#5583" class="Function">uglyTypeError</a> <a id="14177" href="Main.html#14148" class="Bound">e</a><a id="14178" class="Symbol">))</a> <a id="14181" class="Symbol">(</a><a id="14182" href="Check.html#4385" class="Function">inferKind</a> <a id="14192" href="Type.html#981" class="InductiveConstructor">∅</a> <a id="14194" href="Main.html#14061" class="Bound">ty&#39;</a><a id="14197" class="Symbol">)</a>
  <a id="14201" href="Utils.html#3293" class="Field">return</a> <a id="14208" class="Symbol">(</a><a id="14209" href="Main.html#2657" class="Postulate">unconvTy</a> <a id="14218" class="Symbol">(</a><a id="14219" href="Scoped.html#5021" class="Function">unshifterTy</a> <a id="14231" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="14233" class="Symbol">(</a><a id="14234" href="Scoped.html#10165" class="Function">extricateScopeTy</a> <a id="14251" class="Symbol">(</a><a id="14252" href="Scoped.Extrication.html#876" class="Function">extricateNf⋆</a> <a id="14265" href="Main.html#14135" class="Bound">n</a><a id="14266" class="Symbol">))))</a>

<a id="14272" class="Symbol">{-#</a> <a id="14276" class="Keyword">COMPILE</a> <a id="14284" class="Keyword">GHC</a> <a id="14288" href="Main.html#13996" class="Function">normalizeType</a> <a id="14302" class="Pragma">as</a> <a id="14305" class="Pragma">normalizeTypeAgda</a> <a id="14323" class="Symbol">#-}</a>

<a id="14328" class="Comment">-- Haskell interface to type checker:</a>
<a id="inferType∅"></a><a id="14366" href="Main.html#14366" class="Function">inferType∅</a> <a id="14377" class="Symbol">:</a> <a id="14379" href="Main.html#2518" class="Postulate">Term</a> <a id="14384" class="Symbol">→</a> <a id="14386" href="Utils.html#904" class="Datatype">Either</a> <a id="14393" href="Main.html#5428" class="Datatype">ERROR</a> <a id="14399" href="Main.html#2563" class="Postulate">Type</a>
<a id="14404" href="Main.html#14366" class="Function">inferType∅</a> <a id="14415" href="Main.html#14415" class="Bound">t</a> <a id="14417" class="Symbol">=</a> <a id="14419" class="Keyword">do</a>
  <a id="14424" href="Main.html#14424" class="Bound">t&#39;</a> <a id="14427" href="Utils.html#3321" class="Field Operator">←</a> <a id="14429" href="Utils.html#4084" class="Function">withE</a> <a id="14435" href="Main.html#5511" class="InductiveConstructor">scopeError</a> <a id="14446" class="Symbol">(</a><a id="14447" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="14460" class="Symbol">{</a><a id="14461" class="Number">0</a><a id="14462" class="Symbol">}{</a><a id="14464" href="Scoped.html#1963" class="InductiveConstructor">Z</a><a id="14465" class="Symbol">}</a> <a id="14467" class="Symbol">(</a><a id="14468" href="Scoped.html#4478" class="Function">shifter</a> <a id="14476" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="14478" class="Symbol">(</a><a id="14479" href="Main.html#2609" class="Postulate">convTm</a> <a id="14486" href="Main.html#14415" class="Bound">t</a><a id="14487" class="Symbol">)))</a>
  <a id="14493" href="Main.html#14493" class="Bound">ty</a> <a id="14496" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="14499" class="Symbol">_</a> <a id="14501" href="Utils.html#3321" class="Field Operator">←</a> <a id="14503" href="Utils.html#4084" class="Function">withE</a> <a id="14509" class="Symbol">(λ</a> <a id="14512" href="Main.html#14512" class="Bound">e</a> <a id="14514" class="Symbol">→</a> <a id="14516" href="Main.html#5448" class="InductiveConstructor">typeError</a> <a id="14526" class="Symbol">(</a><a id="14527" href="Main.html#5583" class="Function">uglyTypeError</a> <a id="14541" href="Main.html#14512" class="Bound">e</a><a id="14542" class="Symbol">))</a> <a id="14545" class="Symbol">(</a><a id="14546" href="Check.html#10572" class="Function">inferType</a> <a id="14556" href="Algorithmic.html#1249" class="InductiveConstructor">∅</a> <a id="14558" href="Main.html#14424" class="Bound">t&#39;</a><a id="14560" class="Symbol">)</a>
  <a id="14564" href="Utils.html#3293" class="Field">return</a> <a id="14571" class="Symbol">(</a><a id="14572" href="Main.html#2657" class="Postulate">unconvTy</a> <a id="14581" class="Symbol">(</a><a id="14582" href="Scoped.html#5021" class="Function">unshifterTy</a> <a id="14594" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="14596" class="Symbol">(</a><a id="14597" href="Scoped.html#10165" class="Function">extricateScopeTy</a> <a id="14614" class="Symbol">(</a><a id="14615" href="Scoped.Extrication.html#876" class="Function">extricateNf⋆</a> <a id="14628" href="Main.html#14493" class="Bound">ty</a><a id="14630" class="Symbol">))))</a>

<a id="14636" class="Symbol">{-#</a> <a id="14640" class="Keyword">COMPILE</a> <a id="14648" class="Keyword">GHC</a> <a id="14652" href="Main.html#14366" class="Function">inferType∅</a> <a id="14663" class="Pragma">as</a> <a id="14666" class="Pragma">inferTypeAgda</a> <a id="14680" class="Symbol">#-}</a>


<a id="14686" class="Comment">-- FIXME: we have a checkType function now...</a>
<a id="checkType∅"></a><a id="14732" href="Main.html#14732" class="Function">checkType∅</a> <a id="14743" class="Symbol">:</a> <a id="14745" href="Main.html#2563" class="Postulate">Type</a> <a id="14750" class="Symbol">→</a> <a id="14752" href="Main.html#2518" class="Postulate">Term</a> <a id="14757" class="Symbol">→</a> <a id="14759" href="Utils.html#904" class="Datatype">Either</a> <a id="14766" href="Main.html#5428" class="Datatype">ERROR</a> <a id="14772" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="14774" href="Main.html#14732" class="Function">checkType∅</a> <a id="14785" href="Main.html#14785" class="Bound">ty</a> <a id="14788" href="Main.html#14788" class="Bound">t</a> <a id="14790" class="Symbol">=</a> <a id="14792" class="Keyword">do</a>
  <a id="14797" href="Main.html#14797" class="Bound">ty&#39;</a> <a id="14801" href="Utils.html#3321" class="Field Operator">←</a> <a id="14803" href="Utils.html#4084" class="Function">withE</a> <a id="14809" href="Main.html#5511" class="InductiveConstructor">scopeError</a> <a id="14820" class="Symbol">(</a><a id="14821" href="Scoped.html#8181" class="Function">scopeCheckTy</a> <a id="14834" class="Symbol">(</a><a id="14835" href="Scoped.html#4082" class="Function">shifterTy</a> <a id="14845" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="14847" class="Symbol">(</a><a id="14848" href="Main.html#2633" class="Postulate">convTy</a> <a id="14855" href="Main.html#14785" class="Bound">ty</a><a id="14857" class="Symbol">)))</a>
  <a id="14863" href="Main.html#14863" class="Bound">tyN</a> <a id="14867" href="Utils.html#3321" class="Field Operator">←</a> <a id="14869" href="Utils.html#4084" class="Function">withE</a> <a id="14875" class="Symbol">(λ</a> <a id="14878" href="Main.html#14878" class="Bound">e</a> <a id="14880" class="Symbol">→</a> <a id="14882" href="Main.html#5448" class="InductiveConstructor">typeError</a> <a id="14892" class="Symbol">(</a><a id="14893" href="Main.html#5583" class="Function">uglyTypeError</a> <a id="14907" href="Main.html#14878" class="Bound">e</a><a id="14908" class="Symbol">))</a> <a id="14911" class="Symbol">(</a><a id="14912" href="Check.html#4309" class="Function">checkKind</a> <a id="14922" href="Type.html#981" class="InductiveConstructor">∅</a> <a id="14924" href="Main.html#14797" class="Bound">ty&#39;</a> <a id="14928" href="Type.html#615" class="InductiveConstructor">*</a><a id="14929" class="Symbol">)</a>
  <a id="14933" href="Main.html#14933" class="Bound">t&#39;</a>  <a id="14937" href="Utils.html#3321" class="Field Operator">←</a> <a id="14939" href="Utils.html#4084" class="Function">withE</a> <a id="14945" href="Main.html#5511" class="InductiveConstructor">scopeError</a> <a id="14956" class="Symbol">(</a><a id="14957" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="14970" class="Symbol">{</a><a id="14971" class="Number">0</a><a id="14972" class="Symbol">}{</a><a id="14974" href="Scoped.html#1963" class="InductiveConstructor">Z</a><a id="14975" class="Symbol">}</a> <a id="14977" class="Symbol">(</a><a id="14978" href="Scoped.html#4478" class="Function">shifter</a> <a id="14986" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="14988" class="Symbol">(</a><a id="14989" href="Main.html#2609" class="Postulate">convTm</a> <a id="14996" href="Main.html#14788" class="Bound">t</a><a id="14997" class="Symbol">)))</a>
  <a id="15003" href="Utils.html#4084" class="Function">withE</a> <a id="15009" class="Symbol">(λ</a> <a id="15012" href="Main.html#15012" class="Bound">e</a> <a id="15014" class="Symbol">→</a> <a id="15016" href="Main.html#5448" class="InductiveConstructor">typeError</a> <a id="15026" class="Symbol">(</a><a id="15027" href="Main.html#5583" class="Function">uglyTypeError</a> <a id="15041" href="Main.html#15012" class="Bound">e</a><a id="15042" class="Symbol">))</a> <a id="15045" class="Symbol">(</a><a id="15046" href="Check.html#10478" class="Function">checkType</a> <a id="15056" href="Algorithmic.html#1249" class="InductiveConstructor">∅</a> <a id="15058" href="Main.html#14933" class="Bound">t&#39;</a> <a id="15061" href="Main.html#14863" class="Bound">tyN</a><a id="15064" class="Symbol">)</a>
<a id="15066" class="Comment">{-
  tyN&#39; ,, tmC ← withE (λ e → typeError (uglyTypeError e)) (inferType ∅ t&#39;)
  refl      ← withE ((λ e → typeError (uglyTypeError e)) ∘ kindMismatch _ _) (meqKind k *)
  refl      ← withE ((λ e → typeError (uglyTypeError e)) ∘ typeMismatch _ _) (meqNfTy tyN tyN&#39;)
-}</a>
  <a id="15336" href="Utils.html#3293" class="Field">return</a> <a id="15343" class="Symbol">_</a>

<a id="15346" class="Comment">-- Haskell interface to type normalizer (for terms)</a>
<a id="15398" class="Comment">-- the type checker/inferer could also return such a term</a>
<a id="normalizeTypeTerm"></a><a id="15456" href="Main.html#15456" class="Function">normalizeTypeTerm</a> <a id="15474" class="Symbol">:</a> <a id="15476" href="Main.html#2518" class="Postulate">Term</a> <a id="15481" class="Symbol">→</a> <a id="15483" href="Utils.html#904" class="Datatype">Either</a> <a id="15490" href="Main.html#5428" class="Datatype">ERROR</a> <a id="15496" href="Main.html#2518" class="Postulate">Term</a>
<a id="15501" href="Main.html#15456" class="Function">normalizeTypeTerm</a> <a id="15519" href="Main.html#15519" class="Bound">t</a> <a id="15521" class="Symbol">=</a> <a id="15523" class="Keyword">do</a>
  <a id="15528" href="Main.html#15528" class="Bound">tDB</a> <a id="15532" href="Utils.html#3321" class="Field Operator">←</a> <a id="15534" href="Utils.html#4084" class="Function">withE</a> <a id="15540" href="Main.html#5511" class="InductiveConstructor">scopeError</a> <a id="15551" class="Symbol">(</a><a id="15552" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="15565" class="Symbol">{</a><a id="15566" class="Number">0</a><a id="15567" class="Symbol">}{</a><a id="15569" href="Scoped.html#1963" class="InductiveConstructor">Z</a><a id="15570" class="Symbol">}</a> <a id="15572" class="Symbol">(</a><a id="15573" href="Scoped.html#4478" class="Function">shifter</a> <a id="15581" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="15583" class="Symbol">(</a><a id="15584" href="Main.html#2609" class="Postulate">convTm</a> <a id="15591" href="Main.html#15519" class="Bound">t</a><a id="15592" class="Symbol">)))</a>
  <a id="15598" class="Symbol">_</a> <a id="15600" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="15603" href="Main.html#15603" class="Bound">tC</a> <a id="15606" href="Utils.html#3321" class="Field Operator">←</a> <a id="15608" href="Utils.html#4084" class="Function">withE</a> <a id="15614" class="Symbol">(λ</a> <a id="15617" href="Main.html#15617" class="Bound">e</a> <a id="15619" class="Symbol">→</a> <a id="15621" href="Main.html#5448" class="InductiveConstructor">typeError</a> <a id="15631" class="Symbol">(</a><a id="15632" href="Main.html#5583" class="Function">uglyTypeError</a> <a id="15646" href="Main.html#15617" class="Bound">e</a><a id="15647" class="Symbol">))</a> <a id="15650" class="Symbol">(</a><a id="15651" href="Check.html#10572" class="Function">inferType</a> <a id="15661" href="Algorithmic.html#1249" class="InductiveConstructor">∅</a> <a id="15663" href="Main.html#15528" class="Bound">tDB</a><a id="15666" class="Symbol">)</a>
  <a id="15670" href="Utils.html#3293" class="Field">return</a> <a id="15677" class="Symbol">(</a><a id="15678" href="Main.html#2683" class="Postulate">unconvTm</a> <a id="15687" class="Symbol">(</a><a id="15688" href="Scoped.html#5468" class="Function">unshifter</a> <a id="15698" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="15700" class="Symbol">(</a><a id="15701" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="15716" class="Symbol">(</a><a id="15717" href="Scoped.Extrication.html#3921" class="Function">extricate</a> <a id="15727" href="Main.html#15603" class="Bound">tC</a><a id="15729" class="Symbol">))))</a>

<a id="15735" class="Symbol">{-#</a> <a id="15739" class="Keyword">COMPILE</a> <a id="15747" class="Keyword">GHC</a> <a id="15751" href="Main.html#15456" class="Function">normalizeTypeTerm</a> <a id="15769" class="Pragma">as</a> <a id="15772" class="Pragma">normalizeTypeTermAgda</a> <a id="15794" class="Symbol">#-}</a>


<a id="15800" class="Symbol">{-#</a> <a id="15804" class="Keyword">COMPILE</a> <a id="15812" class="Keyword">GHC</a> <a id="15816" href="Main.html#14732" class="Function">checkType∅</a> <a id="15827" class="Pragma">as</a> <a id="15830" class="Pragma">checkTypeAgda</a> <a id="15844" class="Symbol">#-}</a>

<a id="15849" class="Comment">-- Haskell interface to (typechecked and proven correct) reduction</a>

<a id="15917" class="Keyword">import</a> <a id="15924" href="Algorithmic.Evaluation.html" class="Module">Algorithmic.Evaluation</a> <a id="15947" class="Symbol">as</a> <a id="15950" class="Module">L</a>

<a id="runTL"></a><a id="15953" href="Main.html#15953" class="Function">runTL</a> <a id="15959" class="Symbol">:</a> <a id="15961" href="Main.html#2518" class="Postulate">Term</a> <a id="15966" class="Symbol">→</a> <a id="15968" href="Utils.html#904" class="Datatype">Either</a> <a id="15975" href="Main.html#5428" class="Datatype">ERROR</a> <a id="15981" href="Main.html#2518" class="Postulate">Term</a>
<a id="15986" href="Main.html#15953" class="Function">runTL</a> <a id="15992" href="Main.html#15992" class="Bound">t</a> <a id="15994" class="Symbol">=</a> <a id="15996" class="Keyword">do</a>
  <a id="16001" href="Main.html#16001" class="Bound">tDB</a> <a id="16005" href="Utils.html#3321" class="Field Operator">←</a> <a id="16007" href="Utils.html#4084" class="Function">withE</a> <a id="16013" href="Main.html#5511" class="InductiveConstructor">scopeError</a> <a id="16024" class="Symbol">(</a><a id="16025" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="16038" class="Symbol">{</a><a id="16039" class="Number">0</a><a id="16040" class="Symbol">}{</a><a id="16042" href="Scoped.html#1963" class="InductiveConstructor">Z</a><a id="16043" class="Symbol">}</a> <a id="16045" class="Symbol">(</a><a id="16046" href="Scoped.html#4478" class="Function">shifter</a> <a id="16054" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="16056" class="Symbol">(</a><a id="16057" href="Main.html#2609" class="Postulate">convTm</a> <a id="16064" href="Main.html#15992" class="Bound">t</a><a id="16065" class="Symbol">)))</a>
  <a id="16071" class="Symbol">_</a> <a id="16073" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="16076" href="Main.html#16076" class="Bound">tC</a> <a id="16079" href="Utils.html#3321" class="Field Operator">←</a> <a id="16081" href="Utils.html#4084" class="Function">withE</a> <a id="16087" class="Symbol">(λ</a> <a id="16090" href="Main.html#16090" class="Bound">e</a> <a id="16092" class="Symbol">→</a> <a id="16094" href="Main.html#5448" class="InductiveConstructor">typeError</a> <a id="16104" class="Symbol">(</a><a id="16105" href="Main.html#5583" class="Function">uglyTypeError</a> <a id="16119" href="Main.html#16090" class="Bound">e</a><a id="16120" class="Symbol">))</a> <a id="16123" class="Symbol">(</a><a id="16124" href="Check.html#10572" class="Function">inferType</a> <a id="16134" href="Algorithmic.html#1249" class="InductiveConstructor">∅</a> <a id="16136" href="Main.html#16001" class="Bound">tDB</a><a id="16139" class="Symbol">)</a>
  <a id="16143" href="Main.html#16143" class="Bound">t</a> <a id="16145" href="Utils.html#3321" class="Field Operator">←</a> <a id="16147" href="Utils.html#4084" class="Function">withE</a> <a id="16153" href="Main.html#5545" class="InductiveConstructor">runtimeError</a> <a id="16166" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="16168" href="Algorithmic.Evaluation.html#1779" class="Function">L.stepper</a> <a id="16178" href="Main.html#16076" class="Bound">tC</a> <a id="16181" href="Main.html#6795" class="Function">maxsteps</a>
  <a id="16192" href="Utils.html#3293" class="Field">return</a> <a id="16199" class="Symbol">(</a><a id="16200" href="Main.html#2683" class="Postulate">unconvTm</a> <a id="16209" class="Symbol">(</a><a id="16210" href="Scoped.html#5468" class="Function">unshifter</a> <a id="16220" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="16222" class="Symbol">(</a><a id="16223" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="16238" class="Symbol">(</a><a id="16239" href="Scoped.Extrication.html#3921" class="Function">extricate</a> <a id="16249" href="Main.html#16143" class="Bound">t</a><a id="16250" class="Symbol">))))</a>

<a id="16256" class="Symbol">{-#</a> <a id="16260" class="Keyword">COMPILE</a> <a id="16268" class="Keyword">GHC</a> <a id="16272" href="Main.html#15953" class="Function">runTL</a> <a id="16278" class="Pragma">as</a> <a id="16281" class="Pragma">runTLAgda</a> <a id="16291" class="Symbol">#-}</a>

<a id="16296" class="Comment">-- Haskell interface to (untypechecked CK)</a>
<a id="runCK"></a><a id="16339" href="Main.html#16339" class="Function">runCK</a> <a id="16345" class="Symbol">:</a> <a id="16347" href="Main.html#2518" class="Postulate">Term</a> <a id="16352" class="Symbol">→</a> <a id="16354" href="Utils.html#904" class="Datatype">Either</a> <a id="16361" href="Main.html#5428" class="Datatype">ERROR</a> <a id="16367" href="Main.html#2518" class="Postulate">Term</a>
<a id="16372" href="Main.html#16339" class="Function">runCK</a> <a id="16378" href="Main.html#16378" class="Bound">t</a> <a id="16380" class="Symbol">=</a> <a id="16382" class="Keyword">do</a>
  <a id="16387" href="Main.html#16387" class="Bound">tDB</a> <a id="16391" href="Utils.html#3321" class="Field Operator">←</a> <a id="16393" href="Utils.html#4084" class="Function">withE</a> <a id="16399" href="Main.html#5511" class="InductiveConstructor">scopeError</a> <a id="16410" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="16412" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="16425" class="Symbol">{</a><a id="16426" class="Number">0</a><a id="16427" class="Symbol">}{</a><a id="16429" href="Scoped.html#1963" class="InductiveConstructor">Z</a><a id="16430" class="Symbol">}</a> <a id="16432" class="Symbol">(</a><a id="16433" href="Scoped.html#4478" class="Function">shifter</a> <a id="16441" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="16443" class="Symbol">(</a><a id="16444" href="Main.html#2609" class="Postulate">convTm</a> <a id="16451" href="Main.html#16378" class="Bound">t</a><a id="16452" class="Symbol">))</a>
  <a id="16457" href="Scoped.CK.html#1061" class="InductiveConstructor">□</a> <a id="16459" href="Main.html#16459" class="Bound">V</a> <a id="16461" href="Utils.html#3321" class="Field Operator">←</a> <a id="16463" href="Utils.html#4084" class="Function">withE</a> <a id="16469" href="Main.html#5545" class="InductiveConstructor">runtimeError</a> <a id="16482" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="16484" href="Scoped.CK.html#3273" class="Function">Scoped.CK.stepper</a> <a id="16502" href="Main.html#6795" class="Function">maxsteps</a> <a id="16511" class="Symbol">(</a><a id="16512" href="Scoped.CK.html#907" class="InductiveConstructor">ε</a> <a id="16514" href="Scoped.CK.html#975" class="InductiveConstructor Operator">▻</a> <a id="16516" href="Main.html#16387" class="Bound">tDB</a><a id="16519" class="Symbol">)</a>
    <a id="16525" class="Keyword">where</a> <a id="16531" class="Symbol">(_</a> <a id="16534" href="Scoped.CK.html#975" class="InductiveConstructor Operator">▻</a> <a id="16536" class="Symbol">_)</a> <a id="16539" class="Symbol">→</a> <a id="16541" href="Utils.html#937" class="InductiveConstructor">inj₁</a> <a id="16546" class="Symbol">(</a><a id="16547" href="Main.html#5545" class="InductiveConstructor">runtimeError</a> <a id="16560" href="Utils.html#4263" class="InductiveConstructor">gasError</a><a id="16568" class="Symbol">)</a>
          <a id="16580" class="Symbol">(_</a> <a id="16583" href="Scoped.CK.html#1010" class="InductiveConstructor Operator">◅</a> <a id="16585" class="Symbol">_)</a> <a id="16588" class="Symbol">→</a> <a id="16590" href="Utils.html#937" class="InductiveConstructor">inj₁</a> <a id="16595" class="Symbol">(</a><a id="16596" href="Main.html#5545" class="InductiveConstructor">runtimeError</a> <a id="16609" href="Utils.html#4263" class="InductiveConstructor">gasError</a><a id="16617" class="Symbol">)</a>
          <a id="16629" href="Scoped.CK.html#1105" class="InductiveConstructor">◆</a> <a id="16631" class="Symbol">→</a> <a id="16633" href="Utils.html#3293" class="Field">return</a> <a id="16640" class="Symbol">(</a><a id="16641" href="Main.html#2683" class="Postulate">unconvTm</a> <a id="16650" class="Symbol">(</a><a id="16651" href="Scoped.html#5468" class="Function">unshifter</a> <a id="16661" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="16663" class="Symbol">(</a><a id="16664" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="16679" class="Symbol">{</a><a id="16680" class="Number">0</a><a id="16681" class="Symbol">}{</a><a id="16683" href="Scoped.html#1963" class="InductiveConstructor">Z</a><a id="16684" class="Symbol">}</a> <a id="16686" class="Symbol">(</a><a id="16687" href="Scoped.html#6607" class="InductiveConstructor">error</a> <a id="16693" href="Scoped.html#1704" class="InductiveConstructor">missing</a><a id="16700" class="Symbol">))))</a> <a id="16705" class="Comment">-- NOTE: we could use the typechecker to get the correct type</a>
  <a id="16769" href="Utils.html#3293" class="Field">return</a> <a id="16776" class="Symbol">(</a><a id="16777" href="Main.html#2683" class="Postulate">unconvTm</a> <a id="16786" class="Symbol">(</a><a id="16787" href="Scoped.html#5468" class="Function">unshifter</a> <a id="16797" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="16799" class="Symbol">(</a><a id="16800" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="16815" class="Symbol">(</a><a id="16816" href="Scoped.CK.html#3174" class="Function">Scoped.CK.discharge</a> <a id="16836" href="Main.html#16459" class="Bound">V</a><a id="16837" class="Symbol">))))</a>

<a id="16843" class="Symbol">{-#</a> <a id="16847" class="Keyword">COMPILE</a> <a id="16855" class="Keyword">GHC</a> <a id="16859" href="Main.html#16339" class="Function">runCK</a> <a id="16865" class="Pragma">as</a> <a id="16868" class="Pragma">runCKAgda</a> <a id="16878" class="Symbol">#-}</a>

<a id="16883" class="Comment">-- Haskell interface to (typechecked) CK</a>
<a id="runTCK"></a><a id="16924" href="Main.html#16924" class="Function">runTCK</a> <a id="16931" class="Symbol">:</a> <a id="16933" href="Main.html#2518" class="Postulate">Term</a> <a id="16938" class="Symbol">→</a> <a id="16940" href="Utils.html#904" class="Datatype">Either</a> <a id="16947" href="Main.html#5428" class="Datatype">ERROR</a> <a id="16953" href="Main.html#2518" class="Postulate">Term</a>
<a id="16958" href="Main.html#16924" class="Function">runTCK</a> <a id="16965" href="Main.html#16965" class="Bound">t</a> <a id="16967" class="Symbol">=</a> <a id="16969" class="Keyword">do</a>
  <a id="16974" href="Main.html#16974" class="Bound">tDB</a> <a id="16978" href="Utils.html#3321" class="Field Operator">←</a> <a id="16980" href="Utils.html#4084" class="Function">withE</a> <a id="16986" href="Main.html#5511" class="InductiveConstructor">scopeError</a> <a id="16997" class="Symbol">(</a><a id="16998" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="17011" class="Symbol">{</a><a id="17012" class="Number">0</a><a id="17013" class="Symbol">}{</a><a id="17015" href="Scoped.html#1963" class="InductiveConstructor">Z</a><a id="17016" class="Symbol">}</a> <a id="17018" class="Symbol">(</a><a id="17019" href="Scoped.html#4478" class="Function">shifter</a> <a id="17027" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="17029" class="Symbol">(</a><a id="17030" href="Main.html#2609" class="Postulate">convTm</a> <a id="17037" href="Main.html#16965" class="Bound">t</a><a id="17038" class="Symbol">)))</a>
  <a id="17044" class="Symbol">_</a> <a id="17046" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="17049" href="Main.html#17049" class="Bound">tC</a> <a id="17052" href="Utils.html#3321" class="Field Operator">←</a> <a id="17054" href="Utils.html#4084" class="Function">withE</a> <a id="17060" class="Symbol">(λ</a> <a id="17063" href="Main.html#17063" class="Bound">e</a> <a id="17065" class="Symbol">→</a> <a id="17067" href="Main.html#5448" class="InductiveConstructor">typeError</a> <a id="17077" class="Symbol">(</a><a id="17078" href="Main.html#5583" class="Function">uglyTypeError</a> <a id="17092" href="Main.html#17063" class="Bound">e</a><a id="17093" class="Symbol">))</a> <a id="17096" class="Symbol">(</a><a id="17097" href="Check.html#10572" class="Function">inferType</a> <a id="17107" href="Algorithmic.html#1249" class="InductiveConstructor">∅</a> <a id="17109" href="Main.html#16974" class="Bound">tDB</a><a id="17112" class="Symbol">)</a>
  <a id="17116" href="Algorithmic.CK.html#1840" class="InductiveConstructor">□</a> <a id="17118" href="Main.html#17118" class="Bound">V</a> <a id="17120" href="Utils.html#3321" class="Field Operator">←</a> <a id="17122" href="Utils.html#4084" class="Function">withE</a> <a id="17128" href="Main.html#5545" class="InductiveConstructor">runtimeError</a> <a id="17141" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="17143" href="Algorithmic.CK.html#4585" class="Function">Algorithmic.CK.stepper</a> <a id="17166" href="Main.html#6795" class="Function">maxsteps</a> <a id="17175" class="Symbol">(</a><a id="17176" href="Algorithmic.CK.html#1547" class="InductiveConstructor">ε</a> <a id="17178" href="Algorithmic.CK.html#1718" class="InductiveConstructor Operator">▻</a> <a id="17180" href="Main.html#17049" class="Bound">tC</a><a id="17182" class="Symbol">)</a>
    <a id="17188" class="Keyword">where</a> <a id="17194" class="Symbol">(_</a> <a id="17197" href="Algorithmic.CK.html#1718" class="InductiveConstructor Operator">▻</a> <a id="17199" class="Symbol">_)</a> <a id="17202" class="Symbol">→</a> <a id="17204" href="Utils.html#937" class="InductiveConstructor">inj₁</a> <a id="17209" class="Symbol">(</a><a id="17210" href="Main.html#5545" class="InductiveConstructor">runtimeError</a> <a id="17223" href="Utils.html#4263" class="InductiveConstructor">gasError</a><a id="17231" class="Symbol">)</a>
          <a id="17243" class="Symbol">(_</a> <a id="17246" href="Algorithmic.CK.html#1771" class="InductiveConstructor Operator">◅</a> <a id="17248" class="Symbol">_)</a> <a id="17251" class="Symbol">→</a> <a id="17253" href="Utils.html#937" class="InductiveConstructor">inj₁</a> <a id="17258" class="Symbol">(</a><a id="17259" href="Main.html#5545" class="InductiveConstructor">runtimeError</a> <a id="17272" href="Utils.html#4263" class="InductiveConstructor">gasError</a><a id="17280" class="Symbol">)</a>
          <a id="17292" href="Algorithmic.CK.html#1880" class="InductiveConstructor">◆</a> <a id="17294" href="Main.html#17294" class="Bound">A</a> <a id="17296" class="Symbol">→</a> <a id="17298" href="Utils.html#3293" class="Field">return</a> <a id="17305" class="Symbol">(</a><a id="17306" href="Main.html#2683" class="Postulate">unconvTm</a> <a id="17315" class="Symbol">(</a><a id="17316" href="Scoped.html#5468" class="Function">unshifter</a> <a id="17326" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="17328" class="Symbol">(</a><a id="17329" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="17344" class="Symbol">{</a><a id="17345" class="Number">0</a><a id="17346" class="Symbol">}{</a><a id="17348" href="Scoped.html#1963" class="InductiveConstructor">Z</a><a id="17349" class="Symbol">}</a> <a id="17351" class="Symbol">(</a><a id="17352" href="Scoped.html#6607" class="InductiveConstructor">error</a> <a id="17358" href="Scoped.html#1704" class="InductiveConstructor">missing</a><a id="17365" class="Symbol">))))</a> <a id="17370" class="Comment">-- NOTE: we could use the typechecker to get the correct type</a>
  <a id="17434" href="Utils.html#3293" class="Field">return</a> <a id="17441" class="Symbol">(</a><a id="17442" href="Main.html#2683" class="Postulate">unconvTm</a> <a id="17451" class="Symbol">(</a><a id="17452" href="Scoped.html#5468" class="Function">unshifter</a> <a id="17462" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="17464" class="Symbol">(</a><a id="17465" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="17480" class="Symbol">(</a><a id="17481" href="Scoped.Extrication.html#3921" class="Function">extricate</a> <a id="17491" class="Symbol">(</a><a id="17492" href="Algorithmic.CK.html#2656" class="Function">Algorithmic.CK.discharge</a> <a id="17517" href="Main.html#17118" class="Bound">V</a><a id="17518" class="Symbol">)))))</a>

<a id="17525" class="Symbol">{-#</a> <a id="17529" class="Keyword">COMPILE</a> <a id="17537" class="Keyword">GHC</a> <a id="17541" href="Main.html#16924" class="Function">runTCK</a> <a id="17548" class="Pragma">as</a> <a id="17551" class="Pragma">runTCKAgda</a> <a id="17562" class="Symbol">#-}</a>

<a id="17567" class="Comment">-- Haskell interface to (typechecked) CEKV</a>
<a id="runTCEK"></a><a id="17610" href="Main.html#17610" class="Function">runTCEK</a> <a id="17618" class="Symbol">:</a> <a id="17620" href="Main.html#2518" class="Postulate">Term</a> <a id="17625" class="Symbol">→</a> <a id="17627" href="Utils.html#904" class="Datatype">Either</a> <a id="17634" href="Main.html#5428" class="Datatype">ERROR</a> <a id="17640" href="Main.html#2518" class="Postulate">Term</a>
<a id="17645" href="Main.html#17610" class="Function">runTCEK</a> <a id="17653" href="Main.html#17653" class="Bound">t</a> <a id="17655" class="Symbol">=</a> <a id="17657" class="Keyword">do</a>
  <a id="17662" href="Main.html#17662" class="Bound">tDB</a> <a id="17666" href="Utils.html#3321" class="Field Operator">←</a> <a id="17668" href="Utils.html#4084" class="Function">withE</a> <a id="17674" href="Main.html#5511" class="InductiveConstructor">scopeError</a> <a id="17685" class="Symbol">(</a><a id="17686" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="17699" class="Symbol">{</a><a id="17700" class="Number">0</a><a id="17701" class="Symbol">}{</a><a id="17703" href="Scoped.html#1963" class="InductiveConstructor">Z</a><a id="17704" class="Symbol">}</a> <a id="17706" class="Symbol">(</a><a id="17707" href="Scoped.html#4478" class="Function">shifter</a> <a id="17715" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="17717" class="Symbol">(</a><a id="17718" href="Main.html#2609" class="Postulate">convTm</a> <a id="17725" href="Main.html#17653" class="Bound">t</a><a id="17726" class="Symbol">)))</a>
  <a id="17732" class="Symbol">_</a> <a id="17734" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="17737" href="Main.html#17737" class="Bound">tC</a> <a id="17740" href="Utils.html#3321" class="Field Operator">←</a> <a id="17742" href="Utils.html#4084" class="Function">withE</a> <a id="17748" class="Symbol">(λ</a> <a id="17751" href="Main.html#17751" class="Bound">e</a> <a id="17753" class="Symbol">→</a> <a id="17755" href="Main.html#5448" class="InductiveConstructor">typeError</a> <a id="17765" class="Symbol">(</a><a id="17766" href="Main.html#5583" class="Function">uglyTypeError</a> <a id="17780" href="Main.html#17751" class="Bound">e</a><a id="17781" class="Symbol">))</a> <a id="17784" class="Symbol">(</a><a id="17785" href="Check.html#10572" class="Function">inferType</a> <a id="17795" href="Algorithmic.html#1249" class="InductiveConstructor">∅</a> <a id="17797" href="Main.html#17662" class="Bound">tDB</a><a id="17800" class="Symbol">)</a>
  <a id="17804" href="Algorithmic.CEKV.html#8570" class="InductiveConstructor">□</a> <a id="17806" href="Main.html#17806" class="Bound">V</a> <a id="17808" href="Utils.html#3321" class="Field Operator">←</a> <a id="17810" href="Utils.html#4084" class="Function">withE</a> <a id="17816" href="Main.html#5545" class="InductiveConstructor">runtimeError</a> <a id="17829" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="17831" href="Algorithmic.CEKV.html#18832" class="Function">Algorithmic.CEKV.stepper</a> <a id="17856" href="Main.html#6795" class="Function">maxsteps</a> <a id="17865" class="Symbol">(</a><a id="17866" href="Algorithmic.CEKV.html#8334" class="InductiveConstructor">ε</a> <a id="17868" href="Algorithmic.CEKV.html#8448" class="InductiveConstructor Operator">;</a> <a id="17870" href="Algorithmic.CEKV.html#2762" class="InductiveConstructor">[]</a> <a id="17873" href="Algorithmic.CEKV.html#8448" class="InductiveConstructor Operator">▻</a> <a id="17875" href="Main.html#17737" class="Bound">tC</a><a id="17877" class="Symbol">)</a>
    <a id="17883" class="Keyword">where</a> <a id="17889" class="Symbol">(_</a> <a id="17892" href="Algorithmic.CEKV.html#8448" class="InductiveConstructor Operator">;</a> <a id="17894" class="Symbol">_</a> <a id="17896" href="Algorithmic.CEKV.html#8448" class="InductiveConstructor Operator">▻</a> <a id="17898" class="Symbol">_)</a> <a id="17901" class="Symbol">→</a> <a id="17903" href="Utils.html#937" class="InductiveConstructor">inj₁</a> <a id="17908" class="Symbol">(</a><a id="17909" href="Main.html#5545" class="InductiveConstructor">runtimeError</a> <a id="17922" href="Utils.html#4263" class="InductiveConstructor">gasError</a><a id="17930" class="Symbol">)</a>
          <a id="17942" class="Symbol">(_</a> <a id="17945" href="Algorithmic.CEKV.html#8515" class="InductiveConstructor Operator">◅</a> <a id="17947" class="Symbol">_)</a> <a id="17950" class="Symbol">→</a> <a id="17952" href="Utils.html#937" class="InductiveConstructor">inj₁</a> <a id="17957" class="Symbol">(</a><a id="17958" href="Main.html#5545" class="InductiveConstructor">runtimeError</a> <a id="17971" href="Utils.html#4263" class="InductiveConstructor">gasError</a><a id="17979" class="Symbol">)</a>
          <a id="17991" href="Algorithmic.CEKV.html#8598" class="InductiveConstructor">◆</a> <a id="17993" href="Main.html#17993" class="Bound">A</a> <a id="17995" class="Symbol">→</a> <a id="17997" href="Utils.html#3293" class="Field">return</a> <a id="18004" class="Symbol">(</a><a id="18005" href="Main.html#2683" class="Postulate">unconvTm</a> <a id="18014" class="Symbol">(</a><a id="18015" href="Scoped.html#5468" class="Function">unshifter</a> <a id="18025" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="18027" class="Symbol">(</a><a id="18028" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="18043" class="Symbol">{</a><a id="18044" class="Number">0</a><a id="18045" class="Symbol">}{</a><a id="18047" href="Scoped.html#1963" class="InductiveConstructor">Z</a><a id="18048" class="Symbol">}</a> <a id="18050" class="Symbol">(</a><a id="18051" href="Scoped.html#6607" class="InductiveConstructor">error</a> <a id="18057" href="Scoped.html#1704" class="InductiveConstructor">missing</a><a id="18064" class="Symbol">))))</a> <a id="18069" class="Comment">-- NOTE: we could use the typechecker to get the correct type</a>
  <a id="18133" href="Utils.html#3293" class="Field">return</a> <a id="18140" class="Symbol">(</a><a id="18141" href="Main.html#2683" class="Postulate">unconvTm</a> <a id="18150" class="Symbol">(</a><a id="18151" href="Scoped.html#5468" class="Function">unshifter</a> <a id="18161" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="18163" class="Symbol">(</a><a id="18164" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="18179" class="Symbol">(</a><a id="18180" href="Scoped.Extrication.html#3921" class="Function">extricate</a> <a id="18190" class="Symbol">(</a><a id="18191" href="Algorithmic.CEKV.html#3096" class="Function">Algorithmic.CEKV.discharge</a> <a id="18218" href="Main.html#17806" class="Bound">V</a><a id="18219" class="Symbol">)))))</a>

<a id="18226" class="Symbol">{-#</a> <a id="18230" class="Keyword">COMPILE</a> <a id="18238" class="Keyword">GHC</a> <a id="18242" href="Main.html#17610" class="Function">runTCEK</a> <a id="18250" class="Pragma">as</a> <a id="18253" class="Pragma">runTCEKAgda</a> <a id="18265" class="Symbol">#-}</a>
<a id="18269" class="Markup">\end{code}</a><a id="18279" class="Background">
</a></pre></body></html>