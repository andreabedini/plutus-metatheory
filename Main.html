<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Main</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Markup">\begin{code}</a>
<a id="14" class="Keyword">module</a> <a id="21" href="Main.html" class="Module">Main</a> <a id="26" class="Keyword">where</a>
<a id="32" class="Keyword">open</a> <a id="37" class="Keyword">import</a> <a id="44" href="Agda.Builtin.IO.html" class="Module">Agda.Builtin.IO</a>
<a id="60" class="Keyword">import</a> <a id="67" href="IO.Primitive.html" class="Module">IO.Primitive</a> <a id="80" class="Symbol">as</a> <a id="83" class="Module">IO</a> <a id="86" class="Keyword">using</a> <a id="92" class="Symbol">(</a><a id="93" href="IO.Primitive.html#610" class="Postulate">return</a><a id="99" class="Symbol">;</a><a id="100" href="IO.Primitive.html#650" class="Postulate Operator">_&gt;&gt;=_</a><a id="105" class="Symbol">)</a>
<a id="107" class="Keyword">open</a> <a id="112" class="Keyword">import</a> <a id="119" href="Agda.Builtin.Unit.html" class="Module">Agda.Builtin.Unit</a>
<a id="137" class="Keyword">open</a> <a id="142" class="Keyword">import</a> <a id="149" href="Agda.Builtin.String.html" class="Module">Agda.Builtin.String</a>
<a id="169" class="Keyword">open</a> <a id="174" class="Keyword">import</a> <a id="181" href="Function.html" class="Module">Function</a>
<a id="190" class="Keyword">open</a> <a id="195" class="Keyword">import</a> <a id="202" href="Data.Sum.html" class="Module">Data.Sum</a>
<a id="211" class="Keyword">open</a> <a id="216" class="Keyword">import</a> <a id="223" href="Data.String.html" class="Module">Data.String</a>
<a id="235" class="Keyword">open</a> <a id="240" class="Keyword">import</a> <a id="247" href="Agda.Builtin.TrustMe.html" class="Module">Agda.Builtin.TrustMe</a>
<a id="268" class="Keyword">open</a> <a id="273" class="Keyword">import</a> <a id="280" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>
<a id="318" class="Keyword">open</a> <a id="323" class="Keyword">import</a> <a id="330" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a>
<a id="347" class="Keyword">open</a> <a id="352" class="Keyword">import</a> <a id="359" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="368" class="Keyword">open</a> <a id="373" class="Keyword">import</a> <a id="380" href="Agda.Builtin.Int.html" class="Module">Agda.Builtin.Int</a>
<a id="397" class="Keyword">open</a> <a id="402" class="Keyword">import</a> <a id="409" href="Data.Integer.html" class="Module">Data.Integer</a>
<a id="422" class="Keyword">open</a> <a id="427" class="Keyword">import</a> <a id="434" href="Data.Product.html" class="Module">Data.Product</a> <a id="447" class="Keyword">renaming</a> <a id="456" class="Symbol">(</a><a id="457" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="461" class="Symbol">to</a> <a id="Builtin.Sigma._,_"></a><a id="464" href="Main.html#464" class="InductiveConstructor Operator">_,,_</a><a id="468" class="Symbol">)</a>
<a id="470" class="Keyword">open</a> <a id="475" class="Keyword">import</a> <a id="482" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="492" class="Keyword">open</a> <a id="497" class="Keyword">import</a> <a id="504" href="Data.Fin.html" class="Module">Data.Fin</a>
<a id="513" class="Keyword">open</a> <a id="518" class="Keyword">import</a> <a id="525" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="534" class="Keyword">hiding</a> <a id="541" class="Symbol">(</a><a id="542" href="Data.Vec.Base.html#4317" class="Function Operator">_&gt;&gt;=_</a><a id="547" class="Symbol">;</a><a id="548" href="Data.Vec.Base.html#2670" class="Function Operator">_++_</a><a id="552" class="Symbol">)</a>
<a id="554" class="Keyword">open</a> <a id="559" class="Keyword">import</a> <a id="566" href="Data.List.html" class="Module">Data.List</a> <a id="576" class="Keyword">hiding</a> <a id="583" class="Symbol">(</a><a id="584" href="Data.List.Base.html#1763" class="Function Operator">_++_</a><a id="588" class="Symbol">)</a>

<a id="591" class="Keyword">open</a> <a id="596" class="Keyword">import</a> <a id="603" href="Type.html" class="Module">Type</a>
<a id="608" class="Keyword">open</a> <a id="613" class="Keyword">import</a> <a id="620" href="Builtin.html" class="Module">Builtin</a> <a id="628" class="Keyword">hiding</a> <a id="635" class="Symbol">(</a><a id="636" href="Builtin.html#2558" class="Postulate">ByteString</a><a id="646" class="Symbol">)</a>
<a id="648" class="Keyword">open</a> <a id="653" class="Keyword">import</a> <a id="660" href="Check.html" class="Module">Check</a>
<a id="666" class="Keyword">open</a> <a id="671" class="Keyword">import</a> <a id="678" href="Scoped.Extrication.html" class="Module">Scoped.Extrication</a>
<a id="697" class="Keyword">open</a> <a id="702" class="Keyword">import</a> <a id="709" href="Type.BetaNBE.html" class="Module">Type.BetaNBE</a>
<a id="722" class="Keyword">open</a> <a id="727" class="Keyword">import</a> <a id="734" href="Type.BetaNormal.html" class="Module">Type.BetaNormal</a>
<a id="750" class="Keyword">open</a> <a id="755" class="Keyword">import</a> <a id="762" href="Untyped.html" class="Module">Untyped</a> <a id="770" class="Symbol">as</a> <a id="773" class="Module">U</a>
<a id="775" class="Keyword">import</a> <a id="782" href="Untyped.Reduction.html" class="Module">Untyped.Reduction</a> <a id="800" class="Symbol">as</a> <a id="803" class="Module">U</a>
<a id="805" class="Keyword">import</a> <a id="812" href="Scoped.html" class="Module">Scoped</a> <a id="819" class="Symbol">as</a> <a id="822" class="Module">S</a>
<a id="824" class="Keyword">import</a> <a id="831" href="Scoped.Reduction.html" class="Module">Scoped.Reduction</a> <a id="848" class="Symbol">as</a> <a id="851" class="Module">S</a>
<a id="853" class="Keyword">open</a> <a id="858" class="Keyword">import</a> <a id="865" href="Raw.html" class="Module">Raw</a>
<a id="869" class="Keyword">open</a> <a id="874" class="Keyword">import</a> <a id="881" href="Scoped.html" class="Module">Scoped</a>
<a id="888" class="Keyword">open</a> <a id="893" class="Keyword">import</a> <a id="900" href="Utils.html" class="Module">Utils</a>
<a id="906" class="Keyword">open</a> <a id="911" class="Keyword">import</a> <a id="918" href="Untyped.html" class="Module">Untyped</a>
<a id="926" class="Keyword">open</a> <a id="931" class="Keyword">import</a> <a id="938" href="Scoped.CK.html" class="Module">Scoped.CK</a>
<a id="948" class="Keyword">open</a> <a id="953" class="Keyword">import</a> <a id="960" href="Algorithmic.html" class="Module">Algorithmic</a>
<a id="972" class="Keyword">open</a> <a id="977" class="Keyword">import</a> <a id="984" href="Algorithmic.Reduction.html" class="Module">Algorithmic.Reduction</a>
<a id="1006" class="Keyword">open</a> <a id="1011" class="Keyword">import</a> <a id="1018" href="Algorithmic.CK.html" class="Module">Algorithmic.CK</a>
<a id="1033" class="Keyword">open</a> <a id="1038" class="Keyword">import</a> <a id="1045" href="Algorithmic.CEKV.html" class="Module">Algorithmic.CEKV</a>
<a id="1062" class="Keyword">open</a> <a id="1067" class="Keyword">import</a> <a id="1074" href="Scoped.Erasure.html" class="Module">Scoped.Erasure</a>


<a id="1091" class="Comment">-- There&#39;s a long prelude here that could go in a different file but</a>
<a id="1160" class="Comment">-- currently it&#39;s only used here</a>

<a id="1194" class="Comment">-- Text Stuff</a>

<a id="1209" class="Keyword">postulate</a>
  <a id="putStrLn"></a><a id="1221" href="Main.html#1221" class="Postulate">putStrLn</a> <a id="1230" class="Symbol">:</a> <a id="1232" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="1239" class="Symbol">→</a> <a id="1241" href="Agda.Builtin.IO.html#138" class="Postulate">IO</a> <a id="1244" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>

<a id="1247" class="Symbol">{-#</a> <a id="1251" class="Keyword">FOREIGN</a> <a id="1259" class="Pragma">GHC</a> <a id="1263" class="Pragma">import</a> <a id="1270" class="Pragma">qualified</a> <a id="1280" class="Pragma">Data.Text</a> <a id="1290" class="Pragma">as</a> <a id="1293" class="Pragma">T</a> <a id="1295" class="Symbol">#-}</a>
<a id="1299" class="Symbol">{-#</a> <a id="1303" class="Keyword">FOREIGN</a> <a id="1311" class="Pragma">GHC</a> <a id="1315" class="Pragma">import</a> <a id="1322" class="Pragma">qualified</a> <a id="1332" class="Pragma">Data.Text.IO</a> <a id="1345" class="Pragma">as</a> <a id="1348" class="Pragma">TextIO</a> <a id="1355" class="Symbol">#-}</a>
<a id="1359" class="Symbol">{-#</a> <a id="1363" class="Keyword">COMPILE</a> <a id="1371" class="Keyword">GHC</a> <a id="1375" href="Main.html#1221" class="Postulate">putStrLn</a> <a id="1384" class="Pragma">=</a> <a id="1386" class="Pragma">TextIO.putStrLn</a> <a id="1402" class="Symbol">#-}</a>

<a id="1407" class="Comment">-- IO Stuff</a>

<a id="1420" class="Keyword">instance</a>
  <a id="IOMonad"></a><a id="1431" href="Main.html#1431" class="Function">IOMonad</a> <a id="1439" class="Symbol">:</a> <a id="1441" href="Utils.html#3246" class="Record">Monad</a> <a id="1447" href="Agda.Builtin.IO.html#138" class="Postulate">IO</a>
  <a id="1452" href="Main.html#1431" class="Function">IOMonad</a> <a id="1460" class="Symbol">=</a> <a id="1462" class="Keyword">record</a> <a id="1469" class="Symbol">{</a> <a id="1471" href="Utils.html#3293" class="Field">return</a> <a id="1478" class="Symbol">=</a> <a id="1480" href="IO.Primitive.html#610" class="Postulate">IO.return</a><a id="1489" class="Symbol">;</a> <a id="1491" href="Utils.html#3321" class="Field Operator">_&gt;&gt;=_</a> <a id="1497" class="Symbol">=</a> <a id="1499" href="IO.Primitive.html#650" class="Postulate Operator">IO._&gt;&gt;=_</a> <a id="1508" class="Symbol">}</a>

<a id="1511" class="Comment">-- Bytestring stuff</a>

<a id="1532" class="Keyword">postulate</a>
  <a id="ByteString"></a><a id="1544" href="Main.html#1544" class="Postulate">ByteString</a> <a id="1555" class="Symbol">:</a> <a id="1557" class="PrimitiveType">Set</a>
  <a id="getContents"></a><a id="1563" href="Main.html#1563" class="Postulate">getContents</a> <a id="1575" class="Symbol">:</a> <a id="1577" href="Agda.Builtin.IO.html#138" class="Postulate">IO</a> <a id="1580" href="Main.html#1544" class="Postulate">ByteString</a>
  <a id="readFile"></a><a id="1593" href="Main.html#1593" class="Postulate">readFile</a> <a id="1602" class="Symbol">:</a> <a id="1604" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="1611" class="Symbol">→</a> <a id="1613" href="Agda.Builtin.IO.html#138" class="Postulate">IO</a> <a id="1616" href="Main.html#1544" class="Postulate">ByteString</a>

<a id="1628" class="Symbol">{-#</a> <a id="1632" class="Keyword">FOREIGN</a> <a id="1640" class="Pragma">GHC</a> <a id="1644" class="Pragma">import</a> <a id="1651" class="Pragma">qualified</a> <a id="1661" class="Pragma">Data.ByteString.Lazy</a> <a id="1682" class="Pragma">as</a> <a id="1685" class="Pragma">BSL</a> <a id="1689" class="Symbol">#-}</a>
<a id="1693" class="Symbol">{-#</a> <a id="1697" class="Keyword">COMPILE</a> <a id="1705" class="Keyword">GHC</a> <a id="1709" href="Main.html#1544" class="Postulate">ByteString</a> <a id="1720" class="Pragma">=</a> <a id="1722" class="Pragma">type</a> <a id="1727" class="Pragma">BSL.ByteString</a> <a id="1742" class="Symbol">#-}</a>
<a id="1746" class="Symbol">{-#</a> <a id="1750" class="Keyword">COMPILE</a> <a id="1758" class="Keyword">GHC</a> <a id="1762" href="Main.html#1593" class="Postulate">readFile</a> <a id="1771" class="Pragma">=</a> <a id="1773" class="Pragma">\</a> <a id="1775" class="Pragma">s</a> <a id="1777" class="Pragma">-&gt;</a> <a id="1780" class="Pragma">BSL.readFile</a> <a id="1793" class="Pragma">(T.unpack</a> <a id="1803" class="Pragma">s)</a> <a id="1806" class="Symbol">#-}</a>
<a id="1810" class="Symbol">{-#</a> <a id="1814" class="Keyword">COMPILE</a> <a id="1822" class="Keyword">GHC</a> <a id="1826" href="Main.html#1563" class="Postulate">getContents</a> <a id="1838" class="Pragma">=</a> <a id="1840" class="Pragma">BSL.getContents</a> <a id="1856" class="Symbol">#-}</a>

<a id="1861" class="Comment">-- System.Exit stuff</a>

<a id="1883" class="Keyword">postulate</a>
  <a id="exitFailure"></a><a id="1895" href="Main.html#1895" class="Postulate">exitFailure</a> <a id="1907" class="Symbol">:</a> <a id="1909" href="Agda.Builtin.IO.html#138" class="Postulate">IO</a> <a id="1912" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
  <a id="exitSuccess"></a><a id="1916" href="Main.html#1916" class="Postulate">exitSuccess</a> <a id="1928" class="Symbol">:</a> <a id="1930" href="Agda.Builtin.IO.html#138" class="Postulate">IO</a> <a id="1933" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>

<a id="1936" class="Symbol">{-#</a> <a id="1940" class="Keyword">FOREIGN</a> <a id="1948" class="Pragma">GHC</a> <a id="1952" class="Pragma">import</a> <a id="1959" class="Pragma">System.Exit</a> <a id="1971" class="Symbol">#-}</a>
<a id="1975" class="Symbol">{-#</a> <a id="1979" class="Keyword">COMPILE</a> <a id="1987" class="Keyword">GHC</a> <a id="1991" href="Main.html#1916" class="Postulate">exitSuccess</a> <a id="2003" class="Pragma">=</a> <a id="2005" class="Pragma">exitSuccess</a> <a id="2017" class="Symbol">#-}</a>
<a id="2021" class="Symbol">{-#</a> <a id="2025" class="Keyword">COMPILE</a> <a id="2033" class="Keyword">GHC</a> <a id="2037" href="Main.html#1895" class="Postulate">exitFailure</a> <a id="2049" class="Pragma">=</a> <a id="2051" class="Pragma">exitFailure</a> <a id="2063" class="Symbol">#-}</a>

<a id="2068" class="Comment">-- System.Environment stuff</a>

<a id="2097" class="Keyword">postulate</a>
  <a id="getArgs"></a><a id="2109" href="Main.html#2109" class="Postulate">getArgs</a> <a id="2117" class="Symbol">:</a> <a id="2119" href="Agda.Builtin.IO.html#138" class="Postulate">IO</a> <a id="2122" class="Symbol">(</a><a id="2123" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2128" href="Agda.Builtin.String.html#274" class="Postulate">String</a><a id="2134" class="Symbol">)</a>

<a id="2137" class="Symbol">{-#</a> <a id="2141" class="Keyword">FOREIGN</a> <a id="2149" class="Pragma">GHC</a> <a id="2153" class="Pragma">import</a> <a id="2160" class="Pragma">System.Environment</a> <a id="2179" class="Symbol">#-}</a>
<a id="2183" class="Symbol">{-#</a> <a id="2187" class="Keyword">COMPILE</a> <a id="2195" class="Keyword">GHC</a> <a id="2199" href="Main.html#2109" class="Postulate">getArgs</a> <a id="2207" class="Pragma">=</a> <a id="2209" class="Pragma">(fmap</a> <a id="2215" class="Pragma">.</a> <a id="2217" class="Pragma">fmap)</a> <a id="2223" class="Pragma">T.pack</a> <a id="2230" class="Pragma">$</a> <a id="2232" class="Pragma">getArgs</a> <a id="2240" class="Symbol">#-}</a>

<a id="2245" class="Comment">-- Misc stuff</a>

<a id="2260" class="Symbol">{-#</a> <a id="2264" class="Keyword">FOREIGN</a> <a id="2272" class="Pragma">GHC</a> <a id="2276" class="Pragma">import</a> <a id="2283" class="Pragma">Data.Either</a> <a id="2295" class="Symbol">#-}</a>
<a id="2299" class="Symbol">{-#</a> <a id="2303" class="Keyword">FOREIGN</a> <a id="2311" class="Pragma">GHC</a> <a id="2315" class="Pragma">import</a> <a id="2322" class="Pragma">Control.Monad.Trans.Except</a> <a id="2349" class="Symbol">#-}</a>

<a id="2354" class="Keyword">postulate</a>
  <a id="TermN"></a><a id="2366" href="Main.html#2366" class="Postulate">TermN</a> <a id="2372" class="Symbol">:</a> <a id="2374" class="PrimitiveType">Set</a> <a id="2378" class="Comment">-- term with names</a>
  <a id="Term"></a><a id="2399" href="Main.html#2399" class="Postulate">Term</a> <a id="2404" class="Symbol">:</a> <a id="2406" class="PrimitiveType">Set</a>  <a id="2411" class="Comment">-- DeBruijn term</a>
  <a id="TypeN"></a><a id="2430" href="Main.html#2430" class="Postulate">TypeN</a> <a id="2436" class="Symbol">:</a> <a id="2438" class="PrimitiveType">Set</a>
  <a id="Type"></a><a id="2444" href="Main.html#2444" class="Postulate">Type</a> <a id="2449" class="Symbol">:</a> <a id="2451" class="PrimitiveType">Set</a>
  <a id="ProgramN"></a><a id="2457" href="Main.html#2457" class="Postulate">ProgramN</a> <a id="2466" class="Symbol">:</a> <a id="2468" class="PrimitiveType">Set</a>
  <a id="Program"></a><a id="2474" href="Main.html#2474" class="Postulate">Program</a> <a id="2482" class="Symbol">:</a> <a id="2484" class="PrimitiveType">Set</a>
  <a id="convTm"></a><a id="2490" href="Main.html#2490" class="Postulate">convTm</a> <a id="2497" class="Symbol">:</a> <a id="2499" href="Main.html#2399" class="Postulate">Term</a> <a id="2504" class="Symbol">→</a> <a id="2506" href="Raw.html#1138" class="Datatype">RawTm</a>
  <a id="convTy"></a><a id="2514" href="Main.html#2514" class="Postulate">convTy</a> <a id="2521" class="Symbol">:</a> <a id="2523" href="Main.html#2444" class="Postulate">Type</a> <a id="2528" class="Symbol">→</a> <a id="2530" href="Raw.html#694" class="Datatype">RawTy</a>
  <a id="unconvTy"></a><a id="2538" href="Main.html#2538" class="Postulate">unconvTy</a> <a id="2547" class="Symbol">:</a> <a id="2549" href="Raw.html#694" class="Datatype">RawTy</a> <a id="2555" class="Symbol">→</a> <a id="2557" href="Main.html#2444" class="Postulate">Type</a>
  <a id="unconvTm"></a><a id="2564" href="Main.html#2564" class="Postulate">unconvTm</a> <a id="2573" class="Symbol">:</a> <a id="2575" href="Raw.html#1138" class="Datatype">RawTm</a> <a id="2581" class="Symbol">→</a> <a id="2583" href="Main.html#2399" class="Postulate">Term</a>
  <a id="convP"></a><a id="2590" href="Main.html#2590" class="Postulate">convP</a> <a id="2596" class="Symbol">:</a> <a id="2598" href="Main.html#2474" class="Postulate">Program</a> <a id="2606" class="Symbol">→</a> <a id="2608" href="Raw.html#1138" class="Datatype">RawTm</a>
  <a id="ParseError"></a><a id="2616" href="Main.html#2616" class="Postulate">ParseError</a> <a id="2627" class="Symbol">:</a> <a id="2629" class="PrimitiveType">Set</a>
  <a id="parse"></a><a id="2635" href="Main.html#2635" class="Postulate">parse</a> <a id="2641" class="Symbol">:</a> <a id="2643" href="Main.html#1544" class="Postulate">ByteString</a> <a id="2654" class="Symbol">→</a> <a id="2656" href="Utils.html#904" class="Datatype">Either</a> <a id="2663" href="Main.html#2616" class="Postulate">ParseError</a> <a id="2674" href="Main.html#2457" class="Postulate">ProgramN</a>
  <a id="parseTm"></a><a id="2685" href="Main.html#2685" class="Postulate">parseTm</a> <a id="2693" class="Symbol">:</a> <a id="2695" href="Main.html#1544" class="Postulate">ByteString</a> <a id="2706" class="Symbol">→</a> <a id="2708" href="Utils.html#904" class="Datatype">Either</a> <a id="2715" href="Main.html#2616" class="Postulate">ParseError</a> <a id="2726" href="Main.html#2366" class="Postulate">TermN</a>
  <a id="parseTy"></a><a id="2734" href="Main.html#2734" class="Postulate">parseTy</a> <a id="2742" class="Symbol">:</a> <a id="2744" href="Main.html#1544" class="Postulate">ByteString</a> <a id="2755" class="Symbol">→</a> <a id="2757" href="Utils.html#904" class="Datatype">Either</a> <a id="2764" href="Main.html#2616" class="Postulate">ParseError</a> <a id="2775" href="Main.html#2430" class="Postulate">TypeN</a>
  <a id="showTerm"></a><a id="2783" href="Main.html#2783" class="Postulate">showTerm</a> <a id="2792" class="Symbol">:</a> <a id="2794" href="Raw.html#1138" class="Datatype">RawTm</a> <a id="2800" class="Symbol">→</a> <a id="2802" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
  <a id="deBruijnify"></a><a id="2811" href="Main.html#2811" class="Postulate">deBruijnify</a> <a id="2823" class="Symbol">:</a> <a id="2825" href="Main.html#2457" class="Postulate">ProgramN</a> <a id="2834" class="Symbol">→</a> <a id="2836" href="Utils.html#904" class="Datatype">Either</a> <a id="2843" href="Scoped.html#7345" class="Postulate">FreeVariableError</a> <a id="2861" href="Main.html#2474" class="Postulate">Program</a>
  <a id="deBruijnifyTm"></a><a id="2871" href="Main.html#2871" class="Postulate">deBruijnifyTm</a> <a id="2885" class="Symbol">:</a> <a id="2887" href="Main.html#2366" class="Postulate">TermN</a> <a id="2893" class="Symbol">→</a> <a id="2895" href="Utils.html#486" class="Datatype">Maybe</a> <a id="2901" href="Main.html#2399" class="Postulate">Term</a>
  <a id="deBruijnifyTy"></a><a id="2908" href="Main.html#2908" class="Postulate">deBruijnifyTy</a> <a id="2922" class="Symbol">:</a> <a id="2924" href="Main.html#2430" class="Postulate">TypeN</a> <a id="2930" class="Symbol">→</a> <a id="2932" href="Utils.html#486" class="Datatype">Maybe</a> <a id="2938" href="Main.html#2444" class="Postulate">Type</a>

<a id="2944" class="Symbol">{-#</a> <a id="2948" class="Keyword">FOREIGN</a> <a id="2956" class="Pragma">GHC</a> <a id="2960" class="Pragma">import</a> <a id="2967" class="Pragma">Language.PlutusCore.Name</a> <a id="2992" class="Symbol">#-}</a>
<a id="2996" class="Symbol">{-#</a> <a id="3000" class="Keyword">FOREIGN</a> <a id="3008" class="Pragma">GHC</a> <a id="3012" class="Pragma">import</a> <a id="3019" class="Pragma">Language.PlutusCore.Lexer</a> <a id="3045" class="Symbol">#-}</a>
<a id="3049" class="Symbol">{-#</a> <a id="3053" class="Keyword">FOREIGN</a> <a id="3061" class="Pragma">GHC</a> <a id="3065" class="Pragma">import</a> <a id="3072" class="Pragma">Language.PlutusCore.Parser</a> <a id="3099" class="Symbol">#-}</a>
<a id="3103" class="Symbol">{-#</a> <a id="3107" class="Keyword">FOREIGN</a> <a id="3115" class="Pragma">GHC</a> <a id="3119" class="Pragma">import</a> <a id="3126" class="Pragma">Language.PlutusCore.Pretty</a> <a id="3153" class="Symbol">#-}</a>
<a id="3157" class="Symbol">{-#</a> <a id="3161" class="Keyword">FOREIGN</a> <a id="3169" class="Pragma">GHC</a> <a id="3173" class="Pragma">import</a> <a id="3180" class="Pragma">Language.PlutusCore.DeBruijn</a> <a id="3209" class="Symbol">#-}</a>
<a id="3213" class="Symbol">{-#</a> <a id="3217" class="Keyword">FOREIGN</a> <a id="3225" class="Pragma">GHC</a> <a id="3229" class="Pragma">import</a> <a id="3236" class="Pragma">Raw</a> <a id="3240" class="Symbol">#-}</a>
<a id="3244" class="Symbol">{-#</a> <a id="3248" class="Keyword">COMPILE</a> <a id="3256" class="Keyword">GHC</a> <a id="3260" href="Main.html#2590" class="Postulate">convP</a> <a id="3266" class="Pragma">=</a> <a id="3268" class="Pragma">convP</a> <a id="3274" class="Symbol">#-}</a>
<a id="3278" class="Symbol">{-#</a> <a id="3282" class="Keyword">COMPILE</a> <a id="3290" class="Keyword">GHC</a> <a id="3294" href="Main.html#2490" class="Postulate">convTm</a> <a id="3301" class="Pragma">=</a> <a id="3303" class="Pragma">conv</a> <a id="3308" class="Symbol">#-}</a>
<a id="3312" class="Symbol">{-#</a> <a id="3316" class="Keyword">COMPILE</a> <a id="3324" class="Keyword">GHC</a> <a id="3328" href="Main.html#2514" class="Postulate">convTy</a> <a id="3335" class="Pragma">=</a> <a id="3337" class="Pragma">convT</a> <a id="3343" class="Symbol">#-}</a>
<a id="3347" class="Symbol">{-#</a> <a id="3351" class="Keyword">COMPILE</a> <a id="3359" class="Keyword">GHC</a> <a id="3363" href="Main.html#2538" class="Postulate">unconvTy</a> <a id="3372" class="Pragma">=</a> <a id="3374" class="Pragma">unconvT</a> <a id="3382" class="Pragma">0</a> <a id="3384" class="Symbol">#-}</a>
<a id="3388" class="Symbol">{-#</a> <a id="3392" class="Keyword">COMPILE</a> <a id="3400" class="Keyword">GHC</a> <a id="3404" href="Main.html#2564" class="Postulate">unconvTm</a> <a id="3413" class="Pragma">=</a> <a id="3415" class="Pragma">unconv</a> <a id="3422" class="Pragma">0</a> <a id="3424" class="Symbol">#-}</a>
<a id="3428" class="Symbol">{-#</a> <a id="3432" class="Keyword">FOREIGN</a> <a id="3440" class="Pragma">GHC</a> <a id="3444" class="Pragma">import</a> <a id="3451" class="Pragma">Data.Bifunctor</a> <a id="3466" class="Symbol">#-}</a>

<a id="3471" class="Symbol">{-#</a> <a id="3475" class="Keyword">COMPILE</a> <a id="3483" class="Keyword">GHC</a> <a id="3487" href="Main.html#2616" class="Postulate">ParseError</a> <a id="3498" class="Pragma">=</a> <a id="3500" class="Pragma">type</a> <a id="3505" class="Pragma">ParseError</a> <a id="3516" class="Pragma">()</a> <a id="3519" class="Symbol">#-}</a>
<a id="3523" class="Symbol">{-#</a> <a id="3527" class="Keyword">COMPILE</a> <a id="3535" class="Keyword">GHC</a> <a id="3539" href="Main.html#2635" class="Postulate">parse</a> <a id="3545" class="Pragma">=</a> <a id="3547" class="Pragma">first</a> <a id="3553" class="Pragma">(()</a> <a id="3557" class="Pragma">&lt;$)</a> <a id="3561" class="Pragma">.</a> <a id="3563" class="Pragma">runQuote</a> <a id="3572" class="Pragma">.</a> <a id="3574" class="Pragma">runExceptT</a> <a id="3585" class="Pragma">.</a> <a id="3587" class="Pragma">parseProgram</a>  <a id="3601" class="Symbol">#-}</a>
<a id="3605" class="Symbol">{-#</a> <a id="3609" class="Keyword">COMPILE</a> <a id="3617" class="Keyword">GHC</a> <a id="3621" href="Main.html#2685" class="Postulate">parseTm</a> <a id="3629" class="Pragma">=</a> <a id="3631" class="Pragma">first</a> <a id="3637" class="Pragma">(()</a> <a id="3641" class="Pragma">&lt;$)</a> <a id="3645" class="Pragma">.</a> <a id="3647" class="Pragma">runQuote.</a> <a id="3657" class="Pragma">runExceptT</a> <a id="3668" class="Pragma">.</a> <a id="3670" class="Pragma">parseTerm</a>  <a id="3681" class="Symbol">#-}</a>
<a id="3685" class="Symbol">{-#</a> <a id="3689" class="Keyword">COMPILE</a> <a id="3697" class="Keyword">GHC</a> <a id="3701" href="Main.html#2734" class="Postulate">parseTy</a> <a id="3709" class="Pragma">=</a> <a id="3711" class="Pragma">first</a> <a id="3717" class="Pragma">(()</a> <a id="3721" class="Pragma">&lt;$)</a> <a id="3725" class="Pragma">.</a> <a id="3727" class="Pragma">runQuote</a> <a id="3736" class="Pragma">.</a> <a id="3738" class="Pragma">runExceptT</a> <a id="3749" class="Pragma">.</a> <a id="3751" class="Pragma">parseType</a>  <a id="3762" class="Symbol">#-}</a>
<a id="3766" class="Symbol">{-#</a> <a id="3770" class="Keyword">COMPILE</a> <a id="3778" class="Keyword">GHC</a> <a id="3782" href="Main.html#2811" class="Postulate">deBruijnify</a> <a id="3794" class="Pragma">=</a> <a id="3796" class="Pragma">second</a> <a id="3803" class="Pragma">(()</a> <a id="3807" class="Pragma">&lt;$)</a> <a id="3811" class="Pragma">.</a> <a id="3813" class="Pragma">runExcept</a> <a id="3823" class="Pragma">.</a> <a id="3825" class="Pragma">deBruijnProgram</a> <a id="3841" class="Symbol">#-}</a>
<a id="3845" class="Symbol">{-#</a> <a id="3849" class="Keyword">COMPILE</a> <a id="3857" class="Keyword">GHC</a> <a id="3861" href="Main.html#2871" class="Postulate">deBruijnifyTm</a> <a id="3875" class="Pragma">=</a> <a id="3877" class="Pragma">either</a> <a id="3884" class="Pragma">(\_</a> <a id="3888" class="Pragma">-&gt;</a> <a id="3891" class="Pragma">Nothing)</a> <a id="3900" class="Pragma">Just</a> <a id="3905" class="Pragma">.</a> <a id="3907" class="Pragma">runExcept</a> <a id="3917" class="Pragma">.</a> <a id="3919" class="Pragma">deBruijnTerm</a> <a id="3932" class="Pragma">.</a> <a id="3934" class="Pragma">(()</a> <a id="3938" class="Pragma">&lt;$)</a> <a id="3942" class="Symbol">#-}</a>
<a id="3946" class="Symbol">{-#</a> <a id="3950" class="Keyword">COMPILE</a> <a id="3958" class="Keyword">GHC</a> <a id="3962" href="Main.html#2908" class="Postulate">deBruijnifyTy</a> <a id="3976" class="Pragma">=</a> <a id="3978" class="Pragma">either</a> <a id="3985" class="Pragma">(\_</a> <a id="3989" class="Pragma">-&gt;</a> <a id="3992" class="Pragma">Nothing)</a> <a id="4001" class="Pragma">Just</a> <a id="4006" class="Pragma">.</a> <a id="4008" class="Pragma">runExcept</a> <a id="4018" class="Pragma">.</a> <a id="4020" class="Pragma">deBruijnTy</a> <a id="4031" class="Pragma">.</a> <a id="4033" class="Pragma">(()</a> <a id="4037" class="Pragma">&lt;$)</a> <a id="4041" class="Symbol">#-}</a>
<a id="4045" class="Symbol">{-#</a> <a id="4049" class="Keyword">FOREIGN</a> <a id="4057" class="Pragma">GHC</a> <a id="4061" class="Pragma">import</a> <a id="4068" class="Pragma">Language.PlutusCore</a> <a id="4088" class="Symbol">#-}</a>
<a id="4092" class="Symbol">{-#</a> <a id="4096" class="Keyword">COMPILE</a> <a id="4104" class="Keyword">GHC</a> <a id="4108" href="Main.html#2457" class="Postulate">ProgramN</a> <a id="4117" class="Pragma">=</a> <a id="4119" class="Pragma">type</a> <a id="4124" class="Pragma">Language.PlutusCore.Program</a> <a id="4152" class="Pragma">TyName</a> <a id="4159" class="Pragma">Name</a> <a id="4164" class="Pragma">DefaultUni</a> <a id="4175" class="Pragma">DefaultFun</a> <a id="4186" class="Pragma">Language.PlutusCore.Lexer.AlexPosn</a> <a id="4221" class="Symbol">#-}</a>
<a id="4225" class="Symbol">{-#</a> <a id="4229" class="Keyword">COMPILE</a> <a id="4237" class="Keyword">GHC</a> <a id="4241" href="Main.html#2474" class="Postulate">Program</a> <a id="4249" class="Pragma">=</a> <a id="4251" class="Pragma">type</a> <a id="4256" class="Pragma">Language.PlutusCore.Program</a> <a id="4284" class="Pragma">NamedTyDeBruijn</a> <a id="4300" class="Pragma">NamedDeBruijn</a> <a id="4314" class="Pragma">DefaultUni</a> <a id="4325" class="Pragma">DefaultFun</a> <a id="4336" class="Pragma">()</a> <a id="4339" class="Symbol">#-}</a>
<a id="4343" class="Symbol">{-#</a> <a id="4347" class="Keyword">COMPILE</a> <a id="4355" class="Keyword">GHC</a> <a id="4359" href="Main.html#2366" class="Postulate">TermN</a> <a id="4365" class="Pragma">=</a> <a id="4367" class="Pragma">type</a> <a id="4372" class="Pragma">Language.PlutusCore.Term</a> <a id="4397" class="Pragma">TyName</a> <a id="4404" class="Pragma">Name</a> <a id="4409" class="Pragma">DefaultUni</a> <a id="4420" class="Pragma">DefaultFun</a> <a id="4431" class="Pragma">Language.PlutusCore.Lexer.AlexPosn</a> <a id="4466" class="Symbol">#-}</a>
<a id="4470" class="Symbol">{-#</a> <a id="4474" class="Keyword">COMPILE</a> <a id="4482" class="Keyword">GHC</a> <a id="4486" href="Main.html#2399" class="Postulate">Term</a> <a id="4491" class="Pragma">=</a> <a id="4493" class="Pragma">type</a> <a id="4498" class="Pragma">Language.PlutusCore.Term</a> <a id="4523" class="Pragma">NamedTyDeBruijn</a> <a id="4539" class="Pragma">NamedDeBruijn</a> <a id="4553" class="Pragma">DefaultUni</a> <a id="4564" class="Pragma">DefaultFun</a> <a id="4575" class="Pragma">()</a> <a id="4578" class="Symbol">#-}</a>
<a id="4582" class="Symbol">{-#</a> <a id="4586" class="Keyword">COMPILE</a> <a id="4594" class="Keyword">GHC</a> <a id="4598" href="Main.html#2430" class="Postulate">TypeN</a> <a id="4604" class="Pragma">=</a> <a id="4606" class="Pragma">type</a> <a id="4611" class="Pragma">Language.PlutusCore.Type</a> <a id="4636" class="Pragma">TyName</a> <a id="4643" class="Pragma">DefaultUni</a> <a id="4654" class="Pragma">Language.PlutusCore.Lexer.AlexPosn</a> <a id="4689" class="Symbol">#-}</a>
<a id="4693" class="Symbol">{-#</a> <a id="4697" class="Keyword">COMPILE</a> <a id="4705" class="Keyword">GHC</a> <a id="4709" href="Main.html#2444" class="Postulate">Type</a> <a id="4714" class="Pragma">=</a> <a id="4716" class="Pragma">type</a> <a id="4721" class="Pragma">Language.PlutusCore.Type</a> <a id="4746" class="Pragma">NamedTyDeBruijn</a> <a id="4762" class="Pragma">DefaultUni</a> <a id="4773" class="Pragma">()</a> <a id="4776" class="Symbol">#-}</a>

<a id="4781" class="Symbol">{-#</a> <a id="4785" class="Keyword">COMPILE</a> <a id="4793" class="Keyword">GHC</a> <a id="4797" href="Main.html#2783" class="Postulate">showTerm</a> <a id="4806" class="Pragma">=</a> <a id="4808" class="Pragma">T.pack</a> <a id="4815" class="Pragma">.</a> <a id="4817" class="Pragma">show</a> <a id="4822" class="Symbol">#-}</a>

<a id="4827" class="Keyword">postulate</a>
  <a id="prettyPrintTm"></a><a id="4839" href="Main.html#4839" class="Postulate">prettyPrintTm</a> <a id="4853" class="Symbol">:</a> <a id="4855" href="Raw.html#1138" class="Datatype">RawTm</a> <a id="4861" class="Symbol">→</a> <a id="4863" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
  <a id="prettyPrintTy"></a><a id="4872" href="Main.html#4872" class="Postulate">prettyPrintTy</a> <a id="4886" class="Symbol">:</a> <a id="4888" href="Raw.html#694" class="Datatype">RawTy</a> <a id="4894" class="Symbol">→</a> <a id="4896" href="Agda.Builtin.String.html#274" class="Postulate">String</a>

<a id="4904" class="Symbol">{-#</a> <a id="4908" class="Keyword">FOREIGN</a> <a id="4916" class="Pragma">GHC</a> <a id="4920" class="Symbol">{-#</a> <a id="4924" class="Pragma">LANGUAGE</a> <a id="4933" class="Pragma">TypeApplications</a> <a id="4950" class="Symbol">#-}</a> <a id="4954" class="Symbol">#-}</a>
<a id="4958" class="Symbol">{-#</a> <a id="4962" class="Keyword">COMPILE</a> <a id="4970" class="Keyword">GHC</a> <a id="4974" href="Main.html#4839" class="Postulate">prettyPrintTm</a> <a id="4988" class="Pragma">=</a> <a id="4990" class="Pragma">display</a> <a id="4998" class="Pragma">@T.Text</a> <a id="5006" class="Pragma">.</a> <a id="5008" class="Pragma">unconv</a> <a id="5015" class="Pragma">0</a> <a id="5017" class="Symbol">#-}</a>
<a id="5021" class="Symbol">{-#</a> <a id="5025" class="Keyword">COMPILE</a> <a id="5033" class="Keyword">GHC</a> <a id="5037" href="Main.html#4872" class="Postulate">prettyPrintTy</a> <a id="5051" class="Pragma">=</a> <a id="5053" class="Pragma">display</a> <a id="5061" class="Pragma">@T.Text</a> <a id="5069" class="Pragma">.</a> <a id="5071" class="Pragma">unconvT</a> <a id="5079" class="Pragma">0</a> <a id="5081" class="Symbol">#-}</a>

<a id="5086" class="Keyword">data</a> <a id="EvalMode"></a><a id="5091" href="Main.html#5091" class="Datatype">EvalMode</a> <a id="5100" class="Symbol">:</a> <a id="5102" class="PrimitiveType">Set</a> <a id="5106" class="Keyword">where</a>
  <a id="EvalMode.U"></a><a id="5114" href="Main.html#5114" class="InductiveConstructor">U</a> <a id="EvalMode.TL"></a><a id="5116" href="Main.html#5116" class="InductiveConstructor">TL</a> <a id="EvalMode.L"></a><a id="5119" href="Main.html#5119" class="InductiveConstructor">L</a> <a id="EvalMode.TCK"></a><a id="5121" href="Main.html#5121" class="InductiveConstructor">TCK</a> <a id="EvalMode.CK"></a><a id="5125" href="Main.html#5125" class="InductiveConstructor">CK</a> <a id="EvalMode.TCEK"></a><a id="5128" href="Main.html#5128" class="InductiveConstructor">TCEK</a> <a id="5133" class="Symbol">:</a> <a id="5135" href="Main.html#5091" class="Datatype">EvalMode</a>

<a id="5145" class="Symbol">{-#</a> <a id="5149" class="Keyword">COMPILE</a> <a id="5157" class="Keyword">GHC</a> <a id="5161" href="Main.html#5091" class="Datatype">EvalMode</a> <a id="5170" class="Pragma">=</a> <a id="5172" class="Pragma">data</a> <a id="5177" class="Pragma">EvalMode</a> <a id="5186" class="Pragma">(U</a> <a id="5189" class="Pragma">|</a> <a id="5191" class="Pragma">TL</a> <a id="5194" class="Pragma">|</a> <a id="5196" class="Pragma">L</a> <a id="5198" class="Pragma">|</a> <a id="5200" class="Pragma">TCK</a> <a id="5204" class="Pragma">|</a> <a id="5206" class="Pragma">CK</a> <a id="5209" class="Pragma">|</a> <a id="5211" class="Pragma">TCEK)</a> <a id="5217" class="Symbol">#-}</a>

<a id="5222" class="Comment">-- the Error&#39;s returned by `plc-agda` and the haskell interface to `metatheory`.</a>

<a id="5304" class="Keyword">data</a> <a id="ERROR"></a><a id="5309" href="Main.html#5309" class="Datatype">ERROR</a> <a id="5315" class="Symbol">:</a> <a id="5317" class="PrimitiveType">Set</a> <a id="5321" class="Keyword">where</a>
  <a id="ERROR.typeError"></a><a id="5329" href="Main.html#5329" class="InductiveConstructor">typeError</a> <a id="5339" class="Symbol">:</a> <a id="5341" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="5348" class="Symbol">→</a> <a id="5350" href="Main.html#5309" class="Datatype">ERROR</a>
  <a id="ERROR.parseError"></a><a id="5358" href="Main.html#5358" class="InductiveConstructor">parseError</a> <a id="5369" class="Symbol">:</a> <a id="5371" href="Main.html#2616" class="Postulate">ParseError</a> <a id="5382" class="Symbol">→</a> <a id="5384" href="Main.html#5309" class="Datatype">ERROR</a>
  <a id="ERROR.scopeError"></a><a id="5392" href="Main.html#5392" class="InductiveConstructor">scopeError</a> <a id="5403" class="Symbol">:</a> <a id="5405" href="Scoped.html#7440" class="Datatype">ScopeError</a> <a id="5416" class="Symbol">→</a> <a id="5418" href="Main.html#5309" class="Datatype">ERROR</a>
  <a id="ERROR.runtimeError"></a><a id="5426" href="Main.html#5426" class="InductiveConstructor">runtimeError</a> <a id="5439" class="Symbol">:</a> <a id="5441" href="Utils.html#4236" class="Datatype">RuntimeError</a> <a id="5454" class="Symbol">→</a> <a id="5456" href="Main.html#5309" class="Datatype">ERROR</a>


<a id="uglyTypeError"></a><a id="5464" href="Main.html#5464" class="Function">uglyTypeError</a> <a id="5478" class="Symbol">:</a> <a id="5480" href="Check.html#1105" class="Datatype">TypeError</a> <a id="5490" class="Symbol">→</a> <a id="5492" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="5499" href="Main.html#5464" class="Function">uglyTypeError</a> <a id="5513" class="Symbol">(</a><a id="5514" href="Check.html#1129" class="InductiveConstructor">kindMismatch</a> <a id="5527" href="Main.html#5527" class="Bound">K</a> <a id="5529" href="Main.html#5529" class="Bound">K&#39;</a> <a id="5532" href="Main.html#5532" class="Bound">x</a><a id="5533" class="Symbol">)</a> <a id="5535" class="Symbol">=</a> <a id="5537" class="String">&quot;kindMismatch&quot;</a>
<a id="5552" href="Main.html#5464" class="Function">uglyTypeError</a> <a id="5566" class="Symbol">(</a><a id="5567" href="Check.html#1185" class="InductiveConstructor">notStar</a> <a id="5575" href="Main.html#5575" class="Bound">K</a> <a id="5577" href="Main.html#5577" class="Bound">x</a><a id="5578" class="Symbol">)</a> <a id="5580" class="Symbol">=</a> <a id="5582" class="String">&quot;notStar&quot;</a>
<a id="5592" href="Main.html#5464" class="Function">uglyTypeError</a> <a id="5606" class="Symbol">(</a><a id="5607" href="Check.html#1232" class="InductiveConstructor">notFunKind</a> <a id="5618" href="Main.html#5618" class="Bound">K</a> <a id="5620" href="Main.html#5620" class="Bound">x</a><a id="5621" class="Symbol">)</a> <a id="5623" class="Symbol">=</a> <a id="5625" class="String">&quot;NotFunKind&quot;</a>
<a id="5638" href="Main.html#5464" class="Function">uglyTypeError</a> <a id="5652" class="Symbol">(</a><a id="5653" href="Check.html#1299" class="InductiveConstructor">notPat</a> <a id="5660" href="Main.html#5660" class="Bound">K</a> <a id="5662" href="Main.html#5662" class="Bound">x</a><a id="5663" class="Symbol">)</a> <a id="5665" class="Symbol">=</a> <a id="5667" class="String">&quot;notPat&quot;</a>
<a id="5676" href="Main.html#5464" class="Function">uglyTypeError</a> <a id="5690" href="Check.html#1373" class="InductiveConstructor">UnknownType</a> <a id="5702" class="Symbol">=</a> <a id="5704" class="String">&quot;UnknownType&quot;</a>
<a id="5718" href="Main.html#5464" class="Function">uglyTypeError</a> <a id="5732" class="Symbol">(</a><a id="5733" href="Check.html#1399" class="InductiveConstructor">notPi</a> <a id="5739" href="Main.html#5739" class="Bound">A</a> <a id="5741" href="Main.html#5741" class="Bound">x</a><a id="5742" class="Symbol">)</a> <a id="5744" class="Symbol">=</a> <a id="5746" class="String">&quot;notPi&quot;</a>
<a id="5754" href="Main.html#5464" class="Function">uglyTypeError</a> <a id="5768" class="Symbol">(</a><a id="5769" href="Check.html#1489" class="InductiveConstructor">notMu</a> <a id="5775" href="Main.html#5775" class="Bound">A</a> <a id="5777" href="Main.html#5777" class="Bound">x</a><a id="5778" class="Symbol">)</a> <a id="5780" class="Symbol">=</a> <a id="5782" class="String">&quot;notMu&quot;</a>
<a id="5790" href="Main.html#5464" class="Function">uglyTypeError</a> <a id="5804" class="Symbol">(</a><a id="5805" href="Check.html#1589" class="InductiveConstructor">notFunType</a> <a id="5816" href="Main.html#5816" class="Bound">A</a> <a id="5818" href="Main.html#5818" class="Bound">x</a><a id="5819" class="Symbol">)</a> <a id="5821" class="Symbol">=</a> <a id="5823" class="String">&quot;notFunType&quot;</a>
<a id="5836" href="Main.html#5464" class="Function">uglyTypeError</a> <a id="5850" class="Symbol">(</a><a id="5851" href="Check.html#1674" class="InductiveConstructor">typeMismatch</a> <a id="5864" href="Main.html#5864" class="Bound">A</a> <a id="5866" href="Main.html#5866" class="Bound">A&#39;</a> <a id="5869" href="Main.html#5869" class="Bound">x</a><a id="5870" class="Symbol">)</a> <a id="5872" class="Symbol">=</a>
  <a id="5876" href="Main.html#4872" class="Postulate">prettyPrintTy</a> <a id="5890" class="Symbol">(</a><a id="5891" href="Scoped.html#10165" class="Function">extricateScopeTy</a> <a id="5908" class="Symbol">(</a><a id="5909" href="Scoped.Extrication.html#876" class="Function">extricateNf⋆</a> <a id="5922" href="Main.html#5864" class="Bound">A</a><a id="5923" class="Symbol">))</a>
  <a id="5928" href="Data.String.Base.html#2077" class="Function Operator">++</a>
  <a id="5933" class="String">&quot; doesn&#39;t match &quot;</a>
  <a id="5953" href="Data.String.Base.html#2077" class="Function Operator">++</a>
  <a id="5958" href="Main.html#4872" class="Postulate">prettyPrintTy</a> <a id="5972" class="Symbol">(</a><a id="5973" href="Scoped.html#10165" class="Function">extricateScopeTy</a> <a id="5990" class="Symbol">(</a><a id="5991" href="Scoped.Extrication.html#876" class="Function">extricateNf⋆</a> <a id="6004" href="Main.html#5866" class="Bound">A&#39;</a><a id="6006" class="Symbol">))</a>
<a id="6009" href="Main.html#5464" class="Function">uglyTypeError</a> <a id="6023" href="Check.html#1740" class="InductiveConstructor">builtinError</a> <a id="6036" class="Symbol">=</a> <a id="6038" class="String">&quot;builtinError&quot;</a>

<a id="6054" class="Comment">-- the haskell version of Error is defined in Raw</a>
<a id="6104" class="Symbol">{-#</a> <a id="6108" class="Keyword">FOREIGN</a> <a id="6116" class="Pragma">GHC</a> <a id="6120" class="Pragma">import</a> <a id="6127" class="Pragma">Raw</a> <a id="6131" class="Symbol">#-}</a>

<a id="6136" class="Symbol">{-#</a> <a id="6140" class="Keyword">COMPILE</a> <a id="6148" class="Keyword">GHC</a> <a id="6152" href="Main.html#5309" class="Datatype">ERROR</a> <a id="6158" class="Pragma">=</a> <a id="6160" class="Pragma">data</a> <a id="6165" class="Pragma">ERROR</a> <a id="6171" class="Pragma">(TypeError</a> <a id="6182" class="Pragma">|</a> <a id="6184" class="Pragma">ParseError</a> <a id="6195" class="Pragma">|</a> <a id="6197" class="Pragma">ScopeError</a> <a id="6208" class="Pragma">|</a> <a id="6210" class="Pragma">RuntimeError)</a> <a id="6224" class="Symbol">#-}</a>


<a id="parsePLC"></a><a id="6230" href="Main.html#6230" class="Function">parsePLC</a> <a id="6239" class="Symbol">:</a> <a id="6241" href="Main.html#1544" class="Postulate">ByteString</a> <a id="6252" class="Symbol">→</a> <a id="6254" href="Utils.html#904" class="Datatype">Either</a> <a id="6261" href="Main.html#5309" class="Datatype">ERROR</a> <a id="6267" class="Symbol">(</a><a id="6268" href="Scoped.html#6299" class="Datatype">ScopedTm</a> <a id="6277" href="Scoped.html#1963" class="InductiveConstructor">Z</a><a id="6278" class="Symbol">)</a>
<a id="6280" href="Main.html#6230" class="Function">parsePLC</a> <a id="6289" href="Main.html#6289" class="Bound">plc</a> <a id="6293" class="Symbol">=</a> <a id="6295" class="Keyword">do</a>
  <a id="6300" href="Main.html#6300" class="Bound">namedprog</a> <a id="6310" href="Utils.html#3321" class="Field Operator">←</a> <a id="6312" href="Utils.html#4084" class="Function">withE</a> <a id="6318" href="Main.html#5358" class="InductiveConstructor">parseError</a> <a id="6329" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="6331" href="Main.html#2635" class="Postulate">parse</a> <a id="6337" href="Main.html#6289" class="Bound">plc</a>
  <a id="6343" href="Main.html#6343" class="Bound">prog</a> <a id="6348" href="Utils.html#3321" class="Field Operator">←</a> <a id="6350" href="Utils.html#4084" class="Function">withE</a> <a id="6356" class="Symbol">(</a><a id="6357" href="Main.html#5392" class="InductiveConstructor">ERROR.scopeError</a> <a id="6374" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="6376" href="Scoped.html#7489" class="InductiveConstructor">freeVariableError</a><a id="6393" class="Symbol">)</a> <a id="6395" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="6397" href="Main.html#2811" class="Postulate">deBruijnify</a> <a id="6409" href="Main.html#6300" class="Bound">namedprog</a>
  <a id="6421" href="Utils.html#4084" class="Function">withE</a> <a id="6427" href="Main.html#5392" class="InductiveConstructor">scopeError</a> <a id="6438" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="6440" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="6453" class="Symbol">{</a><a id="6454" class="Number">0</a><a id="6455" class="Symbol">}{</a><a id="6457" href="Scoped.html#1963" class="InductiveConstructor">Z</a><a id="6458" class="Symbol">}</a> <a id="6460" class="Symbol">(</a><a id="6461" href="Scoped.html#4478" class="Function">shifter</a> <a id="6469" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="6471" class="Symbol">(</a><a id="6472" href="Main.html#2590" class="Postulate">convP</a> <a id="6478" href="Main.html#6343" class="Bound">prog</a><a id="6482" class="Symbol">))</a>
  <a id="6487" class="Comment">-- ^ FIXME: this should have an interface that guarantees that the</a>
  <a id="6556" class="Comment">-- shifter is run</a>


<a id="typeCheckPLC"></a><a id="6576" href="Main.html#6576" class="Function">typeCheckPLC</a> <a id="6589" class="Symbol">:</a> <a id="6591" href="Scoped.html#6299" class="Datatype">ScopedTm</a> <a id="6600" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="6602" class="Symbol">→</a> <a id="6604" href="Utils.html#904" class="Datatype">Either</a> <a id="6611" href="Check.html#1105" class="Datatype">TypeError</a> <a id="6621" class="Symbol">(</a><a id="6622" href="Agda.Builtin.Sigma.html#166" class="Record">Σ</a> <a id="6624" class="Symbol">(</a><a id="6625" href="Type.html#977" class="InductiveConstructor">∅</a> <a id="6627" href="Type.BetaNormal.html#860" class="Datatype Operator">⊢Nf⋆</a> <a id="6632" href="Type.html#591" class="InductiveConstructor">*</a><a id="6633" class="Symbol">)</a> <a id="6635" class="Symbol">(</a><a id="6636" href="Algorithmic.html#1249" class="InductiveConstructor">∅</a> <a id="6638" href="Algorithmic.html#5483" class="Datatype Operator">⊢_</a><a id="6640" class="Symbol">))</a>
<a id="6643" href="Main.html#6576" class="Function">typeCheckPLC</a> <a id="6656" href="Main.html#6656" class="Bound">t</a> <a id="6658" class="Symbol">=</a> <a id="6660" href="Check.html#10572" class="Function">inferType</a> <a id="6670" class="Symbol">_</a> <a id="6672" href="Main.html#6656" class="Bound">t</a>


<a id="maxsteps"></a><a id="6676" href="Main.html#6676" class="Function">maxsteps</a> <a id="6685" class="Symbol">=</a> <a id="6687" class="Number">10000000000</a>

<a id="6700" class="Keyword">open</a> <a id="6705" class="Keyword">import</a> <a id="6712" href="Data.String.html" class="Module">Data.String</a>

<a id="reportError"></a><a id="6725" href="Main.html#6725" class="Function">reportError</a> <a id="6737" class="Symbol">:</a> <a id="6739" href="Main.html#5309" class="Datatype">ERROR</a> <a id="6745" class="Symbol">→</a> <a id="6747" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="6754" href="Main.html#6725" class="Function">reportError</a> <a id="6766" class="Symbol">(</a><a id="6767" href="Main.html#5358" class="InductiveConstructor">parseError</a> <a id="6778" class="Symbol">_)</a> <a id="6781" class="Symbol">=</a> <a id="6783" class="String">&quot;parseError&quot;</a>
<a id="6796" href="Main.html#6725" class="Function">reportError</a> <a id="6808" class="Symbol">(</a><a id="6809" href="Main.html#5329" class="InductiveConstructor">typeError</a> <a id="6819" href="Main.html#6819" class="Bound">s</a><a id="6820" class="Symbol">)</a> <a id="6822" class="Symbol">=</a> <a id="6824" class="String">&quot;typeError: &quot;</a> <a id="6838" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="6841" href="Main.html#6819" class="Bound">s</a>
<a id="6843" href="Main.html#6725" class="Function">reportError</a> <a id="6855" class="Symbol">(</a><a id="6856" href="Main.html#5392" class="InductiveConstructor">scopeError</a> <a id="6867" class="Symbol">_)</a> <a id="6870" class="Symbol">=</a> <a id="6872" class="String">&quot;scopeError&quot;</a>
<a id="6885" href="Main.html#6725" class="Function">reportError</a> <a id="6897" class="Symbol">(</a><a id="6898" href="Main.html#5426" class="InductiveConstructor">runtimeError</a> <a id="6911" class="Symbol">_)</a> <a id="6914" class="Symbol">=</a> <a id="6916" class="String">&quot;gasError&quot;</a>


<a id="executePLC"></a><a id="6929" href="Main.html#6929" class="Function">executePLC</a> <a id="6940" class="Symbol">:</a> <a id="6942" href="Main.html#5091" class="Datatype">EvalMode</a> <a id="6951" class="Symbol">→</a> <a id="6953" href="Scoped.html#6299" class="Datatype">ScopedTm</a> <a id="6962" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="6964" class="Symbol">→</a> <a id="6966" href="Utils.html#904" class="Datatype">Either</a> <a id="6973" href="Main.html#5309" class="Datatype">ERROR</a> <a id="6979" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="6986" href="Main.html#6929" class="Function">executePLC</a> <a id="6997" href="Main.html#5114" class="InductiveConstructor">U</a> <a id="6999" href="Main.html#6999" class="Bound">t</a> <a id="7001" class="Symbol">=</a> <a id="7003" href="Utils.html#937" class="InductiveConstructor">inj₁</a> <a id="7008" class="Symbol">(</a><a id="7009" href="Main.html#5426" class="InductiveConstructor">runtimeError</a> <a id="7022" href="Utils.html#4263" class="InductiveConstructor">gasError</a><a id="7030" class="Symbol">)</a>
<a id="7032" href="Main.html#6929" class="Function">executePLC</a> <a id="7043" href="Main.html#5116" class="InductiveConstructor">TL</a> <a id="7046" href="Main.html#7046" class="Bound">t</a> <a id="7048" class="Symbol">=</a> <a id="7050" class="Keyword">do</a>
  <a id="7055" class="Symbol">(</a><a id="7056" href="Main.html#7056" class="Bound">A</a> <a id="7058" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="7061" href="Main.html#7061" class="Bound">t</a><a id="7062" class="Symbol">)</a> <a id="7064" href="Utils.html#3321" class="Field Operator">←</a> <a id="7066" href="Utils.html#4084" class="Function">withE</a> <a id="7072" class="Symbol">(λ</a> <a id="7075" href="Main.html#7075" class="Bound">e</a> <a id="7077" class="Symbol">→</a> <a id="7079" href="Main.html#5329" class="InductiveConstructor">typeError</a> <a id="7089" class="Symbol">(</a><a id="7090" href="Main.html#5464" class="Function">uglyTypeError</a> <a id="7104" href="Main.html#7075" class="Bound">e</a><a id="7105" class="Symbol">))</a> <a id="7108" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="7110" href="Main.html#6576" class="Function">typeCheckPLC</a> <a id="7123" href="Main.html#7046" class="Bound">t</a>
  <a id="7127" href="Utils.html#516" class="InductiveConstructor">just</a> <a id="7132" href="Main.html#7132" class="Bound">t&#39;</a> <a id="7135" href="Utils.html#3321" class="Field Operator">←</a> <a id="7137" href="Utils.html#4084" class="Function">withE</a> <a id="7143" href="Main.html#5426" class="InductiveConstructor">runtimeError</a> <a id="7156" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="7158" href="Algorithmic.Reduction.html#18391" class="Function">Algorithmic.Reduction.progressor</a> <a id="7191" href="Main.html#6676" class="Function">maxsteps</a> <a id="7200" href="Main.html#7061" class="Bound">t</a>
    <a id="7206" class="Keyword">where</a> <a id="7212" href="Utils.html#537" class="InductiveConstructor">nothing</a> <a id="7220" class="Symbol">→</a> <a id="7222" href="Utils.html#961" class="InductiveConstructor">inj₂</a> <a id="7227" class="String">&quot;ERROR&quot;</a>
  <a id="7237" href="Utils.html#3293" class="Field">return</a> <a id="7244" class="Symbol">(</a><a id="7245" href="Main.html#4839" class="Postulate">prettyPrintTm</a> <a id="7259" class="Symbol">(</a><a id="7260" href="Scoped.html#5468" class="Function">unshifter</a> <a id="7270" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="7272" class="Symbol">(</a><a id="7273" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="7288" class="Symbol">(</a><a id="7289" href="Scoped.Extrication.html#3921" class="Function">extricate</a> <a id="7299" href="Main.html#7132" class="Bound">t&#39;</a><a id="7301" class="Symbol">))))</a>

<a id="7307" href="Main.html#6929" class="Function">executePLC</a> <a id="7318" href="Main.html#5119" class="InductiveConstructor">L</a> <a id="7320" href="Main.html#7320" class="Bound">t</a> <a id="7322" class="Keyword">with</a> <a id="7327" href="Scoped.Reduction.html#15752" class="Function">S.run</a> <a id="7333" href="Main.html#7320" class="Bound">t</a> <a id="7335" href="Main.html#6676" class="Function">maxsteps</a>
<a id="7344" class="Symbol">...</a> <a id="7348" class="Symbol">|</a> <a id="7350" href="Main.html#7350" class="Bound">t&#39;</a> <a id="7353" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="7356" href="Main.html#7356" class="Bound">p</a> <a id="7358" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="7361" href="Data.Sum.Base.html#778" class="InductiveConstructor">inj₁</a> <a id="7366" class="Symbol">(</a><a id="7367" href="Utils.html#516" class="InductiveConstructor">just</a> <a id="7372" href="Main.html#7372" class="Bound">v</a><a id="7373" class="Symbol">)</a> <a id="7375" class="Symbol">=</a> <a id="7377" href="Utils.html#961" class="InductiveConstructor">inj₂</a> <a id="7382" class="Symbol">(</a><a id="7383" href="Main.html#4839" class="Postulate">prettyPrintTm</a> <a id="7397" class="Symbol">(</a><a id="7398" href="Scoped.html#5468" class="Function">unshifter</a> <a id="7408" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="7410" class="Symbol">(</a><a id="7411" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="7426" href="Main.html#7350" class="Bound">t&#39;</a><a id="7428" class="Symbol">)))</a>
<a id="7432" class="Symbol">...</a> <a id="7436" class="Symbol">|</a> <a id="7438" href="Main.html#7438" class="Bound">t&#39;</a> <a id="7441" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="7444" href="Main.html#7444" class="Bound">p</a> <a id="7446" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="7449" href="Data.Sum.Base.html#778" class="InductiveConstructor">inj₁</a> <a id="7454" href="Utils.html#537" class="InductiveConstructor">nothing</a>  <a id="7463" class="Symbol">=</a> <a id="7465" href="Utils.html#937" class="InductiveConstructor">inj₁</a> <a id="7470" class="Symbol">(</a><a id="7471" href="Main.html#5426" class="InductiveConstructor">runtimeError</a> <a id="7484" href="Utils.html#4263" class="InductiveConstructor">gasError</a><a id="7492" class="Symbol">)</a>
<a id="7494" class="Symbol">...</a> <a id="7498" class="Symbol">|</a> <a id="7500" href="Main.html#7500" class="Bound">t&#39;</a> <a id="7503" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="7506" href="Main.html#7506" class="Bound">p</a> <a id="7508" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="7511" href="Data.Sum.Base.html#803" class="InductiveConstructor">inj₂</a> <a id="7516" href="Main.html#7516" class="Bound">e</a>        <a id="7525" class="Symbol">=</a> <a id="7527" href="Utils.html#961" class="InductiveConstructor">inj₂</a> <a id="7532" class="String">&quot;ERROR&quot;</a>
<a id="7540" href="Main.html#6929" class="Function">executePLC</a> <a id="7551" href="Main.html#5125" class="InductiveConstructor">CK</a> <a id="7554" href="Main.html#7554" class="Bound">t</a> <a id="7556" class="Symbol">=</a> <a id="7558" class="Keyword">do</a>
  <a id="7563" href="Scoped.CK.html#1061" class="InductiveConstructor">□</a> <a id="7565" class="Symbol">{</a><a id="7566" class="Argument">t</a> <a id="7568" class="Symbol">=</a> <a id="7570" href="Main.html#7570" class="Bound">t</a><a id="7571" class="Symbol">}</a> <a id="7573" href="Main.html#7573" class="Bound">v</a> <a id="7575" href="Utils.html#3321" class="Field Operator">←</a> <a id="7577" href="Utils.html#4084" class="Function">withE</a> <a id="7583" href="Main.html#5426" class="InductiveConstructor">runtimeError</a> <a id="7596" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="7598" href="Scoped.CK.html#3273" class="Function">Scoped.CK.stepper</a> <a id="7616" href="Main.html#6676" class="Function">maxsteps</a> <a id="7625" class="Symbol">(</a><a id="7626" href="Scoped.CK.html#907" class="InductiveConstructor">ε</a> <a id="7628" href="Scoped.CK.html#975" class="InductiveConstructor Operator">▻</a> <a id="7630" href="Main.html#7554" class="Bound">t</a><a id="7631" class="Symbol">)</a>
    <a id="7637" class="Keyword">where</a> <a id="7643" href="Scoped.CK.html#1105" class="CatchallClause InductiveConstructor">◆</a><a id="7644" class="CatchallClause">  </a><a id="7646" class="CatchallClause Symbol">→</a><a id="7647" class="CatchallClause"> </a><a id="7648" href="Utils.html#961" class="CatchallClause InductiveConstructor">inj₂</a><a id="7652" class="CatchallClause"> </a><a id="7653" class="CatchallClause String">&quot;ERROR&quot;</a>
          <a id="7671" class="CatchallClause Symbol">_</a><a id="7672" class="CatchallClause">  </a><a id="7674" class="CatchallClause Symbol">→</a><a id="7675" class="CatchallClause"> </a><a id="7676" href="Utils.html#937" class="CatchallClause InductiveConstructor">inj₁</a><a id="7680" class="CatchallClause"> </a><a id="7681" class="CatchallClause Symbol">(</a><a id="7682" href="Main.html#5426" class="CatchallClause InductiveConstructor">runtimeError</a><a id="7694" class="CatchallClause"> </a><a id="7695" href="Utils.html#4263" class="CatchallClause InductiveConstructor">gasError</a><a id="7703" class="CatchallClause Symbol">)</a>
  <a id="7707" href="Utils.html#3293" class="Field">return</a> <a id="7714" class="Symbol">(</a><a id="7715" href="Main.html#4839" class="Postulate">prettyPrintTm</a> <a id="7729" class="Symbol">(</a><a id="7730" href="Scoped.html#5468" class="Function">unshifter</a> <a id="7740" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="7742" class="Symbol">(</a><a id="7743" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="7758" href="Main.html#7570" class="Bound">t</a><a id="7759" class="Symbol">)))</a>
<a id="7763" href="Main.html#6929" class="Function">executePLC</a> <a id="7774" href="Main.html#5121" class="InductiveConstructor">TCK</a> <a id="7778" href="Main.html#7778" class="Bound">t</a> <a id="7780" class="Symbol">=</a> <a id="7782" class="Keyword">do</a>
  <a id="7787" class="Symbol">(</a><a id="7788" href="Main.html#7788" class="Bound">A</a> <a id="7790" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="7793" href="Main.html#7793" class="Bound">t</a><a id="7794" class="Symbol">)</a> <a id="7796" href="Utils.html#3321" class="Field Operator">←</a> <a id="7798" href="Utils.html#4084" class="Function">withE</a> <a id="7804" class="Symbol">(λ</a> <a id="7807" href="Main.html#7807" class="Bound">e</a> <a id="7809" class="Symbol">→</a> <a id="7811" href="Main.html#5329" class="InductiveConstructor">typeError</a> <a id="7821" class="Symbol">(</a><a id="7822" href="Main.html#5464" class="Function">uglyTypeError</a> <a id="7836" href="Main.html#7807" class="Bound">e</a><a id="7837" class="Symbol">))</a> <a id="7840" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="7842" href="Main.html#6576" class="Function">typeCheckPLC</a> <a id="7855" href="Main.html#7778" class="Bound">t</a>
  <a id="7859" href="Algorithmic.CK.html#1840" class="InductiveConstructor">□</a> <a id="7861" class="Symbol">{</a><a id="7862" class="Argument">t</a> <a id="7864" class="Symbol">=</a> <a id="7866" href="Main.html#7866" class="Bound">t</a><a id="7867" class="Symbol">}</a> <a id="7869" href="Main.html#7869" class="Bound">v</a> <a id="7871" href="Utils.html#3321" class="Field Operator">←</a> <a id="7873" href="Utils.html#4084" class="Function">withE</a> <a id="7879" href="Main.html#5426" class="InductiveConstructor">runtimeError</a> <a id="7892" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="7894" href="Algorithmic.CK.html#4571" class="Function">Algorithmic.CK.stepper</a> <a id="7917" href="Main.html#6676" class="Function">maxsteps</a> <a id="7926" class="Symbol">(</a><a id="7927" href="Algorithmic.CK.html#1547" class="InductiveConstructor">ε</a> <a id="7929" href="Algorithmic.CK.html#1718" class="InductiveConstructor Operator">▻</a> <a id="7931" href="Main.html#7793" class="Bound">t</a><a id="7932" class="Symbol">)</a>
    <a id="7938" class="Keyword">where</a> <a id="7944" href="Algorithmic.CK.html#1880" class="CatchallClause InductiveConstructor">◆</a><a id="7945" class="CatchallClause"> </a><a id="7946" class="CatchallClause Symbol">_</a><a id="7947" class="CatchallClause">  </a><a id="7949" class="CatchallClause Symbol">→</a><a id="7950" class="CatchallClause"> </a><a id="7951" href="Utils.html#961" class="CatchallClause InductiveConstructor">inj₂</a><a id="7955" class="CatchallClause"> </a><a id="7956" class="CatchallClause String">&quot;ERROR&quot;</a>
          <a id="7974" class="CatchallClause Symbol">_</a><a id="7975" class="CatchallClause">    </a><a id="7979" class="CatchallClause Symbol">→</a><a id="7980" class="CatchallClause"> </a><a id="7981" href="Utils.html#937" class="CatchallClause InductiveConstructor">inj₁</a><a id="7985" class="CatchallClause"> </a><a id="7986" class="CatchallClause Symbol">(</a><a id="7987" href="Main.html#5426" class="CatchallClause InductiveConstructor">runtimeError</a><a id="7999" class="CatchallClause"> </a><a id="8000" href="Utils.html#4263" class="CatchallClause InductiveConstructor">gasError</a><a id="8008" class="CatchallClause Symbol">)</a>
  <a id="8012" href="Utils.html#3293" class="Field">return</a> <a id="8019" class="Symbol">(</a><a id="8020" href="Main.html#4839" class="Postulate">prettyPrintTm</a> <a id="8034" class="Symbol">(</a><a id="8035" href="Scoped.html#5468" class="Function">unshifter</a> <a id="8045" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="8047" class="Symbol">(</a><a id="8048" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="8063" class="Symbol">(</a><a id="8064" href="Scoped.Extrication.html#3921" class="Function">extricate</a> <a id="8074" href="Main.html#7866" class="Bound">t</a><a id="8075" class="Symbol">))))</a>
<a id="8080" href="Main.html#6929" class="CatchallClause Function">executePLC</a><a id="8090" class="CatchallClause"> </a><a id="8091" href="Main.html#8091" class="CatchallClause Bound">TCEKV</a><a id="8096" class="CatchallClause"> </a><a id="8097" href="Main.html#8097" class="CatchallClause Bound">t</a> <a id="8099" class="Symbol">=</a> <a id="8101" class="Keyword">do</a>
  <a id="8106" class="Symbol">(</a><a id="8107" href="Main.html#8107" class="Bound">A</a> <a id="8109" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="8112" href="Main.html#8112" class="Bound">t</a><a id="8113" class="Symbol">)</a> <a id="8115" href="Utils.html#3321" class="Field Operator">←</a> <a id="8117" href="Utils.html#4084" class="Function">withE</a> <a id="8123" class="Symbol">(λ</a> <a id="8126" href="Main.html#8126" class="Bound">e</a> <a id="8128" class="Symbol">→</a> <a id="8130" href="Main.html#5329" class="InductiveConstructor">typeError</a> <a id="8140" class="Symbol">(</a><a id="8141" href="Main.html#5464" class="Function">uglyTypeError</a> <a id="8155" href="Main.html#8126" class="Bound">e</a><a id="8156" class="Symbol">))</a> <a id="8159" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="8161" href="Main.html#6576" class="Function">typeCheckPLC</a> <a id="8174" href="Main.html#8097" class="Bound">t</a>
  <a id="8178" href="Algorithmic.CEKV.html#8540" class="InductiveConstructor">□</a> <a id="8180" href="Main.html#8180" class="Bound">V</a> <a id="8182" href="Utils.html#3321" class="Field Operator">←</a> <a id="8184" href="Utils.html#4084" class="Function">withE</a> <a id="8190" href="Main.html#5426" class="InductiveConstructor">runtimeError</a> <a id="8203" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="8205" href="Algorithmic.CEKV.html#18786" class="Function">Algorithmic.CEKV.stepper</a> <a id="8230" href="Main.html#6676" class="Function">maxsteps</a> <a id="8239" class="Symbol">(</a><a id="8240" href="Algorithmic.CEKV.html#8304" class="InductiveConstructor">ε</a> <a id="8242" href="Algorithmic.CEKV.html#8418" class="InductiveConstructor Operator">;</a> <a id="8244" href="Algorithmic.CEKV.html#2752" class="InductiveConstructor">[]</a> <a id="8247" href="Algorithmic.CEKV.html#8418" class="InductiveConstructor Operator">▻</a> <a id="8249" href="Main.html#8112" class="Bound">t</a><a id="8250" class="Symbol">)</a>
    <a id="8256" class="Keyword">where</a> <a id="8262" href="Algorithmic.CEKV.html#8568" class="CatchallClause InductiveConstructor">◆</a><a id="8263" class="CatchallClause"> </a><a id="8264" class="CatchallClause Symbol">_</a><a id="8265" class="CatchallClause">  </a><a id="8267" class="CatchallClause Symbol">→</a><a id="8268" class="CatchallClause"> </a><a id="8269" href="Utils.html#961" class="CatchallClause InductiveConstructor">inj₂</a><a id="8273" class="CatchallClause"> </a><a id="8274" class="CatchallClause String">&quot;ERROR&quot;</a>
          <a id="8292" class="CatchallClause Symbol">_</a><a id="8293" class="CatchallClause">    </a><a id="8297" class="CatchallClause Symbol">→</a><a id="8298" class="CatchallClause"> </a><a id="8299" href="Utils.html#937" class="CatchallClause InductiveConstructor">inj₁</a><a id="8303" class="CatchallClause"> </a><a id="8304" class="CatchallClause Symbol">(</a><a id="8305" href="Main.html#5426" class="CatchallClause InductiveConstructor">runtimeError</a><a id="8317" class="CatchallClause"> </a><a id="8318" href="Utils.html#4263" class="CatchallClause InductiveConstructor">gasError</a><a id="8326" class="CatchallClause Symbol">)</a>
  <a id="8330" href="Utils.html#3293" class="Field">return</a> <a id="8337" class="Symbol">(</a><a id="8338" href="Main.html#4839" class="Postulate">prettyPrintTm</a> <a id="8352" class="Symbol">(</a><a id="8353" href="Scoped.html#5468" class="Function">unshifter</a> <a id="8363" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="8365" class="Symbol">(</a><a id="8366" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="8381" class="Symbol">(</a><a id="8382" href="Scoped.Extrication.html#3921" class="Function">extricate</a> <a id="8392" class="Symbol">(</a><a id="8393" href="Algorithmic.CEKV.html#3086" class="Function">Algorithmic.CEKV.discharge</a> <a id="8420" href="Main.html#8180" class="Bound">V</a><a id="8421" class="Symbol">)))))</a>

<a id="evalByteString"></a><a id="8428" href="Main.html#8428" class="Function">evalByteString</a> <a id="8443" class="Symbol">:</a> <a id="8445" href="Main.html#5091" class="Datatype">EvalMode</a> <a id="8454" class="Symbol">→</a> <a id="8456" href="Main.html#1544" class="Postulate">ByteString</a> <a id="8467" class="Symbol">→</a> <a id="8469" href="Utils.html#904" class="Datatype">Either</a> <a id="8476" href="Main.html#5309" class="Datatype">ERROR</a> <a id="8482" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="8489" href="Main.html#8428" class="Function">evalByteString</a> <a id="8504" href="Main.html#8504" class="Bound">m</a> <a id="8506" href="Main.html#8506" class="Bound">b</a> <a id="8508" class="Symbol">=</a> <a id="8510" class="Keyword">do</a>
<a id="8513" class="Comment">{-
  -- some debugging code
  namedprog ← withE parseError $ parse b
  prog ← withE (ERROR.scopeError ∘ freeVariableError) $ deBruijnify namedprog
  let shiftedprog = shifter Z (convP prog)
  scopedprog ← withE scopeError $ scopeCheckTm {0}{Z} shiftedprog
  let extricatedprog = extricateScope scopedprog
  let unshiftedprog = unshifter Z extricatedprog
  return (&quot;orginal: &quot; ++ rawPrinter (convP prog) ++ &quot;\n&quot; ++
          &quot;shifted: &quot; ++ rawPrinter shiftedprog ++ &quot;\n&quot; ++
          &quot;instrinsically scoped: &quot; ++ Scoped.ugly scopedprog ++ &quot;\n&quot; ++
          &quot;extricated: &quot; ++ rawPrinter extricatedprog ++ &quot;\n&quot; ++
          &quot;unshifted: &quot; ++ rawPrinter unshiftedprog ++ &quot;\n&quot; ++
          &quot;unconved: &quot; ++ prettyPrintTm unshiftedprog ++ &quot;\n&quot;)
-}</a>
  <a id="9255" href="Main.html#9255" class="Bound">t</a> <a id="9257" href="Utils.html#3321" class="Field Operator">←</a> <a id="9259" href="Main.html#6230" class="Function">parsePLC</a> <a id="9268" href="Main.html#8506" class="Bound">b</a>
  <a id="9272" href="Main.html#6929" class="Function">executePLC</a> <a id="9283" href="Main.html#8504" class="Bound">m</a> <a id="9285" href="Main.html#9255" class="Bound">t</a>

<a id="typeCheckByteString"></a><a id="9288" href="Main.html#9288" class="Function">typeCheckByteString</a> <a id="9308" class="Symbol">:</a> <a id="9310" href="Main.html#1544" class="Postulate">ByteString</a> <a id="9321" class="Symbol">→</a> <a id="9323" href="Utils.html#904" class="Datatype">Either</a> <a id="9330" href="Main.html#5309" class="Datatype">ERROR</a> <a id="9336" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="9343" href="Main.html#9288" class="Function">typeCheckByteString</a> <a id="9363" href="Main.html#9363" class="Bound">b</a> <a id="9365" class="Symbol">=</a> <a id="9367" class="Keyword">do</a>
  <a id="9372" href="Main.html#9372" class="Bound">t</a> <a id="9374" href="Utils.html#3321" class="Field Operator">←</a> <a id="9376" href="Main.html#6230" class="Function">parsePLC</a> <a id="9385" href="Main.html#9363" class="Bound">b</a>
  <a id="9389" class="Symbol">(</a><a id="9390" href="Main.html#9390" class="Bound">A</a> <a id="9392" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="9395" class="Symbol">_)</a> <a id="9398" href="Utils.html#3321" class="Field Operator">←</a> <a id="9400" href="Utils.html#4084" class="Function">withE</a> <a id="9406" class="Symbol">(λ</a> <a id="9409" href="Main.html#9409" class="Bound">e</a> <a id="9411" class="Symbol">→</a> <a id="9413" href="Main.html#5329" class="InductiveConstructor">typeError</a> <a id="9423" class="Symbol">(</a><a id="9424" href="Main.html#5464" class="Function">uglyTypeError</a> <a id="9438" href="Main.html#9409" class="Bound">e</a><a id="9439" class="Symbol">)</a> <a id="9441" class="Symbol">)</a> <a id="9443" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="9445" href="Main.html#6576" class="Function">typeCheckPLC</a> <a id="9458" href="Main.html#9372" class="Bound">t</a>
<a id="9460" class="Comment">{-
  -- some debugging code
  let extricatedtype = extricateScopeTy (extricateNf⋆ A)
  let unshiftedtype = unshifterTy Z extricatedtype
  return (&quot;original: &quot; ++ &quot;???&quot; ++ &quot;\n&quot; ++
          &quot;extricated: &quot; ++ rawTyPrinter extricatedtype ++ &quot;\n&quot; ++
          &quot;unshifted: &quot; ++ rawTyPrinter unshiftedtype ++ &quot;\n&quot; ++
          &quot;unconved: &quot; ++ prettyPrintTy unshiftedtype ++ &quot;\n&quot;)
-}</a>
  <a id="9839" href="Utils.html#3293" class="Field">return</a> <a id="9846" class="Symbol">(</a><a id="9847" href="Main.html#4872" class="Postulate">prettyPrintTy</a> <a id="9861" class="Symbol">(</a><a id="9862" href="Scoped.html#5021" class="Function">unshifterTy</a> <a id="9874" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="9876" class="Symbol">(</a><a id="9877" href="Scoped.html#10165" class="Function">extricateScopeTy</a> <a id="9894" class="Symbol">(</a><a id="9895" href="Scoped.Extrication.html#876" class="Function">extricateNf⋆</a> <a id="9908" href="Main.html#9390" class="Bound">A</a><a id="9909" class="Symbol">))))</a>

<a id="junk"></a><a id="9915" href="Main.html#9915" class="Function">junk</a> <a id="9920" class="Symbol">:</a> <a id="9922" class="Symbol">∀{</a><a id="9924" href="Main.html#9924" class="Bound">n</a><a id="9925" class="Symbol">}</a> <a id="9927" class="Symbol">→</a> <a id="9929" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="9933" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="9940" href="Main.html#9924" class="Bound">n</a>
<a id="9942" href="Main.html#9915" class="Function">junk</a> <a id="9947" class="Symbol">{</a><a id="9948" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="9952" class="Symbol">}</a>      <a id="9959" class="Symbol">=</a> <a id="9961" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a>
<a id="9964" href="Main.html#9915" class="Function">junk</a> <a id="9969" class="Symbol">{</a><a id="9970" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">Nat.suc</a> <a id="9978" href="Main.html#9978" class="Bound">n</a><a id="9979" class="Symbol">}</a> <a id="9981" class="Symbol">=</a> <a id="9983" href="Data.Integer.html#784" class="Function">Data.Integer.show</a> <a id="10001" class="Symbol">(</a><a id="10002" href="Agda.Builtin.Int.html#264" class="InductiveConstructor">pos</a> <a id="10006" href="Main.html#9978" class="Bound">n</a><a id="10007" class="Symbol">)</a> <a id="10009" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="10011" href="Main.html#9915" class="Function">junk</a>

<a id="alphaTm"></a><a id="10017" href="Main.html#10017" class="Function">alphaTm</a> <a id="10025" class="Symbol">:</a> <a id="10027" href="Main.html#1544" class="Postulate">ByteString</a> <a id="10038" class="Symbol">→</a> <a id="10040" href="Main.html#1544" class="Postulate">ByteString</a> <a id="10051" class="Symbol">→</a> <a id="10053" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="10058" href="Main.html#10017" class="Function">alphaTm</a> <a id="10066" href="Main.html#10066" class="Bound">plc1</a> <a id="10071" href="Main.html#10071" class="Bound">plc2</a> <a id="10076" class="Keyword">with</a> <a id="10081" href="Main.html#2685" class="Postulate">parseTm</a> <a id="10089" href="Main.html#10066" class="Bound">plc1</a> <a id="10094" class="Symbol">|</a> <a id="10096" href="Main.html#2685" class="Postulate">parseTm</a> <a id="10104" href="Main.html#10071" class="Bound">plc2</a>
<a id="10109" href="Main.html#10017" class="Function">alphaTm</a> <a id="10117" href="Main.html#10117" class="Bound">plc1</a> <a id="10122" href="Main.html#10122" class="Bound">plc2</a> <a id="10127" class="Symbol">|</a> <a id="10129" href="Utils.html#961" class="InductiveConstructor">inj₂</a> <a id="10134" href="Main.html#10134" class="Bound">plc1&#39;</a> <a id="10140" class="Symbol">|</a> <a id="10142" href="Utils.html#961" class="InductiveConstructor">inj₂</a> <a id="10147" href="Main.html#10147" class="Bound">plc2&#39;</a> <a id="10153" class="Keyword">with</a> <a id="10158" href="Main.html#2871" class="Postulate">deBruijnifyTm</a> <a id="10172" href="Main.html#10134" class="Bound">plc1&#39;</a> <a id="10178" class="Symbol">|</a> <a id="10180" href="Main.html#2871" class="Postulate">deBruijnifyTm</a> <a id="10194" href="Main.html#10147" class="Bound">plc2&#39;</a>
<a id="10200" href="Main.html#10017" class="Function">alphaTm</a> <a id="10208" href="Main.html#10208" class="Bound">plc1</a> <a id="10213" href="Main.html#10213" class="Bound">plc2</a> <a id="10218" class="Symbol">|</a> <a id="10220" class="InductiveConstructor">inj₂</a> <a id="10225" href="Main.html#10225" class="Bound">plc1&#39;</a> <a id="10231" class="Symbol">|</a> <a id="10233" class="InductiveConstructor">inj₂</a> <a id="10238" href="Main.html#10238" class="Bound">plc2&#39;</a> <a id="10244" class="Symbol">|</a> <a id="10246" href="Utils.html#516" class="InductiveConstructor">just</a> <a id="10251" href="Main.html#10251" class="Bound">plc1&#39;&#39;</a> <a id="10258" class="Symbol">|</a> <a id="10260" href="Utils.html#516" class="InductiveConstructor">just</a> <a id="10265" href="Main.html#10265" class="Bound">plc2&#39;&#39;</a> <a id="10272" class="Symbol">=</a> <a id="10274" href="Raw.html#6123" class="Function">decRTm</a> <a id="10281" class="Symbol">(</a><a id="10282" href="Main.html#2490" class="Postulate">convTm</a> <a id="10289" href="Main.html#10251" class="Bound">plc1&#39;&#39;</a><a id="10295" class="Symbol">)</a> <a id="10297" class="Symbol">(</a><a id="10298" href="Main.html#2490" class="Postulate">convTm</a> <a id="10305" href="Main.html#10265" class="Bound">plc2&#39;&#39;</a><a id="10311" class="Symbol">)</a>
<a id="10313" href="Main.html#10017" class="CatchallClause Function">alphaTm</a><a id="10320" class="CatchallClause"> </a><a id="10321" href="Main.html#10321" class="CatchallClause Bound">plc1</a><a id="10325" class="CatchallClause"> </a><a id="10326" href="Main.html#10326" class="CatchallClause Bound">plc2</a><a id="10330" class="CatchallClause"> </a><a id="10331" class="CatchallClause Symbol">|</a><a id="10332" class="CatchallClause"> </a><a id="10333" class="CatchallClause InductiveConstructor">inj₂</a><a id="10337" class="CatchallClause"> </a><a id="10338" href="Main.html#10338" class="CatchallClause Bound">plc1&#39;</a><a id="10343" class="CatchallClause"> </a><a id="10344" class="CatchallClause Symbol">|</a><a id="10345" class="CatchallClause"> </a><a id="10346" class="CatchallClause InductiveConstructor">inj₂</a><a id="10350" class="CatchallClause"> </a><a id="10351" href="Main.html#10351" class="CatchallClause Bound">plc2&#39;</a><a id="10356" class="CatchallClause"> </a><a id="10357" class="CatchallClause Symbol">|</a><a id="10358" class="CatchallClause"> </a><a id="10359" class="CatchallClause Symbol">_</a><a id="10360" class="CatchallClause"> </a><a id="10361" class="CatchallClause Symbol">|</a><a id="10362" class="CatchallClause"> </a><a id="10363" class="CatchallClause Symbol">_</a> <a id="10365" class="Symbol">=</a> <a id="10367" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">Bool.false</a>
<a id="10378" href="Main.html#10017" class="CatchallClause Function">alphaTm</a><a id="10385" class="CatchallClause"> </a><a id="10386" href="Main.html#10386" class="CatchallClause Bound">plc1</a><a id="10390" class="CatchallClause"> </a><a id="10391" href="Main.html#10391" class="CatchallClause Bound">plc2</a><a id="10395" class="CatchallClause"> </a><a id="10396" class="CatchallClause Symbol">|</a><a id="10397" class="CatchallClause"> </a><a id="10398" class="CatchallClause Symbol">_</a><a id="10399" class="CatchallClause"> </a><a id="10400" class="CatchallClause Symbol">|</a><a id="10401" class="CatchallClause"> </a><a id="10402" class="CatchallClause Symbol">_</a> <a id="10404" class="Symbol">=</a> <a id="10406" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">Bool.false</a>

<a id="10418" class="Symbol">{-#</a> <a id="10422" class="Keyword">COMPILE</a> <a id="10430" class="Keyword">GHC</a> <a id="10434" href="Main.html#10017" class="Function">alphaTm</a> <a id="10442" class="Pragma">as</a> <a id="10445" class="Pragma">alphaTm</a> <a id="10453" class="Symbol">#-}</a>

<a id="blah"></a><a id="10458" href="Main.html#10458" class="Function">blah</a> <a id="10463" class="Symbol">:</a> <a id="10465" href="Main.html#1544" class="Postulate">ByteString</a> <a id="10476" class="Symbol">→</a> <a id="10478" href="Main.html#1544" class="Postulate">ByteString</a> <a id="10489" class="Symbol">→</a> <a id="10491" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="10498" href="Main.html#10458" class="Function">blah</a> <a id="10503" href="Main.html#10503" class="Bound">plc1</a> <a id="10508" href="Main.html#10508" class="Bound">plc2</a> <a id="10513" class="Keyword">with</a> <a id="10518" href="Main.html#2685" class="Postulate">parseTm</a> <a id="10526" href="Main.html#10503" class="Bound">plc1</a> <a id="10531" class="Symbol">|</a> <a id="10533" href="Main.html#2685" class="Postulate">parseTm</a> <a id="10541" href="Main.html#10508" class="Bound">plc2</a>
<a id="10546" href="Main.html#10458" class="Function">blah</a> <a id="10551" href="Main.html#10551" class="Bound">plc1</a> <a id="10556" href="Main.html#10556" class="Bound">plc2</a> <a id="10561" class="Symbol">|</a> <a id="10563" href="Utils.html#961" class="InductiveConstructor">inj₂</a> <a id="10568" href="Main.html#10568" class="Bound">plc1&#39;</a> <a id="10574" class="Symbol">|</a> <a id="10576" href="Utils.html#961" class="InductiveConstructor">inj₂</a> <a id="10581" href="Main.html#10581" class="Bound">plc2&#39;</a> <a id="10587" class="Keyword">with</a> <a id="10592" href="Main.html#2871" class="Postulate">deBruijnifyTm</a> <a id="10606" href="Main.html#10568" class="Bound">plc1&#39;</a> <a id="10612" class="Symbol">|</a> <a id="10614" href="Main.html#2871" class="Postulate">deBruijnifyTm</a> <a id="10628" href="Main.html#10581" class="Bound">plc2&#39;</a>
<a id="10634" href="Main.html#10458" class="Function">blah</a> <a id="10639" href="Main.html#10639" class="Bound">plc1</a> <a id="10644" href="Main.html#10644" class="Bound">plc2</a> <a id="10649" class="Symbol">|</a> <a id="10651" class="InductiveConstructor">inj₂</a> <a id="10656" href="Main.html#10656" class="Bound">plc1&#39;</a> <a id="10662" class="Symbol">|</a> <a id="10664" class="InductiveConstructor">inj₂</a> <a id="10669" href="Main.html#10669" class="Bound">plc2&#39;</a> <a id="10675" class="Symbol">|</a> <a id="10677" href="Utils.html#516" class="InductiveConstructor">just</a> <a id="10682" href="Main.html#10682" class="Bound">plc1&#39;&#39;</a> <a id="10689" class="Symbol">|</a> <a id="10691" href="Utils.html#516" class="InductiveConstructor">just</a> <a id="10696" href="Main.html#10696" class="Bound">plc2&#39;&#39;</a> <a id="10703" class="Symbol">=</a> <a id="10705" href="Raw.html#8337" class="Function">rawPrinter</a> <a id="10716" class="Symbol">(</a><a id="10717" href="Main.html#2490" class="Postulate">convTm</a> <a id="10724" href="Main.html#10682" class="Bound">plc1&#39;&#39;</a><a id="10730" class="Symbol">)</a> <a id="10732" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="10735" class="String">&quot; || &quot;</a> <a id="10742" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="10745" href="Raw.html#8337" class="Function">rawPrinter</a> <a id="10756" class="Symbol">(</a><a id="10757" href="Main.html#2490" class="Postulate">convTm</a> <a id="10764" href="Main.html#10696" class="Bound">plc2&#39;&#39;</a><a id="10770" class="Symbol">)</a>
<a id="10772" href="Main.html#10458" class="CatchallClause Function">blah</a><a id="10776" class="CatchallClause"> </a><a id="10777" href="Main.html#10777" class="CatchallClause Bound">plc1</a><a id="10781" class="CatchallClause"> </a><a id="10782" href="Main.html#10782" class="CatchallClause Bound">plc2</a><a id="10786" class="CatchallClause"> </a><a id="10787" class="CatchallClause Symbol">|</a><a id="10788" class="CatchallClause"> </a><a id="10789" class="CatchallClause InductiveConstructor">inj₂</a><a id="10793" class="CatchallClause"> </a><a id="10794" href="Main.html#10794" class="CatchallClause Bound">plc1&#39;</a><a id="10799" class="CatchallClause"> </a><a id="10800" class="CatchallClause Symbol">|</a><a id="10801" class="CatchallClause"> </a><a id="10802" class="CatchallClause InductiveConstructor">inj₂</a><a id="10806" class="CatchallClause"> </a><a id="10807" href="Main.html#10807" class="CatchallClause Bound">plc2&#39;</a><a id="10812" class="CatchallClause"> </a><a id="10813" class="CatchallClause Symbol">|</a><a id="10814" class="CatchallClause"> </a><a id="10815" class="CatchallClause Symbol">_</a><a id="10816" class="CatchallClause"> </a><a id="10817" class="CatchallClause Symbol">|</a><a id="10818" class="CatchallClause"> </a><a id="10819" class="CatchallClause Symbol">_</a> <a id="10821" class="Symbol">=</a> <a id="10823" class="String">&quot;deBruijnifying failed&quot;</a>
<a id="10847" href="Main.html#10458" class="CatchallClause Function">blah</a><a id="10851" class="CatchallClause"> </a><a id="10852" href="Main.html#10852" class="CatchallClause Bound">plc1</a><a id="10856" class="CatchallClause"> </a><a id="10857" href="Main.html#10857" class="CatchallClause Bound">plc2</a><a id="10861" class="CatchallClause"> </a><a id="10862" class="CatchallClause Symbol">|</a><a id="10863" class="CatchallClause"> </a><a id="10864" class="CatchallClause Symbol">_</a><a id="10865" class="CatchallClause"> </a><a id="10866" class="CatchallClause Symbol">|</a><a id="10867" class="CatchallClause"> </a><a id="10868" class="CatchallClause Symbol">_</a> <a id="10870" class="Symbol">=</a> <a id="10872" class="String">&quot;parsing failed&quot;</a>

<a id="10890" class="Symbol">{-#</a> <a id="10894" class="Keyword">COMPILE</a> <a id="10902" class="Keyword">GHC</a> <a id="10906" href="Main.html#10458" class="Function">blah</a> <a id="10911" class="Pragma">as</a> <a id="10914" class="Pragma">blah</a> <a id="10919" class="Symbol">#-}</a>

<a id="printTy"></a><a id="10924" href="Main.html#10924" class="Function">printTy</a> <a id="10932" class="Symbol">:</a> <a id="10934" href="Main.html#1544" class="Postulate">ByteString</a> <a id="10945" class="Symbol">→</a> <a id="10947" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="10954" href="Main.html#10924" class="Function">printTy</a> <a id="10962" href="Main.html#10962" class="Bound">b</a> <a id="10964" class="Keyword">with</a> <a id="10969" href="Main.html#2734" class="Postulate">parseTy</a> <a id="10977" href="Main.html#10962" class="Bound">b</a>
<a id="10979" class="Symbol">...</a> <a id="10983" class="Symbol">|</a> <a id="10985" href="Utils.html#937" class="InductiveConstructor">inj₁</a> <a id="10990" class="Symbol">_</a> <a id="10992" class="Symbol">=</a> <a id="10994" class="String">&quot;parseTy error&quot;</a>
<a id="11010" class="Symbol">...</a> <a id="11014" class="Symbol">|</a> <a id="11016" href="Utils.html#961" class="InductiveConstructor">inj₂</a> <a id="11021" href="Main.html#11021" class="Bound">A</a>  <a id="11024" class="Keyword">with</a> <a id="11029" href="Main.html#2908" class="Postulate">deBruijnifyTy</a> <a id="11043" href="Main.html#11021" class="Bound">A</a>
<a id="11045" class="Symbol">...</a> <a id="11049" class="Symbol">|</a> <a id="11051" href="Utils.html#537" class="InductiveConstructor">nothing</a> <a id="11059" class="Symbol">=</a> <a id="11061" class="String">&quot;deBruinjifyTy error&quot;</a>
<a id="11083" class="Symbol">...</a> <a id="11087" class="Symbol">|</a> <a id="11089" href="Utils.html#516" class="InductiveConstructor">just</a> <a id="11094" href="Main.html#11094" class="Bound">A&#39;</a> <a id="11097" class="Symbol">=</a> <a id="11099" href="Raw.html#7873" class="Function">rawTyPrinter</a> <a id="11112" class="Symbol">(</a><a id="11113" href="Main.html#2514" class="Postulate">convTy</a> <a id="11120" href="Main.html#11094" class="Bound">A&#39;</a><a id="11122" class="Symbol">)</a>

<a id="11125" class="Symbol">{-#</a> <a id="11129" class="Keyword">COMPILE</a> <a id="11137" class="Keyword">GHC</a> <a id="11141" href="Main.html#10924" class="Function">printTy</a> <a id="11149" class="Pragma">as</a> <a id="11152" class="Pragma">printTy</a> <a id="11160" class="Symbol">#-}</a>

<a id="alphaTy"></a><a id="11165" href="Main.html#11165" class="Function">alphaTy</a> <a id="11173" class="Symbol">:</a> <a id="11175" href="Main.html#1544" class="Postulate">ByteString</a> <a id="11186" class="Symbol">→</a> <a id="11188" href="Main.html#1544" class="Postulate">ByteString</a> <a id="11199" class="Symbol">→</a> <a id="11201" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="11206" href="Main.html#11165" class="Function">alphaTy</a> <a id="11214" href="Main.html#11214" class="Bound">plc1</a> <a id="11219" href="Main.html#11219" class="Bound">plc2</a> <a id="11224" class="Keyword">with</a> <a id="11229" href="Main.html#2734" class="Postulate">parseTy</a> <a id="11237" href="Main.html#11214" class="Bound">plc1</a> <a id="11242" class="Symbol">|</a> <a id="11244" href="Main.html#2734" class="Postulate">parseTy</a> <a id="11252" href="Main.html#11219" class="Bound">plc2</a>
<a id="11257" href="Main.html#11165" class="Function">alphaTy</a> <a id="11265" href="Main.html#11265" class="Bound">plc1</a> <a id="11270" href="Main.html#11270" class="Bound">plc2</a> <a id="11275" class="Symbol">|</a> <a id="11277" href="Utils.html#961" class="InductiveConstructor">inj₂</a> <a id="11282" href="Main.html#11282" class="Bound">plc1&#39;</a> <a id="11288" class="Symbol">|</a> <a id="11290" href="Utils.html#961" class="InductiveConstructor">inj₂</a> <a id="11295" href="Main.html#11295" class="Bound">plc2&#39;</a> <a id="11301" class="Keyword">with</a> <a id="11306" href="Main.html#2908" class="Postulate">deBruijnifyTy</a> <a id="11320" href="Main.html#11282" class="Bound">plc1&#39;</a> <a id="11326" class="Symbol">|</a> <a id="11328" href="Main.html#2908" class="Postulate">deBruijnifyTy</a> <a id="11342" href="Main.html#11295" class="Bound">plc2&#39;</a>
<a id="11348" href="Main.html#11165" class="Function">alphaTy</a> <a id="11356" href="Main.html#11356" class="Bound">plc1</a> <a id="11361" href="Main.html#11361" class="Bound">plc2</a> <a id="11366" class="Symbol">|</a> <a id="11368" class="InductiveConstructor">inj₂</a> <a id="11373" href="Main.html#11373" class="Bound">plc1&#39;</a> <a id="11379" class="Symbol">|</a> <a id="11381" class="InductiveConstructor">inj₂</a> <a id="11386" href="Main.html#11386" class="Bound">plc2&#39;</a> <a id="11392" class="Symbol">|</a> <a id="11394" href="Utils.html#516" class="InductiveConstructor">just</a> <a id="11399" href="Main.html#11399" class="Bound">plc1&#39;&#39;</a> <a id="11406" class="Symbol">|</a> <a id="11408" href="Utils.html#516" class="InductiveConstructor">just</a> <a id="11413" href="Main.html#11413" class="Bound">plc2&#39;&#39;</a> <a id="11420" class="Symbol">=</a> <a id="11422" href="Raw.html#3942" class="Function">decRTy</a> <a id="11429" class="Symbol">(</a><a id="11430" href="Main.html#2514" class="Postulate">convTy</a> <a id="11437" href="Main.html#11399" class="Bound">plc1&#39;&#39;</a><a id="11443" class="Symbol">)</a> <a id="11445" class="Symbol">(</a><a id="11446" href="Main.html#2514" class="Postulate">convTy</a> <a id="11453" href="Main.html#11413" class="Bound">plc2&#39;&#39;</a><a id="11459" class="Symbol">)</a>
<a id="11461" href="Main.html#11165" class="CatchallClause Function">alphaTy</a><a id="11468" class="CatchallClause"> </a><a id="11469" href="Main.html#11469" class="CatchallClause Bound">plc1</a><a id="11473" class="CatchallClause"> </a><a id="11474" href="Main.html#11474" class="CatchallClause Bound">plc2</a><a id="11478" class="CatchallClause"> </a><a id="11479" class="CatchallClause Symbol">|</a><a id="11480" class="CatchallClause"> </a><a id="11481" class="CatchallClause InductiveConstructor">inj₂</a><a id="11485" class="CatchallClause"> </a><a id="11486" href="Main.html#11486" class="CatchallClause Bound">plc1&#39;</a><a id="11491" class="CatchallClause"> </a><a id="11492" class="CatchallClause Symbol">|</a><a id="11493" class="CatchallClause"> </a><a id="11494" class="CatchallClause InductiveConstructor">inj₂</a><a id="11498" class="CatchallClause"> </a><a id="11499" href="Main.html#11499" class="CatchallClause Bound">plc2&#39;</a><a id="11504" class="CatchallClause"> </a><a id="11505" class="CatchallClause Symbol">|</a><a id="11506" class="CatchallClause"> </a><a id="11507" class="CatchallClause Symbol">_</a><a id="11508" class="CatchallClause"> </a><a id="11509" class="CatchallClause Symbol">|</a><a id="11510" class="CatchallClause"> </a><a id="11511" class="CatchallClause Symbol">_</a> <a id="11513" class="Symbol">=</a> <a id="11515" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">Bool.false</a>
<a id="11526" href="Main.html#11165" class="CatchallClause Function">alphaTy</a><a id="11533" class="CatchallClause"> </a><a id="11534" href="Main.html#11534" class="CatchallClause Bound">plc1</a><a id="11538" class="CatchallClause"> </a><a id="11539" href="Main.html#11539" class="CatchallClause Bound">plc2</a><a id="11543" class="CatchallClause"> </a><a id="11544" class="CatchallClause Symbol">|</a><a id="11545" class="CatchallClause"> </a><a id="11546" class="CatchallClause Symbol">_</a><a id="11547" class="CatchallClause"> </a><a id="11548" class="CatchallClause Symbol">|</a><a id="11549" class="CatchallClause"> </a><a id="11550" class="CatchallClause Symbol">_</a> <a id="11552" class="Symbol">=</a> <a id="11554" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">Bool.false</a>

<a id="11566" class="Symbol">{-#</a> <a id="11570" class="Keyword">COMPILE</a> <a id="11578" class="Keyword">GHC</a> <a id="11582" href="Main.html#11165" class="Function">alphaTy</a> <a id="11590" class="Pragma">as</a> <a id="11593" class="Pragma">alphaTy</a> <a id="11601" class="Symbol">#-}</a>

<a id="11606" class="Comment">-- Opt stuff</a>

<a id="11620" class="Symbol">{-#</a> <a id="11624" class="Keyword">FOREIGN</a> <a id="11632" class="Pragma">GHC</a> <a id="11636" class="Pragma">import</a> <a id="11643" class="Pragma">Opts</a> <a id="11648" class="Symbol">#-}</a>

<a id="11653" class="Keyword">data</a> <a id="Input"></a><a id="11658" href="Main.html#11658" class="Datatype">Input</a> <a id="11664" class="Symbol">:</a> <a id="11666" class="PrimitiveType">Set</a> <a id="11670" class="Keyword">where</a>
  <a id="Input.FileInput"></a><a id="11678" href="Main.html#11678" class="InductiveConstructor">FileInput</a> <a id="11688" class="Symbol">:</a> <a id="11690" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="11697" class="Symbol">→</a> <a id="11699" href="Main.html#11658" class="Datatype">Input</a>
  <a id="Input.StdInput"></a><a id="11707" href="Main.html#11707" class="InductiveConstructor">StdInput</a> <a id="11716" class="Symbol">:</a> <a id="11718" href="Main.html#11658" class="Datatype">Input</a>

<a id="11725" class="Symbol">{-#</a> <a id="11729" class="Keyword">COMPILE</a> <a id="11737" class="Keyword">GHC</a> <a id="11741" href="Main.html#11658" class="Datatype">Input</a> <a id="11747" class="Pragma">=</a> <a id="11749" class="Pragma">data</a> <a id="11754" class="Pragma">Input</a> <a id="11760" class="Pragma">(FileInput</a> <a id="11771" class="Pragma">|</a> <a id="11773" class="Pragma">StdInput)</a> <a id="11783" class="Symbol">#-}</a>

<a id="11788" class="Keyword">data</a> <a id="EvalOptions"></a><a id="11793" href="Main.html#11793" class="Datatype">EvalOptions</a> <a id="11805" class="Symbol">:</a> <a id="11807" class="PrimitiveType">Set</a> <a id="11811" class="Keyword">where</a>
  <a id="EvalOptions.EvalOpts"></a><a id="11819" href="Main.html#11819" class="InductiveConstructor">EvalOpts</a> <a id="11828" class="Symbol">:</a> <a id="11830" href="Main.html#11658" class="Datatype">Input</a> <a id="11836" class="Symbol">→</a> <a id="11838" href="Main.html#5091" class="Datatype">EvalMode</a> <a id="11847" class="Symbol">→</a> <a id="11849" href="Main.html#11793" class="Datatype">EvalOptions</a>

<a id="11862" class="Symbol">{-#</a> <a id="11866" class="Keyword">COMPILE</a> <a id="11874" class="Keyword">GHC</a> <a id="11878" href="Main.html#11793" class="Datatype">EvalOptions</a> <a id="11890" class="Pragma">=</a> <a id="11892" class="Pragma">data</a> <a id="11897" class="Pragma">EvalOptions</a> <a id="11909" class="Pragma">(EvalOpts)</a> <a id="11920" class="Symbol">#-}</a>

<a id="11925" class="Keyword">data</a> <a id="TCOptions"></a><a id="11930" href="Main.html#11930" class="Datatype">TCOptions</a> <a id="11940" class="Symbol">:</a> <a id="11942" class="PrimitiveType">Set</a> <a id="11946" class="Keyword">where</a>
  <a id="TCOptions.TCOpts"></a><a id="11954" href="Main.html#11954" class="InductiveConstructor">TCOpts</a> <a id="11961" class="Symbol">:</a> <a id="11963" href="Main.html#11658" class="Datatype">Input</a> <a id="11969" class="Symbol">→</a> <a id="11971" href="Main.html#11930" class="Datatype">TCOptions</a>

<a id="11982" class="Symbol">{-#</a> <a id="11986" class="Keyword">COMPILE</a> <a id="11994" class="Keyword">GHC</a> <a id="11998" href="Main.html#11930" class="Datatype">TCOptions</a> <a id="12008" class="Pragma">=</a> <a id="12010" class="Pragma">data</a> <a id="12015" class="Pragma">TCOptions</a> <a id="12025" class="Pragma">(TCOpts)</a> <a id="12034" class="Symbol">#-}</a>

<a id="12039" class="Keyword">data</a> <a id="Command"></a><a id="12044" href="Main.html#12044" class="Datatype">Command</a> <a id="12052" class="Symbol">:</a> <a id="12054" class="PrimitiveType">Set</a> <a id="12058" class="Keyword">where</a>
  <a id="Command.Evaluate"></a><a id="12066" href="Main.html#12066" class="InductiveConstructor">Evaluate</a>  <a id="12076" class="Symbol">:</a> <a id="12078" href="Main.html#11793" class="Datatype">EvalOptions</a> <a id="12090" class="Symbol">→</a> <a id="12092" href="Main.html#12044" class="Datatype">Command</a>
  <a id="Command.TypeCheck"></a><a id="12102" href="Main.html#12102" class="InductiveConstructor">TypeCheck</a> <a id="12112" class="Symbol">:</a> <a id="12114" href="Main.html#11930" class="Datatype">TCOptions</a> <a id="12124" class="Symbol">→</a> <a id="12126" href="Main.html#12044" class="Datatype">Command</a>

<a id="12135" class="Symbol">{-#</a> <a id="12139" class="Keyword">COMPILE</a> <a id="12147" class="Keyword">GHC</a> <a id="12151" href="Main.html#12044" class="Datatype">Command</a> <a id="12159" class="Pragma">=</a> <a id="12161" class="Pragma">data</a> <a id="12166" class="Pragma">Command</a> <a id="12174" class="Pragma">(Evaluate</a> <a id="12184" class="Pragma">|</a> <a id="12186" class="Pragma">TypeCheck)</a> <a id="12197" class="Symbol">#-}</a>

<a id="12202" class="Keyword">postulate</a> <a id="execP"></a><a id="12212" href="Main.html#12212" class="Postulate">execP</a> <a id="12218" class="Symbol">:</a> <a id="12220" href="Agda.Builtin.IO.html#138" class="Postulate">IO</a> <a id="12223" href="Main.html#12044" class="Datatype">Command</a>

<a id="12232" class="Symbol">{-#</a> <a id="12236" class="Keyword">COMPILE</a> <a id="12244" class="Keyword">GHC</a> <a id="12248" href="Main.html#12212" class="Postulate">execP</a> <a id="12254" class="Pragma">=</a> <a id="12256" class="Pragma">execP</a> <a id="12262" class="Symbol">#-}</a>

<a id="evalInput"></a><a id="12267" href="Main.html#12267" class="Function">evalInput</a> <a id="12277" class="Symbol">:</a> <a id="12279" href="Main.html#5091" class="Datatype">EvalMode</a> <a id="12288" class="Symbol">→</a> <a id="12290" href="Main.html#11658" class="Datatype">Input</a> <a id="12296" class="Symbol">→</a> <a id="12298" href="Agda.Builtin.IO.html#138" class="Postulate">IO</a> <a id="12301" class="Symbol">(</a><a id="12302" href="Utils.html#904" class="Datatype">Either</a> <a id="12309" href="Main.html#5309" class="Datatype">ERROR</a> <a id="12315" href="Agda.Builtin.String.html#274" class="Postulate">String</a><a id="12321" class="Symbol">)</a>
<a id="12323" href="Main.html#12267" class="Function">evalInput</a> <a id="12333" href="Main.html#12333" class="Bound">m</a> <a id="12335" class="Symbol">(</a><a id="12336" href="Main.html#11678" class="InductiveConstructor">FileInput</a> <a id="12346" href="Main.html#12346" class="Bound">fn</a><a id="12348" class="Symbol">)</a> <a id="12350" class="Symbol">=</a> <a id="12352" href="Utils.html#3433" class="Function">fmap</a> <a id="12357" class="Symbol">(</a><a id="12358" href="Main.html#8428" class="Function">evalByteString</a> <a id="12373" href="Main.html#12333" class="Bound">m</a><a id="12374" class="Symbol">)</a> <a id="12376" class="Symbol">(</a><a id="12377" href="Main.html#1593" class="Postulate">readFile</a> <a id="12386" href="Main.html#12346" class="Bound">fn</a><a id="12388" class="Symbol">)</a>
<a id="12390" href="Main.html#12267" class="Function">evalInput</a> <a id="12400" href="Main.html#12400" class="Bound">m</a> <a id="12402" href="Main.html#11707" class="InductiveConstructor">StdInput</a>       <a id="12417" class="Symbol">=</a> <a id="12419" href="Utils.html#3433" class="Function">fmap</a> <a id="12424" class="Symbol">(</a><a id="12425" href="Main.html#8428" class="Function">evalByteString</a> <a id="12440" href="Main.html#12400" class="Bound">m</a><a id="12441" class="Symbol">)</a> <a id="12443" href="Main.html#1563" class="Postulate">getContents</a>

<a id="tcInput"></a><a id="12456" href="Main.html#12456" class="Function">tcInput</a> <a id="12464" class="Symbol">:</a> <a id="12466" href="Main.html#11658" class="Datatype">Input</a> <a id="12472" class="Symbol">→</a> <a id="12474" href="Agda.Builtin.IO.html#138" class="Postulate">IO</a> <a id="12477" class="Symbol">(</a><a id="12478" href="Utils.html#904" class="Datatype">Either</a> <a id="12485" href="Main.html#5309" class="Datatype">ERROR</a> <a id="12491" href="Agda.Builtin.String.html#274" class="Postulate">String</a><a id="12497" class="Symbol">)</a>
<a id="12499" href="Main.html#12456" class="Function">tcInput</a> <a id="12507" class="Symbol">(</a><a id="12508" href="Main.html#11678" class="InductiveConstructor">FileInput</a> <a id="12518" href="Main.html#12518" class="Bound">fn</a><a id="12520" class="Symbol">)</a> <a id="12522" class="Symbol">=</a> <a id="12524" href="Utils.html#3433" class="Function">fmap</a> <a id="12529" href="Main.html#9288" class="Function">typeCheckByteString</a> <a id="12549" class="Symbol">(</a><a id="12550" href="Main.html#1593" class="Postulate">readFile</a> <a id="12559" href="Main.html#12518" class="Bound">fn</a><a id="12561" class="Symbol">)</a>
<a id="12563" href="Main.html#12456" class="Function">tcInput</a> <a id="12571" href="Main.html#11707" class="InductiveConstructor">StdInput</a>       <a id="12586" class="Symbol">=</a> <a id="12588" href="Utils.html#3433" class="Function">fmap</a> <a id="12593" href="Main.html#9288" class="Function">typeCheckByteString</a> <a id="12613" href="Main.html#1563" class="Postulate">getContents</a>


<a id="main&#39;"></a><a id="12627" href="Main.html#12627" class="Function">main&#39;</a> <a id="12633" class="Symbol">:</a> <a id="12635" href="Main.html#12044" class="Datatype">Command</a> <a id="12643" class="Symbol">→</a> <a id="12645" href="Agda.Builtin.IO.html#138" class="Postulate">IO</a> <a id="12648" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="12650" href="Main.html#12627" class="Function">main&#39;</a> <a id="12656" class="Symbol">(</a><a id="12657" href="Main.html#12066" class="InductiveConstructor">Evaluate</a> <a id="12666" class="Symbol">(</a><a id="12667" href="Main.html#11819" class="InductiveConstructor">EvalOpts</a> <a id="12676" href="Main.html#12676" class="Bound">i</a> <a id="12678" href="Main.html#12678" class="Bound">m</a><a id="12679" class="Symbol">))</a> <a id="12682" class="Symbol">=</a> <a id="12684" class="Keyword">do</a>
  <a id="12689" href="Utils.html#961" class="InductiveConstructor">inj₂</a> <a id="12694" href="Main.html#12694" class="Bound">s</a> <a id="12696" href="Utils.html#3321" class="Field Operator">←</a> <a id="12698" href="Main.html#12267" class="Function">evalInput</a> <a id="12708" href="Main.html#12678" class="Bound">m</a> <a id="12710" href="Main.html#12676" class="Bound">i</a>
    <a id="12716" class="Keyword">where</a>
    <a id="12726" href="Utils.html#937" class="InductiveConstructor">inj₁</a> <a id="12731" href="Main.html#12731" class="Bound">e</a> <a id="12733" class="Symbol">→</a> <a id="12735" href="Main.html#1221" class="Postulate">putStrLn</a> <a id="12744" class="Symbol">(</a><a id="12745" href="Main.html#6725" class="Function">reportError</a> <a id="12757" href="Main.html#12731" class="Bound">e</a><a id="12758" class="Symbol">)</a> <a id="12760" href="Utils.html#3369" class="Function Operator">&gt;&gt;</a> <a id="12763" href="Main.html#1895" class="Postulate">exitFailure</a>
  <a id="12777" href="Main.html#1221" class="Postulate">putStrLn</a> <a id="12786" href="Main.html#12694" class="Bound">s</a> <a id="12788" href="Utils.html#3369" class="Function Operator">&gt;&gt;</a> <a id="12791" href="Main.html#1916" class="Postulate">exitSuccess</a>
<a id="12803" href="Main.html#12627" class="Function">main&#39;</a> <a id="12809" class="Symbol">(</a><a id="12810" href="Main.html#12102" class="InductiveConstructor">TypeCheck</a> <a id="12820" class="Symbol">(</a><a id="12821" href="Main.html#11954" class="InductiveConstructor">TCOpts</a> <a id="12828" href="Main.html#12828" class="Bound">i</a><a id="12829" class="Symbol">))</a>    <a id="12835" class="Symbol">=</a> <a id="12837" class="Keyword">do</a>
  <a id="12842" href="Utils.html#961" class="InductiveConstructor">inj₂</a> <a id="12847" href="Main.html#12847" class="Bound">s</a> <a id="12849" href="Utils.html#3321" class="Field Operator">←</a> <a id="12851" href="Main.html#12456" class="Function">tcInput</a> <a id="12859" href="Main.html#12828" class="Bound">i</a>
    <a id="12865" class="Keyword">where</a>
    <a id="12875" href="Utils.html#937" class="InductiveConstructor">inj₁</a> <a id="12880" href="Main.html#12880" class="Bound">e</a> <a id="12882" class="Symbol">→</a> <a id="12884" href="Main.html#1221" class="Postulate">putStrLn</a> <a id="12893" class="Symbol">(</a><a id="12894" href="Main.html#6725" class="Function">reportError</a> <a id="12906" href="Main.html#12880" class="Bound">e</a><a id="12907" class="Symbol">)</a> <a id="12909" href="Utils.html#3369" class="Function Operator">&gt;&gt;</a> <a id="12912" href="Main.html#1895" class="Postulate">exitFailure</a>
  <a id="12926" href="Main.html#1221" class="Postulate">putStrLn</a> <a id="12935" href="Main.html#12847" class="Bound">s</a> <a id="12937" href="Utils.html#3369" class="Function Operator">&gt;&gt;</a> <a id="12940" href="Main.html#1916" class="Postulate">exitSuccess</a>

<a id="main"></a><a id="12953" href="Main.html#12953" class="Function">main</a> <a id="12958" class="Symbol">:</a> <a id="12960" href="Agda.Builtin.IO.html#138" class="Postulate">IO</a> <a id="12963" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="12965" href="Main.html#12953" class="Function">main</a> <a id="12970" class="Symbol">=</a> <a id="12972" href="Main.html#12212" class="Postulate">execP</a> <a id="12978" href="Utils.html#3321" class="Field Operator">&gt;&gt;=</a> <a id="12982" href="Main.html#12627" class="Function">main&#39;</a>

<a id="liftSum"></a><a id="12989" href="Main.html#12989" class="Function">liftSum</a> <a id="12997" class="Symbol">:</a> <a id="12999" class="Symbol">{</a><a id="13000" href="Main.html#13000" class="Bound">A</a> <a id="13002" class="Symbol">:</a> <a id="13004" class="PrimitiveType">Set</a><a id="13007" class="Symbol">}</a> <a id="13009" class="Symbol">→</a> <a id="13011" href="Utils.html#904" class="Datatype">Either</a> <a id="13018" href="Main.html#5309" class="Datatype">ERROR</a> <a id="13024" href="Main.html#13000" class="Bound">A</a> <a id="13026" class="Symbol">→</a> <a id="13028" href="Utils.html#486" class="Datatype">Maybe</a> <a id="13034" href="Main.html#13000" class="Bound">A</a>
<a id="13036" href="Main.html#12989" class="Function">liftSum</a> <a id="13044" class="Symbol">(</a><a id="13045" href="Utils.html#961" class="InductiveConstructor">inj₂</a> <a id="13050" href="Main.html#13050" class="Bound">a</a><a id="13051" class="Symbol">)</a> <a id="13053" class="Symbol">=</a> <a id="13055" href="Utils.html#516" class="InductiveConstructor">just</a> <a id="13060" href="Main.html#13050" class="Bound">a</a>
<a id="13062" href="Main.html#12989" class="Function">liftSum</a> <a id="13070" class="Symbol">(</a><a id="13071" href="Utils.html#937" class="InductiveConstructor">inj₁</a> <a id="13076" href="Main.html#13076" class="Bound">e</a><a id="13077" class="Symbol">)</a> <a id="13079" class="Symbol">=</a> <a id="13081" href="Utils.html#537" class="InductiveConstructor">nothing</a>


<a id="13091" class="Comment">-- a Haskell interface to the kindchecker:</a>
<a id="checkKindX"></a><a id="13134" href="Main.html#13134" class="Function">checkKindX</a> <a id="13145" class="Symbol">:</a> <a id="13147" href="Main.html#2444" class="Postulate">Type</a> <a id="13152" class="Symbol">→</a> <a id="13154" href="Type.html#572" class="Datatype">Kind</a> <a id="13159" class="Symbol">→</a> <a id="13161" href="Utils.html#904" class="Datatype">Either</a> <a id="13168" href="Main.html#5309" class="Datatype">ERROR</a> <a id="13174" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="13176" href="Main.html#13134" class="Function">checkKindX</a> <a id="13187" href="Main.html#13187" class="Bound">ty</a> <a id="13190" href="Main.html#13190" class="Bound">k</a> <a id="13192" class="Symbol">=</a> <a id="13194" class="Keyword">do</a>
  <a id="13199" href="Main.html#13199" class="Bound">ty</a>        <a id="13209" href="Utils.html#3321" class="Field Operator">←</a> <a id="13211" href="Utils.html#4084" class="Function">withE</a> <a id="13217" href="Main.html#5392" class="InductiveConstructor">scopeError</a> <a id="13228" class="Symbol">(</a><a id="13229" href="Scoped.html#8181" class="Function">scopeCheckTy</a> <a id="13242" class="Symbol">(</a><a id="13243" href="Scoped.html#4082" class="Function">shifterTy</a> <a id="13253" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="13255" class="Symbol">(</a><a id="13256" href="Main.html#2514" class="Postulate">convTy</a> <a id="13263" href="Main.html#13187" class="Bound">ty</a><a id="13265" class="Symbol">)))</a>
  <a id="13271" class="Symbol">(</a><a id="13272" href="Main.html#13272" class="Bound">k&#39;</a> <a id="13275" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="13278" class="Symbol">_)</a> <a id="13281" href="Utils.html#3321" class="Field Operator">←</a> <a id="13283" href="Utils.html#4084" class="Function">withE</a> <a id="13289" class="Symbol">(λ</a> <a id="13292" href="Main.html#13292" class="Bound">e</a> <a id="13294" class="Symbol">→</a> <a id="13296" href="Main.html#5329" class="InductiveConstructor">typeError</a> <a id="13306" class="Symbol">(</a><a id="13307" href="Main.html#5464" class="Function">uglyTypeError</a> <a id="13321" href="Main.html#13292" class="Bound">e</a><a id="13322" class="Symbol">))</a> <a id="13325" class="Symbol">(</a><a id="13326" href="Check.html#4385" class="Function">inferKind</a> <a id="13336" href="Type.html#977" class="InductiveConstructor">∅</a> <a id="13338" href="Main.html#13199" class="Bound">ty</a><a id="13340" class="Symbol">)</a>
  <a id="13344" class="Symbol">_</a>         <a id="13354" href="Utils.html#3321" class="Field Operator">←</a> <a id="13356" href="Utils.html#4084" class="Function">withE</a> <a id="13362" class="Symbol">((λ</a> <a id="13366" href="Main.html#13366" class="Bound">e</a> <a id="13368" class="Symbol">→</a> <a id="13370" href="Main.html#5329" class="InductiveConstructor">typeError</a> <a id="13380" class="Symbol">(</a><a id="13381" href="Main.html#5464" class="Function">uglyTypeError</a> <a id="13395" href="Main.html#13366" class="Bound">e</a><a id="13396" class="Symbol">))</a> <a id="13399" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="13401" href="Check.html#1129" class="InductiveConstructor">kindMismatch</a> <a id="13414" class="Symbol">_</a> <a id="13416" class="Symbol">_)</a> <a id="13419" class="Symbol">(</a><a id="13420" href="Check.html#1766" class="Function">meqKind</a> <a id="13428" href="Main.html#13190" class="Bound">k</a> <a id="13430" href="Main.html#13272" class="Bound">k&#39;</a><a id="13432" class="Symbol">)</a>
  <a id="13436" href="Utils.html#3293" class="Field">return</a> <a id="13443" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>

<a id="13447" class="Symbol">{-#</a> <a id="13451" class="Keyword">COMPILE</a> <a id="13459" class="Keyword">GHC</a> <a id="13463" href="Main.html#13134" class="Function">checkKindX</a> <a id="13474" class="Pragma">as</a> <a id="13477" class="Pragma">checkKindAgda</a> <a id="13491" class="Symbol">#-}</a>


<a id="13497" class="Comment">-- a Haskell interface to kind inference:</a>

<a id="inferKind∅"></a><a id="13540" href="Main.html#13540" class="Function">inferKind∅</a> <a id="13551" class="Symbol">:</a> <a id="13553" href="Main.html#2444" class="Postulate">Type</a> <a id="13558" class="Symbol">→</a> <a id="13560" href="Utils.html#904" class="Datatype">Either</a> <a id="13567" href="Main.html#5309" class="Datatype">ERROR</a> <a id="13573" href="Type.html#572" class="Datatype">Kind</a>
<a id="13578" href="Main.html#13540" class="Function">inferKind∅</a> <a id="13589" href="Main.html#13589" class="Bound">ty</a> <a id="13592" class="Symbol">=</a> <a id="13594" class="Keyword">do</a>
  <a id="13599" href="Main.html#13599" class="Bound">ty</a>       <a id="13608" href="Utils.html#3321" class="Field Operator">←</a> <a id="13610" href="Utils.html#4084" class="Function">withE</a> <a id="13616" href="Main.html#5392" class="InductiveConstructor">scopeError</a> <a id="13627" class="Symbol">(</a><a id="13628" href="Scoped.html#8181" class="Function">scopeCheckTy</a> <a id="13641" class="Symbol">(</a><a id="13642" href="Scoped.html#4082" class="Function">shifterTy</a> <a id="13652" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="13654" class="Symbol">(</a><a id="13655" href="Main.html#2514" class="Postulate">convTy</a> <a id="13662" href="Main.html#13589" class="Bound">ty</a><a id="13664" class="Symbol">)))</a>
  <a id="13670" class="Symbol">(</a><a id="13671" href="Main.html#13671" class="Bound">k</a> <a id="13673" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="13676" class="Symbol">_)</a> <a id="13679" href="Utils.html#3321" class="Field Operator">←</a> <a id="13681" href="Utils.html#4084" class="Function">withE</a> <a id="13687" class="Symbol">(λ</a> <a id="13690" href="Main.html#13690" class="Bound">e</a> <a id="13692" class="Symbol">→</a> <a id="13694" href="Main.html#5329" class="InductiveConstructor">typeError</a> <a id="13704" class="Symbol">(</a><a id="13705" href="Main.html#5464" class="Function">uglyTypeError</a> <a id="13719" href="Main.html#13690" class="Bound">e</a><a id="13720" class="Symbol">))</a> <a id="13723" class="Symbol">(</a><a id="13724" href="Check.html#4385" class="Function">inferKind</a> <a id="13734" href="Type.html#977" class="InductiveConstructor">∅</a> <a id="13736" href="Main.html#13599" class="Bound">ty</a><a id="13738" class="Symbol">)</a>
  <a id="13742" href="Utils.html#3293" class="Field">return</a> <a id="13749" href="Main.html#13671" class="Bound">k</a>

<a id="13752" class="Symbol">{-#</a> <a id="13756" class="Keyword">COMPILE</a> <a id="13764" class="Keyword">GHC</a> <a id="13768" href="Main.html#13540" class="Function">inferKind∅</a> <a id="13779" class="Pragma">as</a> <a id="13782" class="Pragma">inferKindAgda</a> <a id="13796" class="Symbol">#-}</a>

<a id="13801" class="Keyword">open</a> <a id="13806" class="Keyword">import</a> <a id="13813" href="Type.BetaNormal.html" class="Module">Type.BetaNormal</a>

<a id="13830" class="Comment">-- a Haskell interface to the type normalizer:</a>
<a id="normalizeType"></a><a id="13877" href="Main.html#13877" class="Function">normalizeType</a> <a id="13891" class="Symbol">:</a> <a id="13893" href="Main.html#2444" class="Postulate">Type</a> <a id="13898" class="Symbol">→</a> <a id="13900" href="Utils.html#904" class="Datatype">Either</a> <a id="13907" href="Main.html#5309" class="Datatype">ERROR</a> <a id="13913" href="Main.html#2444" class="Postulate">Type</a>
<a id="13918" href="Main.html#13877" class="Function">normalizeType</a> <a id="13932" href="Main.html#13932" class="Bound">ty</a> <a id="13935" class="Symbol">=</a> <a id="13937" class="Keyword">do</a>
  <a id="13942" href="Main.html#13942" class="Bound">ty&#39;</a>    <a id="13949" href="Utils.html#3321" class="Field Operator">←</a> <a id="13951" href="Utils.html#4084" class="Function">withE</a> <a id="13957" href="Main.html#5392" class="InductiveConstructor">scopeError</a> <a id="13968" class="Symbol">(</a><a id="13969" href="Scoped.html#8181" class="Function">scopeCheckTy</a> <a id="13982" class="Symbol">(</a><a id="13983" href="Scoped.html#4082" class="Function">shifterTy</a> <a id="13993" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="13995" class="Symbol">(</a><a id="13996" href="Main.html#2514" class="Postulate">convTy</a> <a id="14003" href="Main.html#13932" class="Bound">ty</a><a id="14005" class="Symbol">)))</a>
  <a id="14011" class="Symbol">_</a> <a id="14013" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="14016" href="Main.html#14016" class="Bound">n</a> <a id="14018" href="Utils.html#3321" class="Field Operator">←</a> <a id="14020" href="Utils.html#4084" class="Function">withE</a> <a id="14026" class="Symbol">(λ</a> <a id="14029" href="Main.html#14029" class="Bound">e</a> <a id="14031" class="Symbol">→</a> <a id="14033" href="Main.html#5329" class="InductiveConstructor">typeError</a> <a id="14043" class="Symbol">(</a><a id="14044" href="Main.html#5464" class="Function">uglyTypeError</a> <a id="14058" href="Main.html#14029" class="Bound">e</a><a id="14059" class="Symbol">))</a> <a id="14062" class="Symbol">(</a><a id="14063" href="Check.html#4385" class="Function">inferKind</a> <a id="14073" href="Type.html#977" class="InductiveConstructor">∅</a> <a id="14075" href="Main.html#13942" class="Bound">ty&#39;</a><a id="14078" class="Symbol">)</a>
  <a id="14082" href="Utils.html#3293" class="Field">return</a> <a id="14089" class="Symbol">(</a><a id="14090" href="Main.html#2538" class="Postulate">unconvTy</a> <a id="14099" class="Symbol">(</a><a id="14100" href="Scoped.html#5021" class="Function">unshifterTy</a> <a id="14112" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="14114" class="Symbol">(</a><a id="14115" href="Scoped.html#10165" class="Function">extricateScopeTy</a> <a id="14132" class="Symbol">(</a><a id="14133" href="Scoped.Extrication.html#876" class="Function">extricateNf⋆</a> <a id="14146" href="Main.html#14016" class="Bound">n</a><a id="14147" class="Symbol">))))</a>

<a id="14153" class="Symbol">{-#</a> <a id="14157" class="Keyword">COMPILE</a> <a id="14165" class="Keyword">GHC</a> <a id="14169" href="Main.html#13877" class="Function">normalizeType</a> <a id="14183" class="Pragma">as</a> <a id="14186" class="Pragma">normalizeTypeAgda</a> <a id="14204" class="Symbol">#-}</a>

<a id="14209" class="Comment">-- Haskell interface to type checker:</a>
<a id="inferType∅"></a><a id="14247" href="Main.html#14247" class="Function">inferType∅</a> <a id="14258" class="Symbol">:</a> <a id="14260" href="Main.html#2399" class="Postulate">Term</a> <a id="14265" class="Symbol">→</a> <a id="14267" href="Utils.html#904" class="Datatype">Either</a> <a id="14274" href="Main.html#5309" class="Datatype">ERROR</a> <a id="14280" href="Main.html#2444" class="Postulate">Type</a>
<a id="14285" href="Main.html#14247" class="Function">inferType∅</a> <a id="14296" href="Main.html#14296" class="Bound">t</a> <a id="14298" class="Symbol">=</a> <a id="14300" class="Keyword">do</a>
  <a id="14305" href="Main.html#14305" class="Bound">t&#39;</a> <a id="14308" href="Utils.html#3321" class="Field Operator">←</a> <a id="14310" href="Utils.html#4084" class="Function">withE</a> <a id="14316" href="Main.html#5392" class="InductiveConstructor">scopeError</a> <a id="14327" class="Symbol">(</a><a id="14328" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="14341" class="Symbol">{</a><a id="14342" class="Number">0</a><a id="14343" class="Symbol">}{</a><a id="14345" href="Scoped.html#1963" class="InductiveConstructor">Z</a><a id="14346" class="Symbol">}</a> <a id="14348" class="Symbol">(</a><a id="14349" href="Scoped.html#4478" class="Function">shifter</a> <a id="14357" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="14359" class="Symbol">(</a><a id="14360" href="Main.html#2490" class="Postulate">convTm</a> <a id="14367" href="Main.html#14296" class="Bound">t</a><a id="14368" class="Symbol">)))</a>
  <a id="14374" href="Main.html#14374" class="Bound">ty</a> <a id="14377" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="14380" class="Symbol">_</a> <a id="14382" href="Utils.html#3321" class="Field Operator">←</a> <a id="14384" href="Utils.html#4084" class="Function">withE</a> <a id="14390" class="Symbol">(λ</a> <a id="14393" href="Main.html#14393" class="Bound">e</a> <a id="14395" class="Symbol">→</a> <a id="14397" href="Main.html#5329" class="InductiveConstructor">typeError</a> <a id="14407" class="Symbol">(</a><a id="14408" href="Main.html#5464" class="Function">uglyTypeError</a> <a id="14422" href="Main.html#14393" class="Bound">e</a><a id="14423" class="Symbol">))</a> <a id="14426" class="Symbol">(</a><a id="14427" href="Check.html#10572" class="Function">inferType</a> <a id="14437" href="Algorithmic.html#1249" class="InductiveConstructor">∅</a> <a id="14439" href="Main.html#14305" class="Bound">t&#39;</a><a id="14441" class="Symbol">)</a>
  <a id="14445" href="Utils.html#3293" class="Field">return</a> <a id="14452" class="Symbol">(</a><a id="14453" href="Main.html#2538" class="Postulate">unconvTy</a> <a id="14462" class="Symbol">(</a><a id="14463" href="Scoped.html#5021" class="Function">unshifterTy</a> <a id="14475" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="14477" class="Symbol">(</a><a id="14478" href="Scoped.html#10165" class="Function">extricateScopeTy</a> <a id="14495" class="Symbol">(</a><a id="14496" href="Scoped.Extrication.html#876" class="Function">extricateNf⋆</a> <a id="14509" href="Main.html#14374" class="Bound">ty</a><a id="14511" class="Symbol">))))</a>

<a id="14517" class="Symbol">{-#</a> <a id="14521" class="Keyword">COMPILE</a> <a id="14529" class="Keyword">GHC</a> <a id="14533" href="Main.html#14247" class="Function">inferType∅</a> <a id="14544" class="Pragma">as</a> <a id="14547" class="Pragma">inferTypeAgda</a> <a id="14561" class="Symbol">#-}</a>


<a id="14567" class="Comment">-- FIXME: we have a checkType function now...</a>
<a id="checkType∅"></a><a id="14613" href="Main.html#14613" class="Function">checkType∅</a> <a id="14624" class="Symbol">:</a> <a id="14626" href="Main.html#2444" class="Postulate">Type</a> <a id="14631" class="Symbol">→</a> <a id="14633" href="Main.html#2399" class="Postulate">Term</a> <a id="14638" class="Symbol">→</a> <a id="14640" href="Utils.html#904" class="Datatype">Either</a> <a id="14647" href="Main.html#5309" class="Datatype">ERROR</a> <a id="14653" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="14655" href="Main.html#14613" class="Function">checkType∅</a> <a id="14666" href="Main.html#14666" class="Bound">ty</a> <a id="14669" href="Main.html#14669" class="Bound">t</a> <a id="14671" class="Symbol">=</a> <a id="14673" class="Keyword">do</a>
  <a id="14678" href="Main.html#14678" class="Bound">ty&#39;</a> <a id="14682" href="Utils.html#3321" class="Field Operator">←</a> <a id="14684" href="Utils.html#4084" class="Function">withE</a> <a id="14690" href="Main.html#5392" class="InductiveConstructor">scopeError</a> <a id="14701" class="Symbol">(</a><a id="14702" href="Scoped.html#8181" class="Function">scopeCheckTy</a> <a id="14715" class="Symbol">(</a><a id="14716" href="Scoped.html#4082" class="Function">shifterTy</a> <a id="14726" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="14728" class="Symbol">(</a><a id="14729" href="Main.html#2514" class="Postulate">convTy</a> <a id="14736" href="Main.html#14666" class="Bound">ty</a><a id="14738" class="Symbol">)))</a>
  <a id="14744" href="Main.html#14744" class="Bound">tyN</a> <a id="14748" href="Utils.html#3321" class="Field Operator">←</a> <a id="14750" href="Utils.html#4084" class="Function">withE</a> <a id="14756" class="Symbol">(λ</a> <a id="14759" href="Main.html#14759" class="Bound">e</a> <a id="14761" class="Symbol">→</a> <a id="14763" href="Main.html#5329" class="InductiveConstructor">typeError</a> <a id="14773" class="Symbol">(</a><a id="14774" href="Main.html#5464" class="Function">uglyTypeError</a> <a id="14788" href="Main.html#14759" class="Bound">e</a><a id="14789" class="Symbol">))</a> <a id="14792" class="Symbol">(</a><a id="14793" href="Check.html#4309" class="Function">checkKind</a> <a id="14803" href="Type.html#977" class="InductiveConstructor">∅</a> <a id="14805" href="Main.html#14678" class="Bound">ty&#39;</a> <a id="14809" href="Type.html#591" class="InductiveConstructor">*</a><a id="14810" class="Symbol">)</a>
  <a id="14814" href="Main.html#14814" class="Bound">t&#39;</a>  <a id="14818" href="Utils.html#3321" class="Field Operator">←</a> <a id="14820" href="Utils.html#4084" class="Function">withE</a> <a id="14826" href="Main.html#5392" class="InductiveConstructor">scopeError</a> <a id="14837" class="Symbol">(</a><a id="14838" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="14851" class="Symbol">{</a><a id="14852" class="Number">0</a><a id="14853" class="Symbol">}{</a><a id="14855" href="Scoped.html#1963" class="InductiveConstructor">Z</a><a id="14856" class="Symbol">}</a> <a id="14858" class="Symbol">(</a><a id="14859" href="Scoped.html#4478" class="Function">shifter</a> <a id="14867" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="14869" class="Symbol">(</a><a id="14870" href="Main.html#2490" class="Postulate">convTm</a> <a id="14877" href="Main.html#14669" class="Bound">t</a><a id="14878" class="Symbol">)))</a>
  <a id="14884" href="Utils.html#4084" class="Function">withE</a> <a id="14890" class="Symbol">(λ</a> <a id="14893" href="Main.html#14893" class="Bound">e</a> <a id="14895" class="Symbol">→</a> <a id="14897" href="Main.html#5329" class="InductiveConstructor">typeError</a> <a id="14907" class="Symbol">(</a><a id="14908" href="Main.html#5464" class="Function">uglyTypeError</a> <a id="14922" href="Main.html#14893" class="Bound">e</a><a id="14923" class="Symbol">))</a> <a id="14926" class="Symbol">(</a><a id="14927" href="Check.html#10478" class="Function">checkType</a> <a id="14937" href="Algorithmic.html#1249" class="InductiveConstructor">∅</a> <a id="14939" href="Main.html#14814" class="Bound">t&#39;</a> <a id="14942" href="Main.html#14744" class="Bound">tyN</a><a id="14945" class="Symbol">)</a>
<a id="14947" class="Comment">{-
  tyN&#39; ,, tmC ← withE (λ e → typeError (uglyTypeError e)) (inferType ∅ t&#39;)
  refl      ← withE ((λ e → typeError (uglyTypeError e)) ∘ kindMismatch _ _) (meqKind k *)
  refl      ← withE ((λ e → typeError (uglyTypeError e)) ∘ typeMismatch _ _) (meqNfTy tyN tyN&#39;)
-}</a>
  <a id="15217" href="Utils.html#3293" class="Field">return</a> <a id="15224" class="Symbol">_</a>

<a id="15227" class="Comment">-- Haskell interface to type normalizer (for terms)</a>
<a id="15279" class="Comment">-- the type checker/inferer could also return such a term</a>
<a id="normalizeTypeTerm"></a><a id="15337" href="Main.html#15337" class="Function">normalizeTypeTerm</a> <a id="15355" class="Symbol">:</a> <a id="15357" href="Main.html#2399" class="Postulate">Term</a> <a id="15362" class="Symbol">→</a> <a id="15364" href="Utils.html#904" class="Datatype">Either</a> <a id="15371" href="Main.html#5309" class="Datatype">ERROR</a> <a id="15377" href="Main.html#2399" class="Postulate">Term</a>
<a id="15382" href="Main.html#15337" class="Function">normalizeTypeTerm</a> <a id="15400" href="Main.html#15400" class="Bound">t</a> <a id="15402" class="Symbol">=</a> <a id="15404" class="Keyword">do</a>
  <a id="15409" href="Main.html#15409" class="Bound">tDB</a> <a id="15413" href="Utils.html#3321" class="Field Operator">←</a> <a id="15415" href="Utils.html#4084" class="Function">withE</a> <a id="15421" href="Main.html#5392" class="InductiveConstructor">scopeError</a> <a id="15432" class="Symbol">(</a><a id="15433" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="15446" class="Symbol">{</a><a id="15447" class="Number">0</a><a id="15448" class="Symbol">}{</a><a id="15450" href="Scoped.html#1963" class="InductiveConstructor">Z</a><a id="15451" class="Symbol">}</a> <a id="15453" class="Symbol">(</a><a id="15454" href="Scoped.html#4478" class="Function">shifter</a> <a id="15462" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="15464" class="Symbol">(</a><a id="15465" href="Main.html#2490" class="Postulate">convTm</a> <a id="15472" href="Main.html#15400" class="Bound">t</a><a id="15473" class="Symbol">)))</a>
  <a id="15479" class="Symbol">_</a> <a id="15481" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="15484" href="Main.html#15484" class="Bound">tC</a> <a id="15487" href="Utils.html#3321" class="Field Operator">←</a> <a id="15489" href="Utils.html#4084" class="Function">withE</a> <a id="15495" class="Symbol">(λ</a> <a id="15498" href="Main.html#15498" class="Bound">e</a> <a id="15500" class="Symbol">→</a> <a id="15502" href="Main.html#5329" class="InductiveConstructor">typeError</a> <a id="15512" class="Symbol">(</a><a id="15513" href="Main.html#5464" class="Function">uglyTypeError</a> <a id="15527" href="Main.html#15498" class="Bound">e</a><a id="15528" class="Symbol">))</a> <a id="15531" class="Symbol">(</a><a id="15532" href="Check.html#10572" class="Function">inferType</a> <a id="15542" href="Algorithmic.html#1249" class="InductiveConstructor">∅</a> <a id="15544" href="Main.html#15409" class="Bound">tDB</a><a id="15547" class="Symbol">)</a>
  <a id="15551" href="Utils.html#3293" class="Field">return</a> <a id="15558" class="Symbol">(</a><a id="15559" href="Main.html#2564" class="Postulate">unconvTm</a> <a id="15568" class="Symbol">(</a><a id="15569" href="Scoped.html#5468" class="Function">unshifter</a> <a id="15579" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="15581" class="Symbol">(</a><a id="15582" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="15597" class="Symbol">(</a><a id="15598" href="Scoped.Extrication.html#3921" class="Function">extricate</a> <a id="15608" href="Main.html#15484" class="Bound">tC</a><a id="15610" class="Symbol">))))</a>

<a id="15616" class="Symbol">{-#</a> <a id="15620" class="Keyword">COMPILE</a> <a id="15628" class="Keyword">GHC</a> <a id="15632" href="Main.html#15337" class="Function">normalizeTypeTerm</a> <a id="15650" class="Pragma">as</a> <a id="15653" class="Pragma">normalizeTypeTermAgda</a> <a id="15675" class="Symbol">#-}</a>


<a id="15681" class="Symbol">{-#</a> <a id="15685" class="Keyword">COMPILE</a> <a id="15693" class="Keyword">GHC</a> <a id="15697" href="Main.html#14613" class="Function">checkType∅</a> <a id="15708" class="Pragma">as</a> <a id="15711" class="Pragma">checkTypeAgda</a> <a id="15725" class="Symbol">#-}</a>

<a id="15730" class="Comment">-- Haskell interface to (typechecked and proven correct) reduction</a>

<a id="15798" class="Keyword">import</a> <a id="15805" href="Algorithmic.Evaluation.html" class="Module">Algorithmic.Evaluation</a> <a id="15828" class="Symbol">as</a> <a id="15831" class="Module">L</a>

<a id="runTL"></a><a id="15834" href="Main.html#15834" class="Function">runTL</a> <a id="15840" class="Symbol">:</a> <a id="15842" href="Main.html#2399" class="Postulate">Term</a> <a id="15847" class="Symbol">→</a> <a id="15849" href="Utils.html#904" class="Datatype">Either</a> <a id="15856" href="Main.html#5309" class="Datatype">ERROR</a> <a id="15862" href="Main.html#2399" class="Postulate">Term</a>
<a id="15867" href="Main.html#15834" class="Function">runTL</a> <a id="15873" href="Main.html#15873" class="Bound">t</a> <a id="15875" class="Symbol">=</a> <a id="15877" class="Keyword">do</a>
  <a id="15882" href="Main.html#15882" class="Bound">tDB</a> <a id="15886" href="Utils.html#3321" class="Field Operator">←</a> <a id="15888" href="Utils.html#4084" class="Function">withE</a> <a id="15894" href="Main.html#5392" class="InductiveConstructor">scopeError</a> <a id="15905" class="Symbol">(</a><a id="15906" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="15919" class="Symbol">{</a><a id="15920" class="Number">0</a><a id="15921" class="Symbol">}{</a><a id="15923" href="Scoped.html#1963" class="InductiveConstructor">Z</a><a id="15924" class="Symbol">}</a> <a id="15926" class="Symbol">(</a><a id="15927" href="Scoped.html#4478" class="Function">shifter</a> <a id="15935" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="15937" class="Symbol">(</a><a id="15938" href="Main.html#2490" class="Postulate">convTm</a> <a id="15945" href="Main.html#15873" class="Bound">t</a><a id="15946" class="Symbol">)))</a>
  <a id="15952" class="Symbol">_</a> <a id="15954" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="15957" href="Main.html#15957" class="Bound">tC</a> <a id="15960" href="Utils.html#3321" class="Field Operator">←</a> <a id="15962" href="Utils.html#4084" class="Function">withE</a> <a id="15968" class="Symbol">(λ</a> <a id="15971" href="Main.html#15971" class="Bound">e</a> <a id="15973" class="Symbol">→</a> <a id="15975" href="Main.html#5329" class="InductiveConstructor">typeError</a> <a id="15985" class="Symbol">(</a><a id="15986" href="Main.html#5464" class="Function">uglyTypeError</a> <a id="16000" href="Main.html#15971" class="Bound">e</a><a id="16001" class="Symbol">))</a> <a id="16004" class="Symbol">(</a><a id="16005" href="Check.html#10572" class="Function">inferType</a> <a id="16015" href="Algorithmic.html#1249" class="InductiveConstructor">∅</a> <a id="16017" href="Main.html#15882" class="Bound">tDB</a><a id="16020" class="Symbol">)</a>
  <a id="16024" href="Main.html#16024" class="Bound">t</a> <a id="16026" href="Utils.html#3321" class="Field Operator">←</a> <a id="16028" href="Utils.html#4084" class="Function">withE</a> <a id="16034" href="Main.html#5426" class="InductiveConstructor">runtimeError</a> <a id="16047" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="16049" href="Algorithmic.Evaluation.html#1779" class="Function">L.stepper</a> <a id="16059" href="Main.html#15957" class="Bound">tC</a> <a id="16062" href="Main.html#6676" class="Function">maxsteps</a>
  <a id="16073" href="Utils.html#3293" class="Field">return</a> <a id="16080" class="Symbol">(</a><a id="16081" href="Main.html#2564" class="Postulate">unconvTm</a> <a id="16090" class="Symbol">(</a><a id="16091" href="Scoped.html#5468" class="Function">unshifter</a> <a id="16101" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="16103" class="Symbol">(</a><a id="16104" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="16119" class="Symbol">(</a><a id="16120" href="Scoped.Extrication.html#3921" class="Function">extricate</a> <a id="16130" href="Main.html#16024" class="Bound">t</a><a id="16131" class="Symbol">))))</a>

<a id="16137" class="Symbol">{-#</a> <a id="16141" class="Keyword">COMPILE</a> <a id="16149" class="Keyword">GHC</a> <a id="16153" href="Main.html#15834" class="Function">runTL</a> <a id="16159" class="Pragma">as</a> <a id="16162" class="Pragma">runTLAgda</a> <a id="16172" class="Symbol">#-}</a>

<a id="16177" class="Comment">-- Haskell interface to (untypechecked CK)</a>
<a id="runCK"></a><a id="16220" href="Main.html#16220" class="Function">runCK</a> <a id="16226" class="Symbol">:</a> <a id="16228" href="Main.html#2399" class="Postulate">Term</a> <a id="16233" class="Symbol">→</a> <a id="16235" href="Utils.html#904" class="Datatype">Either</a> <a id="16242" href="Main.html#5309" class="Datatype">ERROR</a> <a id="16248" href="Main.html#2399" class="Postulate">Term</a>
<a id="16253" href="Main.html#16220" class="Function">runCK</a> <a id="16259" href="Main.html#16259" class="Bound">t</a> <a id="16261" class="Symbol">=</a> <a id="16263" class="Keyword">do</a>
  <a id="16268" href="Main.html#16268" class="Bound">tDB</a> <a id="16272" href="Utils.html#3321" class="Field Operator">←</a> <a id="16274" href="Utils.html#4084" class="Function">withE</a> <a id="16280" href="Main.html#5392" class="InductiveConstructor">scopeError</a> <a id="16291" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="16293" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="16306" class="Symbol">{</a><a id="16307" class="Number">0</a><a id="16308" class="Symbol">}{</a><a id="16310" href="Scoped.html#1963" class="InductiveConstructor">Z</a><a id="16311" class="Symbol">}</a> <a id="16313" class="Symbol">(</a><a id="16314" href="Scoped.html#4478" class="Function">shifter</a> <a id="16322" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="16324" class="Symbol">(</a><a id="16325" href="Main.html#2490" class="Postulate">convTm</a> <a id="16332" href="Main.html#16259" class="Bound">t</a><a id="16333" class="Symbol">))</a>
  <a id="16338" href="Scoped.CK.html#1061" class="InductiveConstructor">□</a> <a id="16340" href="Main.html#16340" class="Bound">V</a> <a id="16342" href="Utils.html#3321" class="Field Operator">←</a> <a id="16344" href="Utils.html#4084" class="Function">withE</a> <a id="16350" href="Main.html#5426" class="InductiveConstructor">runtimeError</a> <a id="16363" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="16365" href="Scoped.CK.html#3273" class="Function">Scoped.CK.stepper</a> <a id="16383" href="Main.html#6676" class="Function">maxsteps</a> <a id="16392" class="Symbol">(</a><a id="16393" href="Scoped.CK.html#907" class="InductiveConstructor">ε</a> <a id="16395" href="Scoped.CK.html#975" class="InductiveConstructor Operator">▻</a> <a id="16397" href="Main.html#16268" class="Bound">tDB</a><a id="16400" class="Symbol">)</a>
    <a id="16406" class="Keyword">where</a> <a id="16412" class="Symbol">(_</a> <a id="16415" href="Scoped.CK.html#975" class="InductiveConstructor Operator">▻</a> <a id="16417" class="Symbol">_)</a> <a id="16420" class="Symbol">→</a> <a id="16422" href="Utils.html#937" class="InductiveConstructor">inj₁</a> <a id="16427" class="Symbol">(</a><a id="16428" href="Main.html#5426" class="InductiveConstructor">runtimeError</a> <a id="16441" href="Utils.html#4263" class="InductiveConstructor">gasError</a><a id="16449" class="Symbol">)</a>
          <a id="16461" class="Symbol">(_</a> <a id="16464" href="Scoped.CK.html#1010" class="InductiveConstructor Operator">◅</a> <a id="16466" class="Symbol">_)</a> <a id="16469" class="Symbol">→</a> <a id="16471" href="Utils.html#937" class="InductiveConstructor">inj₁</a> <a id="16476" class="Symbol">(</a><a id="16477" href="Main.html#5426" class="InductiveConstructor">runtimeError</a> <a id="16490" href="Utils.html#4263" class="InductiveConstructor">gasError</a><a id="16498" class="Symbol">)</a>
          <a id="16510" href="Scoped.CK.html#1105" class="InductiveConstructor">◆</a> <a id="16512" class="Symbol">→</a> <a id="16514" href="Utils.html#3293" class="Field">return</a> <a id="16521" class="Symbol">(</a><a id="16522" href="Main.html#2564" class="Postulate">unconvTm</a> <a id="16531" class="Symbol">(</a><a id="16532" href="Scoped.html#5468" class="Function">unshifter</a> <a id="16542" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="16544" class="Symbol">(</a><a id="16545" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="16560" class="Symbol">{</a><a id="16561" class="Number">0</a><a id="16562" class="Symbol">}{</a><a id="16564" href="Scoped.html#1963" class="InductiveConstructor">Z</a><a id="16565" class="Symbol">}</a> <a id="16567" class="Symbol">(</a><a id="16568" href="Scoped.html#6607" class="InductiveConstructor">error</a> <a id="16574" href="Scoped.html#1704" class="InductiveConstructor">missing</a><a id="16581" class="Symbol">))))</a> <a id="16586" class="Comment">-- NOTE: we could use the typechecker to get the correct type</a>
  <a id="16650" href="Utils.html#3293" class="Field">return</a> <a id="16657" class="Symbol">(</a><a id="16658" href="Main.html#2564" class="Postulate">unconvTm</a> <a id="16667" class="Symbol">(</a><a id="16668" href="Scoped.html#5468" class="Function">unshifter</a> <a id="16678" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="16680" class="Symbol">(</a><a id="16681" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="16696" class="Symbol">(</a><a id="16697" href="Scoped.CK.html#3174" class="Function">Scoped.CK.discharge</a> <a id="16717" href="Main.html#16340" class="Bound">V</a><a id="16718" class="Symbol">))))</a>

<a id="16724" class="Symbol">{-#</a> <a id="16728" class="Keyword">COMPILE</a> <a id="16736" class="Keyword">GHC</a> <a id="16740" href="Main.html#16220" class="Function">runCK</a> <a id="16746" class="Pragma">as</a> <a id="16749" class="Pragma">runCKAgda</a> <a id="16759" class="Symbol">#-}</a>

<a id="16764" class="Comment">-- Haskell interface to (typechecked) CK</a>
<a id="runTCK"></a><a id="16805" href="Main.html#16805" class="Function">runTCK</a> <a id="16812" class="Symbol">:</a> <a id="16814" href="Main.html#2399" class="Postulate">Term</a> <a id="16819" class="Symbol">→</a> <a id="16821" href="Utils.html#904" class="Datatype">Either</a> <a id="16828" href="Main.html#5309" class="Datatype">ERROR</a> <a id="16834" href="Main.html#2399" class="Postulate">Term</a>
<a id="16839" href="Main.html#16805" class="Function">runTCK</a> <a id="16846" href="Main.html#16846" class="Bound">t</a> <a id="16848" class="Symbol">=</a> <a id="16850" class="Keyword">do</a>
  <a id="16855" href="Main.html#16855" class="Bound">tDB</a> <a id="16859" href="Utils.html#3321" class="Field Operator">←</a> <a id="16861" href="Utils.html#4084" class="Function">withE</a> <a id="16867" href="Main.html#5392" class="InductiveConstructor">scopeError</a> <a id="16878" class="Symbol">(</a><a id="16879" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="16892" class="Symbol">{</a><a id="16893" class="Number">0</a><a id="16894" class="Symbol">}{</a><a id="16896" href="Scoped.html#1963" class="InductiveConstructor">Z</a><a id="16897" class="Symbol">}</a> <a id="16899" class="Symbol">(</a><a id="16900" href="Scoped.html#4478" class="Function">shifter</a> <a id="16908" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="16910" class="Symbol">(</a><a id="16911" href="Main.html#2490" class="Postulate">convTm</a> <a id="16918" href="Main.html#16846" class="Bound">t</a><a id="16919" class="Symbol">)))</a>
  <a id="16925" class="Symbol">_</a> <a id="16927" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="16930" href="Main.html#16930" class="Bound">tC</a> <a id="16933" href="Utils.html#3321" class="Field Operator">←</a> <a id="16935" href="Utils.html#4084" class="Function">withE</a> <a id="16941" class="Symbol">(λ</a> <a id="16944" href="Main.html#16944" class="Bound">e</a> <a id="16946" class="Symbol">→</a> <a id="16948" href="Main.html#5329" class="InductiveConstructor">typeError</a> <a id="16958" class="Symbol">(</a><a id="16959" href="Main.html#5464" class="Function">uglyTypeError</a> <a id="16973" href="Main.html#16944" class="Bound">e</a><a id="16974" class="Symbol">))</a> <a id="16977" class="Symbol">(</a><a id="16978" href="Check.html#10572" class="Function">inferType</a> <a id="16988" href="Algorithmic.html#1249" class="InductiveConstructor">∅</a> <a id="16990" href="Main.html#16855" class="Bound">tDB</a><a id="16993" class="Symbol">)</a>
  <a id="16997" href="Algorithmic.CK.html#1840" class="InductiveConstructor">□</a> <a id="16999" href="Main.html#16999" class="Bound">V</a> <a id="17001" href="Utils.html#3321" class="Field Operator">←</a> <a id="17003" href="Utils.html#4084" class="Function">withE</a> <a id="17009" href="Main.html#5426" class="InductiveConstructor">runtimeError</a> <a id="17022" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="17024" href="Algorithmic.CK.html#4571" class="Function">Algorithmic.CK.stepper</a> <a id="17047" href="Main.html#6676" class="Function">maxsteps</a> <a id="17056" class="Symbol">(</a><a id="17057" href="Algorithmic.CK.html#1547" class="InductiveConstructor">ε</a> <a id="17059" href="Algorithmic.CK.html#1718" class="InductiveConstructor Operator">▻</a> <a id="17061" href="Main.html#16930" class="Bound">tC</a><a id="17063" class="Symbol">)</a>
    <a id="17069" class="Keyword">where</a> <a id="17075" class="Symbol">(_</a> <a id="17078" href="Algorithmic.CK.html#1718" class="InductiveConstructor Operator">▻</a> <a id="17080" class="Symbol">_)</a> <a id="17083" class="Symbol">→</a> <a id="17085" href="Utils.html#937" class="InductiveConstructor">inj₁</a> <a id="17090" class="Symbol">(</a><a id="17091" href="Main.html#5426" class="InductiveConstructor">runtimeError</a> <a id="17104" href="Utils.html#4263" class="InductiveConstructor">gasError</a><a id="17112" class="Symbol">)</a>
          <a id="17124" class="Symbol">(_</a> <a id="17127" href="Algorithmic.CK.html#1771" class="InductiveConstructor Operator">◅</a> <a id="17129" class="Symbol">_)</a> <a id="17132" class="Symbol">→</a> <a id="17134" href="Utils.html#937" class="InductiveConstructor">inj₁</a> <a id="17139" class="Symbol">(</a><a id="17140" href="Main.html#5426" class="InductiveConstructor">runtimeError</a> <a id="17153" href="Utils.html#4263" class="InductiveConstructor">gasError</a><a id="17161" class="Symbol">)</a>
          <a id="17173" href="Algorithmic.CK.html#1880" class="InductiveConstructor">◆</a> <a id="17175" href="Main.html#17175" class="Bound">A</a> <a id="17177" class="Symbol">→</a> <a id="17179" href="Utils.html#3293" class="Field">return</a> <a id="17186" class="Symbol">(</a><a id="17187" href="Main.html#2564" class="Postulate">unconvTm</a> <a id="17196" class="Symbol">(</a><a id="17197" href="Scoped.html#5468" class="Function">unshifter</a> <a id="17207" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="17209" class="Symbol">(</a><a id="17210" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="17225" class="Symbol">{</a><a id="17226" class="Number">0</a><a id="17227" class="Symbol">}{</a><a id="17229" href="Scoped.html#1963" class="InductiveConstructor">Z</a><a id="17230" class="Symbol">}</a> <a id="17232" class="Symbol">(</a><a id="17233" href="Scoped.html#6607" class="InductiveConstructor">error</a> <a id="17239" href="Scoped.html#1704" class="InductiveConstructor">missing</a><a id="17246" class="Symbol">))))</a> <a id="17251" class="Comment">-- NOTE: we could use the typechecker to get the correct type</a>
  <a id="17315" href="Utils.html#3293" class="Field">return</a> <a id="17322" class="Symbol">(</a><a id="17323" href="Main.html#2564" class="Postulate">unconvTm</a> <a id="17332" class="Symbol">(</a><a id="17333" href="Scoped.html#5468" class="Function">unshifter</a> <a id="17343" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="17345" class="Symbol">(</a><a id="17346" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="17361" class="Symbol">(</a><a id="17362" href="Scoped.Extrication.html#3921" class="Function">extricate</a> <a id="17372" class="Symbol">(</a><a id="17373" href="Algorithmic.CK.html#2656" class="Function">Algorithmic.CK.discharge</a> <a id="17398" href="Main.html#16999" class="Bound">V</a><a id="17399" class="Symbol">)))))</a>

<a id="17406" class="Symbol">{-#</a> <a id="17410" class="Keyword">COMPILE</a> <a id="17418" class="Keyword">GHC</a> <a id="17422" href="Main.html#16805" class="Function">runTCK</a> <a id="17429" class="Pragma">as</a> <a id="17432" class="Pragma">runTCKAgda</a> <a id="17443" class="Symbol">#-}</a>

<a id="17448" class="Comment">-- Haskell interface to (typechecked) CEKV</a>
<a id="runTCEK"></a><a id="17491" href="Main.html#17491" class="Function">runTCEK</a> <a id="17499" class="Symbol">:</a> <a id="17501" href="Main.html#2399" class="Postulate">Term</a> <a id="17506" class="Symbol">→</a> <a id="17508" href="Utils.html#904" class="Datatype">Either</a> <a id="17515" href="Main.html#5309" class="Datatype">ERROR</a> <a id="17521" href="Main.html#2399" class="Postulate">Term</a>
<a id="17526" href="Main.html#17491" class="Function">runTCEK</a> <a id="17534" href="Main.html#17534" class="Bound">t</a> <a id="17536" class="Symbol">=</a> <a id="17538" class="Keyword">do</a>
  <a id="17543" href="Main.html#17543" class="Bound">tDB</a> <a id="17547" href="Utils.html#3321" class="Field Operator">←</a> <a id="17549" href="Utils.html#4084" class="Function">withE</a> <a id="17555" href="Main.html#5392" class="InductiveConstructor">scopeError</a> <a id="17566" class="Symbol">(</a><a id="17567" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="17580" class="Symbol">{</a><a id="17581" class="Number">0</a><a id="17582" class="Symbol">}{</a><a id="17584" href="Scoped.html#1963" class="InductiveConstructor">Z</a><a id="17585" class="Symbol">}</a> <a id="17587" class="Symbol">(</a><a id="17588" href="Scoped.html#4478" class="Function">shifter</a> <a id="17596" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="17598" class="Symbol">(</a><a id="17599" href="Main.html#2490" class="Postulate">convTm</a> <a id="17606" href="Main.html#17534" class="Bound">t</a><a id="17607" class="Symbol">)))</a>
  <a id="17613" class="Symbol">_</a> <a id="17615" href="Main.html#464" class="InductiveConstructor Operator">,,</a> <a id="17618" href="Main.html#17618" class="Bound">tC</a> <a id="17621" href="Utils.html#3321" class="Field Operator">←</a> <a id="17623" href="Utils.html#4084" class="Function">withE</a> <a id="17629" class="Symbol">(λ</a> <a id="17632" href="Main.html#17632" class="Bound">e</a> <a id="17634" class="Symbol">→</a> <a id="17636" href="Main.html#5329" class="InductiveConstructor">typeError</a> <a id="17646" class="Symbol">(</a><a id="17647" href="Main.html#5464" class="Function">uglyTypeError</a> <a id="17661" href="Main.html#17632" class="Bound">e</a><a id="17662" class="Symbol">))</a> <a id="17665" class="Symbol">(</a><a id="17666" href="Check.html#10572" class="Function">inferType</a> <a id="17676" href="Algorithmic.html#1249" class="InductiveConstructor">∅</a> <a id="17678" href="Main.html#17543" class="Bound">tDB</a><a id="17681" class="Symbol">)</a>
  <a id="17685" href="Algorithmic.CEKV.html#8540" class="InductiveConstructor">□</a> <a id="17687" href="Main.html#17687" class="Bound">V</a> <a id="17689" href="Utils.html#3321" class="Field Operator">←</a> <a id="17691" href="Utils.html#4084" class="Function">withE</a> <a id="17697" href="Main.html#5426" class="InductiveConstructor">runtimeError</a> <a id="17710" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="17712" href="Algorithmic.CEKV.html#18786" class="Function">Algorithmic.CEKV.stepper</a> <a id="17737" href="Main.html#6676" class="Function">maxsteps</a> <a id="17746" class="Symbol">(</a><a id="17747" href="Algorithmic.CEKV.html#8304" class="InductiveConstructor">ε</a> <a id="17749" href="Algorithmic.CEKV.html#8418" class="InductiveConstructor Operator">;</a> <a id="17751" href="Algorithmic.CEKV.html#2752" class="InductiveConstructor">[]</a> <a id="17754" href="Algorithmic.CEKV.html#8418" class="InductiveConstructor Operator">▻</a> <a id="17756" href="Main.html#17618" class="Bound">tC</a><a id="17758" class="Symbol">)</a>
    <a id="17764" class="Keyword">where</a> <a id="17770" class="Symbol">(_</a> <a id="17773" href="Algorithmic.CEKV.html#8418" class="InductiveConstructor Operator">;</a> <a id="17775" class="Symbol">_</a> <a id="17777" href="Algorithmic.CEKV.html#8418" class="InductiveConstructor Operator">▻</a> <a id="17779" class="Symbol">_)</a> <a id="17782" class="Symbol">→</a> <a id="17784" href="Utils.html#937" class="InductiveConstructor">inj₁</a> <a id="17789" class="Symbol">(</a><a id="17790" href="Main.html#5426" class="InductiveConstructor">runtimeError</a> <a id="17803" href="Utils.html#4263" class="InductiveConstructor">gasError</a><a id="17811" class="Symbol">)</a>
          <a id="17823" class="Symbol">(_</a> <a id="17826" href="Algorithmic.CEKV.html#8485" class="InductiveConstructor Operator">◅</a> <a id="17828" class="Symbol">_)</a> <a id="17831" class="Symbol">→</a> <a id="17833" href="Utils.html#937" class="InductiveConstructor">inj₁</a> <a id="17838" class="Symbol">(</a><a id="17839" href="Main.html#5426" class="InductiveConstructor">runtimeError</a> <a id="17852" href="Utils.html#4263" class="InductiveConstructor">gasError</a><a id="17860" class="Symbol">)</a>
          <a id="17872" href="Algorithmic.CEKV.html#8568" class="InductiveConstructor">◆</a> <a id="17874" href="Main.html#17874" class="Bound">A</a> <a id="17876" class="Symbol">→</a> <a id="17878" href="Utils.html#3293" class="Field">return</a> <a id="17885" class="Symbol">(</a><a id="17886" href="Main.html#2564" class="Postulate">unconvTm</a> <a id="17895" class="Symbol">(</a><a id="17896" href="Scoped.html#5468" class="Function">unshifter</a> <a id="17906" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="17908" class="Symbol">(</a><a id="17909" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="17924" class="Symbol">{</a><a id="17925" class="Number">0</a><a id="17926" class="Symbol">}{</a><a id="17928" href="Scoped.html#1963" class="InductiveConstructor">Z</a><a id="17929" class="Symbol">}</a> <a id="17931" class="Symbol">(</a><a id="17932" href="Scoped.html#6607" class="InductiveConstructor">error</a> <a id="17938" href="Scoped.html#1704" class="InductiveConstructor">missing</a><a id="17945" class="Symbol">))))</a> <a id="17950" class="Comment">-- NOTE: we could use the typechecker to get the correct type</a>
  <a id="18014" href="Utils.html#3293" class="Field">return</a> <a id="18021" class="Symbol">(</a><a id="18022" href="Main.html#2564" class="Postulate">unconvTm</a> <a id="18031" class="Symbol">(</a><a id="18032" href="Scoped.html#5468" class="Function">unshifter</a> <a id="18042" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="18044" class="Symbol">(</a><a id="18045" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="18060" class="Symbol">(</a><a id="18061" href="Scoped.Extrication.html#3921" class="Function">extricate</a> <a id="18071" class="Symbol">(</a><a id="18072" href="Algorithmic.CEKV.html#3086" class="Function">Algorithmic.CEKV.discharge</a> <a id="18099" href="Main.html#17687" class="Bound">V</a><a id="18100" class="Symbol">)))))</a>

<a id="18107" class="Symbol">{-#</a> <a id="18111" class="Keyword">COMPILE</a> <a id="18119" class="Keyword">GHC</a> <a id="18123" href="Main.html#17491" class="Function">runTCEK</a> <a id="18131" class="Pragma">as</a> <a id="18134" class="Pragma">runTCEKAgda</a> <a id="18146" class="Symbol">#-}</a>
<a id="18150" class="Markup">\end{code}</a><a id="18160" class="Background">
</a></pre></body></html>