<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Main</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Markup">\begin{code}</a>
<a id="14" class="Keyword">module</a> <a id="21" href="Main.html" class="Module">Main</a> <a id="26" class="Keyword">where</a>
<a id="32" class="Keyword">open</a> <a id="37" class="Keyword">import</a> <a id="44" href="Agda.Builtin.IO.html" class="Module">Agda.Builtin.IO</a>
<a id="60" class="Keyword">open</a> <a id="65" class="Keyword">import</a> <a id="72" href="Agda.Builtin.Unit.html" class="Module">Agda.Builtin.Unit</a>
<a id="90" class="Keyword">open</a> <a id="95" class="Keyword">import</a> <a id="102" href="Agda.Builtin.String.html" class="Module">Agda.Builtin.String</a>

<a id="123" class="Keyword">postulate</a>
  <a id="putStrLn"></a><a id="135" href="Main.html#135" class="Postulate">putStrLn</a> <a id="144" class="Symbol">:</a> <a id="146" href="Agda.Builtin.String.html#206" class="Postulate">String</a> <a id="153" class="Symbol">→</a> <a id="155" href="Agda.Builtin.IO.html#111" class="Postulate">IO</a> <a id="158" href="Agda.Builtin.Unit.html#137" class="Record">⊤</a>

<a id="161" class="Symbol">{-#</a> <a id="165" class="Keyword">FOREIGN</a> <a id="173" class="Pragma">GHC</a> <a id="177" class="Pragma">import</a> <a id="184" class="Pragma">qualified</a> <a id="194" class="Pragma">Data.Text.IO</a> <a id="207" class="Pragma">as</a> <a id="210" class="Pragma">Text</a> <a id="215" class="Symbol">#-}</a>
<a id="219" class="Symbol">{-#</a> <a id="223" class="Keyword">FOREIGN</a> <a id="231" class="Pragma">GHC</a> <a id="235" class="Pragma">import</a> <a id="242" class="Pragma">qualified</a> <a id="252" class="Pragma">Data.Text</a> <a id="262" class="Pragma">as</a> <a id="265" class="Pragma">T</a> <a id="267" class="Symbol">#-}</a>
<a id="271" class="Symbol">{-#</a> <a id="275" class="Keyword">COMPILE</a> <a id="283" class="Pragma">GHC</a> <a id="287" href="Main.html#135" class="Postulate">putStrLn</a> <a id="296" class="Pragma">=</a> <a id="298" class="Pragma">Text.putStrLn</a> <a id="312" class="Symbol">#-}</a>

<a id="317" class="Keyword">open</a> <a id="322" class="Keyword">import</a> <a id="329" href="Type.html" class="Module">Type</a>
<a id="334" class="Keyword">open</a> <a id="339" class="Keyword">import</a> <a id="346" href="Builtin.html" class="Module">Builtin</a>
<a id="354" class="Keyword">open</a> <a id="359" class="Keyword">import</a> <a id="366" href="Builtin.Constant.Type.html" class="Module">Builtin.Constant.Type</a>
<a id="388" class="Keyword">open</a> <a id="393" class="Keyword">import</a> <a id="400" href="Builtin.Constant.Term.html" class="Module">Builtin.Constant.Term</a> <a id="422" href="Type.html#866" class="Datatype">Ctx⋆</a> <a id="427" href="Type.html#596" class="Datatype">Kind</a> <a id="432" href="Type.html#615" class="InductiveConstructor">*</a> <a id="434" href="Type.html#1945" class="Datatype Operator">_⊢⋆_</a> <a id="439" href="Type.html#2429" class="InductiveConstructor">con</a>
<a id="443" class="Keyword">open</a> <a id="448" class="Keyword">import</a> <a id="455" href="Builtin.Signature.html" class="Module">Builtin.Signature</a>

<a id="474" class="Keyword">open</a> <a id="479" class="Keyword">import</a> <a id="486" href="Agda.Builtin.TrustMe.html" class="Module">Agda.Builtin.TrustMe</a>
<a id="507" class="Keyword">open</a> <a id="512" class="Keyword">import</a> <a id="519" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>
<a id="557" class="Keyword">open</a> <a id="562" class="Keyword">import</a> <a id="569" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a>
<a id="586" class="Keyword">open</a> <a id="591" class="Keyword">import</a> <a id="598" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="607" class="Keyword">open</a> <a id="612" class="Keyword">import</a> <a id="619" href="Agda.Builtin.Int.html" class="Module">Agda.Builtin.Int</a>
<a id="636" class="Keyword">open</a> <a id="641" class="Keyword">import</a> <a id="648" href="Data.Integer.html" class="Module">Data.Integer</a>

<a id="662" class="Keyword">open</a> <a id="667" class="Keyword">import</a> <a id="674" href="Data.Product.html" class="Module">Data.Product</a> <a id="687" class="Keyword">renaming</a> <a id="696" class="Symbol">(</a><a id="697" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">_,_</a> <a id="701" class="Symbol">to</a> <a id="704" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">_,,_</a><a id="708" class="Symbol">)</a>
<a id="710" class="Keyword">open</a> <a id="715" class="Keyword">import</a> <a id="722" href="Data.Bool.html" class="Module">Data.Bool</a>

<a id="733" class="Keyword">open</a> <a id="738" href="Agda.Builtin.IO.html" class="Module">Agda.Builtin.IO</a>
<a id="754" class="Keyword">open</a> <a id="759" class="Keyword">import</a> <a id="766" href="Data.String.html" class="Module">Data.String</a>
<a id="778" class="Keyword">postulate</a>
  <a id="return"></a><a id="790" href="Main.html#790" class="Postulate">return</a> <a id="797" class="Symbol">:</a> <a id="799" class="Symbol">∀</a> <a id="801" class="Symbol">{</a><a id="802" href="Main.html#802" class="Bound">a</a><a id="803" class="Symbol">}</a> <a id="805" class="Symbol">{</a><a id="806" href="Main.html#806" class="Bound">A</a> <a id="808" class="Symbol">:</a> <a id="810" class="PrimitiveType">Set</a> <a id="814" href="Main.html#802" class="Bound">a</a><a id="815" class="Symbol">}</a> <a id="817" class="Symbol">→</a> <a id="819" href="Main.html#806" class="Bound">A</a> <a id="821" class="Symbol">→</a> <a id="823" href="Agda.Builtin.IO.html#111" class="Postulate">IO</a> <a id="826" href="Main.html#806" class="Bound">A</a>
  <a id="_&gt;&gt;=_"></a><a id="830" href="Main.html#830" class="Postulate Operator">_&gt;&gt;=_</a>  <a id="837" class="Symbol">:</a> <a id="839" class="Symbol">∀</a> <a id="841" class="Symbol">{</a><a id="842" href="Main.html#842" class="Bound">a</a> <a id="844" href="Main.html#844" class="Bound">b</a><a id="845" class="Symbol">}</a> <a id="847" class="Symbol">{</a><a id="848" href="Main.html#848" class="Bound">A</a> <a id="850" class="Symbol">:</a> <a id="852" class="PrimitiveType">Set</a> <a id="856" href="Main.html#842" class="Bound">a</a><a id="857" class="Symbol">}</a> <a id="859" class="Symbol">{</a><a id="860" href="Main.html#860" class="Bound">B</a> <a id="862" class="Symbol">:</a> <a id="864" class="PrimitiveType">Set</a> <a id="868" href="Main.html#844" class="Bound">b</a><a id="869" class="Symbol">}</a> <a id="871" class="Symbol">→</a> <a id="873" href="Agda.Builtin.IO.html#111" class="Postulate">IO</a> <a id="876" href="Main.html#848" class="Bound">A</a> <a id="878" class="Symbol">→</a> <a id="880" class="Symbol">(</a><a id="881" href="Main.html#848" class="Bound">A</a> <a id="883" class="Symbol">→</a> <a id="885" href="Agda.Builtin.IO.html#111" class="Postulate">IO</a> <a id="888" href="Main.html#860" class="Bound">B</a><a id="889" class="Symbol">)</a> <a id="891" class="Symbol">→</a> <a id="893" href="Agda.Builtin.IO.html#111" class="Postulate">IO</a> <a id="896" href="Main.html#860" class="Bound">B</a>

<a id="899" class="Symbol">{-#</a> <a id="903" class="Keyword">COMPILE</a> <a id="911" class="Pragma">GHC</a> <a id="915" href="Main.html#790" class="Postulate">return</a> <a id="922" class="Pragma">=</a> <a id="924" class="Pragma">\_</a> <a id="927" class="Pragma">_</a> <a id="929" class="Pragma">-&gt;</a> <a id="932" class="Pragma">return</a>    <a id="942" class="Symbol">#-}</a>
<a id="946" class="Symbol">{-#</a> <a id="950" class="Keyword">COMPILE</a> <a id="958" class="Pragma">GHC</a> <a id="962" href="Main.html#830" class="Postulate Operator">_&gt;&gt;=_</a>  <a id="969" class="Pragma">=</a> <a id="971" class="Pragma">\_</a> <a id="974" class="Pragma">_</a> <a id="976" class="Pragma">_</a> <a id="978" class="Pragma">_</a> <a id="980" class="Pragma">-&gt;</a> <a id="983" class="Pragma">(&gt;&gt;=)</a> <a id="989" class="Symbol">#-}</a>

<a id="_&gt;&gt;_"></a><a id="994" href="Main.html#994" class="Function Operator">_&gt;&gt;_</a>  <a id="1000" class="Symbol">:</a> <a id="1002" class="Symbol">∀</a> <a id="1004" class="Symbol">{</a><a id="1005" href="Main.html#1005" class="Bound">a</a> <a id="1007" href="Main.html#1007" class="Bound">b</a><a id="1008" class="Symbol">}</a> <a id="1010" class="Symbol">{</a><a id="1011" href="Main.html#1011" class="Bound">A</a> <a id="1013" class="Symbol">:</a> <a id="1015" class="PrimitiveType">Set</a> <a id="1019" href="Main.html#1005" class="Bound">a</a><a id="1020" class="Symbol">}</a> <a id="1022" class="Symbol">{</a><a id="1023" href="Main.html#1023" class="Bound">B</a> <a id="1025" class="Symbol">:</a> <a id="1027" class="PrimitiveType">Set</a> <a id="1031" href="Main.html#1007" class="Bound">b</a><a id="1032" class="Symbol">}</a> <a id="1034" class="Symbol">→</a> <a id="1036" href="Agda.Builtin.IO.html#111" class="Postulate">IO</a> <a id="1039" href="Main.html#1011" class="Bound">A</a> <a id="1041" class="Symbol">→</a> <a id="1043" href="Agda.Builtin.IO.html#111" class="Postulate">IO</a> <a id="1046" href="Main.html#1023" class="Bound">B</a> <a id="1048" class="Symbol">→</a> <a id="1050" href="Agda.Builtin.IO.html#111" class="Postulate">IO</a> <a id="1053" href="Main.html#1023" class="Bound">B</a>
<a id="1055" href="Main.html#1055" class="Bound">x</a> <a id="1057" href="Main.html#994" class="Function Operator">&gt;&gt;</a> <a id="1060" href="Main.html#1060" class="Bound">y</a> <a id="1062" class="Symbol">=</a> <a id="1064" href="Main.html#1055" class="Bound">x</a> <a id="1066" href="Main.html#830" class="Postulate Operator">&gt;&gt;=</a> <a id="1070" class="Symbol">λ</a> <a id="1072" href="Main.html#1072" class="Bound">_</a> <a id="1074" class="Symbol">→</a> <a id="1076" href="Main.html#1060" class="Bound">y</a>

<a id="1079" class="Keyword">open</a> <a id="1084" class="Keyword">import</a> <a id="1091" href="Raw.html" class="Module">Raw</a>
<a id="1095" class="Keyword">open</a> <a id="1100" class="Keyword">import</a> <a id="1107" href="Scoped.html" class="Module">Scoped</a>
<a id="1114" class="Keyword">open</a> <a id="1119" class="Keyword">import</a> <a id="1126" href="Utils.html" class="Module">Utils</a>

<a id="1133" class="Keyword">postulate</a>
  <a id="imap"></a><a id="1145" href="Main.html#1145" class="Postulate">imap</a> <a id="1150" class="Symbol">:</a> <a id="1152" class="Symbol">∀{</a><a id="1154" href="Main.html#1154" class="Bound">A</a> <a id="1156" href="Main.html#1156" class="Bound">B</a> <a id="1158" class="Symbol">:</a> <a id="1160" class="PrimitiveType">Set</a><a id="1163" class="Symbol">}</a> <a id="1165" class="Symbol">→</a> <a id="1167" class="Symbol">(</a><a id="1168" href="Main.html#1154" class="Bound">A</a> <a id="1170" class="Symbol">→</a> <a id="1172" href="Main.html#1156" class="Bound">B</a><a id="1173" class="Symbol">)</a> <a id="1175" class="Symbol">→</a> <a id="1177" href="Agda.Builtin.IO.html#111" class="Postulate">IO</a> <a id="1180" href="Main.html#1154" class="Bound">A</a> <a id="1182" class="Symbol">→</a> <a id="1184" href="Agda.Builtin.IO.html#111" class="Postulate">IO</a> <a id="1187" href="Main.html#1156" class="Bound">B</a>
  <a id="mmap"></a><a id="1191" href="Main.html#1191" class="Postulate">mmap</a> <a id="1196" class="Symbol">:</a> <a id="1198" class="Symbol">∀{</a><a id="1200" href="Main.html#1200" class="Bound">A</a> <a id="1202" href="Main.html#1202" class="Bound">B</a> <a id="1204" class="Symbol">:</a> <a id="1206" class="PrimitiveType">Set</a><a id="1209" class="Symbol">}</a> <a id="1211" class="Symbol">→</a> <a id="1213" class="Symbol">(</a><a id="1214" href="Main.html#1200" class="Bound">A</a> <a id="1216" class="Symbol">→</a> <a id="1218" href="Main.html#1202" class="Bound">B</a><a id="1219" class="Symbol">)</a> <a id="1221" class="Symbol">→</a> <a id="1223" href="Utils.html#39" class="Datatype">Maybe</a> <a id="1229" href="Main.html#1200" class="Bound">A</a> <a id="1231" class="Symbol">→</a> <a id="1233" href="Utils.html#39" class="Datatype">Maybe</a> <a id="1239" href="Main.html#1202" class="Bound">B</a>
  <a id="mbind"></a><a id="1243" href="Main.html#1243" class="Postulate">mbind</a> <a id="1249" class="Symbol">:</a> <a id="1251" class="Symbol">∀{</a><a id="1253" href="Main.html#1253" class="Bound">A</a> <a id="1255" href="Main.html#1255" class="Bound">B</a> <a id="1257" class="Symbol">:</a> <a id="1259" class="PrimitiveType">Set</a><a id="1262" class="Symbol">}</a> <a id="1264" class="Symbol">→</a> <a id="1266" class="Symbol">(</a><a id="1267" href="Main.html#1253" class="Bound">A</a> <a id="1269" class="Symbol">→</a> <a id="1271" href="Utils.html#39" class="Datatype">Maybe</a> <a id="1277" href="Main.html#1255" class="Bound">B</a><a id="1278" class="Symbol">)</a> <a id="1280" class="Symbol">→</a> <a id="1282" href="Utils.html#39" class="Datatype">Maybe</a> <a id="1288" href="Main.html#1253" class="Bound">A</a> <a id="1290" class="Symbol">→</a> <a id="1292" href="Utils.html#39" class="Datatype">Maybe</a> <a id="1298" href="Main.html#1255" class="Bound">B</a>
  <a id="Program"></a><a id="1302" href="Main.html#1302" class="Postulate">Program</a> <a id="1310" class="Symbol">:</a> <a id="1312" class="PrimitiveType">Set</a>
  <a id="convP"></a><a id="1318" href="Main.html#1318" class="Postulate">convP</a> <a id="1324" class="Symbol">:</a> <a id="1326" href="Main.html#1302" class="Postulate">Program</a> <a id="1334" class="Symbol">→</a> <a id="1336" href="Raw.html#741" class="Datatype">RawTm</a>
  <a id="readFile"></a><a id="1344" href="Main.html#1344" class="Postulate">readFile</a> <a id="1353" class="Symbol">:</a> <a id="1355" href="Agda.Builtin.String.html#206" class="Postulate">String</a> <a id="1362" class="Symbol">→</a> <a id="1364" href="Agda.Builtin.IO.html#111" class="Postulate">IO</a> <a id="1367" href="Builtin.Constant.Type.html#517" class="Postulate">ByteString</a>
  <a id="parse"></a><a id="1380" href="Main.html#1380" class="Postulate">parse</a> <a id="1386" class="Symbol">:</a> <a id="1388" href="Builtin.Constant.Type.html#517" class="Postulate">ByteString</a> <a id="1399" class="Symbol">→</a> <a id="1401" href="Utils.html#39" class="Datatype">Maybe</a> <a id="1407" href="Main.html#1302" class="Postulate">Program</a>
  <a id="showTerm"></a><a id="1417" href="Main.html#1417" class="Postulate">showTerm</a> <a id="1426" class="Symbol">:</a> <a id="1428" href="Raw.html#741" class="Datatype">RawTm</a> <a id="1434" class="Symbol">→</a> <a id="1436" href="Agda.Builtin.String.html#206" class="Postulate">String</a>
  <a id="getContents"></a><a id="1445" href="Main.html#1445" class="Postulate">getContents</a> <a id="1457" class="Symbol">:</a> <a id="1459" href="Agda.Builtin.IO.html#111" class="Postulate">IO</a> <a id="1462" href="Builtin.Constant.Type.html#517" class="Postulate">ByteString</a>
  
<a id="1476" class="Symbol">{-#</a> <a id="1480" class="Keyword">FOREIGN</a> <a id="1488" class="Pragma">GHC</a> <a id="1492" class="Pragma">import</a> <a id="1499" class="Pragma">Language.PlutusCore.Name</a> <a id="1524" class="Symbol">#-}</a>
<a id="1528" class="Symbol">{-#</a> <a id="1532" class="Keyword">FOREIGN</a> <a id="1540" class="Pragma">GHC</a> <a id="1544" class="Pragma">import</a> <a id="1551" class="Pragma">Language.PlutusCore.Lexer</a> <a id="1577" class="Symbol">#-}</a>
<a id="1581" class="Symbol">{-#</a> <a id="1585" class="Keyword">FOREIGN</a> <a id="1593" class="Pragma">GHC</a> <a id="1597" class="Pragma">import</a> <a id="1604" class="Pragma">Language.PlutusCore.Parser</a> <a id="1631" class="Symbol">#-}</a>
<a id="1635" class="Symbol">{-#</a> <a id="1639" class="Keyword">FOREIGN</a> <a id="1647" class="Pragma">GHC</a> <a id="1651" class="Pragma">import</a> <a id="1658" class="Pragma">Language.PlutusCore.Pretty</a> <a id="1685" class="Symbol">#-}</a>
<a id="1689" class="Symbol">{-#</a> <a id="1693" class="Keyword">FOREIGN</a> <a id="1701" class="Pragma">GHC</a> <a id="1705" class="Pragma">import</a> <a id="1712" class="Pragma">Data.Either</a> <a id="1724" class="Symbol">#-}</a>

<a id="1729" class="Symbol">{-#</a> <a id="1733" class="Keyword">FOREIGN</a> <a id="1741" class="Pragma">GHC</a> <a id="1745" class="Pragma">import</a> <a id="1752" class="Pragma">Raw</a> <a id="1756" class="Symbol">#-}</a>
<a id="1760" class="Symbol">{-#</a> <a id="1764" class="Keyword">COMPILE</a> <a id="1772" class="Pragma">GHC</a> <a id="1776" href="Main.html#1318" class="Postulate">convP</a> <a id="1782" class="Pragma">=</a> <a id="1784" class="Pragma">convP</a> <a id="1790" class="Symbol">#-}</a>
<a id="1794" class="Symbol">{-#</a> <a id="1798" class="Keyword">FOREIGN</a> <a id="1806" class="Pragma">GHC</a> <a id="1810" class="Pragma">import</a> <a id="1817" class="Pragma">qualified</a> <a id="1827" class="Pragma">Data.ByteString.Lazy</a> <a id="1848" class="Pragma">as</a> <a id="1851" class="Pragma">BSL</a> <a id="1855" class="Symbol">#-}</a>
<a id="1859" class="Symbol">{-#</a> <a id="1863" class="Keyword">COMPILE</a> <a id="1871" class="Pragma">GHC</a> <a id="1875" href="Main.html#1445" class="Postulate">getContents</a> <a id="1887" class="Pragma">=</a> <a id="1889" class="Pragma">BSL.getContents</a> <a id="1905" class="Symbol">#-}</a>
<a id="1909" class="Symbol">{-#</a> <a id="1913" class="Keyword">COMPILE</a> <a id="1921" class="Pragma">GHC</a> <a id="1925" href="Main.html#1145" class="Postulate">imap</a> <a id="1930" class="Pragma">=</a> <a id="1932" class="Pragma">\_</a> <a id="1935" class="Pragma">_</a> <a id="1937" class="Pragma">-&gt;</a> <a id="1940" class="Pragma">fmap</a> <a id="1945" class="Symbol">#-}</a>
<a id="1949" class="Symbol">{-#</a> <a id="1953" class="Keyword">COMPILE</a> <a id="1961" class="Pragma">GHC</a> <a id="1965" href="Main.html#1191" class="Postulate">mmap</a> <a id="1970" class="Pragma">=</a> <a id="1972" class="Pragma">\_</a> <a id="1975" class="Pragma">_</a> <a id="1977" class="Pragma">-&gt;</a> <a id="1980" class="Pragma">fmap</a> <a id="1985" class="Symbol">#-}</a>
<a id="1989" class="Symbol">{-#</a> <a id="1993" class="Keyword">COMPILE</a> <a id="2001" class="Pragma">GHC</a> <a id="2005" href="Main.html#1243" class="Postulate">mbind</a> <a id="2011" class="Pragma">=</a> <a id="2013" class="Pragma">\_</a> <a id="2016" class="Pragma">_</a> <a id="2018" class="Pragma">f</a> <a id="2020" class="Pragma">a</a> <a id="2022" class="Pragma">-&gt;</a> <a id="2025" class="Pragma">f</a> <a id="2027" class="Pragma">=&lt;&lt;</a> <a id="2031" class="Pragma">a</a> <a id="2033" class="Symbol">#-}</a>
<a id="2037" class="Symbol">{-#</a> <a id="2041" class="Keyword">FOREIGN</a> <a id="2049" class="Pragma">GHC</a> <a id="2053" class="Pragma">import</a> <a id="2060" class="Pragma">Data.Either</a> <a id="2072" class="Symbol">#-}</a>
<a id="2076" class="Symbol">{-#</a> <a id="2080" class="Keyword">COMPILE</a> <a id="2088" class="Pragma">GHC</a> <a id="2092" href="Main.html#1380" class="Postulate">parse</a> <a id="2098" class="Pragma">=</a> <a id="2100" class="Pragma">either</a> <a id="2107" class="Pragma">(\_</a> <a id="2111" class="Pragma">-&gt;</a> <a id="2114" class="Pragma">Nothing)</a> <a id="2123" class="Pragma">Just</a> <a id="2128" class="Pragma">.</a> <a id="2130" class="Pragma">parse</a> <a id="2136" class="Symbol">#-}</a>
<a id="2140" class="Symbol">{-#</a> <a id="2144" class="Keyword">FOREIGN</a> <a id="2152" class="Pragma">GHC</a> <a id="2156" class="Pragma">import</a> <a id="2163" class="Pragma">Language.PlutusCore</a> <a id="2183" class="Symbol">#-}</a>
<a id="2187" class="Symbol">{-#</a> <a id="2191" class="Keyword">COMPILE</a> <a id="2199" class="Pragma">GHC</a> <a id="2203" href="Main.html#1302" class="Postulate">Program</a> <a id="2211" class="Pragma">=</a> <a id="2213" class="Pragma">type</a> <a id="2218" class="Pragma">Language.PlutusCore.Program</a> <a id="2246" class="Pragma">TyName</a> <a id="2253" class="Pragma">Name</a> <a id="2258" class="Pragma">Language.PlutusCore.Lexer.AlexPosn</a> <a id="2293" class="Symbol">#-}</a>
<a id="2297" class="Symbol">{-#</a> <a id="2301" class="Keyword">COMPILE</a> <a id="2309" class="Pragma">GHC</a> <a id="2313" href="Main.html#1344" class="Postulate">readFile</a> <a id="2322" class="Pragma">=</a> <a id="2324" class="Pragma">\</a> <a id="2326" class="Pragma">s</a> <a id="2328" class="Pragma">-&gt;</a> <a id="2331" class="Pragma">BSL.readFile</a> <a id="2344" class="Pragma">(T.unpack</a> <a id="2354" class="Pragma">s)</a> <a id="2357" class="Symbol">#-}</a>
<a id="2361" class="Symbol">{-#</a> <a id="2365" class="Keyword">COMPILE</a> <a id="2373" class="Pragma">GHC</a> <a id="2377" href="Main.html#1417" class="Postulate">showTerm</a> <a id="2386" class="Pragma">=</a> <a id="2388" class="Pragma">T.pack</a> <a id="2395" class="Pragma">.</a> <a id="2397" class="Pragma">show</a> <a id="2402" class="Symbol">#-}</a>
<a id="2406" class="Keyword">open</a> <a id="2411" class="Keyword">import</a> <a id="2418" href="Function.html" class="Module">Function</a>

<a id="2428" class="Keyword">open</a> <a id="2433" class="Keyword">import</a> <a id="2440" href="Untyped.html" class="Module">Untyped</a> <a id="2448" class="Symbol">as</a> <a id="2451" class="Module">U</a>
<a id="2453" class="Keyword">import</a> <a id="2460" href="Untyped.Reduction.html" class="Module">Untyped.Reduction</a> <a id="2478" class="Symbol">as</a> <a id="2481" class="Module">U</a>
<a id="2483" class="Keyword">import</a> <a id="2490" href="Scoped.html" class="Module">Scoped</a> <a id="2497" class="Symbol">as</a> <a id="2500" class="Module">S</a>
<a id="2502" class="Keyword">import</a> <a id="2509" href="Scoped.Reduction.html" class="Module">Scoped.Reduction</a> <a id="2526" class="Symbol">as</a> <a id="2529" class="Module">S</a>

<a id="2532" class="Keyword">open</a> <a id="2537" class="Keyword">import</a> <a id="2544" href="Data.Sum.html" class="Module">Data.Sum</a>

<a id="mapper"></a><a id="2554" href="Main.html#2554" class="Function">mapper</a> <a id="2561" class="Symbol">:</a> <a id="2563" class="Symbol">{</a><a id="2564" href="Main.html#2564" class="Bound">A</a> <a id="2566" href="Main.html#2566" class="Bound">B</a> <a id="2568" class="Symbol">:</a> <a id="2570" class="PrimitiveType">Set</a><a id="2573" class="Symbol">}</a> <a id="2575" class="Symbol">→</a> <a id="2577" class="Symbol">(</a><a id="2578" href="Main.html#2564" class="Bound">A</a> <a id="2580" class="Symbol">→</a> <a id="2582" href="Main.html#2566" class="Bound">B</a><a id="2583" class="Symbol">)</a> <a id="2585" class="Symbol">→</a> <a id="2587" href="Utils.html#39" class="Datatype">Maybe</a> <a id="2593" href="Main.html#2564" class="Bound">A</a> <a id="2595" class="Symbol">→</a> <a id="2597" href="Utils.html#39" class="Datatype">Maybe</a> <a id="2603" href="Main.html#2566" class="Bound">B</a>
<a id="2605" href="Main.html#2554" class="Function">mapper</a> <a id="2612" href="Main.html#2612" class="Bound">f</a> <a id="2614" href="Utils.html#90" class="InductiveConstructor">nothing</a> <a id="2622" class="Symbol">=</a> <a id="2624" href="Utils.html#90" class="InductiveConstructor">nothing</a>
<a id="2632" href="Main.html#2554" class="Function">mapper</a> <a id="2639" href="Main.html#2639" class="Bound">f</a> <a id="2641" class="Symbol">(</a><a id="2642" href="Utils.html#69" class="InductiveConstructor">just</a> <a id="2647" href="Main.html#2647" class="Bound">a</a><a id="2648" class="Symbol">)</a> <a id="2650" class="Symbol">=</a> <a id="2652" href="Utils.html#69" class="InductiveConstructor">just</a> <a id="2657" class="Symbol">(</a><a id="2658" href="Main.html#2639" class="Bound">f</a> <a id="2660" href="Main.html#2647" class="Bound">a</a><a id="2661" class="Symbol">)</a>

<a id="2664" class="Keyword">open</a> <a id="2669" class="Keyword">import</a> <a id="2676" href="Untyped.html" class="Module">Untyped</a>


<a id="2686" class="Comment">-- untyped evaluation</a>
<a id="2708" class="Comment">--utestPLC : ByteString → Maybe String</a>
<a id="2747" class="Comment">--utestPLC plc = mmap (U.ugly ∘ (λ (t : 0 ⊢) → proj₁ (U.run t 100)) ∘ erase⊢) (mbind (deBruijnifyTm nil) (mmap convP (parse plc)))</a>

<a id="2879" class="Keyword">open</a> <a id="2884" class="Keyword">import</a> <a id="2891" href="Data.Fin.html" class="Module">Data.Fin</a>

<a id="2901" class="Keyword">postulate</a> <a id="prettyPrint"></a><a id="2911" href="Main.html#2911" class="Postulate">prettyPrint</a> <a id="2923" class="Symbol">:</a> <a id="2925" href="Raw.html#741" class="Datatype">RawTm</a> <a id="2931" class="Symbol">→</a> <a id="2933" href="Agda.Builtin.String.html#206" class="Postulate">String</a>

<a id="2941" class="Symbol">{-#</a> <a id="2945" class="Keyword">COMPILE</a> <a id="2953" class="Pragma">GHC</a> <a id="2957" href="Main.html#2911" class="Postulate">prettyPrint</a> <a id="2969" class="Pragma">=</a> <a id="2971" class="Pragma">prettyText</a> <a id="2982" class="Pragma">.</a> <a id="2984" class="Pragma">unconv</a> <a id="2991" class="Symbol">#-}</a>

<a id="2996" class="Keyword">open</a> <a id="3001" class="Keyword">import</a> <a id="3008" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="3017" class="Keyword">hiding</a> <a id="3024" class="Symbol">(</a><a id="3025" href="Data.Vec.html#4190" class="Function Operator">_&gt;&gt;=_</a><a id="3030" class="Symbol">)</a>

<a id="3033" class="Keyword">open</a> <a id="3038" class="Keyword">import</a> <a id="3045" href="Scoped.CK.html" class="Module">Scoped.CK</a>

<a id="tvars"></a><a id="3056" href="Main.html#3056" class="Function">tvars</a> <a id="3062" class="Symbol">:</a> <a id="3064" class="Symbol">∀{</a><a id="3066" href="Main.html#3066" class="Bound">n</a><a id="3067" class="Symbol">}</a> <a id="3069" class="Symbol">→</a> <a id="3071" href="Data.Vec.html#773" class="Datatype">Vec</a> <a id="3075" href="Agda.Builtin.String.html#206" class="Postulate">String</a> <a id="3082" href="Main.html#3066" class="Bound">n</a>
<a id="3084" href="Main.html#3056" class="Function">tvars</a> <a id="3090" class="Symbol">{</a><a id="3091" href="Agda.Builtin.Nat.html#183" class="InductiveConstructor">zero</a><a id="3095" class="Symbol">}</a>      <a id="3102" class="Symbol">=</a> <a id="3104" href="Data.Vec.html#813" class="InductiveConstructor">[]</a>
<a id="3107" href="Main.html#3056" class="Function">tvars</a> <a id="3113" class="Symbol">{</a><a id="3114" href="Agda.Builtin.Nat.html#196" class="InductiveConstructor">Nat.suc</a> <a id="3122" href="Main.html#3122" class="Bound">n</a><a id="3123" class="Symbol">}</a> <a id="3125" class="Symbol">=</a>
  <a id="3129" class="Symbol">(</a><a id="3130" class="String">&quot;tvar&quot;</a> <a id="3137" href="Data.String.Base.html#1176" class="Function Operator">Data.String.++</a> <a id="3152" href="Data.Integer.html#803" class="Function">Data.Integer.show</a> <a id="3170" class="Symbol">(</a><a id="3171" href="Agda.Builtin.Int.html#237" class="InductiveConstructor">pos</a> <a id="3175" href="Main.html#3122" class="Bound">n</a><a id="3176" class="Symbol">))</a> <a id="3179" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="3181" href="Main.html#3056" class="Function">tvars</a> <a id="3187" class="Symbol">{</a><a id="3188" href="Main.html#3122" class="Bound">n</a><a id="3189" class="Symbol">}</a>

<a id="3192" class="Comment">-- this is not very useful but I am expecting that it won&#39;t be used</a>
<a id="vars"></a><a id="3260" href="Main.html#3260" class="Function">vars</a> <a id="3265" class="Symbol">:</a> <a id="3267" class="Symbol">∀{</a><a id="3269" href="Main.html#3269" class="Bound">n</a><a id="3270" class="Symbol">}{</a><a id="3272" href="Main.html#3272" class="Bound">i</a> <a id="3274" class="Symbol">:</a> <a id="3276" href="Scoped.html#1304" class="Datatype">Weirdℕ</a> <a id="3283" href="Main.html#3269" class="Bound">n</a><a id="3284" class="Symbol">}</a> <a id="3286" class="Symbol">→</a> <a id="3288" href="Scoped.html#4210" class="Datatype">WeirdVec</a> <a id="3297" href="Agda.Builtin.String.html#206" class="Postulate">String</a> <a id="3304" href="Main.html#3272" class="Bound">i</a>
<a id="3306" href="Main.html#3260" class="Function">vars</a> <a id="3311" class="Symbol">{</a><a id="3312" class="Argument">i</a> <a id="3314" class="Symbol">=</a> <a id="3316" href="Scoped.html#1329" class="InductiveConstructor">Z</a><a id="3317" class="Symbol">}</a> <a id="3319" class="Symbol">=</a> <a id="3321" href="Scoped.html#4261" class="InductiveConstructor">nil</a>
<a id="3325" href="Main.html#3260" class="Function">vars</a> <a id="3330" class="Symbol">{</a><a id="3331" class="Argument">i</a> <a id="3333" class="Symbol">=</a> <a id="3335" href="Scoped.html#1344" class="InductiveConstructor">S</a> <a id="3337" href="Main.html#3337" class="Bound">i</a><a id="3338" class="Symbol">}</a> <a id="3340" class="Symbol">=</a> <a id="3342" href="Scoped.html#4282" class="InductiveConstructor">consS</a> <a id="3348" class="String">&quot;varS&quot;</a> <a id="3355" class="Symbol">(</a><a id="3356" href="Main.html#3260" class="Function">vars</a> <a id="3361" class="Symbol">{</a><a id="3362" class="Argument">i</a> <a id="3364" class="Symbol">=</a> <a id="3366" href="Main.html#3337" class="Bound">i</a><a id="3367" class="Symbol">})</a>
<a id="3370" href="Main.html#3260" class="Function">vars</a> <a id="3375" class="Symbol">{</a><a id="3376" class="Argument">i</a> <a id="3378" class="Symbol">=</a> <a id="3380" href="Scoped.html#1378" class="InductiveConstructor">T</a> <a id="3382" href="Main.html#3382" class="Bound">i</a><a id="3383" class="Symbol">}</a> <a id="3385" class="Symbol">=</a> <a id="3387" href="Scoped.html#4349" class="InductiveConstructor">consT</a> <a id="3393" class="String">&quot;varT&quot;</a> <a id="3400" class="Symbol">(</a><a id="3401" href="Main.html#3260" class="Function">vars</a> <a id="3406" class="Symbol">{</a><a id="3407" class="Argument">i</a> <a id="3409" class="Symbol">=</a> <a id="3411" href="Main.html#3382" class="Bound">i</a><a id="3412" class="Symbol">})</a>

<a id="3416" class="Keyword">data</a> <a id="EvalMode"></a><a id="3421" href="Main.html#3421" class="Datatype">EvalMode</a> <a id="3430" class="Symbol">:</a> <a id="3432" class="PrimitiveType">Set</a> <a id="3436" class="Keyword">where</a>
  <a id="EvalMode.CK"></a><a id="3444" href="Main.html#3444" class="InductiveConstructor">CK</a> <a id="EvalMode.L"></a><a id="3447" href="Main.html#3447" class="InductiveConstructor">L</a> <a id="3449" class="Symbol">:</a> <a id="3451" href="Main.html#3421" class="Datatype">EvalMode</a>

<a id="3461" class="Comment">-- extrinsically typed evaluation</a>
<a id="stestPLC"></a><a id="3495" href="Main.html#3495" class="Function">stestPLC</a> <a id="3504" class="Symbol">:</a> <a id="3506" href="Main.html#3421" class="Datatype">EvalMode</a> <a id="3515" class="Symbol">→</a> <a id="3517" href="Builtin.Constant.Type.html#517" class="Postulate">ByteString</a> <a id="3528" class="Symbol">→</a> <a id="3530" href="Agda.Builtin.String.html#206" class="Postulate">String</a>
<a id="3537" href="Main.html#3495" class="Function">stestPLC</a> <a id="3546" href="Main.html#3546" class="Bound">m</a> <a id="3548" href="Main.html#3548" class="Bound">plc</a> <a id="3552" class="Keyword">with</a> <a id="3557" href="Main.html#1380" class="Postulate">parse</a> <a id="3563" href="Main.html#3548" class="Bound">plc</a>
<a id="3567" href="Main.html#3495" class="Function">stestPLC</a> <a id="3576" href="Main.html#3576" class="Bound">m</a> <a id="3578" href="Main.html#3578" class="Bound">plc</a> <a id="3582" class="Symbol">|</a> <a id="3584" href="Utils.html#69" class="InductiveConstructor">just</a> <a id="3589" href="Main.html#3589" class="Bound">t</a> <a id="3591" class="Keyword">with</a> <a id="3596" href="Scoped.html#5271" class="Function">deBruijnifyTm</a> <a id="3610" href="Scoped.html#4261" class="InductiveConstructor">nil</a> <a id="3614" class="Symbol">(</a><a id="3615" href="Main.html#1318" class="Postulate">convP</a> <a id="3621" href="Main.html#3589" class="Bound">t</a><a id="3622" class="Symbol">)</a>
<a id="3624" href="Main.html#3495" class="Function">stestPLC</a> <a id="3633" href="Main.html#3447" class="InductiveConstructor">L</a> <a id="3635" href="Main.html#3635" class="Bound">plc</a> <a id="3639" class="Symbol">|</a> <a id="3641" href="Utils.html#69" class="InductiveConstructor">just</a> <a id="3646" href="Main.html#3646" class="Bound">t</a> <a id="3648" class="Symbol">|</a> <a id="3650" href="Utils.html#69" class="InductiveConstructor">just</a> <a id="3655" href="Main.html#3655" class="Bound">t&#39;</a> <a id="3658" class="Keyword">with</a> <a id="3663" href="Scoped.Reduction.html#13548" class="Function">S.run</a> <a id="3669" class="Symbol">(</a><a id="3670" href="Scoped.html#8255" class="Function">saturate</a> <a id="3679" href="Main.html#3655" class="Bound">t&#39;</a><a id="3681" class="Symbol">)</a> <a id="3683" class="Number">1000000</a>
<a id="3691" href="Main.html#3495" class="Function">stestPLC</a> <a id="3700" href="Main.html#3447" class="InductiveConstructor">L</a> <a id="3702" href="Main.html#3702" class="Bound">plc</a> <a id="3706" class="Symbol">|</a> <a id="3708" href="Utils.html#69" class="InductiveConstructor">just</a> <a id="3713" href="Main.html#3713" class="Bound">t</a> <a id="3715" class="Symbol">|</a> <a id="3717" href="Utils.html#69" class="InductiveConstructor">just</a> <a id="3722" href="Main.html#3722" class="Bound">t&#39;</a> <a id="3725" class="Symbol">|</a> <a id="3727" href="Main.html#3727" class="Bound">t&#39;&#39;</a> <a id="3731" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,,</a> <a id="3734" class="Symbol">_</a> <a id="3736" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,,</a> <a id="3739" href="Data.Sum.Base.html#565" class="InductiveConstructor">inj₁</a> <a id="3744" class="Symbol">(</a><a id="3745" href="Utils.html#69" class="InductiveConstructor">just</a> <a id="3750" class="Symbol">_)</a> <a id="3753" class="Symbol">=</a>
  <a id="3757" href="Main.html#2911" class="Postulate">prettyPrint</a> <a id="3769" class="Symbol">(</a><a id="3770" href="Scoped.html#12628" class="Function">deDeBruijnify</a> <a id="3784" href="Data.Vec.html#813" class="InductiveConstructor">[]</a> <a id="3787" href="Scoped.html#4261" class="InductiveConstructor">nil</a> <a id="3791" class="Symbol">(</a><a id="3792" href="Scoped.html#9162" class="Function">unsaturate</a> <a id="3803" href="Main.html#3727" class="Bound">t&#39;&#39;</a><a id="3806" class="Symbol">))</a>
<a id="3809" href="Main.html#3495" class="Function">stestPLC</a> <a id="3818" href="Main.html#3447" class="InductiveConstructor">L</a> <a id="3820" href="Main.html#3820" class="Bound">plc</a> <a id="3824" class="Symbol">|</a> <a id="3826" href="Utils.html#69" class="InductiveConstructor">just</a> <a id="3831" href="Main.html#3831" class="Bound">t</a> <a id="3833" class="Symbol">|</a> <a id="3835" href="Utils.html#69" class="InductiveConstructor">just</a> <a id="3840" href="Main.html#3840" class="Bound">t&#39;</a> <a id="3843" class="Symbol">|</a> <a id="3845" href="Main.html#3845" class="Bound">t&#39;&#39;</a> <a id="3849" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,,</a> <a id="3852" href="Main.html#3852" class="Bound">p</a> <a id="3854" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,,</a> <a id="3857" href="Data.Sum.Base.html#565" class="InductiveConstructor">inj₁</a> <a id="3862" href="Utils.html#90" class="InductiveConstructor">nothing</a> <a id="3870" class="Symbol">=</a> <a id="3872" class="String">&quot;out of fuel&quot;</a>
<a id="3886" href="Main.html#3495" class="Function">stestPLC</a> <a id="3895" href="Main.html#3447" class="InductiveConstructor">L</a> <a id="3897" href="Main.html#3897" class="Bound">plc</a> <a id="3901" class="Symbol">|</a> <a id="3903" href="Utils.html#69" class="InductiveConstructor">just</a> <a id="3908" href="Main.html#3908" class="Bound">t</a> <a id="3910" class="Symbol">|</a> <a id="3912" href="Utils.html#69" class="InductiveConstructor">just</a> <a id="3917" href="Main.html#3917" class="Bound">t&#39;</a> <a id="3920" class="Symbol">|</a> <a id="3922" href="Main.html#3922" class="Bound">t&#39;&#39;</a> <a id="3926" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,,</a> <a id="3929" href="Main.html#3929" class="Bound">p</a> <a id="3931" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,,</a> <a id="3934" href="Data.Sum.Base.html#590" class="InductiveConstructor">inj₂</a> <a id="3939" href="Main.html#3939" class="Bound">e</a> <a id="3941" class="Symbol">=</a>
  <a id="3945" class="String">&quot;runtime error&quot;</a> <a id="3961" href="Data.String.Base.html#1176" class="Function Operator">Data.String.++</a>
  <a id="3978" href="Main.html#2911" class="Postulate">prettyPrint</a> <a id="3990" class="Symbol">(</a><a id="3991" href="Scoped.html#12628" class="Function">deDeBruijnify</a> <a id="4005" href="Data.Vec.html#813" class="InductiveConstructor">[]</a> <a id="4008" href="Scoped.html#4261" class="InductiveConstructor">nil</a> <a id="4012" class="Symbol">(</a><a id="4013" href="Scoped.html#9162" class="Function">unsaturate</a> <a id="4024" href="Main.html#3922" class="Bound">t&#39;&#39;</a><a id="4027" class="Symbol">))</a>
<a id="4030" href="Main.html#3495" class="Function">stestPLC</a> <a id="4039" href="Main.html#3444" class="InductiveConstructor">CK</a> <a id="4042" href="Main.html#4042" class="Bound">plc</a> <a id="4046" class="Symbol">|</a> <a id="4048" href="Utils.html#69" class="InductiveConstructor">just</a> <a id="4053" href="Main.html#4053" class="Bound">t</a> <a id="4055" class="Symbol">|</a> <a id="4057" href="Utils.html#69" class="InductiveConstructor">just</a> <a id="4062" href="Main.html#4062" class="Bound">t&#39;</a> <a id="4065" class="Keyword">with</a> <a id="4070" href="Scoped.CK.html#4730" class="Function">stepper</a> <a id="4078" class="Number">1000000000</a> <a id="4089" class="Symbol">_</a> <a id="4091" class="Symbol">(</a><a id="4092" href="Scoped.CK.html#918" class="InductiveConstructor">ε</a> <a id="4094" href="Scoped.CK.html#1076" class="InductiveConstructor Operator">▻</a> <a id="4096" href="Scoped.html#8255" class="Function">saturate</a> <a id="4105" href="Main.html#4062" class="Bound">t&#39;</a><a id="4107" class="Symbol">)</a>
<a id="4109" href="Main.html#3495" class="Function">stestPLC</a> <a id="4118" href="Main.html#3444" class="InductiveConstructor">CK</a> <a id="4121" href="Main.html#4121" class="Bound">plc</a> <a id="4125" class="Symbol">|</a> <a id="4127" href="Utils.html#69" class="InductiveConstructor">just</a> <a id="4132" href="Main.html#4132" class="Bound">t</a> <a id="4134" class="Symbol">|</a> <a id="4136" href="Utils.html#69" class="InductiveConstructor">just</a> <a id="4141" href="Main.html#4141" class="Bound">t&#39;</a> <a id="4144" class="Symbol">|</a> <a id="4146" href="Main.html#4146" class="Bound">n</a> <a id="4148" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,,</a> <a id="4151" href="Main.html#4151" class="Bound">i</a> <a id="4153" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,,</a> <a id="4156" class="Symbol">_</a> <a id="4158" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,,</a> <a id="4161" href="Utils.html#69" class="InductiveConstructor">just</a> <a id="4166" class="Symbol">(</a><a id="4167" href="Scoped.CK.html#1171" class="InductiveConstructor">□</a> <a id="4169" class="Symbol">{</a><a id="4170" class="Argument">t</a> <a id="4172" class="Symbol">=</a> <a id="4174" href="Main.html#4174" class="Bound">t&#39;&#39;</a><a id="4177" class="Symbol">}</a>  <a id="4180" href="Main.html#4180" class="Bound">V</a><a id="4181" class="Symbol">)</a> <a id="4183" class="Symbol">=</a>
  <a id="4187" href="Main.html#2911" class="Postulate">prettyPrint</a> <a id="4199" class="Symbol">(</a><a id="4200" href="Scoped.html#12628" class="Function">deDeBruijnify</a> <a id="4214" href="Main.html#3056" class="Function">tvars</a> <a id="4220" href="Main.html#3260" class="Function">vars</a> <a id="4225" class="Symbol">(</a><a id="4226" href="Scoped.html#9162" class="Function">unsaturate</a> <a id="4237" href="Main.html#4174" class="Bound">t&#39;&#39;</a><a id="4240" class="Symbol">))</a>
<a id="4243" href="Main.html#3495" class="CatchallClause Function">stestPLC</a><a id="4251" class="CatchallClause"> </a><a id="4252" href="Main.html#3444" class="CatchallClause InductiveConstructor">CK</a><a id="4254" class="CatchallClause"> </a><a id="4255" href="Main.html#4255" class="CatchallClause Bound">plc</a><a id="4258" class="CatchallClause"> </a><a id="4259" class="CatchallClause Symbol">|</a><a id="4260" class="CatchallClause"> </a><a id="4261" href="Utils.html#69" class="CatchallClause InductiveConstructor">just</a><a id="4265" class="CatchallClause"> </a><a id="4266" href="Main.html#4266" class="CatchallClause Bound">t</a><a id="4267" class="CatchallClause"> </a><a id="4268" class="CatchallClause Symbol">|</a><a id="4269" class="CatchallClause"> </a><a id="4270" href="Utils.html#69" class="CatchallClause InductiveConstructor">just</a><a id="4274" class="CatchallClause"> </a><a id="4275" href="Main.html#4275" class="CatchallClause Bound">t&#39;</a><a id="4277" class="CatchallClause"> </a><a id="4278" class="CatchallClause Symbol">|</a><a id="4279" class="CatchallClause"> </a><a id="4280" class="CatchallClause Symbol">_</a><a id="4281" class="CatchallClause"> </a><a id="4282" href="Agda.Builtin.Sigma.html#209" class="CatchallClause InductiveConstructor Operator">,,</a><a id="4284" class="CatchallClause"> </a><a id="4285" class="CatchallClause Symbol">_</a><a id="4286" class="CatchallClause"> </a><a id="4287" href="Agda.Builtin.Sigma.html#209" class="CatchallClause InductiveConstructor Operator">,,</a><a id="4289" class="CatchallClause"> </a><a id="4290" class="CatchallClause Symbol">_</a><a id="4291" class="CatchallClause"> </a><a id="4292" href="Agda.Builtin.Sigma.html#209" class="CatchallClause InductiveConstructor Operator">,,</a><a id="4294" class="CatchallClause">  </a><a id="4296" href="Utils.html#69" class="CatchallClause InductiveConstructor">just</a><a id="4300" class="CatchallClause"> </a><a id="4301" class="CatchallClause Symbol">_</a> <a id="4303" class="Symbol">=</a>
  <a id="4307" class="String">&quot;this shouldn&#39;t happen&quot;</a>
<a id="4331" href="Main.html#3495" class="Function">stestPLC</a> <a id="4340" href="Main.html#3444" class="InductiveConstructor">CK</a> <a id="4343" href="Main.html#4343" class="Bound">plc</a> <a id="4347" class="Symbol">|</a> <a id="4349" href="Utils.html#69" class="InductiveConstructor">just</a> <a id="4354" href="Main.html#4354" class="Bound">t</a> <a id="4356" class="Symbol">|</a> <a id="4358" href="Utils.html#69" class="InductiveConstructor">just</a> <a id="4363" href="Main.html#4363" class="Bound">t&#39;</a> <a id="4366" class="Symbol">|</a> <a id="4368" class="Symbol">_</a> <a id="4370" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,,</a> <a id="4373" class="Symbol">_</a> <a id="4375" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,,</a> <a id="4378" class="Symbol">_</a> <a id="4380" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,,</a>  <a id="4384" href="Utils.html#90" class="InductiveConstructor">nothing</a> <a id="4392" class="Symbol">=</a> <a id="4394" class="String">&quot;out of fuel&quot;</a>
<a id="4408" href="Main.html#3495" class="Function">stestPLC</a> <a id="4417" href="Main.html#4417" class="Bound">m</a> <a id="4419" href="Main.html#4419" class="Bound">plc</a> <a id="4423" class="Symbol">|</a> <a id="4425" href="Utils.html#69" class="InductiveConstructor">just</a> <a id="4430" href="Main.html#4430" class="Bound">t</a> <a id="4432" class="Symbol">|</a> <a id="4434" href="Utils.html#90" class="InductiveConstructor">nothing</a> <a id="4442" class="Symbol">=</a> <a id="4444" class="String">&quot;scope error&quot;</a>
<a id="4458" href="Main.html#3495" class="Function">stestPLC</a> <a id="4467" href="Main.html#4467" class="Bound">m</a> <a id="4469" href="Main.html#4469" class="Bound">plc</a> <a id="4473" class="Symbol">|</a> <a id="4475" href="Utils.html#90" class="InductiveConstructor">nothing</a> <a id="4483" class="Symbol">=</a> <a id="4485" class="String">&quot;parse error&quot;</a>

<a id="4500" class="Symbol">{-#</a> <a id="4504" class="Keyword">FOREIGN</a> <a id="4512" class="Pragma">GHC</a> <a id="4516" class="Pragma">import</a> <a id="4523" class="Pragma">System.Environment</a> <a id="4542" class="Symbol">#-}</a>

<a id="4547" class="Keyword">open</a> <a id="4552" class="Keyword">import</a> <a id="4559" href="Data.List.html" class="Module">Data.List</a>

<a id="4570" class="Keyword">postulate</a> <a id="getArgs"></a><a id="4580" href="Main.html#4580" class="Postulate">getArgs</a> <a id="4588" class="Symbol">:</a> <a id="4590" href="Agda.Builtin.IO.html#111" class="Postulate">IO</a> <a id="4593" class="Symbol">(</a><a id="4594" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="4599" href="Agda.Builtin.String.html#206" class="Postulate">String</a><a id="4605" class="Symbol">)</a>

<a id="4608" class="Symbol">{-#</a> <a id="4612" class="Keyword">COMPILE</a> <a id="4620" class="Pragma">GHC</a> <a id="4624" href="Main.html#4580" class="Postulate">getArgs</a> <a id="4632" class="Pragma">=</a> <a id="4634" class="Pragma">(fmap</a> <a id="4640" class="Pragma">.</a> <a id="4642" class="Pragma">fmap)</a> <a id="4648" class="Pragma">T.pack</a> <a id="4655" class="Pragma">$</a> <a id="4657" class="Pragma">getArgs</a> <a id="4665" class="Symbol">#-}</a>

<a id="4670" class="Symbol">{-#</a> <a id="4674" class="Keyword">FOREIGN</a> <a id="4682" class="Pragma">GHC</a> <a id="4686" class="Pragma">import</a> <a id="4693" class="Pragma">Opts</a> <a id="4698" class="Symbol">#-}</a>

<a id="4703" class="Keyword">data</a> <a id="Input"></a><a id="4708" href="Main.html#4708" class="Datatype">Input</a> <a id="4714" class="Symbol">:</a> <a id="4716" class="PrimitiveType">Set</a> <a id="4720" class="Keyword">where</a>
  <a id="Input.FileInput"></a><a id="4728" href="Main.html#4728" class="InductiveConstructor">FileInput</a> <a id="4738" class="Symbol">:</a> <a id="4740" href="Agda.Builtin.String.html#206" class="Postulate">String</a> <a id="4747" class="Symbol">→</a> <a id="4749" href="Main.html#4708" class="Datatype">Input</a>
  <a id="Input.StdInput"></a><a id="4757" href="Main.html#4757" class="InductiveConstructor">StdInput</a> <a id="4766" class="Symbol">:</a> <a id="4768" href="Main.html#4708" class="Datatype">Input</a>

<a id="4775" class="Symbol">{-#</a> <a id="4779" class="Keyword">COMPILE</a> <a id="4787" class="Pragma">GHC</a> <a id="4791" href="Main.html#4708" class="Datatype">Input</a> <a id="4797" class="Pragma">=</a> <a id="4799" class="Pragma">data</a> <a id="4804" class="Pragma">Input</a> <a id="4810" class="Pragma">(FileInput</a> <a id="4821" class="Pragma">|</a> <a id="4823" class="Pragma">StdInput)</a> <a id="4833" class="Symbol">#-}</a>

<a id="4838" class="Keyword">data</a> <a id="EvalOptions"></a><a id="4843" href="Main.html#4843" class="Datatype">EvalOptions</a> <a id="4855" class="Symbol">:</a> <a id="4857" class="PrimitiveType">Set</a> <a id="4861" class="Keyword">where</a>
  <a id="EvalOptions.EvalOpts"></a><a id="4869" href="Main.html#4869" class="InductiveConstructor">EvalOpts</a> <a id="4878" class="Symbol">:</a> <a id="4880" href="Main.html#4708" class="Datatype">Input</a> <a id="4886" class="Symbol">→</a> <a id="4888" href="Main.html#3421" class="Datatype">EvalMode</a> <a id="4897" class="Symbol">→</a> <a id="4899" href="Main.html#4843" class="Datatype">EvalOptions</a>

<a id="4912" class="Keyword">postulate</a> <a id="execP"></a><a id="4922" href="Main.html#4922" class="Postulate">execP</a> <a id="4928" class="Symbol">:</a> <a id="4930" href="Agda.Builtin.IO.html#111" class="Postulate">IO</a> <a id="4933" href="Main.html#4843" class="Datatype">EvalOptions</a>

<a id="4946" class="Symbol">{-#</a> <a id="4950" class="Keyword">COMPILE</a> <a id="4958" class="Pragma">GHC</a> <a id="4962" href="Main.html#4843" class="Datatype">EvalOptions</a> <a id="4974" class="Pragma">=</a> <a id="4976" class="Pragma">data</a> <a id="4981" class="Pragma">EvalOptions</a> <a id="4993" class="Pragma">(EvalOpts)</a> <a id="5004" class="Symbol">#-}</a>
<a id="5008" class="Symbol">{-#</a> <a id="5012" class="Keyword">COMPILE</a> <a id="5020" class="Pragma">GHC</a> <a id="5024" href="Main.html#3421" class="Datatype">EvalMode</a> <a id="5033" class="Pragma">=</a> <a id="5035" class="Pragma">data</a> <a id="5040" class="Pragma">EvalMode</a> <a id="5049" class="Pragma">(CK</a> <a id="5053" class="Pragma">|</a> <a id="5055" class="Pragma">L)</a> <a id="5058" class="Symbol">#-}</a>
<a id="5062" class="Symbol">{-#</a> <a id="5066" class="Keyword">COMPILE</a> <a id="5074" class="Pragma">GHC</a> <a id="5078" href="Main.html#4922" class="Postulate">execP</a> <a id="5084" class="Pragma">=</a> <a id="5086" class="Pragma">execP</a> <a id="5092" class="Symbol">#-}</a>

<a id="testFile"></a><a id="5097" href="Main.html#5097" class="Function">testFile</a> <a id="5106" class="Symbol">:</a> <a id="5108" href="Main.html#3421" class="Datatype">EvalMode</a> <a id="5117" class="Symbol">→</a> <a id="5119" href="Main.html#4708" class="Datatype">Input</a> <a id="5125" class="Symbol">→</a> <a id="5127" href="Agda.Builtin.IO.html#111" class="Postulate">IO</a> <a id="5130" href="Agda.Builtin.String.html#206" class="Postulate">String</a>
<a id="5137" href="Main.html#5097" class="Function">testFile</a> <a id="5146" href="Main.html#5146" class="Bound">m</a> <a id="5148" class="Symbol">(</a><a id="5149" href="Main.html#4728" class="InductiveConstructor">FileInput</a> <a id="5159" href="Main.html#5159" class="Bound">fn</a><a id="5161" class="Symbol">)</a> <a id="5163" class="Symbol">=</a> <a id="5165" href="Main.html#1145" class="Postulate">imap</a> <a id="5170" class="Symbol">(</a><a id="5171" href="Main.html#3495" class="Function">stestPLC</a> <a id="5180" href="Main.html#5146" class="Bound">m</a><a id="5181" class="Symbol">)</a> <a id="5183" class="Symbol">(</a><a id="5184" href="Main.html#1344" class="Postulate">readFile</a> <a id="5193" href="Main.html#5159" class="Bound">fn</a><a id="5195" class="Symbol">)</a>
<a id="5197" href="Main.html#5097" class="Function">testFile</a> <a id="5206" href="Main.html#5206" class="Bound">m</a> <a id="5208" href="Main.html#4757" class="InductiveConstructor">StdInput</a>       <a id="5223" class="Symbol">=</a> <a id="5225" href="Main.html#1145" class="Postulate">imap</a> <a id="5230" class="Symbol">(</a><a id="5231" href="Main.html#3495" class="Function">stestPLC</a> <a id="5240" href="Main.html#5206" class="Bound">m</a><a id="5241" class="Symbol">)</a> <a id="5243" href="Main.html#1445" class="Postulate">getContents</a> 

<a id="main&#39;"></a><a id="5257" href="Main.html#5257" class="Function">main&#39;</a> <a id="5263" class="Symbol">:</a> <a id="5265" href="Main.html#4843" class="Datatype">EvalOptions</a> <a id="5277" class="Symbol">→</a> <a id="5279" href="Agda.Builtin.IO.html#111" class="Postulate">IO</a> <a id="5282" href="Agda.Builtin.Unit.html#137" class="Record">⊤</a>
<a id="5284" href="Main.html#5257" class="Function">main&#39;</a> <a id="5290" class="Symbol">(</a><a id="5291" href="Main.html#4869" class="InductiveConstructor">EvalOpts</a> <a id="5300" href="Main.html#5300" class="Bound">i</a> <a id="5302" href="Main.html#5302" class="Bound">m</a><a id="5303" class="Symbol">)</a> <a id="5305" class="Symbol">=</a> <a id="5307" href="Main.html#5097" class="Function">testFile</a> <a id="5316" href="Main.html#5302" class="Bound">m</a> <a id="5318" href="Main.html#5300" class="Bound">i</a> <a id="5320" href="Main.html#830" class="Postulate Operator">&gt;&gt;=</a> <a id="5324" href="Main.html#135" class="Postulate">putStrLn</a>

<a id="main"></a><a id="5334" href="Main.html#5334" class="Function">main</a> <a id="5339" class="Symbol">:</a> <a id="5341" href="Agda.Builtin.IO.html#111" class="Postulate">IO</a> <a id="5344" href="Agda.Builtin.Unit.html#137" class="Record">⊤</a>
<a id="5346" href="Main.html#5334" class="Function">main</a> <a id="5351" class="Symbol">=</a> <a id="5353" href="Main.html#4922" class="Postulate">execP</a> <a id="5359" href="Main.html#830" class="Postulate Operator">&gt;&gt;=</a> <a id="5363" href="Main.html#5257" class="Function">main&#39;</a>
<a id="5369" class="Markup">\end{code}</a><a id="5379" class="Background">
</a></pre></body></html>