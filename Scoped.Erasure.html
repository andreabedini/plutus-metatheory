<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Scoped.Erasure</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Markup">\begin{code}</a>
<a id="14" class="Keyword">module</a> <a id="21" href="Scoped.Erasure.html" class="Module">Scoped.Erasure</a> <a id="36" class="Keyword">where</a>
<a id="42" class="Markup">\end{code}</a><a id="52" class="Background">

</a><a id="54" class="Markup">\begin{code}</a>
<a id="67" class="Keyword">open</a> <a id="72" class="Keyword">import</a> <a id="79" href="Scoped.html" class="Module">Scoped</a>
<a id="86" class="Keyword">open</a> <a id="91" class="Keyword">import</a> <a id="98" href="Untyped.html" class="Module">Untyped</a>

<a id="107" class="Keyword">open</a> <a id="112" class="Keyword">import</a> <a id="119" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="128" class="Keyword">open</a> <a id="133" class="Keyword">import</a> <a id="140" href="Data.Fin.html" class="Module">Data.Fin</a>
<a id="149" class="Keyword">open</a> <a id="154" class="Keyword">import</a> <a id="161" href="Data.List.html" class="Module">Data.List</a>
<a id="171" class="Markup">\end{code}</a><a id="181" class="Background">

</a><a id="183" class="Markup">\begin{code}</a>
<a id="len"></a><a id="196" href="Scoped.Erasure.html#196" class="Function">len</a> <a id="200" class="Symbol">:</a> <a id="202" class="Symbol">∀{</a><a id="204" href="Scoped.Erasure.html#204" class="Bound">n</a><a id="205" class="Symbol">}</a> <a id="207" class="Symbol">→</a> <a id="209" href="Scoped.html#1304" class="Datatype">Weirdℕ</a> <a id="216" href="Scoped.Erasure.html#204" class="Bound">n</a> <a id="218" class="Symbol">→</a> <a id="220" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a>
<a id="222" href="Scoped.Erasure.html#196" class="Function">len</a> <a id="226" href="Scoped.html#1329" class="InductiveConstructor">Z</a>     <a id="232" class="Symbol">=</a> <a id="234" class="Number">0</a>
<a id="236" href="Scoped.Erasure.html#196" class="Function">len</a> <a id="240" class="Symbol">(</a><a id="241" href="Scoped.html#1344" class="InductiveConstructor">S</a> <a id="243" href="Scoped.Erasure.html#243" class="Bound">i</a><a id="244" class="Symbol">)</a> <a id="246" class="Symbol">=</a> <a id="248" href="Agda.Builtin.Nat.html#196" class="InductiveConstructor">suc</a> <a id="252" class="Symbol">(</a><a id="253" href="Scoped.Erasure.html#196" class="Function">len</a> <a id="257" href="Scoped.Erasure.html#243" class="Bound">i</a><a id="258" class="Symbol">)</a>
<a id="260" href="Scoped.Erasure.html#196" class="Function">len</a> <a id="264" class="Symbol">(</a><a id="265" href="Scoped.html#1378" class="InductiveConstructor">T</a> <a id="267" href="Scoped.Erasure.html#267" class="Bound">i</a><a id="268" class="Symbol">)</a> <a id="270" class="Symbol">=</a> <a id="272" href="Scoped.Erasure.html#196" class="Function">len</a> <a id="276" href="Scoped.Erasure.html#267" class="Bound">i</a>
<a id="278" class="Markup">\end{code}</a><a id="288" class="Background">

</a><a id="290" class="Markup">\begin{code}</a>
<a id="eraseVar"></a><a id="303" href="Scoped.Erasure.html#303" class="Function">eraseVar</a> <a id="312" class="Symbol">:</a> <a id="314" class="Symbol">∀{</a><a id="316" href="Scoped.Erasure.html#316" class="Bound">n</a><a id="317" class="Symbol">}{</a><a id="319" href="Scoped.Erasure.html#319" class="Bound">i</a> <a id="321" class="Symbol">:</a> <a id="323" href="Scoped.html#1304" class="Datatype">Weirdℕ</a> <a id="330" href="Scoped.Erasure.html#316" class="Bound">n</a><a id="331" class="Symbol">}</a> <a id="333" class="Symbol">→</a> <a id="335" href="Scoped.html#1421" class="Datatype">WeirdFin</a> <a id="344" href="Scoped.Erasure.html#319" class="Bound">i</a> <a id="346" class="Symbol">→</a> <a id="348" href="Data.Fin.Base.html#951" class="Datatype">Fin</a> <a id="352" class="Symbol">(</a><a id="353" href="Scoped.Erasure.html#196" class="Function">len</a> <a id="357" href="Scoped.Erasure.html#319" class="Bound">i</a><a id="358" class="Symbol">)</a>
<a id="360" href="Scoped.Erasure.html#303" class="Function">eraseVar</a> <a id="369" href="Scoped.html#1462" class="InductiveConstructor">Z</a>     <a id="375" class="Symbol">=</a> <a id="377" href="Data.Fin.Base.html#973" class="InductiveConstructor">zero</a>
<a id="382" href="Scoped.Erasure.html#303" class="Function">eraseVar</a> <a id="391" class="Symbol">(</a><a id="392" href="Scoped.html#1504" class="InductiveConstructor">S</a> <a id="394" href="Scoped.Erasure.html#394" class="Bound">x</a><a id="395" class="Symbol">)</a> <a id="397" class="Symbol">=</a> <a id="399" href="Data.Fin.Base.html#1004" class="InductiveConstructor">suc</a> <a id="403" class="Symbol">(</a><a id="404" href="Scoped.Erasure.html#303" class="Function">eraseVar</a> <a id="413" href="Scoped.Erasure.html#394" class="Bound">x</a><a id="414" class="Symbol">)</a>
<a id="416" href="Scoped.Erasure.html#303" class="Function">eraseVar</a> <a id="425" class="Symbol">(</a><a id="426" href="Scoped.html#1559" class="InductiveConstructor">T</a> <a id="428" href="Scoped.Erasure.html#428" class="Bound">x</a><a id="429" class="Symbol">)</a> <a id="431" class="Symbol">=</a> <a id="433" href="Scoped.Erasure.html#303" class="Function">eraseVar</a> <a id="442" href="Scoped.Erasure.html#428" class="Bound">x</a>

<a id="eraseTC"></a><a id="445" href="Scoped.Erasure.html#445" class="Function">eraseTC</a> <a id="453" class="Symbol">:</a> <a id="455" href="Scoped.html#1889" class="Datatype">Scoped.TermCon</a> <a id="470" class="Symbol">→</a> <a id="472" href="Untyped.html#332" class="Datatype">Untyped.TermCon</a>
<a id="488" href="Scoped.Erasure.html#445" class="Function">eraseTC</a> <a id="496" class="Symbol">(</a><a id="497" href="Scoped.html#1911" class="InductiveConstructor">integer</a> <a id="505" href="Scoped.Erasure.html#505" class="Bound">i</a><a id="506" class="Symbol">)</a>    <a id="511" class="Symbol">=</a> <a id="513" href="Untyped.html#354" class="InductiveConstructor">integer</a> <a id="521" href="Scoped.Erasure.html#505" class="Bound">i</a>
<a id="523" href="Scoped.Erasure.html#445" class="Function">eraseTC</a> <a id="531" class="Symbol">(</a><a id="532" href="Scoped.html#1944" class="InductiveConstructor">bytestring</a> <a id="543" href="Scoped.Erasure.html#543" class="Bound">b</a><a id="544" class="Symbol">)</a> <a id="546" class="Symbol">=</a> <a id="548" href="Untyped.html#378" class="InductiveConstructor">bytestring</a> <a id="559" href="Scoped.Erasure.html#543" class="Bound">b</a>
<a id="561" href="Scoped.Erasure.html#445" class="Function">eraseTC</a> <a id="569" class="Symbol">(</a><a id="570" href="Scoped.html#1986" class="InductiveConstructor">string</a> <a id="577" href="Scoped.Erasure.html#577" class="Bound">s</a><a id="578" class="Symbol">)</a>     <a id="584" class="Symbol">=</a> <a id="586" href="Untyped.html#414" class="InductiveConstructor">string</a> <a id="593" href="Scoped.Erasure.html#577" class="Bound">s</a>

<a id="eraseTm"></a><a id="596" href="Scoped.Erasure.html#596" class="Function">eraseTm</a> <a id="604" class="Symbol">:</a> <a id="606" class="Symbol">∀{</a><a id="608" href="Scoped.Erasure.html#608" class="Bound">n</a><a id="609" class="Symbol">}{</a><a id="611" href="Scoped.Erasure.html#611" class="Bound">i</a> <a id="613" class="Symbol">:</a> <a id="615" href="Scoped.html#1304" class="Datatype">Weirdℕ</a> <a id="622" href="Scoped.Erasure.html#608" class="Bound">n</a><a id="623" class="Symbol">}</a> <a id="625" class="Symbol">→</a> <a id="627" href="Scoped.html#2022" class="Datatype">ScopedTm</a> <a id="636" href="Scoped.Erasure.html#611" class="Bound">i</a> <a id="638" class="Symbol">→</a> <a id="640" href="Scoped.Erasure.html#196" class="Function">len</a> <a id="644" href="Scoped.Erasure.html#611" class="Bound">i</a> <a id="646" href="Untyped.html#485" class="Datatype Operator">⊢</a> 
<a id="eraseList"></a><a id="649" href="Scoped.Erasure.html#649" class="Function">eraseList</a> <a id="659" class="Symbol">:</a> <a id="661" class="Symbol">∀{</a><a id="663" href="Scoped.Erasure.html#663" class="Bound">n</a><a id="664" class="Symbol">}{</a><a id="666" href="Scoped.Erasure.html#666" class="Bound">i</a> <a id="668" class="Symbol">:</a> <a id="670" href="Scoped.html#1304" class="Datatype">Weirdℕ</a> <a id="677" href="Scoped.Erasure.html#663" class="Bound">n</a><a id="678" class="Symbol">}</a> <a id="680" class="Symbol">→</a> <a id="682" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="687" class="Symbol">(</a><a id="688" href="Scoped.html#2022" class="Datatype">ScopedTm</a> <a id="697" href="Scoped.Erasure.html#666" class="Bound">i</a><a id="698" class="Symbol">)</a> <a id="700" class="Symbol">→</a> <a id="702" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="707" class="Symbol">(</a><a id="708" href="Scoped.Erasure.html#196" class="Function">len</a> <a id="712" href="Scoped.Erasure.html#666" class="Bound">i</a> <a id="714" href="Untyped.html#485" class="Datatype Operator">⊢</a><a id="715" class="Symbol">)</a>

<a id="718" href="Scoped.Erasure.html#649" class="Function">eraseList</a> <a id="728" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>       <a id="737" class="Symbol">=</a> <a id="739" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>
<a id="742" href="Scoped.Erasure.html#649" class="Function">eraseList</a> <a id="752" class="Symbol">(</a><a id="753" href="Scoped.Erasure.html#753" class="Bound">t</a> <a id="755" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="757" href="Scoped.Erasure.html#757" class="Bound">ts</a><a id="759" class="Symbol">)</a> <a id="761" class="Symbol">=</a> <a id="763" href="Scoped.Erasure.html#596" class="Function">eraseTm</a> <a id="771" href="Scoped.Erasure.html#753" class="Bound">t</a> <a id="773" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="775" href="Scoped.Erasure.html#649" class="Function">eraseList</a> <a id="785" href="Scoped.Erasure.html#757" class="Bound">ts</a>

<a id="789" href="Scoped.Erasure.html#596" class="Function">eraseTm</a> <a id="797" class="Symbol">(</a><a id="798" href="Scoped.html#2063" class="InductiveConstructor">`</a> <a id="800" href="Scoped.Erasure.html#800" class="Bound">x</a><a id="801" class="Symbol">)</a>              <a id="816" class="Symbol">=</a> <a id="818" href="Untyped.html#506" class="InductiveConstructor">`</a> <a id="820" class="Symbol">(</a><a id="821" href="Scoped.Erasure.html#303" class="Function">eraseVar</a> <a id="830" href="Scoped.Erasure.html#800" class="Bound">x</a><a id="831" class="Symbol">)</a>
<a id="833" href="Scoped.Erasure.html#596" class="Function">eraseTm</a> <a id="841" class="Symbol">(</a><a id="842" href="Scoped.html#2099" class="InductiveConstructor">Λ</a> <a id="844" href="Scoped.Erasure.html#844" class="Bound">x</a> <a id="846" href="Scoped.Erasure.html#846" class="Bound">K</a> <a id="848" href="Scoped.Erasure.html#848" class="Bound">t</a><a id="849" class="Symbol">)</a>          <a id="860" class="Symbol">=</a> <a id="862" href="Scoped.Erasure.html#596" class="Function">eraseTm</a> <a id="870" href="Scoped.Erasure.html#848" class="Bound">t</a>
<a id="872" href="Scoped.Erasure.html#596" class="Function">eraseTm</a> <a id="880" class="Symbol">(</a><a id="881" href="Scoped.Erasure.html#881" class="Bound">t</a> <a id="883" href="Scoped.html#2161" class="InductiveConstructor Operator">·⋆</a> <a id="886" href="Scoped.Erasure.html#886" class="Bound">A</a><a id="887" class="Symbol">)</a>           <a id="899" class="Symbol">=</a> <a id="901" href="Scoped.Erasure.html#596" class="Function">eraseTm</a> <a id="909" href="Scoped.Erasure.html#881" class="Bound">t</a>
<a id="911" href="Scoped.Erasure.html#596" class="Function">eraseTm</a> <a id="919" class="Symbol">(</a><a id="920" href="Scoped.html#2210" class="InductiveConstructor">ƛ</a> <a id="922" href="Scoped.Erasure.html#922" class="Bound">x</a> <a id="924" href="Scoped.Erasure.html#924" class="Bound">A</a> <a id="926" href="Scoped.Erasure.html#926" class="Bound">t</a><a id="927" class="Symbol">)</a>          <a id="938" class="Symbol">=</a> <a id="940" href="Untyped.html#537" class="InductiveConstructor">ƛ</a> <a id="942" href="Scoped.Erasure.html#922" class="Bound">x</a> <a id="944" class="Symbol">(</a><a id="945" href="Scoped.Erasure.html#596" class="Function">eraseTm</a> <a id="953" href="Scoped.Erasure.html#926" class="Bound">t</a><a id="954" class="Symbol">)</a>
<a id="956" href="Scoped.Erasure.html#596" class="Function">eraseTm</a> <a id="964" class="Symbol">(</a><a id="965" href="Scoped.Erasure.html#965" class="Bound">t</a> <a id="967" href="Scoped.html#2272" class="InductiveConstructor Operator">·</a> <a id="969" href="Scoped.Erasure.html#969" class="Bound">u</a><a id="970" class="Symbol">)</a>            <a id="983" class="Symbol">=</a> <a id="985" href="Scoped.Erasure.html#596" class="Function">eraseTm</a> <a id="993" href="Scoped.Erasure.html#965" class="Bound">t</a> <a id="995" href="Untyped.html#579" class="InductiveConstructor Operator">·</a> <a id="997" href="Scoped.Erasure.html#596" class="Function">eraseTm</a> <a id="1005" href="Scoped.Erasure.html#969" class="Bound">u</a>
<a id="1007" href="Scoped.Erasure.html#596" class="Function">eraseTm</a> <a id="1015" class="Symbol">(</a><a id="1016" href="Scoped.html#2321" class="InductiveConstructor">con</a> <a id="1020" href="Scoped.Erasure.html#1020" class="Bound">c</a><a id="1021" class="Symbol">)</a>            <a id="1034" class="Symbol">=</a> <a id="1036" href="Untyped.html#614" class="InductiveConstructor">con</a> <a id="1040" class="Symbol">(</a><a id="1041" href="Scoped.Erasure.html#445" class="Function">eraseTC</a> <a id="1049" href="Scoped.Erasure.html#1020" class="Bound">c</a><a id="1050" class="Symbol">)</a>
<a id="1052" href="Scoped.Erasure.html#596" class="Function">eraseTm</a> <a id="1060" class="Symbol">(</a><a id="1061" href="Scoped.html#2354" class="InductiveConstructor">error</a> <a id="1067" href="Scoped.Erasure.html#1067" class="Bound">A</a><a id="1068" class="Symbol">)</a>          <a id="1079" class="Symbol">=</a> <a id="1081" href="Untyped.html#688" class="InductiveConstructor">error</a>
<a id="1087" href="Scoped.Erasure.html#596" class="Function">eraseTm</a> <a id="1095" class="Symbol">(</a><a id="1096" href="Scoped.html#2390" class="InductiveConstructor">builtin</a> <a id="1104" href="Scoped.Erasure.html#1104" class="Bound">bn</a> <a id="1107" href="Scoped.Erasure.html#1107" class="Bound">As</a> <a id="1110" href="Scoped.Erasure.html#1110" class="Bound">ts</a><a id="1112" class="Symbol">)</a> <a id="1114" class="Symbol">=</a> <a id="1116" href="Untyped.html#647" class="InductiveConstructor">builtin</a> <a id="1124" href="Scoped.Erasure.html#1104" class="Bound">bn</a> <a id="1127" class="Symbol">(</a><a id="1128" href="Scoped.Erasure.html#649" class="Function">eraseList</a> <a id="1138" href="Scoped.Erasure.html#1110" class="Bound">ts</a><a id="1140" class="Symbol">)</a>
<a id="1142" href="Scoped.Erasure.html#596" class="Function">eraseTm</a> <a id="1150" class="Symbol">(</a><a id="1151" href="Scoped.html#2482" class="InductiveConstructor">wrap</a> <a id="1156" href="Scoped.Erasure.html#1156" class="Bound">pat</a> <a id="1160" href="Scoped.Erasure.html#1160" class="Bound">arg</a> <a id="1164" href="Scoped.Erasure.html#1164" class="Bound">t</a><a id="1165" class="Symbol">)</a>   <a id="1169" class="Symbol">=</a> <a id="1171" href="Scoped.Erasure.html#596" class="Function">eraseTm</a> <a id="1179" href="Scoped.Erasure.html#1164" class="Bound">t</a>
<a id="1181" href="Scoped.Erasure.html#596" class="Function">eraseTm</a> <a id="1189" class="Symbol">(</a><a id="1190" href="Scoped.html#2544" class="InductiveConstructor">unwrap</a> <a id="1197" href="Scoped.Erasure.html#1197" class="Bound">t</a><a id="1198" class="Symbol">)</a>         <a id="1208" class="Symbol">=</a> <a id="1210" href="Scoped.Erasure.html#596" class="Function">eraseTm</a> <a id="1218" href="Scoped.Erasure.html#1197" class="Bound">t</a>
<a id="1220" class="Markup">\end{code}</a><a id="1230" class="Background">
</a></pre></body></html>