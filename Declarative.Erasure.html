<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Declarative.Erasure</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Markup">\begin{code}</a>
<a id="14" class="Keyword">module</a> <a id="21" href="Declarative.Erasure.html" class="Module">Declarative.Erasure</a> <a id="41" class="Keyword">where</a>
<a id="47" class="Markup">\end{code}</a><a id="57" class="Background">

</a><a id="59" class="Markup">\begin{code}</a>
<a id="72" class="Keyword">open</a> <a id="77" class="Keyword">import</a> <a id="84" href="Declarative.html" class="Module">Declarative</a>
<a id="96" class="Keyword">open</a> <a id="101" class="Keyword">import</a> <a id="108" href="Untyped.html" class="Module">Untyped</a>
<a id="116" class="Markup">\end{code}</a><a id="126" class="Background">

</a><a id="128" class="Markup">\begin{code}</a>
<a id="141" class="Keyword">open</a> <a id="146" class="Keyword">import</a> <a id="153" href="Type.html" class="Module">Type</a>
<a id="158" class="Keyword">open</a> <a id="163" class="Keyword">import</a> <a id="170" href="Declarative.html" class="Module">Declarative</a>
<a id="182" class="Keyword">open</a> <a id="187" class="Keyword">import</a> <a id="194" href="Builtin.Constant.Term.html" class="Module">Builtin.Constant.Term</a> <a id="216" href="Type.html#866" class="Datatype">Ctx⋆</a> <a id="221" href="Type.html#596" class="Datatype">Kind</a> <a id="226" href="Type.html#615" class="InductiveConstructor">*</a> <a id="228" href="Type.html#1945" class="Datatype Operator">_⊢⋆_</a> <a id="233" href="Type.html#2429" class="InductiveConstructor">con</a> <a id="237" class="Keyword">renaming</a> <a id="246" class="Symbol">(</a>TermCon <a id="255" class="Symbol">to</a> TyTermCon<a id="267" class="Symbol">)</a>
<a id="269" class="Keyword">open</a> <a id="274" class="Keyword">import</a> <a id="281" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="290" class="Keyword">open</a> <a id="295" class="Keyword">import</a> <a id="302" href="Data.Fin.html" class="Module">Data.Fin</a>
<a id="311" class="Keyword">open</a> <a id="316" class="Keyword">import</a> <a id="323" href="Data.List.html" class="Module">Data.List</a>

<a id="len"></a><a id="334" href="Declarative.Erasure.html#334" class="Function">len</a> <a id="338" class="Symbol">:</a> <a id="340" class="Symbol">∀{</a><a id="342" href="Declarative.Erasure.html#342" class="Bound">Φ</a><a id="343" class="Symbol">}</a> <a id="345" class="Symbol">→</a> <a id="347" href="Declarative.html#1486" class="Datatype">Ctx</a> <a id="351" href="Declarative.Erasure.html#342" class="Bound">Φ</a> <a id="353" class="Symbol">→</a> <a id="355" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a>
<a id="357" href="Declarative.Erasure.html#334" class="Function">len</a> <a id="361" href="Declarative.html#1511" class="InductiveConstructor">∅</a> <a id="363" class="Symbol">=</a> <a id="365" class="Number">0</a>
<a id="367" href="Declarative.Erasure.html#334" class="Function">len</a> <a id="371" class="Symbol">(</a><a id="372" href="Declarative.Erasure.html#372" class="Bound">Γ</a> <a id="374" href="Declarative.html#1523" class="InductiveConstructor Operator">,⋆</a> <a id="377" href="Declarative.Erasure.html#377" class="Bound">K</a><a id="378" class="Symbol">)</a> <a id="380" class="Symbol">=</a> <a id="382" href="Declarative.Erasure.html#334" class="Function">len</a> <a id="386" href="Declarative.Erasure.html#372" class="Bound">Γ</a>
<a id="388" href="Declarative.Erasure.html#334" class="Function">len</a> <a id="392" class="Symbol">(</a><a id="393" href="Declarative.Erasure.html#393" class="Bound">Γ</a> <a id="395" href="Declarative.html#1576" class="InductiveConstructor Operator">,</a> <a id="397" href="Declarative.Erasure.html#397" class="Bound">A</a><a id="398" class="Symbol">)</a>  <a id="401" class="Symbol">=</a> <a id="403" href="Agda.Builtin.Nat.html#196" class="InductiveConstructor">suc</a> <a id="407" class="Symbol">(</a><a id="408" href="Declarative.Erasure.html#334" class="Function">len</a> <a id="412" href="Declarative.Erasure.html#393" class="Bound">Γ</a><a id="413" class="Symbol">)</a>

<a id="eraseVar"></a><a id="416" href="Declarative.Erasure.html#416" class="Function">eraseVar</a> <a id="425" class="Symbol">:</a> <a id="427" class="Symbol">∀{</a><a id="429" href="Declarative.Erasure.html#429" class="Bound">Φ</a> <a id="431" href="Declarative.Erasure.html#431" class="Bound">Γ</a><a id="432" class="Symbol">}{</a><a id="434" href="Declarative.Erasure.html#434" class="Bound">A</a> <a id="436" class="Symbol">:</a> <a id="438" href="Declarative.Erasure.html#429" class="Bound">Φ</a> <a id="440" href="Type.html#1945" class="Datatype Operator">⊢⋆</a> <a id="443" href="Type.html#615" class="InductiveConstructor">*</a><a id="444" class="Symbol">}</a> <a id="446" class="Symbol">→</a> <a id="448" href="Declarative.Erasure.html#431" class="Bound">Γ</a> <a id="450" href="Declarative.html#2050" class="Datatype Operator">∋</a> <a id="452" href="Declarative.Erasure.html#434" class="Bound">A</a> <a id="454" class="Symbol">→</a> <a id="456" href="Data.Fin.Base.html#951" class="Datatype">Fin</a> <a id="460" class="Symbol">(</a><a id="461" href="Declarative.Erasure.html#334" class="Function">len</a> <a id="465" href="Declarative.Erasure.html#431" class="Bound">Γ</a><a id="466" class="Symbol">)</a>
<a id="468" href="Declarative.Erasure.html#416" class="Function">eraseVar</a> <a id="477" href="Declarative.html#2098" class="InductiveConstructor">Z</a>     <a id="483" class="Symbol">=</a> <a id="485" href="Data.Fin.Base.html#973" class="InductiveConstructor">zero</a>
<a id="490" href="Declarative.Erasure.html#416" class="Function">eraseVar</a> <a id="499" class="Symbol">(</a><a id="500" href="Declarative.html#2160" class="InductiveConstructor">S</a> <a id="502" href="Declarative.Erasure.html#502" class="Bound">α</a><a id="503" class="Symbol">)</a> <a id="505" class="Symbol">=</a> <a id="507" href="Data.Fin.Base.html#1004" class="InductiveConstructor">suc</a> <a id="511" class="Symbol">(</a><a id="512" href="Declarative.Erasure.html#416" class="Function">eraseVar</a> <a id="521" href="Declarative.Erasure.html#502" class="Bound">α</a><a id="522" class="Symbol">)</a> 
<a id="525" href="Declarative.Erasure.html#416" class="Function">eraseVar</a> <a id="534" class="Symbol">(</a><a id="535" href="Declarative.html#2237" class="InductiveConstructor">T</a> <a id="537" href="Declarative.Erasure.html#537" class="Bound">α</a><a id="538" class="Symbol">)</a> <a id="540" class="Symbol">=</a> <a id="542" href="Declarative.Erasure.html#416" class="Function">eraseVar</a> <a id="551" href="Declarative.Erasure.html#537" class="Bound">α</a>

<a id="eraseTC"></a><a id="554" href="Declarative.Erasure.html#554" class="Function">eraseTC</a> <a id="562" class="Symbol">:</a> <a id="564" class="Symbol">∀{</a><a id="566" href="Declarative.Erasure.html#566" class="Bound">Φ</a><a id="567" class="Symbol">}{</a><a id="569" href="Declarative.Erasure.html#569" class="Bound">Γ</a> <a id="571" class="Symbol">:</a> <a id="573" href="Declarative.html#1486" class="Datatype">Ctx</a> <a id="577" href="Declarative.Erasure.html#566" class="Bound">Φ</a><a id="578" class="Symbol">}{</a><a id="580" href="Declarative.Erasure.html#580" class="Bound">A</a> <a id="582" class="Symbol">:</a> <a id="584" href="Declarative.Erasure.html#566" class="Bound">Φ</a> <a id="586" href="Type.html#1945" class="Datatype Operator">⊢⋆</a> <a id="589" href="Type.html#615" class="InductiveConstructor">*</a><a id="590" class="Symbol">}</a> <a id="592" class="Symbol">→</a> <a id="594" href="Builtin.Constant.Term.html#300" class="Datatype">TyTermCon</a> <a id="604" href="Declarative.Erasure.html#580" class="Bound">A</a> <a id="606" class="Symbol">→</a> <a id="608" href="Untyped.html#332" class="Datatype">TermCon</a>
<a id="616" href="Declarative.Erasure.html#554" class="Function">eraseTC</a> <a id="624" class="Symbol">(</a><a id="625" href="Builtin.Constant.Term.html#335" class="InductiveConstructor">integer</a> <a id="633" href="Declarative.Erasure.html#633" class="Bound">i</a><a id="634" class="Symbol">)</a>    <a id="639" class="Symbol">=</a> <a id="641" href="Untyped.html#354" class="InductiveConstructor">integer</a> <a id="649" href="Declarative.Erasure.html#633" class="Bound">i</a>
<a id="651" href="Declarative.Erasure.html#554" class="Function">eraseTC</a> <a id="659" class="Symbol">(</a><a id="660" href="Builtin.Constant.Term.html#392" class="InductiveConstructor">bytestring</a> <a id="671" href="Declarative.Erasure.html#671" class="Bound">b</a><a id="672" class="Symbol">)</a> <a id="674" class="Symbol">=</a> <a id="676" href="Untyped.html#378" class="InductiveConstructor">bytestring</a> <a id="687" href="Declarative.Erasure.html#671" class="Bound">b</a>

<a id="690" class="Keyword">open</a> <a id="695" class="Keyword">import</a> <a id="702" href="Type.RenamingSubstitution.html" class="Module">Type.RenamingSubstitution</a>

<a id="eraseTel"></a><a id="729" href="Declarative.Erasure.html#729" class="Function">eraseTel</a> <a id="738" class="Symbol">:</a> <a id="740" class="Symbol">∀{</a><a id="742" href="Declarative.Erasure.html#742" class="Bound">Φ</a> <a id="744" href="Declarative.Erasure.html#744" class="Bound">Γ</a> <a id="746" href="Declarative.Erasure.html#746" class="Bound">Δ</a><a id="747" class="Symbol">}{</a><a id="749" href="Declarative.Erasure.html#749" class="Bound">σ</a> <a id="751" class="Symbol">:</a> <a id="753" href="Type.RenamingSubstitution.html#3977" class="Function">Sub</a> <a id="757" href="Declarative.Erasure.html#746" class="Bound">Δ</a> <a id="759" href="Declarative.Erasure.html#742" class="Bound">Φ</a><a id="760" class="Symbol">}{</a><a id="762" href="Declarative.Erasure.html#762" class="Bound">As</a> <a id="765" class="Symbol">:</a> <a id="767" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="772" class="Symbol">(</a><a id="773" href="Declarative.Erasure.html#746" class="Bound">Δ</a> <a id="775" href="Type.html#1945" class="Datatype Operator">⊢⋆</a> <a id="778" href="Type.html#615" class="InductiveConstructor">*</a><a id="779" class="Symbol">)}</a>
  <a id="784" class="Symbol">→</a> <a id="786" href="Declarative.html#2545" class="Function">Declarative.Tel</a> <a id="802" href="Declarative.Erasure.html#744" class="Bound">Γ</a> <a id="804" href="Declarative.Erasure.html#746" class="Bound">Δ</a> <a id="806" href="Declarative.Erasure.html#749" class="Bound">σ</a> <a id="808" href="Declarative.Erasure.html#762" class="Bound">As</a>
  <a id="813" class="Symbol">→</a> <a id="815" href="Untyped.html#465" class="Function">Untyped.Tel</a> <a id="827" class="Symbol">(</a><a id="828" href="Declarative.Erasure.html#334" class="Function">len</a> <a id="832" href="Declarative.Erasure.html#744" class="Bound">Γ</a><a id="833" class="Symbol">)</a>
<a id="erase"></a><a id="835" href="Declarative.Erasure.html#835" class="Function">erase</a> <a id="841" class="Symbol">:</a> <a id="843" class="Symbol">∀{</a><a id="845" href="Declarative.Erasure.html#845" class="Bound">Φ</a> <a id="847" href="Declarative.Erasure.html#847" class="Bound">Γ</a><a id="848" class="Symbol">}{</a><a id="850" href="Declarative.Erasure.html#850" class="Bound">A</a> <a id="852" class="Symbol">:</a> <a id="854" href="Declarative.Erasure.html#845" class="Bound">Φ</a> <a id="856" href="Type.html#1945" class="Datatype Operator">⊢⋆</a> <a id="859" href="Type.html#615" class="InductiveConstructor">*</a><a id="860" class="Symbol">}</a> <a id="862" class="Symbol">→</a> <a id="864" href="Declarative.Erasure.html#847" class="Bound">Γ</a> <a id="866" href="Declarative.html#2601" class="Datatype Operator">⊢</a> <a id="868" href="Declarative.Erasure.html#850" class="Bound">A</a> <a id="870" class="Symbol">→</a> <a id="872" href="Declarative.Erasure.html#334" class="Function">len</a> <a id="876" href="Declarative.Erasure.html#847" class="Bound">Γ</a> <a id="878" href="Untyped.html#485" class="Datatype Operator">⊢</a>

<a id="881" href="Declarative.Erasure.html#835" class="Function">erase</a> <a id="887" class="Symbol">(</a><a id="888" href="Declarative.html#2648" class="InductiveConstructor">`</a> <a id="890" href="Declarative.Erasure.html#890" class="Bound">α</a><a id="891" class="Symbol">)</a>             <a id="905" class="Symbol">=</a> <a id="907" href="Untyped.html#506" class="InductiveConstructor">`</a> <a id="909" class="Symbol">(</a><a id="910" href="Declarative.Erasure.html#416" class="Function">eraseVar</a> <a id="919" href="Declarative.Erasure.html#890" class="Bound">α</a><a id="920" class="Symbol">)</a>
<a id="922" href="Declarative.Erasure.html#835" class="Function">erase</a> <a id="928" class="Symbol">(</a><a id="929" href="Declarative.html#2706" class="InductiveConstructor">ƛ</a> <a id="931" href="Declarative.Erasure.html#931" class="Bound">x</a> <a id="933" href="Declarative.Erasure.html#933" class="Bound">t</a><a id="934" class="Symbol">)</a>           <a id="946" class="Symbol">=</a> <a id="948" href="Untyped.html#537" class="InductiveConstructor">ƛ</a> <a id="950" href="Declarative.Erasure.html#931" class="Bound">x</a> <a id="952" class="Symbol">(</a><a id="953" href="Declarative.Erasure.html#835" class="Function">erase</a> <a id="959" href="Declarative.Erasure.html#933" class="Bound">t</a><a id="960" class="Symbol">)</a> 
<a id="963" href="Declarative.Erasure.html#835" class="Function">erase</a> <a id="969" class="Symbol">(</a><a id="970" href="Declarative.Erasure.html#970" class="Bound">t</a> <a id="972" href="Declarative.html#2784" class="InductiveConstructor Operator">·</a> <a id="974" href="Declarative.Erasure.html#974" class="Bound">u</a><a id="975" class="Symbol">)</a>           <a id="987" class="Symbol">=</a> <a id="989" href="Declarative.Erasure.html#835" class="Function">erase</a> <a id="995" href="Declarative.Erasure.html#970" class="Bound">t</a> <a id="997" href="Untyped.html#579" class="InductiveConstructor Operator">·</a> <a id="999" href="Declarative.Erasure.html#835" class="Function">erase</a> <a id="1005" href="Declarative.Erasure.html#974" class="Bound">u</a>
<a id="1007" href="Declarative.Erasure.html#835" class="Function">erase</a> <a id="1013" class="Symbol">(</a><a id="1014" href="Declarative.html#2859" class="InductiveConstructor">Λ</a> <a id="1016" href="Declarative.Erasure.html#1016" class="Bound">x</a> <a id="1018" href="Declarative.Erasure.html#1018" class="Bound">t</a><a id="1019" class="Symbol">)</a>           <a id="1031" class="Symbol">=</a> <a id="1033" href="Declarative.Erasure.html#835" class="Function">erase</a> <a id="1039" href="Declarative.Erasure.html#1018" class="Bound">t</a>
<a id="1041" href="Declarative.Erasure.html#835" class="Function">erase</a> <a id="1047" class="Symbol">(</a><a id="1048" href="Declarative.Erasure.html#1048" class="Bound">t</a> <a id="1050" href="Declarative.html#2959" class="InductiveConstructor Operator">·⋆</a> <a id="1053" href="Declarative.Erasure.html#1053" class="Bound">A</a><a id="1054" class="Symbol">)</a>          <a id="1065" class="Symbol">=</a> <a id="1067" href="Declarative.Erasure.html#835" class="Function">erase</a> <a id="1073" href="Declarative.Erasure.html#1048" class="Bound">t</a>
<a id="1075" href="Declarative.Erasure.html#835" class="Function">erase</a> <a id="1081" class="Symbol">(</a><a id="1082" href="Declarative.html#3055" class="InductiveConstructor">wrap1</a> <a id="1088" href="Declarative.Erasure.html#1088" class="Bound">pat</a> <a id="1092" href="Declarative.Erasure.html#1092" class="Bound">arg</a> <a id="1096" href="Declarative.Erasure.html#1096" class="Bound">t</a><a id="1097" class="Symbol">)</a> <a id="1099" class="Symbol">=</a> <a id="1101" href="Declarative.Erasure.html#835" class="Function">erase</a> <a id="1107" href="Declarative.Erasure.html#1096" class="Bound">t</a>
<a id="1109" href="Declarative.Erasure.html#835" class="Function">erase</a> <a id="1115" class="Symbol">(</a><a id="1116" href="Declarative.html#3192" class="InductiveConstructor">unwrap1</a> <a id="1124" href="Declarative.Erasure.html#1124" class="Bound">t</a><a id="1125" class="Symbol">)</a>       <a id="1133" class="Symbol">=</a> <a id="1135" href="Declarative.Erasure.html#835" class="Function">erase</a> <a id="1141" href="Declarative.Erasure.html#1124" class="Bound">t</a>
<a id="1143" href="Declarative.Erasure.html#835" class="Function">erase</a> <a id="1149" class="Symbol">(</a><a id="1150" href="Declarative.html#3339" class="InductiveConstructor">conv</a> <a id="1155" href="Declarative.Erasure.html#1155" class="Bound">p</a> <a id="1157" href="Declarative.Erasure.html#1157" class="Bound">t</a><a id="1158" class="Symbol">)</a>        <a id="1167" class="Symbol">=</a> <a id="1169" href="Declarative.Erasure.html#835" class="Function">erase</a> <a id="1175" href="Declarative.Erasure.html#1157" class="Bound">t</a>
<a id="1177" href="Declarative.Erasure.html#835" class="Function">erase</a> <a id="1183" class="Symbol">{</a><a id="1184" href="Declarative.Erasure.html#1184" class="Bound">Φ</a><a id="1185" class="Symbol">}{</a><a id="1187" href="Declarative.Erasure.html#1187" class="Bound">Γ</a><a id="1188" class="Symbol">}</a> <a id="1190" class="Symbol">(</a><a id="1191" href="Declarative.html#3414" class="InductiveConstructor">con</a> <a id="1195" href="Declarative.Erasure.html#1195" class="Bound">t</a><a id="1196" class="Symbol">)</a>    <a id="1201" class="Symbol">=</a> <a id="1203" href="Untyped.html#614" class="InductiveConstructor">con</a> <a id="1207" class="Symbol">(</a><a id="1208" href="Declarative.Erasure.html#554" class="Function">eraseTC</a> <a id="1216" class="Symbol">{</a><a id="1217" class="Argument">Γ</a> <a id="1219" class="Symbol">=</a> <a id="1221" href="Declarative.Erasure.html#1187" class="Bound">Γ</a><a id="1222" class="Symbol">}</a> <a id="1224" href="Declarative.Erasure.html#1195" class="Bound">t</a><a id="1225" class="Symbol">)</a>
<a id="1227" href="Declarative.Erasure.html#835" class="Function">erase</a> <a id="1233" class="Symbol">(</a><a id="1234" href="Declarative.html#3503" class="InductiveConstructor">builtin</a> <a id="1242" href="Declarative.Erasure.html#1242" class="Bound">bn</a> <a id="1245" href="Declarative.Erasure.html#1245" class="Bound">σ</a> <a id="1247" href="Declarative.Erasure.html#1247" class="Bound">ts</a><a id="1249" class="Symbol">)</a> <a id="1251" class="Symbol">=</a> <a id="1253" href="Untyped.html#647" class="InductiveConstructor">builtin</a> <a id="1261" href="Declarative.Erasure.html#1242" class="Bound">bn</a> <a id="1264" class="Symbol">(</a><a id="1265" href="Declarative.Erasure.html#729" class="Function">eraseTel</a> <a id="1274" href="Declarative.Erasure.html#1247" class="Bound">ts</a><a id="1276" class="Symbol">)</a>
<a id="1278" href="Declarative.Erasure.html#835" class="Function">erase</a> <a id="1284" class="Symbol">(</a><a id="1285" href="Declarative.html#3766" class="InductiveConstructor">error</a> <a id="1291" href="Declarative.Erasure.html#1291" class="Bound">A</a><a id="1292" class="Symbol">)</a>         <a id="1302" class="Symbol">=</a> <a id="1304" href="Untyped.html#688" class="InductiveConstructor">error</a>

<a id="1311" class="Keyword">open</a> <a id="1316" class="Keyword">import</a> <a id="1323" href="Data.Product.html" class="Module">Data.Product</a> <a id="1336" class="Keyword">renaming</a> <a id="1345" class="Symbol">(</a><a id="1346" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">_,_</a> <a id="1350" class="Symbol">to</a> <a id="1353" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">_,,_</a><a id="1357" class="Symbol">)</a>

<a id="1360" href="Declarative.Erasure.html#729" class="Function">eraseTel</a> <a id="1369" class="Symbol">{</a><a id="1370" class="Argument">As</a> <a id="1373" class="Symbol">=</a> <a id="1375" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a><a id="1377" class="Symbol">}</a>     <a id="1383" class="Symbol">_</a>          <a id="1394" class="Symbol">=</a> <a id="1396" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>
<a id="1399" href="Declarative.Erasure.html#729" class="Function">eraseTel</a> <a id="1408" class="Symbol">{</a><a id="1409" class="Argument">As</a> <a id="1412" class="Symbol">=</a> <a id="1414" href="Declarative.Erasure.html#1414" class="Bound">x</a> <a id="1416" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1418" href="Declarative.Erasure.html#1418" class="Bound">As</a><a id="1420" class="Symbol">}</a> <a id="1422" class="Symbol">(</a><a id="1423" href="Declarative.Erasure.html#1423" class="Bound">t</a> <a id="1425" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,,</a> <a id="1428" href="Declarative.Erasure.html#1428" class="Bound">tel</a><a id="1431" class="Symbol">)</a> <a id="1433" class="Symbol">=</a> <a id="1435" href="Declarative.Erasure.html#835" class="Function">erase</a> <a id="1441" href="Declarative.Erasure.html#1423" class="Bound">t</a> <a id="1443" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1445" href="Declarative.Erasure.html#729" class="Function">eraseTel</a> <a id="1454" href="Declarative.Erasure.html#1428" class="Bound">tel</a>
<a id="1458" class="Markup">\end{code}</a><a id="1468" class="Background">
</a></pre></body></html>