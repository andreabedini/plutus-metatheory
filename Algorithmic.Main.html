<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Algorithmic.Main</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Markup">\begin{code}</a>
<a id="14" class="Keyword">module</a> <a id="21" href="Algorithmic.Main.html" class="Module">Algorithmic.Main</a> <a id="38" class="Keyword">where</a>
<a id="44" class="Keyword">open</a> <a id="49" class="Keyword">import</a> <a id="56" href="Agda.Builtin.IO.html" class="Module">Agda.Builtin.IO</a>
<a id="72" class="Keyword">open</a> <a id="77" class="Keyword">import</a> <a id="84" href="Agda.Builtin.Unit.html" class="Module">Agda.Builtin.Unit</a>
<a id="102" class="Keyword">open</a> <a id="107" class="Keyword">import</a> <a id="114" href="Agda.Builtin.String.html" class="Module">Agda.Builtin.String</a>

<a id="135" class="Keyword">open</a> <a id="140" class="Keyword">import</a> <a id="147" href="Type.html" class="Module">Type</a>
<a id="152" class="Keyword">open</a> <a id="157" class="Keyword">import</a> <a id="164" href="Type.BetaNormal.html" class="Module">Type.BetaNormal</a>
<a id="180" class="Keyword">open</a> <a id="185" class="Keyword">import</a> <a id="192" href="Algorithmic.html" class="Module">Algorithmic</a>
<a id="204" class="Keyword">open</a> <a id="209" class="Keyword">import</a> <a id="216" href="Algorithmic.Reduction.html" class="Module">Algorithmic.Reduction</a>

<a id="239" class="Keyword">open</a> <a id="244" class="Keyword">import</a> <a id="251" href="Algorithmic.Evaluation.html" class="Module">Algorithmic.Evaluation</a>
<a id="274" class="Keyword">open</a> <a id="279" class="Keyword">import</a> <a id="286" href="Builtin.html" class="Module">Builtin</a>
<a id="294" class="Keyword">open</a> <a id="299" class="Keyword">import</a> <a id="306" href="Builtin.Constant.Type.html" class="Module">Builtin.Constant.Type</a>
<a id="328" class="Keyword">open</a> <a id="333" class="Keyword">import</a> <a id="340" href="Builtin.Constant.Term.html" class="Module">Builtin.Constant.Term</a>
<a id="362" class="Keyword">open</a> <a id="367" class="Keyword">import</a> <a id="374" href="Builtin.Signature.html" class="Module">Builtin.Signature</a>

<a id="393" class="Keyword">open</a> <a id="398" class="Keyword">import</a> <a id="405" href="Function.html" class="Module">Function</a>
<a id="414" class="Keyword">open</a> <a id="419" class="Keyword">import</a> <a id="426" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a>
<a id="443" class="Keyword">open</a> <a id="448" class="Keyword">import</a> <a id="455" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="464" class="Keyword">open</a> <a id="469" class="Keyword">import</a> <a id="476" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="485" class="Keyword">hiding</a> <a id="492" class="Symbol">(</a><a id="493" href="Data.Vec.Base.html#1404" class="Function">length</a><a id="499" class="Symbol">)</a>
<a id="501" class="Keyword">open</a> <a id="506" class="Keyword">import</a> <a id="513" href="Agda.Builtin.Int.html" class="Module">Agda.Builtin.Int</a>
<a id="530" class="Keyword">open</a> <a id="535" class="Keyword">import</a> <a id="542" href="Data.Integer.html" class="Module">Data.Integer</a>
<a id="555" class="Keyword">open</a> <a id="560" class="Keyword">import</a> <a id="567" href="Data.Product.html" class="Module">Data.Product</a> <a id="580" class="Keyword">renaming</a> <a id="589" class="Symbol">(</a><a id="590" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="594" class="Symbol">to</a> <a id="Sigma._,_"></a><a id="597" href="Algorithmic.Main.html#597" class="InductiveConstructor Operator">_,,_</a><a id="601" class="Symbol">)</a>
<a id="603" class="Keyword">open</a> <a id="608" class="Keyword">import</a> <a id="615" href="Agda.Builtin.TrustMe.html" class="Module">Agda.Builtin.TrustMe</a>
<a id="636" class="Keyword">open</a> <a id="641" class="Keyword">import</a> <a id="648" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>


<a id="688" class="Keyword">postulate</a>
  <a id="putStrLn"></a><a id="700" href="Algorithmic.Main.html#700" class="Postulate">putStrLn</a> <a id="709" class="Symbol">:</a> <a id="711" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="718" class="Symbol">→</a> <a id="720" href="Agda.Builtin.IO.html#138" class="Postulate">IO</a> <a id="723" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>

<a id="726" class="Symbol">{-#</a> <a id="730" class="Keyword">FOREIGN</a> <a id="738" class="Pragma">GHC</a> <a id="742" class="Pragma">import</a> <a id="749" class="Pragma">qualified</a> <a id="759" class="Pragma">Data.Text.IO</a> <a id="772" class="Pragma">as</a> <a id="775" class="Pragma">Text</a> <a id="780" class="Symbol">#-}</a>
<a id="784" class="Symbol">{-#</a> <a id="788" class="Keyword">FOREIGN</a> <a id="796" class="Pragma">GHC</a> <a id="800" class="Pragma">import</a> <a id="807" class="Pragma">qualified</a> <a id="817" class="Pragma">Data.Text</a> <a id="827" class="Pragma">as</a> <a id="830" class="Pragma">T</a> <a id="832" class="Symbol">#-}</a>
<a id="836" class="Symbol">{-#</a> <a id="840" class="Keyword">COMPILE</a> <a id="848" class="Keyword">GHC</a> <a id="852" href="Algorithmic.Main.html#700" class="Postulate">putStrLn</a> <a id="861" class="Pragma">=</a> <a id="863" class="Pragma">Text.putStrLn</a> <a id="877" class="Symbol">#-}</a>

<a id="882" class="Comment">--open import Algorithmic.Examples</a>

<a id="918" class="Keyword">postulate</a>
  <a id="str1"></a><a id="930" href="Algorithmic.Main.html#930" class="Postulate">str1</a> <a id="935" class="Symbol">:</a> <a id="937" href="Builtin.Constant.Type.html#616" class="Postulate">ByteString</a>
  <a id="str2"></a><a id="950" href="Algorithmic.Main.html#950" class="Postulate">str2</a> <a id="955" class="Symbol">:</a> <a id="957" href="Builtin.Constant.Type.html#616" class="Postulate">ByteString</a>

  <a id="printByteString"></a><a id="971" href="Algorithmic.Main.html#971" class="Postulate">printByteString</a> <a id="987" class="Symbol">:</a> <a id="989" href="Builtin.Constant.Type.html#616" class="Postulate">ByteString</a> <a id="1000" class="Symbol">-&gt;</a> <a id="1003" href="Agda.Builtin.String.html#274" class="Postulate">String</a>

<a id="1011" class="Symbol">{-#</a> <a id="1015" class="Keyword">FOREIGN</a> <a id="1023" class="Pragma">GHC</a> <a id="1027" class="Pragma">import</a> <a id="1034" class="Pragma">qualified</a> <a id="1044" class="Pragma">Data.ByteString.Char8</a> <a id="1066" class="Pragma">as</a> <a id="1069" class="Pragma">BS</a> <a id="1072" class="Symbol">#-}</a>
<a id="1076" class="Symbol">{-#</a> <a id="1080" class="Keyword">COMPILE</a> <a id="1088" class="Keyword">GHC</a> <a id="1092" href="Algorithmic.Main.html#930" class="Postulate">str1</a> <a id="1097" class="Pragma">=</a> <a id="1099" class="Pragma">BS.pack</a> <a id="1107" class="Pragma">&quot;Hello,</a> <a id="1115" class="Pragma">&quot;</a> <a id="1117" class="Symbol">#-}</a>
<a id="1121" class="Symbol">{-#</a> <a id="1125" class="Keyword">COMPILE</a> <a id="1133" class="Keyword">GHC</a> <a id="1137" href="Algorithmic.Main.html#950" class="Postulate">str2</a> <a id="1142" class="Pragma">=</a> <a id="1144" class="Pragma">BS.pack</a> <a id="1152" class="Pragma">&quot;world&quot;</a>   <a id="1162" class="Symbol">#-}</a>
<a id="1166" class="Symbol">{-#</a> <a id="1170" class="Keyword">COMPILE</a> <a id="1178" class="Keyword">GHC</a> <a id="1182" href="Algorithmic.Main.html#971" class="Postulate">printByteString</a> <a id="1198" class="Pragma">=</a> <a id="1200" class="Pragma">T.pack</a> <a id="1207" class="Pragma">.</a> <a id="1209" class="Pragma">BS.unpack</a> <a id="1219" class="Symbol">#-}</a>

<a id="lemma1"></a><a id="1224" href="Algorithmic.Main.html#1224" class="Function">lemma1</a> <a id="1231" class="Symbol">:</a> <a id="1233" href="Builtin.Constant.Type.html#635" class="Postulate">length</a> <a id="1240" href="Algorithmic.Main.html#930" class="Postulate">str1</a> <a id="1245" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1247" class="Number">7</a>
<a id="1249" href="Algorithmic.Main.html#1224" class="Function">lemma1</a> <a id="1256" class="Symbol">=</a> <a id="1258" href="Agda.Builtin.TrustMe.html#258" class="Function">primTrustMe</a> 
<a id="lemma2"></a><a id="1271" href="Algorithmic.Main.html#1271" class="Function">lemma2</a> <a id="1278" class="Symbol">:</a> <a id="1280" href="Builtin.Constant.Type.html#635" class="Postulate">length</a> <a id="1287" href="Algorithmic.Main.html#950" class="Postulate">str2</a> <a id="1292" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1294" class="Number">7</a>
<a id="1296" href="Algorithmic.Main.html#1271" class="Function">lemma2</a> <a id="1303" class="Symbol">=</a> <a id="1305" href="Agda.Builtin.TrustMe.html#258" class="Function">primTrustMe</a>

<a id="1318" class="Comment">{-
constr1 : ∀{Γ} → Γ ⊢ con bytestring (size⋆ 16)
constr1 = con (bytestring 16 str1 (subst (λ x → x Data.Nat.≤ 16) (sym lemma1) (s≤s (s≤s (s≤s (s≤s (s≤s (s≤s (s≤s z≤n)))))))))
-}</a>

<a id="1498" class="Comment">{-
constr2 : ∀{Γ} → Γ ⊢ con bytestring (size⋆ 16)
constr2 = con (bytestring 16 str2 (subst (λ x → x Data.Nat.≤ 16) (sym lemma2) (s≤s (s≤s (s≤s (s≤s (s≤s (s≤s (s≤s z≤n)))))))))
-}</a>

<a id="1678" class="Comment">{-
append12 : ∀{Γ} → Γ ⊢ con bytestring (size⋆ 16)
append12 = builtin concatenate (λ { Z → size⋆ 16 ; (S ())}) (constr1 ,, constr2 ,, tt)
-}</a>

<a id="con1"></a><a id="1820" href="Algorithmic.Main.html#1820" class="Function">con1</a> <a id="1825" class="Symbol">:</a> <a id="1827" class="Symbol">∀{</a><a id="1829" href="Algorithmic.Main.html#1829" class="Bound">Φ</a><a id="1830" class="Symbol">}{</a><a id="1832" href="Algorithmic.Main.html#1832" class="Bound">Γ</a> <a id="1834" class="Symbol">:</a> <a id="1836" href="Algorithmic.html#1224" class="Datatype">Ctx</a> <a id="1840" href="Algorithmic.Main.html#1829" class="Bound">Φ</a><a id="1841" class="Symbol">}</a> <a id="1843" class="Symbol">→</a> <a id="1845" href="Algorithmic.Main.html#1832" class="Bound">Γ</a> <a id="1847" href="Algorithmic.html#5489" class="Datatype Operator">⊢</a> <a id="1849" href="Type.BetaNormal.html#1365" class="InductiveConstructor">con</a> <a id="1853" href="Builtin.Constant.Type.html#2918" class="InductiveConstructor">integer</a>
<a id="1861" href="Algorithmic.Main.html#1820" class="Function">con1</a> <a id="1866" class="Symbol">=</a> <a id="1868" href="Algorithmic.html#6270" class="InductiveConstructor">con</a> <a id="1872" class="Symbol">(</a><a id="1873" href="Builtin.Constant.Term.html#382" class="InductiveConstructor">integer</a> <a id="1881" class="Symbol">(</a><a id="1882" href="Agda.Builtin.Int.html#264" class="InductiveConstructor">pos</a> <a id="1886" class="Number">1</a><a id="1887" class="Symbol">))</a> <a id="1890" class="Comment">-- _) -- (-≤+ ,, (+≤+ (s≤s (s≤s z≤n)))))</a>

<a id="con2"></a><a id="1932" href="Algorithmic.Main.html#1932" class="Function">con2</a> <a id="1937" class="Symbol">:</a> <a id="1939" class="Symbol">∀{</a><a id="1941" href="Algorithmic.Main.html#1941" class="Bound">Φ</a><a id="1942" class="Symbol">}{</a><a id="1944" href="Algorithmic.Main.html#1944" class="Bound">Γ</a> <a id="1946" class="Symbol">:</a> <a id="1948" href="Algorithmic.html#1224" class="Datatype">Ctx</a> <a id="1952" href="Algorithmic.Main.html#1941" class="Bound">Φ</a><a id="1953" class="Symbol">}</a> <a id="1955" class="Symbol">→</a> <a id="1957" href="Algorithmic.Main.html#1944" class="Bound">Γ</a> <a id="1959" href="Algorithmic.html#5489" class="Datatype Operator">⊢</a> <a id="1961" href="Type.BetaNormal.html#1365" class="InductiveConstructor">con</a> <a id="1965" href="Builtin.Constant.Type.html#2918" class="InductiveConstructor">integer</a>
<a id="1973" href="Algorithmic.Main.html#1932" class="Function">con2</a> <a id="1978" class="Symbol">=</a> <a id="1980" href="Algorithmic.html#6270" class="InductiveConstructor">con</a> <a id="1984" class="Symbol">(</a><a id="1985" href="Builtin.Constant.Term.html#382" class="InductiveConstructor">integer</a> <a id="1993" class="Symbol">(</a><a id="1994" href="Agda.Builtin.Int.html#264" class="InductiveConstructor">pos</a> <a id="1998" class="Number">2</a><a id="1999" class="Symbol">))</a> <a id="2002" class="Comment">-- _) -- (-≤+ ,, (+≤+ (s≤s (s≤s (s≤s z≤n))))))</a>

<a id="builtin2plus2"></a><a id="2050" href="Algorithmic.Main.html#2050" class="Function">builtin2plus2</a> <a id="2064" class="Symbol">:</a> <a id="2066" href="Algorithmic.html#1249" class="InductiveConstructor">∅</a> <a id="2068" href="Algorithmic.html#5489" class="Datatype Operator">⊢</a> <a id="2070" href="Type.BetaNormal.html#1365" class="InductiveConstructor">con</a> <a id="2074" href="Builtin.Constant.Type.html#2918" class="InductiveConstructor">integer</a>
<a id="2082" href="Algorithmic.Main.html#2050" class="Function">builtin2plus2</a> <a id="2096" class="Symbol">=</a> <a id="2098" href="Algorithmic.html#6358" class="InductiveConstructor">ibuiltin</a> <a id="2107" href="Builtin.html#63" class="InductiveConstructor">addInteger</a> <a id="2118" href="Algorithmic.html#5672" class="InductiveConstructor Operator">·</a> <a id="2120" href="Algorithmic.Main.html#1932" class="Function">con2</a> <a id="2125" href="Algorithmic.html#5672" class="InductiveConstructor Operator">·</a> <a id="2127" href="Algorithmic.Main.html#1932" class="Function">con2</a>

<a id="2133" class="Comment">{-
inc : ∅ ⊢ Π (con integer (ne (` Z)) ⇒ con integer (ne (` Z)))
inc = Λ (ƛ (builtin addInteger (ne ∘ `) ((builtin resizeInteger (λ { Z → (ne (` Z)) ; (S Z) → size⋆ 8 ; (S (S ()))}) (builtin sizeOfInteger (ne ∘ `) (` Z ,, tt) ,, (con1 ,, tt))) ,, (` Z) ,, tt)))

builtininc2&#39; : ∅ ⊢ con integer (size⋆ 8)
builtininc2&#39; = (inc ·⋆ size⋆ 8) · con2

printInt : (x : ∅ ⊢ con integer (size⋆ 8)) → Value x → ℤ
printInt .(con (integer 8 i x)) (V-con (integer .8 i x)) = i

printBS : (x : ∅ ⊢ con bytestring (size⋆ 16)) → Value x → String
printBS .(con (bytestring 16 b x)) (V-con (bytestring .16 b x)) =
  printByteString b


helpX :  ∀{A : ∅ ⊢Nf⋆ *}(M : ∅ ⊢ A) → Steps M → String
helpX M (steps x (done n v)) = &quot;it terminated&quot;
helpX M (steps x out-of-gas) = &quot;out of gas...&quot;
helpX M error                = &quot;something went wrong...&quot;

help :  (M : ∅ ⊢ con integer (size⋆ 8)) → Steps M → String
help M (steps x (done n v)) = show (printInt n v)
help M (steps x out-of-gas) = &quot;out of gas...&quot;
help M error                = &quot;something went wrong...&quot;

helpB :  (M : ∅ ⊢ con bytestring (size⋆ 16)) → Steps M → String
helpB M (steps x (done n v)) = printBS n v
helpB M (steps x out-of-gas) = &quot;out of gas...&quot;
helpB M error                = &quot;something went wrong...&quot;

main : IO ⊤
main = putStrLn (help _ (eval (gas 100) builtininc2&#39;))
-}</a>
<a id="3450" class="Markup">\end{code}</a><a id="3460" class="Background">
</a></pre></body></html>