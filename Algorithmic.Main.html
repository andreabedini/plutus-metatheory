<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Algorithmic.Main</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Markup">\begin{code}</a>
<a id="14" class="Keyword">module</a> <a id="21" href="Algorithmic.Main.html" class="Module">Algorithmic.Main</a> <a id="38" class="Keyword">where</a>
<a id="44" class="Keyword">open</a> <a id="49" class="Keyword">import</a> <a id="56" href="Agda.Builtin.IO.html" class="Module">Agda.Builtin.IO</a>
<a id="72" class="Keyword">open</a> <a id="77" class="Keyword">import</a> <a id="84" href="Agda.Builtin.Unit.html" class="Module">Agda.Builtin.Unit</a>
<a id="102" class="Keyword">open</a> <a id="107" class="Keyword">import</a> <a id="114" href="Agda.Builtin.String.html" class="Module">Agda.Builtin.String</a>

<a id="135" class="Keyword">open</a> <a id="140" class="Keyword">import</a> <a id="147" href="Type.html" class="Module">Type</a>
<a id="152" class="Keyword">open</a> <a id="157" class="Keyword">import</a> <a id="164" href="Type.BetaNormal.html" class="Module">Type.BetaNormal</a>
<a id="180" class="Keyword">open</a> <a id="185" class="Keyword">import</a> <a id="192" href="Algorithmic.html" class="Module">Algorithmic</a>
<a id="204" class="Keyword">open</a> <a id="209" class="Keyword">import</a> <a id="216" href="Algorithmic.Reduction.html" class="Module">Algorithmic.Reduction</a>

<a id="239" class="Keyword">open</a> <a id="244" class="Keyword">import</a> <a id="251" href="Algorithmic.Evaluation.html" class="Module">Algorithmic.Evaluation</a>
<a id="274" class="Keyword">open</a> <a id="279" class="Keyword">import</a> <a id="286" href="Builtin.html" class="Module">Builtin</a>
<a id="294" class="Keyword">open</a> <a id="299" class="Keyword">import</a> <a id="306" href="Builtin.Constant.Type.html" class="Module">Builtin.Constant.Type</a>
<a id="328" class="Keyword">open</a> <a id="333" class="Keyword">import</a> <a id="340" href="Builtin.Constant.Term.html" class="Module">Builtin.Constant.Term</a>
<a id="362" class="Keyword">open</a> <a id="367" class="Keyword">import</a> <a id="374" href="Builtin.Signature.html" class="Module">Builtin.Signature</a>

<a id="393" class="Keyword">open</a> <a id="398" class="Keyword">import</a> <a id="405" href="Function.html" class="Module">Function</a>
<a id="414" class="Keyword">open</a> <a id="419" class="Keyword">import</a> <a id="426" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a>
<a id="443" class="Keyword">open</a> <a id="448" class="Keyword">import</a> <a id="455" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="464" class="Keyword">open</a> <a id="469" class="Keyword">import</a> <a id="476" href="Agda.Builtin.Int.html" class="Module">Agda.Builtin.Int</a>
<a id="493" class="Keyword">open</a> <a id="498" class="Keyword">import</a> <a id="505" href="Data.Integer.html" class="Module">Data.Integer</a>
<a id="518" class="Keyword">open</a> <a id="523" class="Keyword">import</a> <a id="530" href="Data.Product.html" class="Module">Data.Product</a> <a id="543" class="Keyword">renaming</a> <a id="552" class="Symbol">(</a><a id="553" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">_,_</a> <a id="557" class="Symbol">to</a> <a id="560" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">_,,_</a><a id="564" class="Symbol">)</a>
<a id="566" class="Keyword">open</a> <a id="571" class="Keyword">import</a> <a id="578" href="Agda.Builtin.TrustMe.html" class="Module">Agda.Builtin.TrustMe</a>
<a id="599" class="Keyword">open</a> <a id="604" class="Keyword">import</a> <a id="611" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>


<a id="651" class="Keyword">postulate</a>
  <a id="putStrLn"></a><a id="663" href="Algorithmic.Main.html#663" class="Postulate">putStrLn</a> <a id="672" class="Symbol">:</a> <a id="674" href="Agda.Builtin.String.html#206" class="Postulate">String</a> <a id="681" class="Symbol">→</a> <a id="683" href="Agda.Builtin.IO.html#111" class="Postulate">IO</a> <a id="686" href="Agda.Builtin.Unit.html#137" class="Record">⊤</a>

<a id="689" class="Symbol">{-#</a> <a id="693" class="Keyword">FOREIGN</a> <a id="701" class="Pragma">GHC</a> <a id="705" class="Pragma">import</a> <a id="712" class="Pragma">qualified</a> <a id="722" class="Pragma">Data.Text.IO</a> <a id="735" class="Pragma">as</a> <a id="738" class="Pragma">Text</a> <a id="743" class="Symbol">#-}</a>
<a id="747" class="Symbol">{-#</a> <a id="751" class="Keyword">FOREIGN</a> <a id="759" class="Pragma">GHC</a> <a id="763" class="Pragma">import</a> <a id="770" class="Pragma">qualified</a> <a id="780" class="Pragma">Data.Text</a> <a id="790" class="Pragma">as</a> <a id="793" class="Pragma">T</a> <a id="795" class="Symbol">#-}</a>
<a id="799" class="Symbol">{-#</a> <a id="803" class="Keyword">COMPILE</a> <a id="811" class="Pragma">GHC</a> <a id="815" href="Algorithmic.Main.html#663" class="Postulate">putStrLn</a> <a id="824" class="Pragma">=</a> <a id="826" class="Pragma">Text.putStrLn</a> <a id="840" class="Symbol">#-}</a>

<a id="845" class="Comment">--open import Algorithmic.Examples</a>

<a id="881" class="Keyword">postulate</a>
  <a id="str1"></a><a id="893" href="Algorithmic.Main.html#893" class="Postulate">str1</a> <a id="898" class="Symbol">:</a> <a id="900" href="Builtin.Constant.Type.html#517" class="Postulate">ByteString</a>
  <a id="str2"></a><a id="913" href="Algorithmic.Main.html#913" class="Postulate">str2</a> <a id="918" class="Symbol">:</a> <a id="920" href="Builtin.Constant.Type.html#517" class="Postulate">ByteString</a>

  <a id="printByteString"></a><a id="934" href="Algorithmic.Main.html#934" class="Postulate">printByteString</a> <a id="950" class="Symbol">:</a> <a id="952" href="Builtin.Constant.Type.html#517" class="Postulate">ByteString</a> <a id="963" class="Symbol">-&gt;</a> <a id="966" href="Agda.Builtin.String.html#206" class="Postulate">String</a>

<a id="974" class="Symbol">{-#</a> <a id="978" class="Keyword">FOREIGN</a> <a id="986" class="Pragma">GHC</a> <a id="990" class="Pragma">import</a> <a id="997" class="Pragma">qualified</a> <a id="1007" class="Pragma">Data.ByteString.Char8</a> <a id="1029" class="Pragma">as</a> <a id="1032" class="Pragma">BS</a> <a id="1035" class="Symbol">#-}</a>
<a id="1039" class="Symbol">{-#</a> <a id="1043" class="Keyword">COMPILE</a> <a id="1051" class="Pragma">GHC</a> <a id="1055" href="Algorithmic.Main.html#893" class="Postulate">str1</a> <a id="1060" class="Pragma">=</a> <a id="1062" class="Pragma">BS.pack</a> <a id="1070" class="Pragma">&quot;Hello,</a> <a id="1078" class="Pragma">&quot;</a> <a id="1080" class="Symbol">#-}</a>
<a id="1084" class="Symbol">{-#</a> <a id="1088" class="Keyword">COMPILE</a> <a id="1096" class="Pragma">GHC</a> <a id="1100" href="Algorithmic.Main.html#913" class="Postulate">str2</a> <a id="1105" class="Pragma">=</a> <a id="1107" class="Pragma">BS.pack</a> <a id="1115" class="Pragma">&quot;world&quot;</a>   <a id="1125" class="Symbol">#-}</a>
<a id="1129" class="Symbol">{-#</a> <a id="1133" class="Keyword">COMPILE</a> <a id="1141" class="Pragma">GHC</a> <a id="1145" href="Algorithmic.Main.html#934" class="Postulate">printByteString</a> <a id="1161" class="Pragma">=</a> <a id="1163" class="Pragma">T.pack</a> <a id="1170" class="Pragma">.</a> <a id="1172" class="Pragma">BS.unpack</a> <a id="1182" class="Symbol">#-}</a>

<a id="lemma1"></a><a id="1187" href="Algorithmic.Main.html#1187" class="Function">lemma1</a> <a id="1194" class="Symbol">:</a> <a id="1196" href="Builtin.Constant.Type.html#536" class="Postulate">length</a> <a id="1203" href="Algorithmic.Main.html#893" class="Postulate">str1</a> <a id="1208" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="1210" class="Number">7</a>
<a id="1212" href="Algorithmic.Main.html#1187" class="Function">lemma1</a> <a id="1219" class="Symbol">=</a> <a id="1221" href="Agda.Builtin.TrustMe.html#242" class="Function">primTrustMe</a> 
<a id="lemma2"></a><a id="1234" href="Algorithmic.Main.html#1234" class="Function">lemma2</a> <a id="1241" class="Symbol">:</a> <a id="1243" href="Builtin.Constant.Type.html#536" class="Postulate">length</a> <a id="1250" href="Algorithmic.Main.html#913" class="Postulate">str2</a> <a id="1255" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="1257" class="Number">7</a>
<a id="1259" href="Algorithmic.Main.html#1234" class="Function">lemma2</a> <a id="1266" class="Symbol">=</a> <a id="1268" href="Agda.Builtin.TrustMe.html#242" class="Function">primTrustMe</a>

<a id="1281" class="Comment">{-
constr1 : ∀{Γ} → Γ ⊢ con bytestring (size⋆ 16)
constr1 = con (bytestring 16 str1 (subst (λ x → x Data.Nat.≤ 16) (sym lemma1) (s≤s (s≤s (s≤s (s≤s (s≤s (s≤s (s≤s z≤n)))))))))
-}</a>

<a id="1461" class="Comment">{-
constr2 : ∀{Γ} → Γ ⊢ con bytestring (size⋆ 16)
constr2 = con (bytestring 16 str2 (subst (λ x → x Data.Nat.≤ 16) (sym lemma2) (s≤s (s≤s (s≤s (s≤s (s≤s (s≤s (s≤s z≤n)))))))))
-}</a>

<a id="1641" class="Comment">{-
append12 : ∀{Γ} → Γ ⊢ con bytestring (size⋆ 16)
append12 = builtin concatenate (λ { Z → size⋆ 16 ; (S ())}) (constr1 ,, constr2 ,, tt)
-}</a>

<a id="con1"></a><a id="1783" href="Algorithmic.Main.html#1783" class="Function">con1</a> <a id="1788" class="Symbol">:</a> <a id="1790" class="Symbol">∀{</a><a id="1792" href="Algorithmic.Main.html#1792" class="Bound">Φ</a><a id="1793" class="Symbol">}{</a><a id="1795" href="Algorithmic.Main.html#1795" class="Bound">Γ</a> <a id="1797" class="Symbol">:</a> <a id="1799" href="Algorithmic.html#1128" class="Datatype">Ctx</a> <a id="1803" href="Algorithmic.Main.html#1792" class="Bound">Φ</a><a id="1804" class="Symbol">}</a> <a id="1806" class="Symbol">→</a> <a id="1808" href="Algorithmic.Main.html#1795" class="Bound">Γ</a> <a id="1810" href="Algorithmic.html#2242" class="Datatype Operator">⊢</a> <a id="1812" href="Type.BetaNormal.html#1509" class="InductiveConstructor">con</a> <a id="1816" href="Builtin.Constant.Type.html#4877" class="InductiveConstructor">integer</a>
<a id="1824" href="Algorithmic.Main.html#1783" class="Function">con1</a> <a id="1829" class="Symbol">=</a> <a id="1831" href="Algorithmic.html#3129" class="InductiveConstructor">con</a> <a id="1835" class="Symbol">(</a><a id="1836" href="Builtin.Constant.Term.html#335" class="InductiveConstructor">integer</a> <a id="1844" class="Symbol">(</a><a id="1845" href="Agda.Builtin.Int.html#237" class="InductiveConstructor">pos</a> <a id="1849" class="Number">1</a><a id="1850" class="Symbol">))</a> <a id="1853" class="Comment">-- _) -- (-≤+ ,, (+≤+ (s≤s (s≤s z≤n)))))</a>

<a id="con2"></a><a id="1895" href="Algorithmic.Main.html#1895" class="Function">con2</a> <a id="1900" class="Symbol">:</a> <a id="1902" class="Symbol">∀{</a><a id="1904" href="Algorithmic.Main.html#1904" class="Bound">Φ</a><a id="1905" class="Symbol">}{</a><a id="1907" href="Algorithmic.Main.html#1907" class="Bound">Γ</a> <a id="1909" class="Symbol">:</a> <a id="1911" href="Algorithmic.html#1128" class="Datatype">Ctx</a> <a id="1915" href="Algorithmic.Main.html#1904" class="Bound">Φ</a><a id="1916" class="Symbol">}</a> <a id="1918" class="Symbol">→</a> <a id="1920" href="Algorithmic.Main.html#1907" class="Bound">Γ</a> <a id="1922" href="Algorithmic.html#2242" class="Datatype Operator">⊢</a> <a id="1924" href="Type.BetaNormal.html#1509" class="InductiveConstructor">con</a> <a id="1928" href="Builtin.Constant.Type.html#4877" class="InductiveConstructor">integer</a>
<a id="1936" href="Algorithmic.Main.html#1895" class="Function">con2</a> <a id="1941" class="Symbol">=</a> <a id="1943" href="Algorithmic.html#3129" class="InductiveConstructor">con</a> <a id="1947" class="Symbol">(</a><a id="1948" href="Builtin.Constant.Term.html#335" class="InductiveConstructor">integer</a> <a id="1956" class="Symbol">(</a><a id="1957" href="Agda.Builtin.Int.html#237" class="InductiveConstructor">pos</a> <a id="1961" class="Number">2</a><a id="1962" class="Symbol">))</a> <a id="1965" class="Comment">-- _) -- (-≤+ ,, (+≤+ (s≤s (s≤s (s≤s z≤n))))))</a>

<a id="builtin2plus2"></a><a id="2013" href="Algorithmic.Main.html#2013" class="Function">builtin2plus2</a> <a id="2027" class="Symbol">:</a> <a id="2029" href="Algorithmic.html#1153" class="InductiveConstructor">∅</a> <a id="2031" href="Algorithmic.html#2242" class="Datatype Operator">⊢</a> <a id="2033" href="Type.BetaNormal.html#1509" class="InductiveConstructor">con</a> <a id="2037" href="Builtin.Constant.Type.html#4877" class="InductiveConstructor">integer</a>
<a id="2045" href="Algorithmic.Main.html#2013" class="Function">builtin2plus2</a> <a id="2059" class="Symbol">=</a> <a id="2061" href="Algorithmic.html#3231" class="InductiveConstructor">builtin</a>
  <a id="2071" href="Builtin.html#63" class="InductiveConstructor">addInteger</a>
  <a id="2084" class="Symbol">(λ</a> <a id="2087" class="Symbol">{()})</a>
  <a id="2095" class="Symbol">(</a><a id="2096" href="Algorithmic.Main.html#1895" class="Function">con2</a> <a id="2101" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,,</a> <a id="2104" href="Algorithmic.Main.html#1895" class="Function">con2</a> <a id="2109" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,,</a> <a id="2112" href="Agda.Builtin.Unit.html#174" class="InductiveConstructor">tt</a><a id="2114" class="Symbol">)</a>

<a id="2117" class="Comment">{-
inc : ∅ ⊢ Π (con integer (ne (` Z)) ⇒ con integer (ne (` Z)))
inc = Λ (ƛ (builtin addInteger (ne ∘ `) ((builtin resizeInteger (λ { Z → (ne (` Z)) ; (S Z) → size⋆ 8 ; (S (S ()))}) (builtin sizeOfInteger (ne ∘ `) (` Z ,, tt) ,, (con1 ,, tt))) ,, (` Z) ,, tt)))

builtininc2&#39; : ∅ ⊢ con integer (size⋆ 8)
builtininc2&#39; = (inc ·⋆ size⋆ 8) · con2

printInt : (x : ∅ ⊢ con integer (size⋆ 8)) → Value x → ℤ
printInt .(con (integer 8 i x)) (V-con (integer .8 i x)) = i

printBS : (x : ∅ ⊢ con bytestring (size⋆ 16)) → Value x → String
printBS .(con (bytestring 16 b x)) (V-con (bytestring .16 b x)) =
  printByteString b


helpX :  ∀{A : ∅ ⊢Nf⋆ *}(M : ∅ ⊢ A) → Steps M → String
helpX M (steps x (done n v)) = &quot;it terminated&quot;
helpX M (steps x out-of-gas) = &quot;out of gas...&quot;
helpX M error                = &quot;something went wrong...&quot;

help :  (M : ∅ ⊢ con integer (size⋆ 8)) → Steps M → String
help M (steps x (done n v)) = show (printInt n v)
help M (steps x out-of-gas) = &quot;out of gas...&quot;
help M error                = &quot;something went wrong...&quot;

helpB :  (M : ∅ ⊢ con bytestring (size⋆ 16)) → Steps M → String
helpB M (steps x (done n v)) = printBS n v
helpB M (steps x out-of-gas) = &quot;out of gas...&quot;
helpB M error                = &quot;something went wrong...&quot;

main : IO ⊤
main = putStrLn (help _ (eval (gas 100) builtininc2&#39;))
-}</a>
<a id="3434" class="Markup">\end{code}</a><a id="3444" class="Background">
</a></pre></body></html>