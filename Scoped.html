<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Scoped</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Markup">\begin{code}</a>
<a id="14" class="Keyword">module</a> <a id="21" href="Scoped.html" class="Module">Scoped</a> <a id="28" class="Keyword">where</a>
<a id="34" class="Markup">\end{code}</a><a id="44" class="Background">

</a><a id="46" class="Markup">\begin{code}</a>
<a id="59" class="Keyword">open</a> <a id="64" class="Keyword">import</a> <a id="71" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="80" class="Keyword">hiding</a> <a id="87" class="Symbol">(</a><a id="88" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">_*_</a><a id="91" class="Symbol">)</a>
<a id="93" class="Keyword">open</a> <a id="98" class="Keyword">import</a> <a id="105" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="114" class="Keyword">hiding</a> <a id="121" class="Symbol">(</a><a id="122" href="Data.Fin.Base.html#4782" class="Function Operator">_-_</a><a id="125" class="Symbol">;</a><a id="126" href="Data.Fin.Base.html#4646" class="Function Operator">_+_</a><a id="129" class="Symbol">;</a><a id="130" href="Data.Fin.Base.html#6064" class="Function Operator">_&lt;_</a><a id="133" class="Symbol">)</a>
<a id="135" class="Keyword">open</a> <a id="140" class="Keyword">import</a> <a id="147" href="Data.List.html" class="Module">Data.List</a> <a id="157" class="Keyword">hiding</a> <a id="164" class="Symbol">(</a><a id="165" href="Data.List.Base.html#1497" class="Function">map</a><a id="168" class="Symbol">;</a> <a id="170" href="Data.List.Base.html#1763" class="Function Operator">_++_</a><a id="174" class="Symbol">)</a>
<a id="176" class="Keyword">open</a> <a id="181" class="Keyword">import</a> <a id="188" href="Data.Integer.html" class="Module">Data.Integer</a> <a id="201" class="Keyword">hiding</a> <a id="208" class="Symbol">(</a><a id="209" href="Data.Integer.Base.html#3367" class="Function Operator">_*_</a><a id="212" class="Symbol">;</a> <a id="214" href="Data.Integer.Base.html#3264" class="Function">suc</a><a id="217" class="Symbol">;</a><a id="218" href="Data.Integer.Base.html#3214" class="Function Operator">_-_</a><a id="221" class="Symbol">;</a><a id="222" href="Data.Integer.Base.html#3035" class="Function Operator">_+_</a><a id="225" class="Symbol">;</a><a id="226" href="Data.Integer.Base.html#1619" class="Datatype Operator">_&lt;_</a><a id="229" class="Symbol">)</a>
<a id="231" class="Keyword">open</a> <a id="236" class="Keyword">import</a> <a id="243" href="Data.String.html" class="Module">Data.String</a> <a id="255" class="Keyword">hiding</a> <a id="262" class="Symbol">(</a><a id="263" href="Data.String.Base.html#1732" class="Function Operator">_&lt;_</a><a id="266" class="Symbol">)</a>
<a id="268" class="Keyword">open</a> <a id="273" class="Keyword">import</a> <a id="280" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="290" class="Keyword">open</a> <a id="295" class="Keyword">import</a> <a id="302" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="311" class="Keyword">using</a> <a id="317" class="Symbol">(</a><a id="318" href="Data.Vec.Base.html#959" class="Datatype">Vec</a><a id="321" class="Symbol">;</a><a id="322" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a><a id="324" class="Symbol">;</a><a id="325" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">_∷_</a><a id="328" class="Symbol">)</a>
<a id="330" class="Keyword">open</a> <a id="335" class="Keyword">import</a> <a id="342" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="352" class="Keyword">using</a> <a id="358" class="Symbol">(</a><a id="359" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="363" class="Symbol">)</a>
<a id="365" class="Keyword">open</a> <a id="370" class="Keyword">import</a> <a id="377" href="Data.Char.html" class="Module">Data.Char</a> <a id="387" class="Keyword">using</a> <a id="393" class="Symbol">(</a><a id="394" href="Agda.Builtin.Char.html#227" class="Postulate">Char</a><a id="398" class="Symbol">)</a>
<a id="400" class="Keyword">open</a> <a id="405" class="Keyword">import</a> <a id="412" href="Data.Product.html" class="Module">Data.Product</a> <a id="425" class="Keyword">using</a> <a id="431" class="Symbol">(</a><a id="432" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="435" class="Symbol">;</a><a id="436" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="439" class="Symbol">)</a>
<a id="441" class="Keyword">open</a> <a id="446" class="Keyword">import</a> <a id="453" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="491" class="Keyword">using</a> <a id="497" class="Symbol">(</a><a id="498" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="501" class="Symbol">;</a><a id="502" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="506" class="Symbol">)</a>
<a id="508" class="Keyword">open</a> <a id="513" class="Keyword">import</a> <a id="520" href="Data.Sum.html" class="Module">Data.Sum</a> <a id="529" class="Keyword">using</a> <a id="535" class="Symbol">(</a><a id="536" href="Data.Sum.Base.html#728" class="Datatype Operator">_⊎_</a><a id="539" class="Symbol">;</a><a id="540" href="Data.Sum.Base.html#778" class="InductiveConstructor">inj₁</a><a id="544" class="Symbol">)</a>
<a id="546" class="Keyword">open</a> <a id="551" class="Keyword">import</a> <a id="558" href="Relation.Nullary.html" class="Module">Relation.Nullary</a>
<a id="575" class="Keyword">open</a> <a id="580" class="Keyword">import</a> <a id="587" href="Category.Monad.html" class="Module">Category.Monad</a>
<a id="602" class="Keyword">import</a> <a id="609" href="Level.html" class="Module">Level</a>

<a id="616" class="Keyword">open</a> <a id="621" class="Keyword">import</a> <a id="628" href="Builtin.Constant.Type.html" class="Module">Builtin.Constant.Type</a>
<a id="650" class="Keyword">open</a> <a id="655" class="Keyword">import</a> <a id="662" href="Builtin.html" class="Module">Builtin</a>
<a id="670" class="Keyword">open</a> <a id="675" class="Keyword">import</a> <a id="682" href="Raw.html" class="Module">Raw</a>
<a id="686" class="Keyword">open</a> <a id="691" class="Keyword">import</a> <a id="698" href="Utils.html" class="Module">Utils</a>
<a id="704" class="Markup">\end{code}</a><a id="714" class="Background">

</a><a id="716" class="Markup">\begin{code}</a>
<a id="arity"></a><a id="729" href="Scoped.html#729" class="Function">arity</a> <a id="735" class="Symbol">:</a> <a id="737" href="Builtin.html#41" class="Datatype">Builtin</a> <a id="745" class="Symbol">→</a> <a id="747" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="749" href="Scoped.html#729" class="Function">arity</a> <a id="755" href="Builtin.html#63" class="InductiveConstructor">addInteger</a> <a id="766" class="Symbol">=</a> <a id="768" class="Number">2</a>
<a id="770" href="Scoped.html#729" class="Function">arity</a> <a id="776" href="Builtin.html#100" class="InductiveConstructor">subtractInteger</a> <a id="792" class="Symbol">=</a> <a id="794" class="Number">2</a>
<a id="796" href="Scoped.html#729" class="Function">arity</a> <a id="802" href="Builtin.html#137" class="InductiveConstructor">multiplyInteger</a> <a id="818" class="Symbol">=</a> <a id="820" class="Number">2</a>
<a id="822" href="Scoped.html#729" class="Function">arity</a> <a id="828" href="Builtin.html#174" class="InductiveConstructor">divideInteger</a> <a id="842" class="Symbol">=</a> <a id="844" class="Number">2</a>
<a id="846" href="Scoped.html#729" class="Function">arity</a> <a id="852" href="Builtin.html#211" class="InductiveConstructor">quotientInteger</a> <a id="868" class="Symbol">=</a> <a id="870" class="Number">2</a>
<a id="872" href="Scoped.html#729" class="Function">arity</a> <a id="878" href="Builtin.html#248" class="InductiveConstructor">remainderInteger</a> <a id="895" class="Symbol">=</a> <a id="897" class="Number">2</a>
<a id="899" href="Scoped.html#729" class="Function">arity</a> <a id="905" href="Builtin.html#285" class="InductiveConstructor">modInteger</a> <a id="916" class="Symbol">=</a> <a id="918" class="Number">2</a>
<a id="920" href="Scoped.html#729" class="Function">arity</a> <a id="926" href="Builtin.html#322" class="InductiveConstructor">lessThanInteger</a> <a id="942" class="Symbol">=</a> <a id="944" class="Number">2</a>
<a id="946" href="Scoped.html#729" class="Function">arity</a> <a id="952" href="Builtin.html#359" class="InductiveConstructor">lessThanEqualsInteger</a> <a id="974" class="Symbol">=</a> <a id="976" class="Number">2</a>
<a id="978" href="Scoped.html#729" class="Function">arity</a> <a id="984" href="Builtin.html#396" class="InductiveConstructor">greaterThanInteger</a> <a id="1003" class="Symbol">=</a> <a id="1005" class="Number">2</a>
<a id="1007" href="Scoped.html#729" class="Function">arity</a> <a id="1013" href="Builtin.html#433" class="InductiveConstructor">greaterThanEqualsInteger</a> <a id="1038" class="Symbol">=</a> <a id="1040" class="Number">2</a>
<a id="1042" href="Scoped.html#729" class="Function">arity</a> <a id="1048" href="Builtin.html#470" class="InductiveConstructor">equalsInteger</a> <a id="1062" class="Symbol">=</a> <a id="1064" class="Number">2</a>
<a id="1066" href="Scoped.html#729" class="Function">arity</a> <a id="1072" href="Builtin.html#507" class="InductiveConstructor">concatenate</a> <a id="1084" class="Symbol">=</a> <a id="1086" class="Number">2</a>
<a id="1088" href="Scoped.html#729" class="Function">arity</a> <a id="1094" href="Builtin.html#544" class="InductiveConstructor">takeByteString</a> <a id="1109" class="Symbol">=</a> <a id="1111" class="Number">2</a>
<a id="1113" href="Scoped.html#729" class="Function">arity</a> <a id="1119" href="Builtin.html#581" class="InductiveConstructor">dropByteString</a> <a id="1134" class="Symbol">=</a> <a id="1136" class="Number">2</a>
<a id="1138" href="Scoped.html#729" class="Function">arity</a> <a id="1144" href="Builtin.html#618" class="InductiveConstructor">sha2-256</a> <a id="1153" class="Symbol">=</a> <a id="1155" class="Number">1</a>
<a id="1157" href="Scoped.html#729" class="Function">arity</a> <a id="1163" href="Builtin.html#655" class="InductiveConstructor">sha3-256</a> <a id="1172" class="Symbol">=</a> <a id="1174" class="Number">1</a>
<a id="1176" href="Scoped.html#729" class="Function">arity</a> <a id="1182" href="Builtin.html#692" class="InductiveConstructor">verifySignature</a> <a id="1198" class="Symbol">=</a> <a id="1200" class="Number">3</a>
<a id="1202" href="Scoped.html#729" class="Function">arity</a> <a id="1208" href="Builtin.html#729" class="InductiveConstructor">equalsByteString</a> <a id="1225" class="Symbol">=</a> <a id="1227" class="Number">2</a>
<a id="1229" href="Scoped.html#729" class="Function">arity</a> <a id="1235" href="Builtin.html#766" class="InductiveConstructor">ifThenElse</a> <a id="1246" class="Symbol">=</a> <a id="1248" class="Number">3</a>
<a id="1250" href="Scoped.html#729" class="Function">arity</a> <a id="1256" href="Builtin.html#803" class="InductiveConstructor">charToString</a> <a id="1269" class="Symbol">=</a> <a id="1271" class="Number">1</a>
<a id="1273" href="Scoped.html#729" class="Function">arity</a> <a id="1279" href="Builtin.html#840" class="InductiveConstructor">append</a> <a id="1286" class="Symbol">=</a> <a id="1288" class="Number">2</a>
<a id="1290" href="Scoped.html#729" class="Function">arity</a> <a id="1296" href="Builtin.html#877" class="InductiveConstructor">trace</a> <a id="1302" class="Symbol">=</a> <a id="1304" class="Number">1</a>

<a id="arity⋆"></a><a id="1307" href="Scoped.html#1307" class="Function">arity⋆</a> <a id="1314" class="Symbol">:</a> <a id="1316" href="Builtin.html#41" class="Datatype">Builtin</a> <a id="1324" class="Symbol">→</a> <a id="1326" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="1328" href="Scoped.html#1307" class="Function">arity⋆</a> <a id="1335" href="Builtin.html#766" class="InductiveConstructor">ifThenElse</a> <a id="1346" class="Symbol">=</a> <a id="1348" class="Number">1</a>
<a id="1350" href="Scoped.html#1307" class="CatchallClause Function">arity⋆</a><a id="1356" class="CatchallClause"> </a><a id="1357" class="CatchallClause Symbol">_</a> <a id="1359" class="Symbol">=</a> <a id="1361" class="Number">0</a>

<a id="1364" class="Keyword">open</a> <a id="1369" class="Keyword">import</a> <a id="1376" href="Type.html" class="Module">Type</a>

<a id="1382" class="Keyword">data</a> <a id="ScopedTy"></a><a id="1387" href="Scoped.html#1387" class="Datatype">ScopedTy</a> <a id="1396" class="Symbol">(</a><a id="1397" href="Scoped.html#1397" class="Bound">n</a> <a id="1399" class="Symbol">:</a> <a id="1401" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1402" class="Symbol">)</a> <a id="1404" class="Symbol">:</a> <a id="1406" class="PrimitiveType">Set</a> <a id="1410" class="Keyword">where</a>
  <a id="ScopedTy.`"></a><a id="1418" href="Scoped.html#1418" class="InductiveConstructor">`</a>    <a id="1423" class="Symbol">:</a> <a id="1425" href="Data.Fin.Base.html#1066" class="Datatype">Fin</a> <a id="1429" href="Scoped.html#1397" class="Bound">n</a> <a id="1431" class="Symbol">→</a> <a id="1433" href="Scoped.html#1387" class="Datatype">ScopedTy</a> <a id="1442" href="Scoped.html#1397" class="Bound">n</a>
  <a id="ScopedTy._⇒_"></a><a id="1446" href="Scoped.html#1446" class="InductiveConstructor Operator">_⇒_</a>  <a id="1451" class="Symbol">:</a> <a id="1453" href="Scoped.html#1387" class="Datatype">ScopedTy</a> <a id="1462" href="Scoped.html#1397" class="Bound">n</a> <a id="1464" class="Symbol">→</a> <a id="1466" href="Scoped.html#1387" class="Datatype">ScopedTy</a> <a id="1475" href="Scoped.html#1397" class="Bound">n</a> <a id="1477" class="Symbol">→</a> <a id="1479" href="Scoped.html#1387" class="Datatype">ScopedTy</a> <a id="1488" href="Scoped.html#1397" class="Bound">n</a>
  <a id="ScopedTy.Π"></a><a id="1492" href="Scoped.html#1492" class="InductiveConstructor">Π</a>    <a id="1497" class="Symbol">:</a> <a id="1499" href="Type.html#596" class="Datatype">Kind</a> <a id="1504" class="Symbol">→</a> <a id="1506" href="Scoped.html#1387" class="Datatype">ScopedTy</a> <a id="1515" class="Symbol">(</a><a id="1516" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1520" href="Scoped.html#1397" class="Bound">n</a><a id="1521" class="Symbol">)</a> <a id="1523" class="Symbol">→</a> <a id="1525" href="Scoped.html#1387" class="Datatype">ScopedTy</a> <a id="1534" href="Scoped.html#1397" class="Bound">n</a>
  <a id="ScopedTy.ƛ"></a><a id="1538" href="Scoped.html#1538" class="InductiveConstructor">ƛ</a>    <a id="1543" class="Symbol">:</a> <a id="1545" href="Type.html#596" class="Datatype">Kind</a> <a id="1550" class="Symbol">→</a> <a id="1552" href="Scoped.html#1387" class="Datatype">ScopedTy</a> <a id="1561" class="Symbol">(</a><a id="1562" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1566" href="Scoped.html#1397" class="Bound">n</a><a id="1567" class="Symbol">)</a> <a id="1569" class="Symbol">→</a> <a id="1571" href="Scoped.html#1387" class="Datatype">ScopedTy</a> <a id="1580" href="Scoped.html#1397" class="Bound">n</a>
  <a id="ScopedTy._·_"></a><a id="1584" href="Scoped.html#1584" class="InductiveConstructor Operator">_·_</a>  <a id="1589" class="Symbol">:</a> <a id="1591" href="Scoped.html#1387" class="Datatype">ScopedTy</a> <a id="1600" href="Scoped.html#1397" class="Bound">n</a> <a id="1602" class="Symbol">→</a> <a id="1604" href="Scoped.html#1387" class="Datatype">ScopedTy</a> <a id="1613" href="Scoped.html#1397" class="Bound">n</a> <a id="1615" class="Symbol">→</a> <a id="1617" href="Scoped.html#1387" class="Datatype">ScopedTy</a> <a id="1626" href="Scoped.html#1397" class="Bound">n</a>
  <a id="ScopedTy.con"></a><a id="1630" href="Scoped.html#1630" class="InductiveConstructor">con</a>  <a id="1635" class="Symbol">:</a> <a id="1637" href="Builtin.Constant.Type.html#2898" class="Datatype">TyCon</a> <a id="1643" class="Symbol">→</a> <a id="1645" href="Scoped.html#1387" class="Datatype">ScopedTy</a> <a id="1654" href="Scoped.html#1397" class="Bound">n</a>
  <a id="ScopedTy.μ"></a><a id="1658" href="Scoped.html#1658" class="InductiveConstructor">μ</a>    <a id="1663" class="Symbol">:</a> <a id="1665" href="Scoped.html#1387" class="Datatype">ScopedTy</a> <a id="1674" href="Scoped.html#1397" class="Bound">n</a> <a id="1676" class="Symbol">→</a> <a id="1678" href="Scoped.html#1387" class="Datatype">ScopedTy</a> <a id="1687" href="Scoped.html#1397" class="Bound">n</a> <a id="1689" class="Symbol">→</a> <a id="1691" href="Scoped.html#1387" class="Datatype">ScopedTy</a> <a id="1700" href="Scoped.html#1397" class="Bound">n</a>
  <a id="ScopedTy.missing"></a><a id="1704" href="Scoped.html#1704" class="InductiveConstructor">missing</a> <a id="1712" class="Symbol">:</a> <a id="1714" href="Scoped.html#1387" class="Datatype">ScopedTy</a> <a id="1723" href="Scoped.html#1397" class="Bound">n</a> <a id="1725" class="Comment">-- for when things compute to error</a>

<a id="Tel⋆"></a><a id="1762" href="Scoped.html#1762" class="Function">Tel⋆</a> <a id="1767" class="Symbol">:</a> <a id="1769" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1771" class="Symbol">→</a> <a id="1773" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1775" class="Symbol">→</a> <a id="1777" class="PrimitiveType">Set</a>
<a id="1781" href="Scoped.html#1762" class="Function">Tel⋆</a> <a id="1786" href="Scoped.html#1786" class="Bound">n</a> <a id="1788" href="Scoped.html#1788" class="Bound">m</a> <a id="1790" class="Symbol">=</a> <a id="1792" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1796" class="Symbol">(</a><a id="1797" href="Scoped.html#1387" class="Datatype">ScopedTy</a> <a id="1806" href="Scoped.html#1786" class="Bound">n</a><a id="1807" class="Symbol">)</a> <a id="1809" href="Scoped.html#1788" class="Bound">m</a>

<a id="1812" class="Keyword">open</a> <a id="1817" class="Keyword">import</a> <a id="1824" href="Builtin.Signature.html" class="Module">Builtin.Signature</a> <a id="1842" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1844" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a> <a id="1846" class="Number">0</a> <a id="1848" class="Symbol">(λ</a> <a id="1851" href="Scoped.html#1851" class="Bound">n</a> <a id="1853" href="Scoped.html#1853" class="Bound">_</a> <a id="1855" class="Symbol">→</a> <a id="1857" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1861" href="Scoped.html#1851" class="Bound">n</a><a id="1862" class="Symbol">)</a> <a id="1864" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a> <a id="1867" class="Symbol">(λ</a> <a id="1870" href="Scoped.html#1870" class="Bound">n</a> <a id="1872" href="Scoped.html#1872" class="Bound">_</a> <a id="1874" class="Symbol">→</a> <a id="1876" href="Data.Fin.Base.html#1066" class="Datatype">Fin</a> <a id="1880" href="Scoped.html#1870" class="Bound">n</a><a id="1881" class="Symbol">)</a> <a id="1883" href="Data.Fin.Base.html#1088" class="InductiveConstructor">zero</a> <a id="1888" href="Data.Fin.Base.html#1119" class="InductiveConstructor">suc</a> <a id="1892" class="Symbol">(λ</a> <a id="1895" href="Scoped.html#1895" class="Bound">n</a> <a id="1897" href="Scoped.html#1897" class="Bound">_</a> <a id="1899" class="Symbol">→</a> <a id="1901" href="Scoped.html#1387" class="Datatype">ScopedTy</a> <a id="1910" href="Scoped.html#1895" class="Bound">n</a><a id="1911" class="Symbol">)</a> <a id="1913" href="Scoped.html#1418" class="InductiveConstructor">`</a> <a id="1915" href="Scoped.html#1630" class="InductiveConstructor">con</a>

<a id="1920" class="Comment">-- contexts</a>

<a id="1933" class="Keyword">data</a> <a id="Weirdℕ"></a><a id="1938" href="Scoped.html#1938" class="Datatype">Weirdℕ</a> <a id="1945" class="Symbol">:</a> <a id="1947" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1949" class="Symbol">→</a> <a id="1951" class="PrimitiveType">Set</a> <a id="1955" class="Keyword">where</a>
  <a id="Weirdℕ.Z"></a><a id="1963" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="1965" class="Symbol">:</a> <a id="1967" href="Scoped.html#1938" class="Datatype">Weirdℕ</a> <a id="1974" class="Number">0</a>
  <a id="Weirdℕ.S"></a><a id="1978" href="Scoped.html#1978" class="InductiveConstructor">S</a> <a id="1980" class="Symbol">:</a> <a id="1982" class="Symbol">∀{</a><a id="1984" href="Scoped.html#1984" class="Bound">n</a><a id="1985" class="Symbol">}</a> <a id="1987" class="Symbol">→</a> <a id="1989" href="Scoped.html#1938" class="Datatype">Weirdℕ</a> <a id="1996" href="Scoped.html#1984" class="Bound">n</a>  <a id="1999" class="Symbol">→</a> <a id="2001" href="Scoped.html#1938" class="Datatype">Weirdℕ</a> <a id="2008" href="Scoped.html#1984" class="Bound">n</a>
  <a id="Weirdℕ.T"></a><a id="2012" href="Scoped.html#2012" class="InductiveConstructor">T</a> <a id="2014" class="Symbol">:</a> <a id="2016" class="Symbol">∀{</a><a id="2018" href="Scoped.html#2018" class="Bound">n</a><a id="2019" class="Symbol">}</a> <a id="2021" class="Symbol">→</a> <a id="2023" href="Scoped.html#1938" class="Datatype">Weirdℕ</a> <a id="2030" href="Scoped.html#2018" class="Bound">n</a> <a id="2032" class="Symbol">→</a> <a id="2034" href="Scoped.html#1938" class="Datatype">Weirdℕ</a> <a id="2041" class="Symbol">(</a><a id="2042" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2046" href="Scoped.html#2018" class="Bound">n</a><a id="2047" class="Symbol">)</a>

<a id="2050" class="Comment">-- variables</a>

<a id="2064" class="Keyword">data</a> <a id="WeirdFin"></a><a id="2069" href="Scoped.html#2069" class="Datatype">WeirdFin</a> <a id="2078" class="Symbol">:</a> <a id="2080" class="Symbol">∀{</a><a id="2082" href="Scoped.html#2082" class="Bound">n</a><a id="2083" class="Symbol">}</a> <a id="2085" class="Symbol">→</a> <a id="2087" href="Scoped.html#1938" class="Datatype">Weirdℕ</a> <a id="2094" href="Scoped.html#2082" class="Bound">n</a> <a id="2096" class="Symbol">→</a> <a id="2098" class="PrimitiveType">Set</a> <a id="2102" class="Keyword">where</a>
  <a id="WeirdFin.Z"></a><a id="2110" href="Scoped.html#2110" class="InductiveConstructor">Z</a> <a id="2112" class="Symbol">:</a> <a id="2114" class="Symbol">∀{</a><a id="2116" href="Scoped.html#2116" class="Bound">n</a><a id="2117" class="Symbol">}{</a><a id="2119" href="Scoped.html#2119" class="Bound">w</a> <a id="2121" class="Symbol">:</a> <a id="2123" href="Scoped.html#1938" class="Datatype">Weirdℕ</a> <a id="2130" href="Scoped.html#2116" class="Bound">n</a><a id="2131" class="Symbol">}</a> <a id="2133" class="Symbol">→</a> <a id="2135" href="Scoped.html#2069" class="Datatype">WeirdFin</a> <a id="2144" class="Symbol">(</a><a id="2145" href="Scoped.html#1978" class="InductiveConstructor">S</a> <a id="2147" href="Scoped.html#2119" class="Bound">w</a><a id="2148" class="Symbol">)</a>
  <a id="WeirdFin.S"></a><a id="2152" href="Scoped.html#2152" class="InductiveConstructor">S</a> <a id="2154" class="Symbol">:</a> <a id="2156" class="Symbol">∀{</a><a id="2158" href="Scoped.html#2158" class="Bound">n</a><a id="2159" class="Symbol">}{</a><a id="2161" href="Scoped.html#2161" class="Bound">w</a> <a id="2163" class="Symbol">:</a> <a id="2165" href="Scoped.html#1938" class="Datatype">Weirdℕ</a> <a id="2172" href="Scoped.html#2158" class="Bound">n</a><a id="2173" class="Symbol">}</a> <a id="2175" class="Symbol">→</a> <a id="2177" href="Scoped.html#2069" class="Datatype">WeirdFin</a> <a id="2186" href="Scoped.html#2161" class="Bound">w</a> <a id="2188" class="Symbol">→</a> <a id="2190" href="Scoped.html#2069" class="Datatype">WeirdFin</a> <a id="2199" class="Symbol">(</a><a id="2200" href="Scoped.html#1978" class="InductiveConstructor">S</a> <a id="2202" href="Scoped.html#2161" class="Bound">w</a><a id="2203" class="Symbol">)</a>
  <a id="WeirdFin.T"></a><a id="2207" href="Scoped.html#2207" class="InductiveConstructor">T</a> <a id="2209" class="Symbol">:</a> <a id="2211" class="Symbol">∀{</a><a id="2213" href="Scoped.html#2213" class="Bound">n</a><a id="2214" class="Symbol">}{</a><a id="2216" href="Scoped.html#2216" class="Bound">w</a> <a id="2218" class="Symbol">:</a> <a id="2220" href="Scoped.html#1938" class="Datatype">Weirdℕ</a> <a id="2227" href="Scoped.html#2213" class="Bound">n</a><a id="2228" class="Symbol">}</a> <a id="2230" class="Symbol">→</a> <a id="2232" href="Scoped.html#2069" class="Datatype">WeirdFin</a> <a id="2241" href="Scoped.html#2216" class="Bound">w</a> <a id="2243" class="Symbol">→</a> <a id="2245" href="Scoped.html#2069" class="Datatype">WeirdFin</a> <a id="2254" class="Symbol">(</a><a id="2255" href="Scoped.html#2012" class="InductiveConstructor">T</a> <a id="2257" href="Scoped.html#2216" class="Bound">w</a><a id="2258" class="Symbol">)</a>


<a id="2262" class="Comment">-- what is this for?</a>
<a id="2283" class="Comment">-- there are two meaningful things here:</a>
<a id="2324" class="Comment">-- 1. one to literally convert the number</a>
<a id="2366" class="Comment">-- 2. to extract a type context from a term one</a>
<a id="2414" class="Comment">-- this looks like (1)</a>

<a id="wtoℕ"></a><a id="2438" href="Scoped.html#2438" class="Function">wtoℕ</a> <a id="2443" class="Symbol">:</a> <a id="2445" class="Symbol">∀{</a><a id="2447" href="Scoped.html#2447" class="Bound">n</a><a id="2448" class="Symbol">}</a> <a id="2450" class="Symbol">→</a> <a id="2452" href="Scoped.html#1938" class="Datatype">Weirdℕ</a> <a id="2459" href="Scoped.html#2447" class="Bound">n</a> <a id="2461" class="Symbol">→</a> <a id="2463" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="2465" href="Scoped.html#2438" class="Function">wtoℕ</a> <a id="2470" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="2472" class="Symbol">=</a> <a id="2474" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>
<a id="2479" href="Scoped.html#2438" class="Function">wtoℕ</a> <a id="2484" class="Symbol">(</a><a id="2485" href="Scoped.html#1978" class="InductiveConstructor">S</a> <a id="2487" href="Scoped.html#2487" class="Bound">x</a><a id="2488" class="Symbol">)</a> <a id="2490" class="Symbol">=</a> <a id="2492" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2496" class="Symbol">(</a><a id="2497" href="Scoped.html#2438" class="Function">wtoℕ</a> <a id="2502" href="Scoped.html#2487" class="Bound">x</a><a id="2503" class="Symbol">)</a>
<a id="2505" href="Scoped.html#2438" class="Function">wtoℕ</a> <a id="2510" class="Symbol">(</a><a id="2511" href="Scoped.html#2012" class="InductiveConstructor">T</a> <a id="2513" href="Scoped.html#2513" class="Bound">x</a><a id="2514" class="Symbol">)</a> <a id="2516" class="Symbol">=</a> <a id="2518" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2522" class="Symbol">(</a><a id="2523" href="Scoped.html#2438" class="Function">wtoℕ</a> <a id="2528" href="Scoped.html#2513" class="Bound">x</a><a id="2529" class="Symbol">)</a>

<a id="WeirdFintoℕ"></a><a id="2532" href="Scoped.html#2532" class="Function">WeirdFintoℕ</a> <a id="2544" class="Symbol">:</a> <a id="2546" class="Symbol">∀{</a><a id="2548" href="Scoped.html#2548" class="Bound">n</a><a id="2549" class="Symbol">}{</a><a id="2551" href="Scoped.html#2551" class="Bound">w</a> <a id="2553" class="Symbol">:</a> <a id="2555" href="Scoped.html#1938" class="Datatype">Weirdℕ</a> <a id="2562" href="Scoped.html#2548" class="Bound">n</a><a id="2563" class="Symbol">}</a> <a id="2565" class="Symbol">→</a> <a id="2567" href="Scoped.html#2069" class="Datatype">WeirdFin</a> <a id="2576" href="Scoped.html#2551" class="Bound">w</a> <a id="2578" class="Symbol">→</a> <a id="2580" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="2582" href="Scoped.html#2532" class="Function">WeirdFintoℕ</a> <a id="2594" href="Scoped.html#2110" class="InductiveConstructor">Z</a>     <a id="2600" class="Symbol">=</a> <a id="2602" class="Number">0</a>
<a id="2604" href="Scoped.html#2532" class="Function">WeirdFintoℕ</a> <a id="2616" class="Symbol">(</a><a id="2617" href="Scoped.html#2152" class="InductiveConstructor">S</a> <a id="2619" href="Scoped.html#2619" class="Bound">i</a><a id="2620" class="Symbol">)</a> <a id="2622" class="Symbol">=</a> <a id="2624" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2628" class="Symbol">(</a><a id="2629" href="Scoped.html#2532" class="Function">WeirdFintoℕ</a> <a id="2641" href="Scoped.html#2619" class="Bound">i</a><a id="2642" class="Symbol">)</a>
<a id="2644" href="Scoped.html#2532" class="Function">WeirdFintoℕ</a> <a id="2656" class="Symbol">(</a><a id="2657" href="Scoped.html#2207" class="InductiveConstructor">T</a> <a id="2659" href="Scoped.html#2659" class="Bound">i</a><a id="2660" class="Symbol">)</a> <a id="2662" class="Symbol">=</a> <a id="2664" href="Scoped.html#2532" class="Function">WeirdFintoℕ</a> <a id="2676" href="Scoped.html#2659" class="Bound">i</a>

<a id="2679" class="Comment">-- extract number of term binders we are under</a>
<a id="wtoℕTm"></a><a id="2726" href="Scoped.html#2726" class="Function">wtoℕTm</a> <a id="2733" class="Symbol">:</a> <a id="2735" class="Symbol">∀{</a><a id="2737" href="Scoped.html#2737" class="Bound">n</a><a id="2738" class="Symbol">}</a> <a id="2740" class="Symbol">→</a> <a id="2742" href="Scoped.html#1938" class="Datatype">Weirdℕ</a> <a id="2749" href="Scoped.html#2737" class="Bound">n</a> <a id="2751" class="Symbol">→</a> <a id="2753" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="2755" href="Scoped.html#2726" class="Function">wtoℕTm</a> <a id="2762" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="2764" class="Symbol">=</a> <a id="2766" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>
<a id="2771" href="Scoped.html#2726" class="Function">wtoℕTm</a> <a id="2778" class="Symbol">(</a><a id="2779" href="Scoped.html#1978" class="InductiveConstructor">S</a> <a id="2781" href="Scoped.html#2781" class="Bound">x</a><a id="2782" class="Symbol">)</a> <a id="2784" class="Symbol">=</a> <a id="2786" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2790" class="Symbol">(</a><a id="2791" href="Scoped.html#2726" class="Function">wtoℕTm</a> <a id="2798" href="Scoped.html#2781" class="Bound">x</a><a id="2799" class="Symbol">)</a>
<a id="2801" href="Scoped.html#2726" class="Function">wtoℕTm</a> <a id="2808" class="Symbol">(</a><a id="2809" href="Scoped.html#2012" class="InductiveConstructor">T</a> <a id="2811" href="Scoped.html#2811" class="Bound">x</a><a id="2812" class="Symbol">)</a> <a id="2814" class="Symbol">=</a> <a id="2816" href="Scoped.html#2726" class="Function">wtoℕTm</a> <a id="2823" href="Scoped.html#2811" class="Bound">x</a>

<a id="wtoℕTy"></a><a id="2826" href="Scoped.html#2826" class="Function">wtoℕTy</a> <a id="2833" class="Symbol">:</a> <a id="2835" class="Symbol">∀{</a><a id="2837" href="Scoped.html#2837" class="Bound">n</a><a id="2838" class="Symbol">}</a> <a id="2840" class="Symbol">→</a> <a id="2842" href="Scoped.html#1938" class="Datatype">Weirdℕ</a> <a id="2849" href="Scoped.html#2837" class="Bound">n</a> <a id="2851" class="Symbol">→</a> <a id="2853" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="2855" href="Scoped.html#2826" class="Function">wtoℕTy</a> <a id="2862" href="Scoped.html#1963" class="InductiveConstructor">Z</a>     <a id="2868" class="Symbol">=</a> <a id="2870" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>
<a id="2875" href="Scoped.html#2826" class="Function">wtoℕTy</a> <a id="2882" class="Symbol">(</a><a id="2883" href="Scoped.html#1978" class="InductiveConstructor">S</a> <a id="2885" href="Scoped.html#2885" class="Bound">x</a><a id="2886" class="Symbol">)</a> <a id="2888" class="Symbol">=</a> <a id="2890" href="Scoped.html#2726" class="Function">wtoℕTm</a> <a id="2897" href="Scoped.html#2885" class="Bound">x</a>
<a id="2899" href="Scoped.html#2826" class="Function">wtoℕTy</a> <a id="2906" class="Symbol">(</a><a id="2907" href="Scoped.html#2012" class="InductiveConstructor">T</a> <a id="2909" href="Scoped.html#2909" class="Bound">x</a><a id="2910" class="Symbol">)</a> <a id="2912" class="Symbol">=</a> <a id="2914" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2918" class="Symbol">(</a><a id="2919" href="Scoped.html#2726" class="Function">wtoℕTm</a> <a id="2926" href="Scoped.html#2909" class="Bound">x</a><a id="2927" class="Symbol">)</a>


<a id="2931" class="Comment">-- extract the number of type binders</a>

<a id="lookupWTm"></a><a id="2970" href="Scoped.html#2970" class="Function">lookupWTm</a> <a id="2980" class="Symbol">:</a> <a id="2982" class="Symbol">∀(</a><a id="2984" href="Scoped.html#2984" class="Bound">x</a> <a id="2986" class="Symbol">:</a> <a id="2988" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="2989" class="Symbol">){</a><a id="2991" href="Scoped.html#2991" class="Bound">n</a><a id="2992" class="Symbol">}(</a><a id="2994" href="Scoped.html#2994" class="Bound">w</a> <a id="2996" class="Symbol">:</a> <a id="2998" href="Scoped.html#1938" class="Datatype">Weirdℕ</a> <a id="3005" href="Scoped.html#2991" class="Bound">n</a><a id="3006" class="Symbol">)</a> <a id="3008" class="Symbol">→</a> <a id="3010" href="Utils.html#486" class="Datatype">Maybe</a> <a id="3016" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="3018" href="Scoped.html#2970" class="Function">lookupWTm</a> <a id="3028" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="3033" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="3035" class="Symbol">=</a> <a id="3037" href="Utils.html#537" class="InductiveConstructor">nothing</a>
<a id="3045" href="Scoped.html#2970" class="Function">lookupWTm</a> <a id="3055" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="3060" class="Symbol">(</a><a id="3061" href="Scoped.html#1978" class="InductiveConstructor">S</a> <a id="3063" href="Scoped.html#3063" class="Bound">w</a><a id="3064" class="Symbol">)</a> <a id="3066" class="Symbol">=</a> <a id="3068" href="Utils.html#516" class="InductiveConstructor">just</a> <a id="3073" class="Number">0</a>
<a id="3075" href="Scoped.html#2970" class="Function">lookupWTm</a> <a id="3085" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="3090" class="Symbol">(</a><a id="3091" href="Scoped.html#2012" class="InductiveConstructor">T</a> <a id="3093" href="Scoped.html#3093" class="Bound">w</a><a id="3094" class="Symbol">)</a> <a id="3096" class="Symbol">=</a> <a id="3098" href="Utils.html#537" class="InductiveConstructor">nothing</a>
<a id="3106" href="Scoped.html#2970" class="Function">lookupWTm</a> <a id="3116" class="Symbol">(</a><a id="3117" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="3121" href="Scoped.html#3121" class="Bound">x</a><a id="3122" class="Symbol">)</a> <a id="3124" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="3126" class="Symbol">=</a> <a id="3128" href="Utils.html#537" class="InductiveConstructor">nothing</a>
<a id="3136" href="Scoped.html#2970" class="Function">lookupWTm</a> <a id="3146" class="Symbol">(</a><a id="3147" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="3151" href="Scoped.html#3151" class="Bound">x</a><a id="3152" class="Symbol">)</a> <a id="3154" class="Symbol">(</a><a id="3155" href="Scoped.html#1978" class="InductiveConstructor">S</a> <a id="3157" href="Scoped.html#3157" class="Bound">w</a><a id="3158" class="Symbol">)</a> <a id="3160" class="Symbol">=</a> <a id="3162" href="Utils.html#3433" class="Function">fmap</a> <a id="3167" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="3171" class="Symbol">(</a><a id="3172" href="Scoped.html#2970" class="Function">lookupWTm</a> <a id="3182" href="Scoped.html#3151" class="Bound">x</a> <a id="3184" href="Scoped.html#3157" class="Bound">w</a><a id="3185" class="Symbol">)</a>
<a id="3187" href="Scoped.html#2970" class="Function">lookupWTm</a> <a id="3197" class="Symbol">(</a><a id="3198" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="3202" href="Scoped.html#3202" class="Bound">x</a><a id="3203" class="Symbol">)</a> <a id="3205" class="Symbol">(</a><a id="3206" href="Scoped.html#2012" class="InductiveConstructor">T</a> <a id="3208" href="Scoped.html#3208" class="Bound">w</a><a id="3209" class="Symbol">)</a> <a id="3211" class="Symbol">=</a> <a id="3213" href="Scoped.html#2970" class="Function">lookupWTm</a> <a id="3223" href="Scoped.html#3202" class="Bound">x</a> <a id="3225" href="Scoped.html#3208" class="Bound">w</a>

<a id="lookupWTy"></a><a id="3228" href="Scoped.html#3228" class="Function">lookupWTy</a> <a id="3238" class="Symbol">:</a> <a id="3240" class="Symbol">∀(</a><a id="3242" href="Scoped.html#3242" class="Bound">x</a> <a id="3244" class="Symbol">:</a> <a id="3246" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="3247" class="Symbol">){</a><a id="3249" href="Scoped.html#3249" class="Bound">n</a><a id="3250" class="Symbol">}(</a><a id="3252" href="Scoped.html#3252" class="Bound">w</a> <a id="3254" class="Symbol">:</a> <a id="3256" href="Scoped.html#1938" class="Datatype">Weirdℕ</a> <a id="3263" href="Scoped.html#3249" class="Bound">n</a><a id="3264" class="Symbol">)</a> <a id="3266" class="Symbol">→</a> <a id="3268" href="Utils.html#486" class="Datatype">Maybe</a> <a id="3274" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="3276" href="Scoped.html#3228" class="Function">lookupWTy</a> <a id="3286" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="3291" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="3293" class="Symbol">=</a> <a id="3295" href="Utils.html#537" class="InductiveConstructor">nothing</a>
<a id="3303" href="Scoped.html#3228" class="Function">lookupWTy</a> <a id="3313" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="3318" class="Symbol">(</a><a id="3319" href="Scoped.html#1978" class="InductiveConstructor">S</a> <a id="3321" href="Scoped.html#3321" class="Bound">w</a><a id="3322" class="Symbol">)</a> <a id="3324" class="Symbol">=</a> <a id="3326" href="Utils.html#537" class="InductiveConstructor">nothing</a>
<a id="3334" href="Scoped.html#3228" class="Function">lookupWTy</a> <a id="3344" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="3349" class="Symbol">(</a><a id="3350" href="Scoped.html#2012" class="InductiveConstructor">T</a> <a id="3352" href="Scoped.html#3352" class="Bound">w</a><a id="3353" class="Symbol">)</a> <a id="3355" class="Symbol">=</a> <a id="3357" href="Utils.html#516" class="InductiveConstructor">just</a> <a id="3362" class="Number">0</a>
<a id="3364" href="Scoped.html#3228" class="Function">lookupWTy</a> <a id="3374" class="Symbol">(</a><a id="3375" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="3379" href="Scoped.html#3379" class="Bound">x</a><a id="3380" class="Symbol">)</a> <a id="3382" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="3384" class="Symbol">=</a> <a id="3386" href="Utils.html#537" class="InductiveConstructor">nothing</a>
<a id="3394" href="Scoped.html#3228" class="Function">lookupWTy</a> <a id="3404" class="Symbol">(</a><a id="3405" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="3409" href="Scoped.html#3409" class="Bound">x</a><a id="3410" class="Symbol">)</a> <a id="3412" class="Symbol">(</a><a id="3413" href="Scoped.html#1978" class="InductiveConstructor">S</a> <a id="3415" href="Scoped.html#3415" class="Bound">w</a><a id="3416" class="Symbol">)</a> <a id="3418" class="Symbol">=</a> <a id="3420" href="Scoped.html#3228" class="Function">lookupWTy</a> <a id="3430" href="Scoped.html#3409" class="Bound">x</a> <a id="3432" href="Scoped.html#3415" class="Bound">w</a>
<a id="3434" href="Scoped.html#3228" class="Function">lookupWTy</a> <a id="3444" class="Symbol">(</a><a id="3445" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="3449" href="Scoped.html#3449" class="Bound">x</a><a id="3450" class="Symbol">)</a> <a id="3452" class="Symbol">(</a><a id="3453" href="Scoped.html#2012" class="InductiveConstructor">T</a> <a id="3455" href="Scoped.html#3455" class="Bound">w</a><a id="3456" class="Symbol">)</a> <a id="3458" class="Symbol">=</a> <a id="3460" href="Utils.html#3433" class="Function">fmap</a> <a id="3465" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="3469" class="Symbol">(</a><a id="3470" href="Scoped.html#3228" class="Function">lookupWTy</a> <a id="3480" href="Scoped.html#3449" class="Bound">x</a> <a id="3482" href="Scoped.html#3455" class="Bound">w</a><a id="3483" class="Symbol">)</a>


<a id="lookupWTm&#39;"></a><a id="3487" href="Scoped.html#3487" class="Function">lookupWTm&#39;</a> <a id="3498" class="Symbol">:</a> <a id="3500" class="Symbol">∀(</a><a id="3502" href="Scoped.html#3502" class="Bound">x</a> <a id="3504" class="Symbol">:</a> <a id="3506" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="3507" class="Symbol">){</a><a id="3509" href="Scoped.html#3509" class="Bound">n</a><a id="3510" class="Symbol">}</a> <a id="3512" class="Symbol">→</a> <a id="3514" href="Scoped.html#1938" class="Datatype">Weirdℕ</a> <a id="3521" href="Scoped.html#3509" class="Bound">n</a> <a id="3523" class="Symbol">→</a> <a id="3525" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="3527" href="Scoped.html#3487" class="Function">lookupWTm&#39;</a> <a id="3538" href="Scoped.html#3538" class="Bound">i</a> <a id="3540" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="3542" class="Symbol">=</a> <a id="3544" href="Scoped.html#3538" class="Bound">i</a>
<a id="3546" href="Scoped.html#3487" class="Function">lookupWTm&#39;</a> <a id="3557" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="3562" class="Symbol">(</a><a id="3563" href="Scoped.html#1978" class="InductiveConstructor">S</a> <a id="3565" href="Scoped.html#3565" class="Bound">w</a><a id="3566" class="Symbol">)</a> <a id="3568" class="Symbol">=</a> <a id="3570" class="Number">1</a>
<a id="3572" href="Scoped.html#3487" class="Function">lookupWTm&#39;</a> <a id="3583" class="Symbol">(</a><a id="3584" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="3588" href="Scoped.html#3588" class="Bound">i</a><a id="3589" class="Symbol">)</a> <a id="3591" class="Symbol">(</a><a id="3592" href="Scoped.html#1978" class="InductiveConstructor">S</a> <a id="3594" href="Scoped.html#3594" class="Bound">w</a><a id="3595" class="Symbol">)</a> <a id="3597" class="Symbol">=</a> <a id="3599" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="3603" class="Symbol">(</a><a id="3604" href="Scoped.html#3487" class="Function">lookupWTm&#39;</a> <a id="3615" href="Scoped.html#3588" class="Bound">i</a> <a id="3617" href="Scoped.html#3594" class="Bound">w</a><a id="3618" class="Symbol">)</a>
<a id="3620" href="Scoped.html#3487" class="Function">lookupWTm&#39;</a> <a id="3631" href="Scoped.html#3631" class="Bound">i</a> <a id="3633" class="Symbol">(</a><a id="3634" href="Scoped.html#2012" class="InductiveConstructor">T</a> <a id="3636" href="Scoped.html#3636" class="Bound">w</a><a id="3637" class="Symbol">)</a> <a id="3639" class="Symbol">=</a> <a id="3641" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="3645" class="Symbol">(</a><a id="3646" href="Scoped.html#3487" class="Function">lookupWTm&#39;</a> <a id="3657" href="Scoped.html#3631" class="Bound">i</a> <a id="3659" href="Scoped.html#3636" class="Bound">w</a><a id="3660" class="Symbol">)</a>
<a id="3662" class="Comment">{-
lookupWTm&#39; x (S m) = lookupWTm&#39; x m
lookupWTm&#39; x (T m) = lookupWTm&#39; (suc x) m
lookupWTm&#39; x Z     = suc x
-}</a>

<a id="lookupWTy&#39;"></a><a id="3774" href="Scoped.html#3774" class="Function">lookupWTy&#39;</a> <a id="3785" class="Symbol">:</a> <a id="3787" class="Symbol">∀(</a><a id="3789" href="Scoped.html#3789" class="Bound">x</a> <a id="3791" class="Symbol">:</a> <a id="3793" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="3794" class="Symbol">){</a><a id="3796" href="Scoped.html#3796" class="Bound">n</a><a id="3797" class="Symbol">}</a> <a id="3799" class="Symbol">→</a> <a id="3801" href="Scoped.html#1938" class="Datatype">Weirdℕ</a> <a id="3808" href="Scoped.html#3796" class="Bound">n</a> <a id="3810" class="Symbol">→</a> <a id="3812" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="3814" href="Scoped.html#3774" class="Function">lookupWTy&#39;</a> <a id="3825" href="Scoped.html#3825" class="Bound">i</a> <a id="3827" href="Scoped.html#1963" class="InductiveConstructor">Z</a> <a id="3829" class="Symbol">=</a> <a id="3831" href="Scoped.html#3825" class="Bound">i</a>
<a id="3833" href="Scoped.html#3774" class="Function">lookupWTy&#39;</a> <a id="3844" href="Scoped.html#3844" class="Bound">i</a> <a id="3846" class="Symbol">(</a><a id="3847" href="Scoped.html#1978" class="InductiveConstructor">S</a> <a id="3849" href="Scoped.html#3849" class="Bound">w</a><a id="3850" class="Symbol">)</a> <a id="3852" class="Symbol">=</a> <a id="3854" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="3858" class="Symbol">(</a><a id="3859" href="Scoped.html#3774" class="Function">lookupWTy&#39;</a> <a id="3870" href="Scoped.html#3844" class="Bound">i</a> <a id="3872" href="Scoped.html#3849" class="Bound">w</a><a id="3873" class="Symbol">)</a>
<a id="3875" href="Scoped.html#3774" class="Function">lookupWTy&#39;</a> <a id="3886" class="Symbol">(</a><a id="3887" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="3891" href="Scoped.html#3891" class="Bound">i</a><a id="3892" class="Symbol">)</a> <a id="3894" class="Symbol">(</a><a id="3895" href="Scoped.html#2012" class="InductiveConstructor">T</a> <a id="3897" href="Scoped.html#3897" class="Bound">w</a><a id="3898" class="Symbol">)</a> <a id="3900" class="Symbol">=</a> <a id="3902" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="3906" class="Symbol">(</a><a id="3907" href="Scoped.html#3774" class="Function">lookupWTy&#39;</a> <a id="3918" href="Scoped.html#3891" class="Bound">i</a> <a id="3920" href="Scoped.html#3897" class="Bound">w</a><a id="3921" class="Symbol">)</a>
<a id="3923" href="Scoped.html#3774" class="Function">lookupWTy&#39;</a> <a id="3934" class="Number">0</a> <a id="3936" class="Symbol">(</a><a id="3937" href="Scoped.html#2012" class="InductiveConstructor">T</a> <a id="3939" href="Scoped.html#3939" class="Bound">w</a><a id="3940" class="Symbol">)</a> <a id="3942" class="Symbol">=</a> <a id="3944" class="Number">1</a>

<a id="3947" class="Comment">{-
lookupWTy&#39; x (S m) = lookupWTy&#39; (suc x) m
lookupWTy&#39; x (T m) = lookupWTy&#39; x m
lookupWTy&#39; x Z     = suc x
-}</a>

<a id="4059" class="Comment">-- these are renamings</a>
<a id="shifterTy"></a><a id="4082" href="Scoped.html#4082" class="Function">shifterTy</a> <a id="4092" class="Symbol">:</a> <a id="4094" class="Symbol">∀{</a><a id="4096" href="Scoped.html#4096" class="Bound">n</a><a id="4097" class="Symbol">}(</a><a id="4099" href="Scoped.html#4099" class="Bound">w</a> <a id="4101" class="Symbol">:</a> <a id="4103" href="Scoped.html#1938" class="Datatype">Weirdℕ</a> <a id="4110" href="Scoped.html#4096" class="Bound">n</a><a id="4111" class="Symbol">)</a> <a id="4113" class="Symbol">→</a> <a id="4115" href="Raw.html#694" class="Datatype">RawTy</a> <a id="4121" class="Symbol">→</a> <a id="4123" href="Raw.html#694" class="Datatype">RawTy</a>
<a id="4129" href="Scoped.html#4082" class="Function">shifterTy</a> <a id="4139" href="Scoped.html#4139" class="Bound">w</a> <a id="4141" class="Symbol">(</a><a id="4142" href="Raw.html#714" class="InductiveConstructor">`</a> <a id="4144" href="Scoped.html#4144" class="Bound">x</a><a id="4145" class="Symbol">)</a> <a id="4147" class="Symbol">=</a> <a id="4149" href="Raw.html#714" class="InductiveConstructor">`</a> <a id="4151" class="Symbol">(</a><a id="4152" href="Utils.html#613" class="Function">maybe</a> <a id="4158" class="Symbol">(\</a><a id="4160" href="Scoped.html#4160" class="Bound">x</a> <a id="4162" class="Symbol">→</a> <a id="4164" href="Scoped.html#4160" class="Bound">x</a><a id="4165" class="Symbol">)</a> <a id="4167" class="Number">100</a> <a id="4171" class="Symbol">(</a><a id="4172" href="Scoped.html#3228" class="Function">lookupWTy</a> <a id="4182" href="Data.Nat.Base.html#2114" class="Function Operator">∣</a> <a id="4184" href="Scoped.html#4144" class="Bound">x</a> <a id="4186" href="Data.Nat.Base.html#2114" class="Function Operator">-</a> <a id="4188" class="Number">1</a> <a id="4190" href="Data.Nat.Base.html#2114" class="Function Operator">∣</a>  <a id="4193" href="Scoped.html#4139" class="Bound">w</a><a id="4194" class="Symbol">))</a>
<a id="4197" href="Scoped.html#4082" class="Function">shifterTy</a> <a id="4207" href="Scoped.html#4207" class="Bound">w</a> <a id="4209" class="Symbol">(</a><a id="4210" href="Scoped.html#4210" class="Bound">A</a> <a id="4212" href="Raw.html#732" class="InductiveConstructor Operator">⇒</a> <a id="4214" href="Scoped.html#4214" class="Bound">B</a><a id="4215" class="Symbol">)</a> <a id="4217" class="Symbol">=</a> <a id="4219" href="Scoped.html#4082" class="Function">shifterTy</a> <a id="4229" href="Scoped.html#4207" class="Bound">w</a> <a id="4231" href="Scoped.html#4210" class="Bound">A</a> <a id="4233" href="Raw.html#732" class="InductiveConstructor Operator">⇒</a> <a id="4235" href="Scoped.html#4082" class="Function">shifterTy</a> <a id="4245" href="Scoped.html#4207" class="Bound">w</a> <a id="4247" href="Scoped.html#4214" class="Bound">B</a>
<a id="4249" href="Scoped.html#4082" class="Function">shifterTy</a> <a id="4259" href="Scoped.html#4259" class="Bound">w</a> <a id="4261" class="Symbol">(</a><a id="4262" href="Raw.html#762" class="InductiveConstructor">Π</a> <a id="4264" href="Scoped.html#4264" class="Bound">K</a> <a id="4266" href="Scoped.html#4266" class="Bound">A</a><a id="4267" class="Symbol">)</a> <a id="4269" class="Symbol">=</a> <a id="4271" href="Raw.html#762" class="InductiveConstructor">Π</a> <a id="4273" href="Scoped.html#4264" class="Bound">K</a> <a id="4275" class="Symbol">(</a><a id="4276" href="Scoped.html#4082" class="Function">shifterTy</a> <a id="4286" class="Symbol">(</a><a id="4287" href="Scoped.html#2012" class="InductiveConstructor">T</a> <a id="4289" href="Scoped.html#4259" class="Bound">w</a><a id="4290" class="Symbol">)</a> <a id="4292" href="Scoped.html#4266" class="Bound">A</a><a id="4293" class="Symbol">)</a>
<a id="4295" href="Scoped.html#4082" class="Function">shifterTy</a> <a id="4305" href="Scoped.html#4305" class="Bound">w</a> <a id="4307" class="Symbol">(</a><a id="4308" href="Raw.html#794" class="InductiveConstructor">ƛ</a> <a id="4310" href="Scoped.html#4310" class="Bound">K</a> <a id="4312" href="Scoped.html#4312" class="Bound">A</a><a id="4313" class="Symbol">)</a> <a id="4315" class="Symbol">=</a> <a id="4317" href="Raw.html#794" class="InductiveConstructor">ƛ</a> <a id="4319" href="Scoped.html#4310" class="Bound">K</a> <a id="4321" class="Symbol">(</a><a id="4322" href="Scoped.html#4082" class="Function">shifterTy</a> <a id="4332" class="Symbol">(</a><a id="4333" href="Scoped.html#2012" class="InductiveConstructor">T</a> <a id="4335" href="Scoped.html#4305" class="Bound">w</a><a id="4336" class="Symbol">)</a> <a id="4338" href="Scoped.html#4312" class="Bound">A</a><a id="4339" class="Symbol">)</a>
<a id="4341" href="Scoped.html#4082" class="Function">shifterTy</a> <a id="4351" href="Scoped.html#4351" class="Bound">w</a> <a id="4353" class="Symbol">(</a><a id="4354" href="Scoped.html#4354" class="Bound">A</a> <a id="4356" href="Raw.html#826" class="InductiveConstructor Operator">·</a> <a id="4358" href="Scoped.html#4358" class="Bound">B</a><a id="4359" class="Symbol">)</a> <a id="4361" class="Symbol">=</a> <a id="4363" href="Scoped.html#4082" class="Function">shifterTy</a> <a id="4373" href="Scoped.html#4351" class="Bound">w</a> <a id="4375" href="Scoped.html#4354" class="Bound">A</a> <a id="4377" href="Raw.html#826" class="InductiveConstructor Operator">·</a> <a id="4379" href="Scoped.html#4082" class="Function">shifterTy</a> <a id="4389" href="Scoped.html#4351" class="Bound">w</a> <a id="4391" href="Scoped.html#4358" class="Bound">B</a>
<a id="4393" href="Scoped.html#4082" class="Function">shifterTy</a> <a id="4403" href="Scoped.html#4403" class="Bound">w</a> <a id="4405" class="Symbol">(</a><a id="4406" href="Raw.html#856" class="InductiveConstructor">con</a> <a id="4410" href="Scoped.html#4410" class="Bound">c</a><a id="4411" class="Symbol">)</a> <a id="4413" class="Symbol">=</a> <a id="4415" href="Raw.html#856" class="InductiveConstructor">con</a> <a id="4419" href="Scoped.html#4410" class="Bound">c</a>
<a id="4421" href="Scoped.html#4082" class="Function">shifterTy</a> <a id="4431" href="Scoped.html#4431" class="Bound">w</a> <a id="4433" class="Symbol">(</a><a id="4434" href="Raw.html#878" class="InductiveConstructor">μ</a> <a id="4436" href="Scoped.html#4436" class="Bound">A</a> <a id="4438" href="Scoped.html#4438" class="Bound">B</a><a id="4439" class="Symbol">)</a> <a id="4441" class="Symbol">=</a> <a id="4443" href="Raw.html#878" class="InductiveConstructor">μ</a> <a id="4445" class="Symbol">(</a><a id="4446" href="Scoped.html#4082" class="Function">shifterTy</a> <a id="4456" href="Scoped.html#4431" class="Bound">w</a> <a id="4458" href="Scoped.html#4436" class="Bound">A</a><a id="4459" class="Symbol">)</a> <a id="4461" class="Symbol">(</a><a id="4462" href="Scoped.html#4082" class="Function">shifterTy</a> <a id="4472" href="Scoped.html#4431" class="Bound">w</a> <a id="4474" href="Scoped.html#4438" class="Bound">B</a><a id="4475" class="Symbol">)</a>

<a id="shifter"></a><a id="4478" href="Scoped.html#4478" class="Function">shifter</a> <a id="4486" class="Symbol">:</a> <a id="4488" class="Symbol">∀{</a><a id="4490" href="Scoped.html#4490" class="Bound">n</a><a id="4491" class="Symbol">}(</a><a id="4493" href="Scoped.html#4493" class="Bound">w</a> <a id="4495" class="Symbol">:</a> <a id="4497" href="Scoped.html#1938" class="Datatype">Weirdℕ</a> <a id="4504" href="Scoped.html#4490" class="Bound">n</a><a id="4505" class="Symbol">)</a> <a id="4507" class="Symbol">→</a> <a id="4509" href="Raw.html#1138" class="Datatype">RawTm</a> <a id="4515" class="Symbol">→</a> <a id="4517" href="Raw.html#1138" class="Datatype">RawTm</a>
<a id="4523" href="Scoped.html#4478" class="Function">shifter</a> <a id="4531" href="Scoped.html#4531" class="Bound">w</a> <a id="4533" class="Symbol">(</a><a id="4534" href="Raw.html#1158" class="InductiveConstructor">`</a> <a id="4536" href="Scoped.html#4536" class="Bound">x</a><a id="4537" class="Symbol">)</a> <a id="4539" class="Symbol">=</a> <a id="4541" href="Raw.html#1158" class="InductiveConstructor">`</a> <a id="4543" class="Symbol">(</a><a id="4544" href="Utils.html#613" class="Function">maybe</a> <a id="4550" class="Symbol">(\</a><a id="4552" href="Scoped.html#4552" class="Bound">x</a> <a id="4554" class="Symbol">→</a> <a id="4556" href="Scoped.html#4552" class="Bound">x</a><a id="4557" class="Symbol">)</a> <a id="4559" class="Number">100</a> <a id="4563" class="Symbol">(</a><a id="4564" href="Scoped.html#2970" class="Function">lookupWTm</a> <a id="4574" href="Data.Nat.Base.html#2114" class="Function Operator">∣</a> <a id="4576" href="Scoped.html#4536" class="Bound">x</a> <a id="4578" href="Data.Nat.Base.html#2114" class="Function Operator">-</a> <a id="4580" class="Number">1</a> <a id="4582" href="Data.Nat.Base.html#2114" class="Function Operator">∣</a> <a id="4584" href="Scoped.html#4531" class="Bound">w</a><a id="4585" class="Symbol">))</a>
<a id="4588" href="Scoped.html#4478" class="Function">shifter</a> <a id="4596" href="Scoped.html#4596" class="Bound">w</a> <a id="4598" class="Symbol">(</a><a id="4599" href="Raw.html#1186" class="InductiveConstructor">Λ</a> <a id="4601" href="Scoped.html#4601" class="Bound">K</a> <a id="4603" href="Scoped.html#4603" class="Bound">t</a><a id="4604" class="Symbol">)</a> <a id="4606" class="Symbol">=</a> <a id="4608" href="Raw.html#1186" class="InductiveConstructor">Λ</a> <a id="4610" href="Scoped.html#4601" class="Bound">K</a> <a id="4612" class="Symbol">(</a><a id="4613" href="Scoped.html#4478" class="Function">shifter</a> <a id="4621" class="Symbol">(</a><a id="4622" href="Scoped.html#2012" class="InductiveConstructor">T</a> <a id="4624" href="Scoped.html#4596" class="Bound">w</a><a id="4625" class="Symbol">)</a> <a id="4627" href="Scoped.html#4603" class="Bound">t</a><a id="4628" class="Symbol">)</a>
<a id="4630" href="Scoped.html#4478" class="Function">shifter</a> <a id="4638" href="Scoped.html#4638" class="Bound">w</a> <a id="4640" class="Symbol">(</a><a id="4641" href="Scoped.html#4641" class="Bound">t</a> <a id="4643" href="Raw.html#1228" class="InductiveConstructor Operator">·⋆</a> <a id="4646" href="Scoped.html#4646" class="Bound">A</a><a id="4647" class="Symbol">)</a> <a id="4649" class="Symbol">=</a> <a id="4651" href="Scoped.html#4478" class="Function">shifter</a> <a id="4659" href="Scoped.html#4638" class="Bound">w</a> <a id="4661" href="Scoped.html#4641" class="Bound">t</a> <a id="4663" href="Raw.html#1228" class="InductiveConstructor Operator">·⋆</a> <a id="4666" href="Scoped.html#4082" class="Function">shifterTy</a> <a id="4676" href="Scoped.html#4638" class="Bound">w</a> <a id="4678" href="Scoped.html#4646" class="Bound">A</a>
<a id="4680" href="Scoped.html#4478" class="Function">shifter</a> <a id="4688" href="Scoped.html#4688" class="Bound">w</a> <a id="4690" class="Symbol">(</a><a id="4691" href="Raw.html#1268" class="InductiveConstructor">ƛ</a> <a id="4693" href="Scoped.html#4693" class="Bound">A</a> <a id="4695" href="Scoped.html#4695" class="Bound">t</a><a id="4696" class="Symbol">)</a> <a id="4698" class="Symbol">=</a> <a id="4700" href="Raw.html#1268" class="InductiveConstructor">ƛ</a> <a id="4702" class="Symbol">(</a><a id="4703" href="Scoped.html#4082" class="Function">shifterTy</a> <a id="4713" class="Symbol">(</a><a id="4714" href="Scoped.html#1978" class="InductiveConstructor">S</a> <a id="4716" href="Scoped.html#4688" class="Bound">w</a><a id="4717" class="Symbol">)</a> <a id="4719" href="Scoped.html#4693" class="Bound">A</a><a id="4720" class="Symbol">)</a> <a id="4722" class="Symbol">(</a><a id="4723" href="Scoped.html#4478" class="Function">shifter</a> <a id="4731" class="Symbol">(</a><a id="4732" href="Scoped.html#1978" class="InductiveConstructor">S</a> <a id="4734" href="Scoped.html#4688" class="Bound">w</a><a id="4735" class="Symbol">)</a> <a id="4737" href="Scoped.html#4695" class="Bound">t</a><a id="4738" class="Symbol">)</a>
<a id="4740" href="Scoped.html#4478" class="Function">shifter</a> <a id="4748" href="Scoped.html#4748" class="Bound">w</a> <a id="4750" class="Symbol">(</a><a id="4751" href="Scoped.html#4751" class="Bound">t</a> <a id="4753" href="Raw.html#1308" class="InductiveConstructor Operator">·</a> <a id="4755" href="Scoped.html#4755" class="Bound">u</a><a id="4756" class="Symbol">)</a> <a id="4758" class="Symbol">=</a> <a id="4760" href="Scoped.html#4478" class="Function">shifter</a> <a id="4768" href="Scoped.html#4748" class="Bound">w</a> <a id="4770" href="Scoped.html#4751" class="Bound">t</a> <a id="4772" href="Raw.html#1308" class="InductiveConstructor Operator">·</a> <a id="4774" href="Scoped.html#4478" class="Function">shifter</a> <a id="4782" href="Scoped.html#4748" class="Bound">w</a> <a id="4784" href="Scoped.html#4755" class="Bound">u</a>
<a id="4786" href="Scoped.html#4478" class="Function">shifter</a> <a id="4794" href="Scoped.html#4794" class="Bound">w</a> <a id="4796" class="Symbol">(</a><a id="4797" href="Raw.html#1348" class="InductiveConstructor">con</a> <a id="4801" href="Scoped.html#4801" class="Bound">c</a><a id="4802" class="Symbol">)</a> <a id="4804" class="Symbol">=</a> <a id="4806" href="Raw.html#1348" class="InductiveConstructor">con</a> <a id="4810" href="Scoped.html#4801" class="Bound">c</a>
<a id="4812" href="Scoped.html#4478" class="Function">shifter</a> <a id="4820" href="Scoped.html#4820" class="Bound">w</a> <a id="4822" class="Symbol">(</a><a id="4823" href="Raw.html#1385" class="InductiveConstructor">error</a> <a id="4829" href="Scoped.html#4829" class="Bound">A</a><a id="4830" class="Symbol">)</a> <a id="4832" class="Symbol">=</a> <a id="4834" href="Raw.html#1385" class="InductiveConstructor">error</a> <a id="4840" class="Symbol">(</a><a id="4841" href="Scoped.html#4082" class="Function">shifterTy</a> <a id="4851" href="Scoped.html#4820" class="Bound">w</a> <a id="4853" href="Scoped.html#4829" class="Bound">A</a><a id="4854" class="Symbol">)</a>
<a id="4856" href="Scoped.html#4478" class="Function">shifter</a> <a id="4864" href="Scoped.html#4864" class="Bound">w</a> <a id="4866" class="Symbol">(</a><a id="4867" href="Raw.html#1417" class="InductiveConstructor">builtin</a> <a id="4875" href="Scoped.html#4875" class="Bound">b</a><a id="4876" class="Symbol">)</a> <a id="4878" class="Symbol">=</a> <a id="4880" href="Raw.html#1417" class="InductiveConstructor">builtin</a> <a id="4888" href="Scoped.html#4875" class="Bound">b</a>
<a id="4890" href="Scoped.html#4478" class="Function">shifter</a> <a id="4898" href="Scoped.html#4898" class="Bound">w</a> <a id="4900" class="Symbol">(</a><a id="4901" href="Raw.html#1451" class="InductiveConstructor">wrap</a> <a id="4906" href="Scoped.html#4906" class="Bound">pat</a> <a id="4910" href="Scoped.html#4910" class="Bound">arg</a> <a id="4914" href="Scoped.html#4914" class="Bound">t</a><a id="4915" class="Symbol">)</a> <a id="4917" class="Symbol">=</a>
  <a id="4921" href="Raw.html#1451" class="InductiveConstructor">wrap</a> <a id="4926" class="Symbol">(</a><a id="4927" href="Scoped.html#4082" class="Function">shifterTy</a> <a id="4937" href="Scoped.html#4898" class="Bound">w</a> <a id="4939" href="Scoped.html#4906" class="Bound">pat</a><a id="4942" class="Symbol">)</a> <a id="4944" class="Symbol">(</a><a id="4945" href="Scoped.html#4082" class="Function">shifterTy</a> <a id="4955" href="Scoped.html#4898" class="Bound">w</a> <a id="4957" href="Scoped.html#4910" class="Bound">arg</a><a id="4960" class="Symbol">)</a> <a id="4962" class="Symbol">(</a><a id="4963" href="Scoped.html#4478" class="Function">shifter</a> <a id="4971" href="Scoped.html#4898" class="Bound">w</a> <a id="4973" href="Scoped.html#4914" class="Bound">t</a><a id="4974" class="Symbol">)</a>
<a id="4976" href="Scoped.html#4478" class="Function">shifter</a> <a id="4984" href="Scoped.html#4984" class="Bound">w</a> <a id="4986" class="Symbol">(</a><a id="4987" href="Raw.html#1499" class="InductiveConstructor">unwrap</a> <a id="4994" href="Scoped.html#4994" class="Bound">t</a><a id="4995" class="Symbol">)</a> <a id="4997" class="Symbol">=</a> <a id="4999" href="Raw.html#1499" class="InductiveConstructor">unwrap</a> <a id="5006" class="Symbol">(</a><a id="5007" href="Scoped.html#4478" class="Function">shifter</a> <a id="5015" href="Scoped.html#4984" class="Bound">w</a> <a id="5017" href="Scoped.html#4994" class="Bound">t</a><a id="5018" class="Symbol">)</a>

<a id="unshifterTy"></a><a id="5021" href="Scoped.html#5021" class="Function">unshifterTy</a> <a id="5033" class="Symbol">:</a> <a id="5035" class="Symbol">∀{</a><a id="5037" href="Scoped.html#5037" class="Bound">n</a><a id="5038" class="Symbol">}</a> <a id="5040" class="Symbol">→</a> <a id="5042" href="Scoped.html#1938" class="Datatype">Weirdℕ</a> <a id="5049" href="Scoped.html#5037" class="Bound">n</a> <a id="5051" class="Symbol">→</a> <a id="5053" href="Raw.html#694" class="Datatype">RawTy</a> <a id="5059" class="Symbol">→</a> <a id="5061" href="Raw.html#694" class="Datatype">RawTy</a>
<a id="5067" href="Scoped.html#5021" class="Function">unshifterTy</a> <a id="5079" href="Scoped.html#5079" class="Bound">w</a> <a id="5081" class="Symbol">(</a><a id="5082" href="Raw.html#714" class="InductiveConstructor">`</a> <a id="5084" href="Scoped.html#5084" class="Bound">x</a><a id="5085" class="Symbol">)</a> <a id="5087" class="Symbol">=</a> <a id="5089" href="Raw.html#714" class="InductiveConstructor">`</a> <a id="5091" class="Symbol">(</a><a id="5092" href="Scoped.html#3774" class="Function">lookupWTy&#39;</a> <a id="5103" href="Scoped.html#5084" class="Bound">x</a> <a id="5105" href="Scoped.html#5079" class="Bound">w</a><a id="5106" class="Symbol">)</a>
<a id="5108" href="Scoped.html#5021" class="Function">unshifterTy</a> <a id="5120" href="Scoped.html#5120" class="Bound">w</a> <a id="5122" class="Symbol">(</a><a id="5123" href="Scoped.html#5123" class="Bound">A</a> <a id="5125" href="Raw.html#732" class="InductiveConstructor Operator">⇒</a> <a id="5127" href="Scoped.html#5127" class="Bound">B</a><a id="5128" class="Symbol">)</a> <a id="5130" class="Symbol">=</a> <a id="5132" href="Scoped.html#5021" class="Function">unshifterTy</a> <a id="5144" href="Scoped.html#5120" class="Bound">w</a> <a id="5146" href="Scoped.html#5123" class="Bound">A</a> <a id="5148" href="Raw.html#732" class="InductiveConstructor Operator">⇒</a> <a id="5150" href="Scoped.html#5021" class="Function">unshifterTy</a> <a id="5162" href="Scoped.html#5120" class="Bound">w</a> <a id="5164" href="Scoped.html#5127" class="Bound">B</a>
<a id="5166" href="Scoped.html#5021" class="Function">unshifterTy</a> <a id="5178" href="Scoped.html#5178" class="Bound">w</a> <a id="5180" class="Symbol">(</a><a id="5181" href="Raw.html#762" class="InductiveConstructor">Π</a> <a id="5183" href="Scoped.html#5183" class="Bound">K</a> <a id="5185" href="Scoped.html#5185" class="Bound">A</a><a id="5186" class="Symbol">)</a> <a id="5188" class="Symbol">=</a> <a id="5190" href="Raw.html#762" class="InductiveConstructor">Π</a> <a id="5192" href="Scoped.html#5183" class="Bound">K</a> <a id="5194" class="Symbol">(</a><a id="5195" href="Scoped.html#5021" class="Function">unshifterTy</a> <a id="5207" class="Symbol">(</a><a id="5208" href="Scoped.html#2012" class="InductiveConstructor">T</a> <a id="5210" href="Scoped.html#5178" class="Bound">w</a><a id="5211" class="Symbol">)</a> <a id="5213" href="Scoped.html#5185" class="Bound">A</a><a id="5214" class="Symbol">)</a>
<a id="5216" href="Scoped.html#5021" class="Function">unshifterTy</a> <a id="5228" href="Scoped.html#5228" class="Bound">w</a> <a id="5230" class="Symbol">(</a><a id="5231" href="Raw.html#794" class="InductiveConstructor">ƛ</a> <a id="5233" href="Scoped.html#5233" class="Bound">K</a> <a id="5235" href="Scoped.html#5235" class="Bound">A</a><a id="5236" class="Symbol">)</a> <a id="5238" class="Symbol">=</a> <a id="5240" href="Raw.html#794" class="InductiveConstructor">ƛ</a> <a id="5242" href="Scoped.html#5233" class="Bound">K</a> <a id="5244" class="Symbol">(</a><a id="5245" href="Scoped.html#5021" class="Function">unshifterTy</a> <a id="5257" class="Symbol">(</a><a id="5258" href="Scoped.html#2012" class="InductiveConstructor">T</a> <a id="5260" href="Scoped.html#5228" class="Bound">w</a><a id="5261" class="Symbol">)</a> <a id="5263" href="Scoped.html#5235" class="Bound">A</a><a id="5264" class="Symbol">)</a>
<a id="5266" href="Scoped.html#5021" class="Function">unshifterTy</a> <a id="5278" href="Scoped.html#5278" class="Bound">w</a> <a id="5280" class="Symbol">(</a><a id="5281" href="Scoped.html#5281" class="Bound">A</a> <a id="5283" href="Raw.html#826" class="InductiveConstructor Operator">·</a> <a id="5285" href="Scoped.html#5285" class="Bound">B</a><a id="5286" class="Symbol">)</a> <a id="5288" class="Symbol">=</a> <a id="5290" href="Scoped.html#5021" class="Function">unshifterTy</a> <a id="5302" href="Scoped.html#5278" class="Bound">w</a> <a id="5304" href="Scoped.html#5281" class="Bound">A</a> <a id="5306" href="Raw.html#826" class="InductiveConstructor Operator">·</a> <a id="5308" href="Scoped.html#5021" class="Function">unshifterTy</a> <a id="5320" href="Scoped.html#5278" class="Bound">w</a> <a id="5322" href="Scoped.html#5285" class="Bound">B</a>
<a id="5324" href="Scoped.html#5021" class="Function">unshifterTy</a> <a id="5336" href="Scoped.html#5336" class="Bound">w</a> <a id="5338" class="Symbol">(</a><a id="5339" href="Raw.html#856" class="InductiveConstructor">con</a> <a id="5343" href="Scoped.html#5343" class="Bound">c</a><a id="5344" class="Symbol">)</a> <a id="5346" class="Symbol">=</a> <a id="5348" href="Raw.html#856" class="InductiveConstructor">con</a> <a id="5352" href="Scoped.html#5343" class="Bound">c</a>
<a id="5354" href="Scoped.html#5021" class="Function">unshifterTy</a> <a id="5366" href="Scoped.html#5366" class="Bound">w</a> <a id="5368" class="Symbol">(</a><a id="5369" href="Raw.html#878" class="InductiveConstructor">μ</a> <a id="5371" href="Scoped.html#5371" class="Bound">A</a> <a id="5373" href="Scoped.html#5373" class="Bound">B</a><a id="5374" class="Symbol">)</a> <a id="5376" class="Symbol">=</a> <a id="5378" href="Raw.html#878" class="InductiveConstructor">μ</a> <a id="5380" class="Symbol">(</a><a id="5381" href="Scoped.html#5021" class="Function">unshifterTy</a> <a id="5393" href="Scoped.html#5366" class="Bound">w</a> <a id="5395" href="Scoped.html#5371" class="Bound">A</a><a id="5396" class="Symbol">)</a> <a id="5398" class="Symbol">(</a><a id="5399" href="Scoped.html#5021" class="Function">unshifterTy</a> <a id="5411" href="Scoped.html#5366" class="Bound">w</a> <a id="5413" href="Scoped.html#5373" class="Bound">B</a><a id="5414" class="Symbol">)</a>

<a id="5417" class="Keyword">open</a> <a id="5422" class="Keyword">import</a> <a id="5429" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>

<a id="unshifter"></a><a id="5468" href="Scoped.html#5468" class="Function">unshifter</a> <a id="5478" class="Symbol">:</a> <a id="5480" class="Symbol">∀{</a><a id="5482" href="Scoped.html#5482" class="Bound">n</a><a id="5483" class="Symbol">}</a> <a id="5485" class="Symbol">→</a> <a id="5487" href="Scoped.html#1938" class="Datatype">Weirdℕ</a> <a id="5494" href="Scoped.html#5482" class="Bound">n</a> <a id="5496" class="Symbol">→</a> <a id="5498" href="Raw.html#1138" class="Datatype">RawTm</a> <a id="5504" class="Symbol">→</a> <a id="5506" href="Raw.html#1138" class="Datatype">RawTm</a>
<a id="5512" href="Scoped.html#5468" class="Function">unshifter</a> <a id="5522" href="Scoped.html#5522" class="Bound">w</a> <a id="5524" class="Symbol">(</a><a id="5525" href="Raw.html#1158" class="InductiveConstructor">`</a> <a id="5527" href="Scoped.html#5527" class="Bound">x</a><a id="5528" class="Symbol">)</a> <a id="5530" class="Symbol">=</a> <a id="5532" href="Raw.html#1158" class="InductiveConstructor">`</a> <a id="5534" class="Symbol">(</a><a id="5535" href="Scoped.html#3487" class="Function">lookupWTm&#39;</a> <a id="5546" href="Scoped.html#5527" class="Bound">x</a> <a id="5548" href="Scoped.html#5522" class="Bound">w</a><a id="5549" class="Symbol">)</a>
<a id="5551" href="Scoped.html#5468" class="Function">unshifter</a> <a id="5561" href="Scoped.html#5561" class="Bound">w</a> <a id="5563" class="Symbol">(</a><a id="5564" href="Raw.html#1186" class="InductiveConstructor">Λ</a> <a id="5566" href="Scoped.html#5566" class="Bound">K</a> <a id="5568" href="Scoped.html#5568" class="Bound">t</a><a id="5569" class="Symbol">)</a> <a id="5571" class="Symbol">=</a> <a id="5573" href="Raw.html#1186" class="InductiveConstructor">Λ</a> <a id="5575" href="Scoped.html#5566" class="Bound">K</a> <a id="5577" class="Symbol">(</a><a id="5578" href="Scoped.html#5468" class="Function">unshifter</a> <a id="5588" class="Symbol">(</a><a id="5589" href="Scoped.html#2012" class="InductiveConstructor">T</a> <a id="5591" href="Scoped.html#5561" class="Bound">w</a><a id="5592" class="Symbol">)</a> <a id="5594" href="Scoped.html#5568" class="Bound">t</a><a id="5595" class="Symbol">)</a>

<a id="5598" href="Scoped.html#5468" class="Function">unshifter</a> <a id="5608" href="Scoped.html#5608" class="Bound">w</a> <a id="5610" class="Symbol">(</a><a id="5611" href="Scoped.html#5611" class="Bound">t</a> <a id="5613" href="Raw.html#1228" class="InductiveConstructor Operator">·⋆</a> <a id="5616" href="Scoped.html#5616" class="Bound">A</a><a id="5617" class="Symbol">)</a> <a id="5619" class="Symbol">=</a> <a id="5621" href="Scoped.html#5468" class="Function">unshifter</a> <a id="5631" href="Scoped.html#5608" class="Bound">w</a> <a id="5633" href="Scoped.html#5611" class="Bound">t</a> <a id="5635" href="Raw.html#1228" class="InductiveConstructor Operator">·⋆</a> <a id="5638" href="Scoped.html#5021" class="Function">unshifterTy</a> <a id="5650" href="Scoped.html#5608" class="Bound">w</a> <a id="5652" href="Scoped.html#5616" class="Bound">A</a>
<a id="5654" href="Scoped.html#5468" class="Function">unshifter</a> <a id="5664" href="Scoped.html#5664" class="Bound">w</a> <a id="5666" class="Symbol">(</a><a id="5667" href="Raw.html#1268" class="InductiveConstructor">ƛ</a> <a id="5669" href="Scoped.html#5669" class="Bound">A</a> <a id="5671" href="Scoped.html#5671" class="Bound">t</a><a id="5672" class="Symbol">)</a> <a id="5674" class="Symbol">=</a> <a id="5676" href="Raw.html#1268" class="InductiveConstructor">ƛ</a> <a id="5678" class="Symbol">(</a><a id="5679" href="Scoped.html#5021" class="Function">unshifterTy</a> <a id="5691" class="Symbol">(</a><a id="5692" href="Scoped.html#1978" class="InductiveConstructor">S</a> <a id="5694" href="Scoped.html#5664" class="Bound">w</a><a id="5695" class="Symbol">)</a> <a id="5697" href="Scoped.html#5669" class="Bound">A</a><a id="5698" class="Symbol">)</a> <a id="5700" class="Symbol">(</a><a id="5701" href="Scoped.html#5468" class="Function">unshifter</a> <a id="5711" class="Symbol">(</a><a id="5712" href="Scoped.html#1978" class="InductiveConstructor">S</a> <a id="5714" href="Scoped.html#5664" class="Bound">w</a><a id="5715" class="Symbol">)</a> <a id="5717" href="Scoped.html#5671" class="Bound">t</a><a id="5718" class="Symbol">)</a>
<a id="5720" href="Scoped.html#5468" class="Function">unshifter</a> <a id="5730" href="Scoped.html#5730" class="Bound">w</a> <a id="5732" class="Symbol">(</a><a id="5733" href="Scoped.html#5733" class="Bound">t</a> <a id="5735" href="Raw.html#1308" class="InductiveConstructor Operator">·</a> <a id="5737" href="Scoped.html#5737" class="Bound">u</a><a id="5738" class="Symbol">)</a> <a id="5740" class="Symbol">=</a> <a id="5742" href="Scoped.html#5468" class="Function">unshifter</a> <a id="5752" href="Scoped.html#5730" class="Bound">w</a> <a id="5754" href="Scoped.html#5733" class="Bound">t</a> <a id="5756" href="Raw.html#1308" class="InductiveConstructor Operator">·</a> <a id="5758" href="Scoped.html#5468" class="Function">unshifter</a> <a id="5768" href="Scoped.html#5730" class="Bound">w</a> <a id="5770" href="Scoped.html#5737" class="Bound">u</a>
<a id="5772" href="Scoped.html#5468" class="Function">unshifter</a> <a id="5782" href="Scoped.html#5782" class="Bound">w</a> <a id="5784" class="Symbol">(</a><a id="5785" href="Raw.html#1348" class="InductiveConstructor">con</a> <a id="5789" href="Scoped.html#5789" class="Bound">c</a><a id="5790" class="Symbol">)</a> <a id="5792" class="Symbol">=</a> <a id="5794" href="Raw.html#1348" class="InductiveConstructor">con</a> <a id="5798" href="Scoped.html#5789" class="Bound">c</a>
<a id="5800" href="Scoped.html#5468" class="Function">unshifter</a> <a id="5810" href="Scoped.html#5810" class="Bound">w</a> <a id="5812" class="Symbol">(</a><a id="5813" href="Raw.html#1385" class="InductiveConstructor">error</a> <a id="5819" href="Scoped.html#5819" class="Bound">A</a><a id="5820" class="Symbol">)</a> <a id="5822" class="Symbol">=</a> <a id="5824" href="Raw.html#1385" class="InductiveConstructor">error</a> <a id="5830" class="Symbol">(</a><a id="5831" href="Scoped.html#5021" class="Function">unshifterTy</a> <a id="5843" href="Scoped.html#5810" class="Bound">w</a> <a id="5845" href="Scoped.html#5819" class="Bound">A</a><a id="5846" class="Symbol">)</a>
<a id="5848" href="Scoped.html#5468" class="Function">unshifter</a> <a id="5858" href="Scoped.html#5858" class="Bound">w</a> <a id="5860" class="Symbol">(</a><a id="5861" href="Raw.html#1417" class="InductiveConstructor">builtin</a> <a id="5869" href="Scoped.html#5869" class="Bound">b</a><a id="5870" class="Symbol">)</a> <a id="5872" class="Symbol">=</a> <a id="5874" href="Raw.html#1417" class="InductiveConstructor">builtin</a> <a id="5882" href="Scoped.html#5869" class="Bound">b</a>
<a id="5884" href="Scoped.html#5468" class="Function">unshifter</a> <a id="5894" href="Scoped.html#5894" class="Bound">w</a> <a id="5896" class="Symbol">(</a><a id="5897" href="Raw.html#1451" class="InductiveConstructor">wrap</a> <a id="5902" href="Scoped.html#5902" class="Bound">pat</a> <a id="5906" href="Scoped.html#5906" class="Bound">arg</a> <a id="5910" href="Scoped.html#5910" class="Bound">t</a><a id="5911" class="Symbol">)</a> <a id="5913" class="Symbol">=</a>
  <a id="5917" href="Raw.html#1451" class="InductiveConstructor">wrap</a> <a id="5922" class="Symbol">(</a><a id="5923" href="Scoped.html#5021" class="Function">unshifterTy</a> <a id="5935" href="Scoped.html#5894" class="Bound">w</a> <a id="5937" href="Scoped.html#5902" class="Bound">pat</a><a id="5940" class="Symbol">)</a> <a id="5942" class="Symbol">(</a><a id="5943" href="Scoped.html#5021" class="Function">unshifterTy</a> <a id="5955" href="Scoped.html#5894" class="Bound">w</a> <a id="5957" href="Scoped.html#5906" class="Bound">arg</a><a id="5960" class="Symbol">)</a> <a id="5962" class="Symbol">(</a><a id="5963" href="Scoped.html#5468" class="Function">unshifter</a> <a id="5973" href="Scoped.html#5894" class="Bound">w</a> <a id="5975" href="Scoped.html#5910" class="Bound">t</a><a id="5976" class="Symbol">)</a>
<a id="5978" href="Scoped.html#5468" class="Function">unshifter</a> <a id="5988" href="Scoped.html#5988" class="Bound">w</a> <a id="5990" class="Symbol">(</a><a id="5991" href="Raw.html#1499" class="InductiveConstructor">unwrap</a> <a id="5998" href="Scoped.html#5998" class="Bound">t</a><a id="5999" class="Symbol">)</a> <a id="6001" class="Symbol">=</a> <a id="6003" href="Raw.html#1499" class="InductiveConstructor">unwrap</a> <a id="6010" class="Symbol">(</a><a id="6011" href="Scoped.html#5468" class="Function">unshifter</a> <a id="6021" href="Scoped.html#5988" class="Bound">w</a> <a id="6023" href="Scoped.html#5998" class="Bound">t</a><a id="6024" class="Symbol">)</a>

<a id="6027" class="Keyword">data</a> <a id="TermCon"></a><a id="6032" href="Scoped.html#6032" class="Datatype">TermCon</a> <a id="6040" class="Symbol">:</a> <a id="6042" class="PrimitiveType">Set</a> <a id="6046" class="Keyword">where</a>
  <a id="TermCon.integer"></a><a id="6054" href="Scoped.html#6054" class="InductiveConstructor">integer</a>    <a id="6065" class="Symbol">:</a> <a id="6067" class="Symbol">(</a><a id="6068" href="Scoped.html#6068" class="Bound">i</a> <a id="6070" class="Symbol">:</a> <a id="6072" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a><a id="6073" class="Symbol">)</a> <a id="6075" class="Symbol">→</a> <a id="6077" href="Scoped.html#6032" class="Datatype">TermCon</a>
  <a id="TermCon.bytestring"></a><a id="6087" href="Scoped.html#6087" class="InductiveConstructor">bytestring</a> <a id="6098" class="Symbol">:</a> <a id="6100" class="Symbol">(</a><a id="6101" href="Scoped.html#6101" class="Bound">b</a> <a id="6103" class="Symbol">:</a> <a id="6105" href="Builtin.Constant.Type.html#616" class="Postulate">ByteString</a><a id="6115" class="Symbol">)</a> <a id="6117" class="Symbol">→</a> <a id="6119" href="Scoped.html#6032" class="Datatype">TermCon</a>
  <a id="TermCon.string"></a><a id="6129" href="Scoped.html#6129" class="InductiveConstructor">string</a>     <a id="6140" class="Symbol">:</a> <a id="6142" class="Symbol">(</a><a id="6143" href="Scoped.html#6143" class="Bound">s</a> <a id="6145" class="Symbol">:</a> <a id="6147" href="Agda.Builtin.String.html#274" class="Postulate">String</a><a id="6153" class="Symbol">)</a> <a id="6155" class="Symbol">→</a> <a id="6157" href="Scoped.html#6032" class="Datatype">TermCon</a>
  <a id="TermCon.bool"></a><a id="6167" href="Scoped.html#6167" class="InductiveConstructor">bool</a>       <a id="6178" class="Symbol">:</a> <a id="6180" class="Symbol">(</a><a id="6181" href="Scoped.html#6181" class="Bound">b</a> <a id="6183" class="Symbol">:</a> <a id="6185" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="6189" class="Symbol">)</a> <a id="6191" class="Symbol">→</a> <a id="6193" href="Scoped.html#6032" class="Datatype">TermCon</a>
  <a id="TermCon.char"></a><a id="6203" href="Scoped.html#6203" class="InductiveConstructor">char</a>       <a id="6214" class="Symbol">:</a> <a id="6216" class="Symbol">(</a><a id="6217" href="Scoped.html#6217" class="Bound">c</a> <a id="6219" class="Symbol">:</a> <a id="6221" href="Agda.Builtin.Char.html#227" class="Postulate">Char</a><a id="6225" class="Symbol">)</a> <a id="6227" class="Symbol">→</a> <a id="6229" href="Scoped.html#6032" class="Datatype">TermCon</a>
  <a id="TermCon.unit"></a><a id="6239" href="Scoped.html#6239" class="InductiveConstructor">unit</a>       <a id="6250" class="Symbol">:</a> <a id="6252" href="Scoped.html#6032" class="Datatype">TermCon</a>

<a id="Tel"></a><a id="6261" href="Scoped.html#6261" class="Function">Tel</a> <a id="6265" class="Symbol">:</a> <a id="6267" class="Symbol">∀{</a><a id="6269" href="Scoped.html#6269" class="Bound">n</a><a id="6270" class="Symbol">}</a> <a id="6272" class="Symbol">→</a> <a id="6274" href="Scoped.html#1938" class="Datatype">Weirdℕ</a> <a id="6281" href="Scoped.html#6269" class="Bound">n</a> <a id="6283" class="Symbol">→</a> <a id="6285" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="6287" class="Symbol">→</a> <a id="6289" class="PrimitiveType">Set</a>

<a id="6294" class="Keyword">data</a> <a id="ScopedTm"></a><a id="6299" href="Scoped.html#6299" class="Datatype">ScopedTm</a> <a id="6308" class="Symbol">{</a><a id="6309" href="Scoped.html#6309" class="Bound">n</a><a id="6310" class="Symbol">}(</a><a id="6312" href="Scoped.html#6312" class="Bound">w</a> <a id="6314" class="Symbol">:</a> <a id="6316" href="Scoped.html#1938" class="Datatype">Weirdℕ</a> <a id="6323" href="Scoped.html#6309" class="Bound">n</a><a id="6324" class="Symbol">)</a> <a id="6326" class="Symbol">:</a> <a id="6328" class="PrimitiveType">Set</a> <a id="6332" class="Keyword">where</a>
  <a id="ScopedTm.`"></a><a id="6340" href="Scoped.html#6340" class="InductiveConstructor">`</a>    <a id="6345" class="Symbol">:</a>    <a id="6350" href="Scoped.html#2069" class="Datatype">WeirdFin</a> <a id="6359" href="Scoped.html#6312" class="Bound">w</a> <a id="6361" class="Symbol">→</a> <a id="6363" href="Scoped.html#6299" class="Datatype">ScopedTm</a> <a id="6372" href="Scoped.html#6312" class="Bound">w</a>
  <a id="ScopedTm.Λ"></a><a id="6376" href="Scoped.html#6376" class="InductiveConstructor">Λ</a>    <a id="6381" class="Symbol">:</a>    <a id="6386" href="Type.html#596" class="Datatype">Kind</a> <a id="6391" class="Symbol">→</a> <a id="6393" href="Scoped.html#6299" class="Datatype">ScopedTm</a> <a id="6402" class="Symbol">(</a><a id="6403" href="Scoped.html#2012" class="InductiveConstructor">T</a> <a id="6405" href="Scoped.html#6312" class="Bound">w</a><a id="6406" class="Symbol">)</a> <a id="6408" class="Symbol">→</a> <a id="6410" href="Scoped.html#6299" class="Datatype">ScopedTm</a> <a id="6419" href="Scoped.html#6312" class="Bound">w</a>
  <a id="ScopedTm._·⋆_"></a><a id="6423" href="Scoped.html#6423" class="InductiveConstructor Operator">_·⋆_</a> <a id="6428" class="Symbol">:</a>    <a id="6433" href="Scoped.html#6299" class="Datatype">ScopedTm</a> <a id="6442" href="Scoped.html#6312" class="Bound">w</a> <a id="6444" class="Symbol">→</a> <a id="6446" href="Scoped.html#1387" class="Datatype">ScopedTy</a> <a id="6455" href="Scoped.html#6309" class="Bound">n</a> <a id="6457" class="Symbol">→</a> <a id="6459" href="Scoped.html#6299" class="Datatype">ScopedTm</a> <a id="6468" href="Scoped.html#6312" class="Bound">w</a>
  <a id="ScopedTm.ƛ"></a><a id="6472" href="Scoped.html#6472" class="InductiveConstructor">ƛ</a>    <a id="6477" class="Symbol">:</a>    <a id="6482" href="Scoped.html#1387" class="Datatype">ScopedTy</a> <a id="6491" href="Scoped.html#6309" class="Bound">n</a> <a id="6493" class="Symbol">→</a> <a id="6495" href="Scoped.html#6299" class="Datatype">ScopedTm</a> <a id="6504" class="Symbol">(</a><a id="6505" href="Scoped.html#1978" class="InductiveConstructor">S</a> <a id="6507" href="Scoped.html#6312" class="Bound">w</a><a id="6508" class="Symbol">)</a> <a id="6510" class="Symbol">→</a> <a id="6512" href="Scoped.html#6299" class="Datatype">ScopedTm</a> <a id="6521" href="Scoped.html#6312" class="Bound">w</a>
  <a id="ScopedTm._·_"></a><a id="6525" href="Scoped.html#6525" class="InductiveConstructor Operator">_·_</a>  <a id="6530" class="Symbol">:</a>    <a id="6535" href="Scoped.html#6299" class="Datatype">ScopedTm</a> <a id="6544" href="Scoped.html#6312" class="Bound">w</a> <a id="6546" class="Symbol">→</a> <a id="6548" href="Scoped.html#6299" class="Datatype">ScopedTm</a> <a id="6557" href="Scoped.html#6312" class="Bound">w</a> <a id="6559" class="Symbol">→</a> <a id="6561" href="Scoped.html#6299" class="Datatype">ScopedTm</a> <a id="6570" href="Scoped.html#6312" class="Bound">w</a>
  <a id="ScopedTm.con"></a><a id="6574" href="Scoped.html#6574" class="InductiveConstructor">con</a>  <a id="6579" class="Symbol">:</a>    <a id="6584" href="Scoped.html#6032" class="Datatype">TermCon</a> <a id="6592" class="Symbol">→</a> <a id="6594" href="Scoped.html#6299" class="Datatype">ScopedTm</a> <a id="6603" href="Scoped.html#6312" class="Bound">w</a>
  <a id="ScopedTm.error"></a><a id="6607" href="Scoped.html#6607" class="InductiveConstructor">error</a> <a id="6613" class="Symbol">:</a>   <a id="6617" href="Scoped.html#1387" class="Datatype">ScopedTy</a> <a id="6626" href="Scoped.html#6309" class="Bound">n</a> <a id="6628" class="Symbol">→</a> <a id="6630" href="Scoped.html#6299" class="Datatype">ScopedTm</a> <a id="6639" href="Scoped.html#6312" class="Bound">w</a>
  <a id="ScopedTm.ibuiltin"></a><a id="6643" href="Scoped.html#6643" class="InductiveConstructor">ibuiltin</a> <a id="6652" class="Symbol">:</a> <a id="6654" class="Symbol">(</a><a id="6655" href="Scoped.html#6655" class="Bound">b</a> <a id="6657" class="Symbol">:</a> <a id="6659" href="Builtin.html#41" class="Datatype">Builtin</a><a id="6666" class="Symbol">)</a> <a id="6668" class="Symbol">→</a> <a id="6670" href="Scoped.html#6299" class="Datatype">ScopedTm</a> <a id="6679" href="Scoped.html#6312" class="Bound">w</a>
  <a id="ScopedTm.wrap"></a><a id="6683" href="Scoped.html#6683" class="InductiveConstructor">wrap</a> <a id="6688" class="Symbol">:</a>    <a id="6693" href="Scoped.html#1387" class="Datatype">ScopedTy</a> <a id="6702" href="Scoped.html#6309" class="Bound">n</a> <a id="6704" class="Symbol">→</a> <a id="6706" href="Scoped.html#1387" class="Datatype">ScopedTy</a> <a id="6715" href="Scoped.html#6309" class="Bound">n</a> <a id="6717" class="Symbol">→</a> <a id="6719" href="Scoped.html#6299" class="Datatype">ScopedTm</a> <a id="6728" href="Scoped.html#6312" class="Bound">w</a> <a id="6730" class="Symbol">→</a> <a id="6732" href="Scoped.html#6299" class="Datatype">ScopedTm</a> <a id="6741" href="Scoped.html#6312" class="Bound">w</a>
  <a id="ScopedTm.unwrap"></a><a id="6745" href="Scoped.html#6745" class="InductiveConstructor">unwrap</a> <a id="6752" class="Symbol">:</a>  <a id="6755" href="Scoped.html#6299" class="Datatype">ScopedTm</a> <a id="6764" href="Scoped.html#6312" class="Bound">w</a> <a id="6766" class="Symbol">→</a> <a id="6768" href="Scoped.html#6299" class="Datatype">ScopedTm</a> <a id="6777" href="Scoped.html#6312" class="Bound">w</a>

<a id="6780" href="Scoped.html#6261" class="Function">Tel</a> <a id="6784" href="Scoped.html#6784" class="Bound">w</a> <a id="6786" href="Scoped.html#6786" class="Bound">n</a> <a id="6788" class="Symbol">=</a> <a id="6790" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="6794" class="Symbol">(</a><a id="6795" href="Scoped.html#6299" class="Datatype">ScopedTm</a> <a id="6804" href="Scoped.html#6784" class="Bound">w</a><a id="6805" class="Symbol">)</a> <a id="6807" href="Scoped.html#6786" class="Bound">n</a>

<a id="6810" class="Comment">-- SCOPE CHECKING / CONVERSION FROM RAW TO SCOPED</a>

<a id="6861" class="Comment">-- should just use ordinary kind for everything</a>

<a id="deBruijnifyK"></a><a id="6910" href="Scoped.html#6910" class="Function">deBruijnifyK</a> <a id="6923" class="Symbol">:</a> <a id="6925" href="Raw.html#615" class="Datatype">RawKind</a> <a id="6933" class="Symbol">→</a> <a id="6935" href="Type.html#596" class="Datatype">Kind</a>
<a id="6940" href="Scoped.html#6910" class="Function">deBruijnifyK</a> <a id="6953" href="Raw.html#637" class="InductiveConstructor">*</a> <a id="6955" class="Symbol">=</a> <a id="6957" href="Type.html#615" class="InductiveConstructor">*</a>
<a id="6959" href="Scoped.html#6910" class="Function">deBruijnifyK</a> <a id="6972" class="Symbol">(</a><a id="6973" href="Scoped.html#6973" class="Bound">K</a> <a id="6975" href="Raw.html#653" class="InductiveConstructor Operator">⇒</a> <a id="6977" href="Scoped.html#6977" class="Bound">J</a><a id="6978" class="Symbol">)</a> <a id="6980" class="Symbol">=</a> <a id="6982" href="Scoped.html#6910" class="Function">deBruijnifyK</a> <a id="6995" href="Scoped.html#6973" class="Bound">K</a> <a id="6997" href="Type.html#650" class="InductiveConstructor Operator">⇒</a> <a id="6999" href="Scoped.html#6910" class="Function">deBruijnifyK</a> <a id="7012" href="Scoped.html#6977" class="Bound">J</a>

<a id="7015" class="Symbol">{-#</a> <a id="7019" class="Keyword">COMPILE</a> <a id="7027" class="Keyword">GHC</a> <a id="7031" href="Scoped.html#6910" class="Function">deBruijnifyK</a> <a id="7044" class="Pragma">as</a> <a id="7047" class="Pragma">deBruijnifyK</a> <a id="7060" class="Symbol">#-}</a>

<a id="deBruijnifyC"></a><a id="7065" href="Scoped.html#7065" class="Function">deBruijnifyC</a> <a id="7078" class="Symbol">:</a> <a id="7080" href="Raw.html#913" class="Datatype">RawTermCon</a> <a id="7091" class="Symbol">→</a> <a id="7093" href="Scoped.html#6032" class="Datatype">TermCon</a>
<a id="7101" href="Scoped.html#7065" class="Function">deBruijnifyC</a> <a id="7114" class="Symbol">(</a><a id="7115" href="Raw.html#938" class="InductiveConstructor">integer</a> <a id="7123" href="Scoped.html#7123" class="Bound">i</a><a id="7124" class="Symbol">)</a>    <a id="7129" class="Symbol">=</a> <a id="7131" href="Scoped.html#6054" class="InductiveConstructor">integer</a> <a id="7139" href="Scoped.html#7123" class="Bound">i</a>
<a id="7141" href="Scoped.html#7065" class="Function">deBruijnifyC</a> <a id="7154" class="Symbol">(</a><a id="7155" href="Raw.html#968" class="InductiveConstructor">bytestring</a> <a id="7166" href="Scoped.html#7166" class="Bound">b</a><a id="7167" class="Symbol">)</a> <a id="7169" class="Symbol">=</a> <a id="7171" href="Scoped.html#6087" class="InductiveConstructor">bytestring</a> <a id="7182" href="Scoped.html#7166" class="Bound">b</a>
<a id="7184" href="Scoped.html#7065" class="Function">deBruijnifyC</a> <a id="7197" class="Symbol">(</a><a id="7198" href="Raw.html#1007" class="InductiveConstructor">string</a> <a id="7205" href="Scoped.html#7205" class="Bound">s</a><a id="7206" class="Symbol">)</a>     <a id="7212" class="Symbol">=</a> <a id="7214" href="Scoped.html#6129" class="InductiveConstructor">string</a> <a id="7221" href="Scoped.html#7205" class="Bound">s</a>
<a id="7223" href="Scoped.html#7065" class="Function">deBruijnifyC</a> <a id="7236" class="Symbol">(</a><a id="7237" href="Raw.html#1042" class="InductiveConstructor">bool</a> <a id="7242" href="Scoped.html#7242" class="Bound">b</a><a id="7243" class="Symbol">)</a>       <a id="7251" class="Symbol">=</a> <a id="7253" href="Scoped.html#6167" class="InductiveConstructor">bool</a> <a id="7258" href="Scoped.html#7242" class="Bound">b</a>
<a id="7260" href="Scoped.html#7065" class="Function">deBruijnifyC</a> <a id="7273" class="Symbol">(</a><a id="7274" href="Raw.html#1075" class="InductiveConstructor">char</a> <a id="7279" href="Scoped.html#7279" class="Bound">c</a><a id="7280" class="Symbol">)</a>       <a id="7288" class="Symbol">=</a> <a id="7290" href="Scoped.html#6203" class="InductiveConstructor">char</a> <a id="7295" href="Scoped.html#7279" class="Bound">c</a>
<a id="7297" href="Scoped.html#7065" class="Function">deBruijnifyC</a> <a id="7310" href="Raw.html#1108" class="InductiveConstructor">unit</a>           <a id="7325" class="Symbol">=</a> <a id="7327" href="Scoped.html#6239" class="InductiveConstructor">unit</a>

<a id="7333" class="Keyword">postulate</a>
  <a id="FreeVariableError"></a><a id="7345" href="Scoped.html#7345" class="Postulate">FreeVariableError</a> <a id="7363" class="Symbol">:</a> <a id="7365" class="PrimitiveType">Set</a>

<a id="7370" class="Symbol">{-#</a> <a id="7374" class="Keyword">COMPILE</a> <a id="7382" class="Keyword">GHC</a> <a id="7386" href="Scoped.html#7345" class="Postulate">FreeVariableError</a> <a id="7404" class="Pragma">=</a> <a id="7406" class="Pragma">type</a> <a id="7411" class="Pragma">FreeVariableError</a> <a id="7429" class="Symbol">#-}</a>


<a id="7435" class="Keyword">data</a> <a id="ScopeError"></a><a id="7440" href="Scoped.html#7440" class="Datatype">ScopeError</a> <a id="7451" class="Symbol">:</a> <a id="7453" class="PrimitiveType">Set</a> <a id="7457" class="Keyword">where</a>
  <a id="ScopeError.deBError"></a><a id="7465" href="Scoped.html#7465" class="InductiveConstructor">deBError</a> <a id="7474" class="Symbol">:</a> <a id="7476" href="Scoped.html#7440" class="Datatype">ScopeError</a>
  <a id="ScopeError.freeVariableError"></a><a id="7489" href="Scoped.html#7489" class="InductiveConstructor">freeVariableError</a> <a id="7507" class="Symbol">:</a> <a id="7509" href="Scoped.html#7345" class="Postulate">FreeVariableError</a> <a id="7527" class="Symbol">→</a> <a id="7529" href="Scoped.html#7440" class="Datatype">ScopeError</a>

<a id="7541" class="Symbol">{-#</a> <a id="7545" class="Keyword">FOREIGN</a> <a id="7553" class="Pragma">GHC</a> <a id="7557" class="Pragma">import</a> <a id="7564" class="Pragma">Language.PlutusCore.DeBruijn</a> <a id="7593" class="Symbol">#-}</a>
<a id="7597" class="Symbol">{-#</a> <a id="7601" class="Keyword">FOREIGN</a> <a id="7609" class="Pragma">GHC</a> <a id="7613" class="Pragma">import</a> <a id="7620" class="Pragma">Raw</a> <a id="7624" class="Symbol">#-}</a>
<a id="7628" class="Symbol">{-#</a> <a id="7632" class="Keyword">COMPILE</a> <a id="7640" class="Keyword">GHC</a> <a id="7644" href="Scoped.html#7440" class="Datatype">ScopeError</a> <a id="7655" class="Pragma">=</a> <a id="7657" class="Pragma">data</a> <a id="7662" class="Pragma">ScopeError</a> <a id="7673" class="Pragma">(DeBError</a> <a id="7683" class="Pragma">|</a> <a id="7685" class="Pragma">FreeVariableError)</a> <a id="7704" class="Symbol">#-}</a>


<a id="ℕtoFin"></a><a id="7710" href="Scoped.html#7710" class="Function">ℕtoFin</a> <a id="7717" class="Symbol">:</a> <a id="7719" class="Symbol">∀{</a><a id="7721" href="Scoped.html#7721" class="Bound">n</a><a id="7722" class="Symbol">}</a> <a id="7724" class="Symbol">→</a> <a id="7726" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="7728" class="Symbol">→</a> <a id="7730" href="Utils.html#904" class="Datatype">Either</a> <a id="7737" href="Scoped.html#7440" class="Datatype">ScopeError</a> <a id="7748" class="Symbol">(</a><a id="7749" href="Data.Fin.Base.html#1066" class="Datatype">Fin</a> <a id="7753" href="Scoped.html#7721" class="Bound">n</a><a id="7754" class="Symbol">)</a>
<a id="7756" href="Scoped.html#7710" class="Function">ℕtoFin</a> <a id="7763" class="Symbol">{</a><a id="7764" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="7768" class="Symbol">}</a>  <a id="7771" class="Symbol">_</a>       <a id="7779" class="Symbol">=</a> <a id="7781" href="Utils.html#937" class="InductiveConstructor">inj₁</a> <a id="7786" href="Scoped.html#7465" class="InductiveConstructor">deBError</a>
<a id="7795" href="Scoped.html#7710" class="Function">ℕtoFin</a> <a id="7802" class="Symbol">{</a><a id="7803" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="7807" href="Scoped.html#7807" class="Bound">m</a><a id="7808" class="Symbol">}</a> <a id="7810" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>    <a id="7818" class="Symbol">=</a> <a id="7820" href="Utils.html#3293" class="Field">return</a> <a id="7827" href="Data.Fin.Base.html#1088" class="InductiveConstructor">zero</a>
<a id="7832" href="Scoped.html#7710" class="Function">ℕtoFin</a> <a id="7839" class="Symbol">{</a><a id="7840" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="7844" href="Scoped.html#7844" class="Bound">m</a><a id="7845" class="Symbol">}</a> <a id="7847" class="Symbol">(</a><a id="7848" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="7852" href="Scoped.html#7852" class="Bound">n</a><a id="7853" class="Symbol">)</a> <a id="7855" class="Symbol">=</a> <a id="7857" href="Utils.html#3433" class="Function">fmap</a> <a id="7862" href="Data.Fin.Base.html#1119" class="InductiveConstructor">suc</a> <a id="7866" class="Symbol">(</a><a id="7867" href="Scoped.html#7710" class="Function">ℕtoFin</a> <a id="7874" href="Scoped.html#7852" class="Bound">n</a><a id="7875" class="Symbol">)</a>

<a id="ℕtoWeirdFin"></a><a id="7878" href="Scoped.html#7878" class="Function">ℕtoWeirdFin</a> <a id="7890" class="Symbol">:</a> <a id="7892" class="Symbol">∀{</a><a id="7894" href="Scoped.html#7894" class="Bound">n</a><a id="7895" class="Symbol">}{</a><a id="7897" href="Scoped.html#7897" class="Bound">w</a> <a id="7899" class="Symbol">:</a> <a id="7901" href="Scoped.html#1938" class="Datatype">Weirdℕ</a> <a id="7908" href="Scoped.html#7894" class="Bound">n</a><a id="7909" class="Symbol">}</a> <a id="7911" class="Symbol">→</a> <a id="7913" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="7915" class="Symbol">→</a> <a id="7917" href="Utils.html#904" class="Datatype">Either</a> <a id="7924" href="Scoped.html#7440" class="Datatype">ScopeError</a> <a id="7935" class="Symbol">(</a><a id="7936" href="Scoped.html#2069" class="Datatype">WeirdFin</a> <a id="7945" href="Scoped.html#7897" class="Bound">w</a><a id="7946" class="Symbol">)</a>
<a id="7948" href="Scoped.html#7878" class="Function">ℕtoWeirdFin</a> <a id="7960" class="Symbol">{</a><a id="7961" class="Argument">w</a> <a id="7963" class="Symbol">=</a> <a id="7965" href="Scoped.html#1963" class="InductiveConstructor">Z</a><a id="7966" class="Symbol">}</a>   <a id="7970" href="Scoped.html#7970" class="Bound">n</a>    <a id="7975" class="Symbol">=</a> <a id="7977" href="Utils.html#937" class="InductiveConstructor">inj₁</a> <a id="7982" href="Scoped.html#7465" class="InductiveConstructor">deBError</a>
<a id="7991" href="Scoped.html#7878" class="Function">ℕtoWeirdFin</a> <a id="8003" class="Symbol">{</a><a id="8004" class="Argument">w</a> <a id="8006" class="Symbol">=</a> <a id="8008" href="Scoped.html#1978" class="InductiveConstructor">S</a> <a id="8010" href="Scoped.html#8010" class="Bound">w</a><a id="8011" class="Symbol">}</a> <a id="8013" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="8018" class="Symbol">=</a> <a id="8020" href="Utils.html#3293" class="Field">return</a> <a id="8027" href="Scoped.html#2110" class="InductiveConstructor">Z</a>
<a id="8029" href="Scoped.html#7878" class="Function">ℕtoWeirdFin</a> <a id="8041" class="Symbol">{</a><a id="8042" class="Argument">w</a> <a id="8044" class="Symbol">=</a> <a id="8046" href="Scoped.html#1978" class="InductiveConstructor">S</a> <a id="8048" href="Scoped.html#8048" class="Bound">w</a><a id="8049" class="Symbol">}</a> <a id="8051" class="Symbol">(</a><a id="8052" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="8056" href="Scoped.html#8056" class="Bound">n</a><a id="8057" class="Symbol">)</a> <a id="8059" class="Symbol">=</a> <a id="8061" class="Keyword">do</a>
  <a id="8066" href="Scoped.html#8066" class="Bound">i</a> <a id="8068" href="Utils.html#3321" class="Field Operator">←</a> <a id="8070" href="Scoped.html#7878" class="Function">ℕtoWeirdFin</a> <a id="8082" class="Symbol">{</a><a id="8083" class="Argument">w</a> <a id="8085" class="Symbol">=</a> <a id="8087" href="Scoped.html#8048" class="Bound">w</a><a id="8088" class="Symbol">}</a> <a id="8090" href="Scoped.html#8056" class="Bound">n</a>
  <a id="8094" href="Utils.html#3293" class="Field">return</a> <a id="8101" class="Symbol">(</a><a id="8102" href="Scoped.html#2152" class="InductiveConstructor">S</a> <a id="8104" href="Scoped.html#8066" class="Bound">i</a><a id="8105" class="Symbol">)</a>
<a id="8107" href="Scoped.html#7878" class="Function">ℕtoWeirdFin</a> <a id="8119" class="Symbol">{</a><a id="8120" class="Argument">w</a> <a id="8122" class="Symbol">=</a> <a id="8124" href="Scoped.html#2012" class="InductiveConstructor">T</a> <a id="8126" href="Scoped.html#8126" class="Bound">w</a><a id="8127" class="Symbol">}</a> <a id="8129" href="Scoped.html#8129" class="Bound">n</a>  <a id="8132" class="Symbol">=</a> <a id="8134" class="Keyword">do</a>
  <a id="8139" href="Scoped.html#8139" class="Bound">i</a> <a id="8141" href="Utils.html#3321" class="Field Operator">←</a> <a id="8143" href="Scoped.html#7878" class="Function">ℕtoWeirdFin</a> <a id="8155" class="Symbol">{</a><a id="8156" class="Argument">w</a> <a id="8158" class="Symbol">=</a> <a id="8160" href="Scoped.html#8126" class="Bound">w</a><a id="8161" class="Symbol">}</a> <a id="8163" href="Scoped.html#8129" class="Bound">n</a>
  <a id="8167" href="Utils.html#3293" class="Field">return</a> <a id="8174" class="Symbol">(</a><a id="8175" href="Scoped.html#2207" class="InductiveConstructor">T</a> <a id="8177" href="Scoped.html#8139" class="Bound">i</a><a id="8178" class="Symbol">)</a>

<a id="scopeCheckTy"></a><a id="8181" href="Scoped.html#8181" class="Function">scopeCheckTy</a> <a id="8194" class="Symbol">:</a> <a id="8196" class="Symbol">∀{</a><a id="8198" href="Scoped.html#8198" class="Bound">n</a><a id="8199" class="Symbol">}</a> <a id="8201" class="Symbol">→</a> <a id="8203" href="Raw.html#694" class="Datatype">RawTy</a> <a id="8209" class="Symbol">→</a> <a id="8211" href="Utils.html#904" class="Datatype">Either</a> <a id="8218" href="Scoped.html#7440" class="Datatype">ScopeError</a> <a id="8229" class="Symbol">(</a><a id="8230" href="Scoped.html#1387" class="Datatype">ScopedTy</a> <a id="8239" href="Scoped.html#8198" class="Bound">n</a><a id="8240" class="Symbol">)</a>
<a id="8242" href="Scoped.html#8181" class="Function">scopeCheckTy</a> <a id="8255" class="Symbol">(</a><a id="8256" href="Raw.html#714" class="InductiveConstructor">`</a> <a id="8258" href="Scoped.html#8258" class="Bound">x</a><a id="8259" class="Symbol">)</a> <a id="8261" class="Symbol">=</a> <a id="8263" href="Utils.html#3433" class="Function">fmap</a> <a id="8268" href="Scoped.html#1418" class="InductiveConstructor">`</a> <a id="8270" class="Symbol">(</a><a id="8271" href="Scoped.html#7710" class="Function">ℕtoFin</a> <a id="8278" href="Scoped.html#8258" class="Bound">x</a><a id="8279" class="Symbol">)</a>
<a id="8281" href="Scoped.html#8181" class="Function">scopeCheckTy</a> <a id="8294" class="Symbol">(</a><a id="8295" href="Scoped.html#8295" class="Bound">A</a> <a id="8297" href="Raw.html#732" class="InductiveConstructor Operator">⇒</a> <a id="8299" href="Scoped.html#8299" class="Bound">B</a><a id="8300" class="Symbol">)</a> <a id="8302" class="Symbol">=</a> <a id="8304" class="Keyword">do</a>
  <a id="8309" href="Scoped.html#8309" class="Bound">A</a> <a id="8311" href="Utils.html#3321" class="Field Operator">←</a> <a id="8313" href="Scoped.html#8181" class="Function">scopeCheckTy</a> <a id="8326" href="Scoped.html#8295" class="Bound">A</a>
  <a id="8330" href="Scoped.html#8330" class="Bound">B</a> <a id="8332" href="Utils.html#3321" class="Field Operator">←</a> <a id="8334" href="Scoped.html#8181" class="Function">scopeCheckTy</a> <a id="8347" href="Scoped.html#8299" class="Bound">B</a>
  <a id="8351" href="Utils.html#3293" class="Field">return</a> <a id="8358" class="Symbol">(</a><a id="8359" href="Scoped.html#8309" class="Bound">A</a> <a id="8361" href="Scoped.html#1446" class="InductiveConstructor Operator">⇒</a> <a id="8363" href="Scoped.html#8330" class="Bound">B</a><a id="8364" class="Symbol">)</a>
<a id="8366" href="Scoped.html#8181" class="Function">scopeCheckTy</a> <a id="8379" class="Symbol">(</a><a id="8380" href="Raw.html#762" class="InductiveConstructor">Π</a> <a id="8382" href="Scoped.html#8382" class="Bound">K</a> <a id="8384" href="Scoped.html#8384" class="Bound">A</a><a id="8385" class="Symbol">)</a> <a id="8387" class="Symbol">=</a> <a id="8389" href="Utils.html#3433" class="Function">fmap</a> <a id="8394" class="Symbol">(</a><a id="8395" href="Scoped.html#1492" class="InductiveConstructor">Π</a> <a id="8397" class="Symbol">(</a><a id="8398" href="Scoped.html#6910" class="Function">deBruijnifyK</a> <a id="8411" href="Scoped.html#8382" class="Bound">K</a><a id="8412" class="Symbol">))</a> <a id="8415" class="Symbol">(</a><a id="8416" href="Scoped.html#8181" class="Function">scopeCheckTy</a> <a id="8429" href="Scoped.html#8384" class="Bound">A</a><a id="8430" class="Symbol">)</a>
<a id="8432" href="Scoped.html#8181" class="Function">scopeCheckTy</a> <a id="8445" class="Symbol">(</a><a id="8446" href="Raw.html#794" class="InductiveConstructor">ƛ</a> <a id="8448" href="Scoped.html#8448" class="Bound">K</a> <a id="8450" href="Scoped.html#8450" class="Bound">A</a><a id="8451" class="Symbol">)</a> <a id="8453" class="Symbol">=</a> <a id="8455" href="Utils.html#3433" class="Function">fmap</a> <a id="8460" class="Symbol">(</a><a id="8461" href="Scoped.html#1538" class="InductiveConstructor">ƛ</a> <a id="8463" class="Symbol">(</a><a id="8464" href="Scoped.html#6910" class="Function">deBruijnifyK</a> <a id="8477" href="Scoped.html#8448" class="Bound">K</a><a id="8478" class="Symbol">))</a> <a id="8481" class="Symbol">(</a><a id="8482" href="Scoped.html#8181" class="Function">scopeCheckTy</a> <a id="8495" href="Scoped.html#8450" class="Bound">A</a><a id="8496" class="Symbol">)</a>
<a id="8498" href="Scoped.html#8181" class="Function">scopeCheckTy</a> <a id="8511" class="Symbol">(</a><a id="8512" href="Scoped.html#8512" class="Bound">A</a> <a id="8514" href="Raw.html#826" class="InductiveConstructor Operator">·</a> <a id="8516" href="Scoped.html#8516" class="Bound">B</a><a id="8517" class="Symbol">)</a> <a id="8519" class="Symbol">=</a> <a id="8521" class="Keyword">do</a>
  <a id="8526" href="Scoped.html#8526" class="Bound">A</a> <a id="8528" href="Utils.html#3321" class="Field Operator">←</a> <a id="8530" href="Scoped.html#8181" class="Function">scopeCheckTy</a> <a id="8543" href="Scoped.html#8512" class="Bound">A</a>
  <a id="8547" href="Scoped.html#8547" class="Bound">B</a> <a id="8549" href="Utils.html#3321" class="Field Operator">←</a> <a id="8551" href="Scoped.html#8181" class="Function">scopeCheckTy</a> <a id="8564" href="Scoped.html#8516" class="Bound">B</a>
  <a id="8568" href="Utils.html#3293" class="Field">return</a> <a id="8575" class="Symbol">(</a><a id="8576" href="Scoped.html#8526" class="Bound">A</a> <a id="8578" href="Scoped.html#1584" class="InductiveConstructor Operator">·</a> <a id="8580" href="Scoped.html#8547" class="Bound">B</a><a id="8581" class="Symbol">)</a>
<a id="8583" href="Scoped.html#8181" class="Function">scopeCheckTy</a> <a id="8596" class="Symbol">(</a><a id="8597" href="Raw.html#856" class="InductiveConstructor">con</a> <a id="8601" href="Scoped.html#8601" class="Bound">c</a><a id="8602" class="Symbol">)</a> <a id="8604" class="Symbol">=</a> <a id="8606" href="Utils.html#961" class="InductiveConstructor">inj₂</a> <a id="8611" class="Symbol">(</a><a id="8612" href="Scoped.html#1630" class="InductiveConstructor">con</a> <a id="8616" href="Scoped.html#8601" class="Bound">c</a><a id="8617" class="Symbol">)</a>
<a id="8619" href="Scoped.html#8181" class="Function">scopeCheckTy</a> <a id="8632" class="Symbol">(</a><a id="8633" href="Raw.html#878" class="InductiveConstructor">μ</a> <a id="8635" href="Scoped.html#8635" class="Bound">A</a> <a id="8637" href="Scoped.html#8637" class="Bound">B</a><a id="8638" class="Symbol">)</a> <a id="8640" class="Symbol">=</a> <a id="8642" class="Keyword">do</a>
  <a id="8647" href="Scoped.html#8647" class="Bound">A</a> <a id="8649" href="Utils.html#3321" class="Field Operator">←</a> <a id="8651" href="Scoped.html#8181" class="Function">scopeCheckTy</a> <a id="8664" href="Scoped.html#8635" class="Bound">A</a>
  <a id="8668" href="Scoped.html#8668" class="Bound">B</a> <a id="8670" href="Utils.html#3321" class="Field Operator">←</a> <a id="8672" href="Scoped.html#8181" class="Function">scopeCheckTy</a> <a id="8685" href="Scoped.html#8637" class="Bound">B</a>
  <a id="8689" href="Utils.html#3293" class="Field">return</a> <a id="8696" class="Symbol">(</a><a id="8697" href="Scoped.html#1658" class="InductiveConstructor">μ</a> <a id="8699" href="Scoped.html#8647" class="Bound">A</a> <a id="8701" href="Scoped.html#8668" class="Bound">B</a><a id="8702" class="Symbol">)</a>

<a id="scopeCheckTm"></a><a id="8705" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="8718" class="Symbol">:</a> <a id="8720" class="Symbol">∀{</a><a id="8722" href="Scoped.html#8722" class="Bound">n</a><a id="8723" class="Symbol">}{</a><a id="8725" href="Scoped.html#8725" class="Bound">w</a> <a id="8727" class="Symbol">:</a> <a id="8729" href="Scoped.html#1938" class="Datatype">Weirdℕ</a> <a id="8736" href="Scoped.html#8722" class="Bound">n</a><a id="8737" class="Symbol">}</a> <a id="8739" class="Symbol">→</a> <a id="8741" href="Raw.html#1138" class="Datatype">RawTm</a> <a id="8747" class="Symbol">→</a> <a id="8749" href="Utils.html#904" class="Datatype">Either</a> <a id="8756" href="Scoped.html#7440" class="Datatype">ScopeError</a> <a id="8767" class="Symbol">(</a><a id="8768" href="Scoped.html#6299" class="Datatype">ScopedTm</a> <a id="8777" href="Scoped.html#8725" class="Bound">w</a><a id="8778" class="Symbol">)</a>
<a id="8780" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="8793" class="Symbol">(</a><a id="8794" href="Raw.html#1158" class="InductiveConstructor">`</a> <a id="8796" href="Scoped.html#8796" class="Bound">x</a><a id="8797" class="Symbol">)</a> <a id="8799" class="Symbol">=</a> <a id="8801" href="Utils.html#3433" class="Function">fmap</a> <a id="8806" href="Scoped.html#6340" class="InductiveConstructor">`</a> <a id="8808" class="Symbol">(</a><a id="8809" href="Scoped.html#7878" class="Function">ℕtoWeirdFin</a> <a id="8821" href="Scoped.html#8796" class="Bound">x</a><a id="8822" class="Symbol">)</a>
<a id="8824" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="8837" class="Symbol">{</a><a id="8838" href="Scoped.html#8838" class="Bound">n</a><a id="8839" class="Symbol">}{</a><a id="8841" href="Scoped.html#8841" class="Bound">w</a><a id="8842" class="Symbol">}(</a><a id="8844" href="Raw.html#1186" class="InductiveConstructor">Λ</a> <a id="8846" href="Scoped.html#8846" class="Bound">K</a> <a id="8848" href="Scoped.html#8848" class="Bound">t</a><a id="8849" class="Symbol">)</a> <a id="8851" class="Symbol">=</a> <a id="8853" href="Utils.html#3433" class="Function">fmap</a> <a id="8858" class="Symbol">(</a><a id="8859" href="Scoped.html#6376" class="InductiveConstructor">Λ</a> <a id="8861" class="Symbol">(</a><a id="8862" href="Scoped.html#6910" class="Function">deBruijnifyK</a> <a id="8875" href="Scoped.html#8846" class="Bound">K</a><a id="8876" class="Symbol">))</a> <a id="8879" class="Symbol">(</a><a id="8880" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="8893" class="Symbol">{</a><a id="8894" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="8898" href="Scoped.html#8838" class="Bound">n</a><a id="8899" class="Symbol">}{</a><a id="8901" href="Scoped.html#2012" class="InductiveConstructor">T</a> <a id="8903" href="Scoped.html#8841" class="Bound">w</a><a id="8904" class="Symbol">}</a> <a id="8906" href="Scoped.html#8848" class="Bound">t</a><a id="8907" class="Symbol">)</a>
<a id="8909" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="8922" class="Symbol">(</a><a id="8923" href="Scoped.html#8923" class="Bound">t</a> <a id="8925" href="Raw.html#1228" class="InductiveConstructor Operator">·⋆</a> <a id="8928" href="Scoped.html#8928" class="Bound">A</a><a id="8929" class="Symbol">)</a> <a id="8931" class="Symbol">=</a> <a id="8933" class="Keyword">do</a>
  <a id="8938" href="Scoped.html#8938" class="Bound">A</a> <a id="8940" href="Utils.html#3321" class="Field Operator">←</a> <a id="8942" href="Scoped.html#8181" class="Function">scopeCheckTy</a> <a id="8955" href="Scoped.html#8928" class="Bound">A</a>
  <a id="8959" href="Scoped.html#8959" class="Bound">t</a> <a id="8961" href="Utils.html#3321" class="Field Operator">←</a> <a id="8963" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="8976" href="Scoped.html#8923" class="Bound">t</a>
  <a id="8980" href="Utils.html#3293" class="Field">return</a> <a id="8987" class="Symbol">(</a><a id="8988" href="Scoped.html#8959" class="Bound">t</a> <a id="8990" href="Scoped.html#6423" class="InductiveConstructor Operator">·⋆</a> <a id="8993" href="Scoped.html#8938" class="Bound">A</a><a id="8994" class="Symbol">)</a>
<a id="8996" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="9009" class="Symbol">(</a><a id="9010" href="Raw.html#1268" class="InductiveConstructor">ƛ</a> <a id="9012" href="Scoped.html#9012" class="Bound">A</a> <a id="9014" href="Scoped.html#9014" class="Bound">t</a><a id="9015" class="Symbol">)</a> <a id="9017" class="Symbol">=</a> <a id="9019" class="Keyword">do</a>
  <a id="9024" href="Scoped.html#9024" class="Bound">A</a> <a id="9026" href="Utils.html#3321" class="Field Operator">←</a> <a id="9028" href="Scoped.html#8181" class="Function">scopeCheckTy</a> <a id="9041" href="Scoped.html#9012" class="Bound">A</a>
  <a id="9045" href="Scoped.html#9045" class="Bound">t</a> <a id="9047" href="Utils.html#3321" class="Field Operator">←</a> <a id="9049" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="9062" href="Scoped.html#9014" class="Bound">t</a>
  <a id="9066" href="Utils.html#3293" class="Field">return</a> <a id="9073" class="Symbol">(</a><a id="9074" href="Scoped.html#6472" class="InductiveConstructor">ƛ</a> <a id="9076" href="Scoped.html#9024" class="Bound">A</a> <a id="9078" href="Scoped.html#9045" class="Bound">t</a><a id="9079" class="Symbol">)</a>
<a id="9081" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="9094" class="Symbol">(</a><a id="9095" href="Scoped.html#9095" class="Bound">t</a> <a id="9097" href="Raw.html#1308" class="InductiveConstructor Operator">·</a> <a id="9099" href="Scoped.html#9099" class="Bound">u</a><a id="9100" class="Symbol">)</a> <a id="9102" class="Symbol">=</a> <a id="9104" class="Keyword">do</a>
  <a id="9109" href="Scoped.html#9109" class="Bound">t</a> <a id="9111" href="Utils.html#3321" class="Field Operator">←</a> <a id="9113" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="9126" href="Scoped.html#9095" class="Bound">t</a>
  <a id="9130" href="Scoped.html#9130" class="Bound">u</a> <a id="9132" href="Utils.html#3321" class="Field Operator">←</a> <a id="9134" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="9147" href="Scoped.html#9099" class="Bound">u</a>
  <a id="9151" href="Utils.html#3293" class="Field">return</a> <a id="9158" class="Symbol">(</a><a id="9159" href="Scoped.html#9109" class="Bound">t</a> <a id="9161" href="Scoped.html#6525" class="InductiveConstructor Operator">·</a> <a id="9163" href="Scoped.html#9130" class="Bound">u</a><a id="9164" class="Symbol">)</a>
<a id="9166" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="9179" class="Symbol">(</a><a id="9180" href="Raw.html#1348" class="InductiveConstructor">con</a> <a id="9184" href="Scoped.html#9184" class="Bound">c</a><a id="9185" class="Symbol">)</a> <a id="9187" class="Symbol">=</a> <a id="9189" href="Utils.html#3293" class="Field">return</a> <a id="9196" class="Symbol">(</a><a id="9197" href="Scoped.html#6574" class="InductiveConstructor">con</a> <a id="9201" class="Symbol">(</a><a id="9202" href="Scoped.html#7065" class="Function">deBruijnifyC</a> <a id="9215" href="Scoped.html#9184" class="Bound">c</a><a id="9216" class="Symbol">))</a>
<a id="9219" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="9232" class="Symbol">(</a><a id="9233" href="Raw.html#1417" class="InductiveConstructor">builtin</a> <a id="9241" href="Scoped.html#9241" class="Bound">b</a><a id="9242" class="Symbol">)</a> <a id="9244" class="Symbol">=</a> <a id="9246" href="Utils.html#3293" class="Field">return</a> <a id="9253" class="Symbol">(</a><a id="9254" href="Scoped.html#6643" class="InductiveConstructor">ibuiltin</a> <a id="9263" href="Scoped.html#9241" class="Bound">b</a><a id="9264" class="Symbol">)</a>
<a id="9266" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="9279" class="Symbol">(</a><a id="9280" href="Raw.html#1385" class="InductiveConstructor">error</a> <a id="9286" href="Scoped.html#9286" class="Bound">A</a><a id="9287" class="Symbol">)</a> <a id="9289" class="Symbol">=</a> <a id="9291" href="Utils.html#3433" class="Function">fmap</a> <a id="9296" href="Scoped.html#6607" class="InductiveConstructor">error</a> <a id="9302" class="Symbol">(</a><a id="9303" href="Scoped.html#8181" class="Function">scopeCheckTy</a> <a id="9316" href="Scoped.html#9286" class="Bound">A</a><a id="9317" class="Symbol">)</a>
<a id="9319" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="9332" class="Symbol">(</a><a id="9333" href="Raw.html#1451" class="InductiveConstructor">wrap</a> <a id="9338" href="Scoped.html#9338" class="Bound">A</a> <a id="9340" href="Scoped.html#9340" class="Bound">B</a> <a id="9342" href="Scoped.html#9342" class="Bound">t</a><a id="9343" class="Symbol">)</a> <a id="9345" class="Symbol">=</a> <a id="9347" class="Keyword">do</a>
  <a id="9352" href="Scoped.html#9352" class="Bound">A</a> <a id="9354" href="Utils.html#3321" class="Field Operator">←</a> <a id="9356" href="Scoped.html#8181" class="Function">scopeCheckTy</a> <a id="9369" href="Scoped.html#9338" class="Bound">A</a>
  <a id="9373" href="Scoped.html#9373" class="Bound">B</a> <a id="9375" href="Utils.html#3321" class="Field Operator">←</a> <a id="9377" href="Scoped.html#8181" class="Function">scopeCheckTy</a> <a id="9390" href="Scoped.html#9340" class="Bound">B</a>
  <a id="9394" href="Scoped.html#9394" class="Bound">t</a> <a id="9396" href="Utils.html#3321" class="Field Operator">←</a> <a id="9398" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="9411" href="Scoped.html#9342" class="Bound">t</a>
  <a id="9415" href="Utils.html#3293" class="Field">return</a> <a id="9422" class="Symbol">(</a><a id="9423" href="Scoped.html#6683" class="InductiveConstructor">wrap</a> <a id="9428" href="Scoped.html#9352" class="Bound">A</a> <a id="9430" href="Scoped.html#9373" class="Bound">B</a> <a id="9432" href="Scoped.html#9394" class="Bound">t</a><a id="9433" class="Symbol">)</a>
<a id="9435" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="9448" class="Symbol">(</a><a id="9449" href="Raw.html#1499" class="InductiveConstructor">unwrap</a> <a id="9456" href="Scoped.html#9456" class="Bound">t</a><a id="9457" class="Symbol">)</a> <a id="9459" class="Symbol">=</a> <a id="9461" href="Utils.html#3433" class="Function">fmap</a> <a id="9466" href="Scoped.html#6745" class="InductiveConstructor">unwrap</a> <a id="9473" class="Symbol">(</a><a id="9474" href="Scoped.html#8705" class="Function">scopeCheckTm</a> <a id="9487" href="Scoped.html#9456" class="Bound">t</a><a id="9488" class="Symbol">)</a>
<a id="9490" class="Markup">\end{code}</a><a id="9500" class="Background">

</a><a id="9502" class="Markup">\begin{code}</a>
<a id="unDeBruijnifyK"></a><a id="9515" href="Scoped.html#9515" class="Function">unDeBruijnifyK</a> <a id="9530" class="Symbol">:</a> <a id="9532" href="Type.html#596" class="Datatype">Kind</a> <a id="9537" class="Symbol">→</a> <a id="9539" href="Raw.html#615" class="Datatype">RawKind</a>
<a id="9547" href="Scoped.html#9515" class="Function">unDeBruijnifyK</a> <a id="9562" href="Type.html#615" class="InductiveConstructor">*</a> <a id="9564" class="Symbol">=</a> <a id="9566" href="Raw.html#637" class="InductiveConstructor">*</a>
<a id="9568" href="Scoped.html#9515" class="Function">unDeBruijnifyK</a> <a id="9583" class="Symbol">(</a><a id="9584" href="Scoped.html#9584" class="Bound">K</a> <a id="9586" href="Type.html#650" class="InductiveConstructor Operator">⇒</a> <a id="9588" href="Scoped.html#9588" class="Bound">J</a><a id="9589" class="Symbol">)</a> <a id="9591" class="Symbol">=</a> <a id="9593" href="Scoped.html#9515" class="Function">unDeBruijnifyK</a> <a id="9608" href="Scoped.html#9584" class="Bound">K</a> <a id="9610" href="Raw.html#653" class="InductiveConstructor Operator">⇒</a> <a id="9612" href="Scoped.html#9515" class="Function">unDeBruijnifyK</a> <a id="9627" href="Scoped.html#9588" class="Bound">J</a>

<a id="9630" class="Symbol">{-#</a> <a id="9634" class="Keyword">COMPILE</a> <a id="9642" class="Keyword">GHC</a> <a id="9646" href="Scoped.html#9515" class="Function">unDeBruijnifyK</a> <a id="9661" class="Pragma">as</a> <a id="9664" class="Pragma">unDeBruijnifyK</a> <a id="9679" class="Symbol">#-}</a>

<a id="9684" class="Markup">\end{code}</a><a id="9694" class="Background">

</a><a id="9696" class="Markup">\begin{code}</a>
<a id="9709" class="Comment">{-
wftoℕ : ∀{n}{w : Weirdℕ n} → WeirdFin w → ℕ
wftoℕ Z = zero
wftoℕ (S i) = ℕ.suc (wftoℕ i)
wftoℕ (T i) = ℕ.suc (wftoℕ i)
-}</a>
<a id="9834" class="Markup">\end{code}</a><a id="9844" class="Background">

</a><a id="9846" class="Markup">\begin{code}</a>
<a id="unDeBruijnifyC"></a><a id="9859" href="Scoped.html#9859" class="Function">unDeBruijnifyC</a> <a id="9874" class="Symbol">:</a> <a id="9876" href="Scoped.html#6032" class="Datatype">TermCon</a> <a id="9884" class="Symbol">→</a> <a id="9886" href="Raw.html#913" class="Datatype">RawTermCon</a>
<a id="9897" href="Scoped.html#9859" class="Function">unDeBruijnifyC</a> <a id="9912" class="Symbol">(</a><a id="9913" href="Scoped.html#6054" class="InductiveConstructor">integer</a> <a id="9921" href="Scoped.html#9921" class="Bound">i</a><a id="9922" class="Symbol">)</a>    <a id="9927" class="Symbol">=</a> <a id="9929" href="Raw.html#938" class="InductiveConstructor">integer</a> <a id="9937" href="Scoped.html#9921" class="Bound">i</a>
<a id="9939" href="Scoped.html#9859" class="Function">unDeBruijnifyC</a> <a id="9954" class="Symbol">(</a><a id="9955" href="Scoped.html#6087" class="InductiveConstructor">bytestring</a> <a id="9966" href="Scoped.html#9966" class="Bound">b</a><a id="9967" class="Symbol">)</a> <a id="9969" class="Symbol">=</a> <a id="9971" href="Raw.html#968" class="InductiveConstructor">bytestring</a> <a id="9982" href="Scoped.html#9966" class="Bound">b</a>
<a id="9984" href="Scoped.html#9859" class="Function">unDeBruijnifyC</a> <a id="9999" class="Symbol">(</a><a id="10000" href="Scoped.html#6129" class="InductiveConstructor">string</a> <a id="10007" href="Scoped.html#10007" class="Bound">s</a><a id="10008" class="Symbol">)</a>     <a id="10014" class="Symbol">=</a> <a id="10016" href="Raw.html#1007" class="InductiveConstructor">string</a> <a id="10023" href="Scoped.html#10007" class="Bound">s</a>
<a id="10025" href="Scoped.html#9859" class="Function">unDeBruijnifyC</a> <a id="10040" class="Symbol">(</a><a id="10041" href="Scoped.html#6167" class="InductiveConstructor">bool</a> <a id="10046" href="Scoped.html#10046" class="Bound">b</a><a id="10047" class="Symbol">)</a>       <a id="10055" class="Symbol">=</a> <a id="10057" href="Raw.html#1042" class="InductiveConstructor">bool</a> <a id="10062" href="Scoped.html#10046" class="Bound">b</a>
<a id="10064" href="Scoped.html#9859" class="Function">unDeBruijnifyC</a> <a id="10079" class="Symbol">(</a><a id="10080" href="Scoped.html#6203" class="InductiveConstructor">char</a> <a id="10085" href="Scoped.html#10085" class="Bound">c</a><a id="10086" class="Symbol">)</a>       <a id="10094" class="Symbol">=</a> <a id="10096" href="Raw.html#1075" class="InductiveConstructor">char</a> <a id="10101" href="Scoped.html#10085" class="Bound">c</a>
<a id="10103" href="Scoped.html#9859" class="Function">unDeBruijnifyC</a> <a id="10118" href="Scoped.html#6239" class="InductiveConstructor">unit</a>           <a id="10133" class="Symbol">=</a> <a id="10135" href="Raw.html#1108" class="InductiveConstructor">unit</a>
<a id="10140" class="Markup">\end{code}</a><a id="10150" class="Background">

</a><a id="10152" class="Markup">\begin{code}</a>
<a id="extricateScopeTy"></a><a id="10165" href="Scoped.html#10165" class="Function">extricateScopeTy</a> <a id="10182" class="Symbol">:</a> <a id="10184" class="Symbol">∀{</a><a id="10186" href="Scoped.html#10186" class="Bound">n</a><a id="10187" class="Symbol">}</a> <a id="10189" class="Symbol">→</a> <a id="10191" href="Scoped.html#1387" class="Datatype">ScopedTy</a> <a id="10200" href="Scoped.html#10186" class="Bound">n</a> <a id="10202" class="Symbol">→</a> <a id="10204" href="Raw.html#694" class="Datatype">RawTy</a>
<a id="10210" href="Scoped.html#10165" class="Function">extricateScopeTy</a> <a id="10227" class="Symbol">(</a><a id="10228" href="Scoped.html#1418" class="InductiveConstructor">`</a> <a id="10230" href="Scoped.html#10230" class="Bound">x</a><a id="10231" class="Symbol">)</a> <a id="10233" class="Symbol">=</a> <a id="10235" href="Raw.html#714" class="InductiveConstructor">`</a> <a id="10237" class="Symbol">(</a><a id="10238" href="Data.Fin.Base.html#1192" class="Function">toℕ</a> <a id="10242" href="Scoped.html#10230" class="Bound">x</a><a id="10243" class="Symbol">)</a>
<a id="10245" href="Scoped.html#10165" class="Function">extricateScopeTy</a> <a id="10262" class="Symbol">(</a><a id="10263" href="Scoped.html#10263" class="Bound">A</a> <a id="10265" href="Scoped.html#1446" class="InductiveConstructor Operator">⇒</a> <a id="10267" href="Scoped.html#10267" class="Bound">B</a><a id="10268" class="Symbol">)</a> <a id="10270" class="Symbol">=</a> <a id="10272" href="Scoped.html#10165" class="Function">extricateScopeTy</a> <a id="10289" href="Scoped.html#10263" class="Bound">A</a> <a id="10291" href="Raw.html#732" class="InductiveConstructor Operator">⇒</a> <a id="10293" href="Scoped.html#10165" class="Function">extricateScopeTy</a> <a id="10310" href="Scoped.html#10267" class="Bound">B</a>
<a id="10312" href="Scoped.html#10165" class="Function">extricateScopeTy</a> <a id="10329" class="Symbol">(</a><a id="10330" href="Scoped.html#1492" class="InductiveConstructor">Π</a> <a id="10332" href="Scoped.html#10332" class="Bound">K</a> <a id="10334" href="Scoped.html#10334" class="Bound">A</a><a id="10335" class="Symbol">)</a> <a id="10337" class="Symbol">=</a> <a id="10339" href="Raw.html#762" class="InductiveConstructor">Π</a> <a id="10341" class="Symbol">(</a><a id="10342" href="Scoped.html#9515" class="Function">unDeBruijnifyK</a> <a id="10357" href="Scoped.html#10332" class="Bound">K</a><a id="10358" class="Symbol">)</a> <a id="10360" class="Symbol">(</a><a id="10361" href="Scoped.html#10165" class="Function">extricateScopeTy</a> <a id="10378" href="Scoped.html#10334" class="Bound">A</a><a id="10379" class="Symbol">)</a>
<a id="10381" href="Scoped.html#10165" class="Function">extricateScopeTy</a> <a id="10398" class="Symbol">(</a><a id="10399" href="Scoped.html#1538" class="InductiveConstructor">ƛ</a> <a id="10401" href="Scoped.html#10401" class="Bound">K</a> <a id="10403" href="Scoped.html#10403" class="Bound">A</a><a id="10404" class="Symbol">)</a> <a id="10406" class="Symbol">=</a> <a id="10408" href="Raw.html#794" class="InductiveConstructor">ƛ</a> <a id="10410" class="Symbol">(</a><a id="10411" href="Scoped.html#9515" class="Function">unDeBruijnifyK</a> <a id="10426" href="Scoped.html#10401" class="Bound">K</a><a id="10427" class="Symbol">)</a> <a id="10429" class="Symbol">(</a><a id="10430" href="Scoped.html#10165" class="Function">extricateScopeTy</a> <a id="10447" href="Scoped.html#10403" class="Bound">A</a><a id="10448" class="Symbol">)</a>
<a id="10450" href="Scoped.html#10165" class="Function">extricateScopeTy</a> <a id="10467" class="Symbol">(</a><a id="10468" href="Scoped.html#10468" class="Bound">A</a> <a id="10470" href="Scoped.html#1584" class="InductiveConstructor Operator">·</a> <a id="10472" href="Scoped.html#10472" class="Bound">B</a><a id="10473" class="Symbol">)</a> <a id="10475" class="Symbol">=</a> <a id="10477" href="Scoped.html#10165" class="Function">extricateScopeTy</a> <a id="10494" href="Scoped.html#10468" class="Bound">A</a> <a id="10496" href="Raw.html#826" class="InductiveConstructor Operator">·</a> <a id="10498" href="Scoped.html#10165" class="Function">extricateScopeTy</a> <a id="10515" href="Scoped.html#10472" class="Bound">B</a>
<a id="10517" href="Scoped.html#10165" class="Function">extricateScopeTy</a> <a id="10534" class="Symbol">(</a><a id="10535" href="Scoped.html#1630" class="InductiveConstructor">con</a> <a id="10539" href="Scoped.html#10539" class="Bound">c</a><a id="10540" class="Symbol">)</a> <a id="10542" class="Symbol">=</a> <a id="10544" href="Raw.html#856" class="InductiveConstructor">con</a> <a id="10548" href="Scoped.html#10539" class="Bound">c</a>
<a id="10550" href="Scoped.html#10165" class="Function">extricateScopeTy</a> <a id="10567" class="Symbol">(</a><a id="10568" href="Scoped.html#1658" class="InductiveConstructor">μ</a> <a id="10570" href="Scoped.html#10570" class="Bound">A</a> <a id="10572" href="Scoped.html#10572" class="Bound">B</a><a id="10573" class="Symbol">)</a> <a id="10575" class="Symbol">=</a> <a id="10577" href="Raw.html#878" class="InductiveConstructor">μ</a> <a id="10579" class="Symbol">(</a><a id="10580" href="Scoped.html#10165" class="Function">extricateScopeTy</a> <a id="10597" href="Scoped.html#10570" class="Bound">A</a><a id="10598" class="Symbol">)</a> <a id="10600" class="Symbol">(</a><a id="10601" href="Scoped.html#10165" class="Function">extricateScopeTy</a> <a id="10618" href="Scoped.html#10572" class="Bound">B</a><a id="10619" class="Symbol">)</a>
<a id="10621" href="Scoped.html#10165" class="Function">extricateScopeTy</a> <a id="10638" href="Scoped.html#1704" class="InductiveConstructor">missing</a> <a id="10646" class="Symbol">=</a> <a id="10648" href="Raw.html#856" class="InductiveConstructor">con</a> <a id="10652" href="Builtin.Constant.Type.html#3023" class="InductiveConstructor">bool</a> <a id="10657" class="Comment">-- TODO</a>

<a id="extricateScope"></a><a id="10666" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="10681" class="Symbol">:</a> <a id="10683" class="Symbol">∀{</a><a id="10685" href="Scoped.html#10685" class="Bound">n</a><a id="10686" class="Symbol">}{</a><a id="10688" href="Scoped.html#10688" class="Bound">w</a> <a id="10690" class="Symbol">:</a> <a id="10692" href="Scoped.html#1938" class="Datatype">Weirdℕ</a> <a id="10699" href="Scoped.html#10685" class="Bound">n</a><a id="10700" class="Symbol">}</a> <a id="10702" class="Symbol">→</a> <a id="10704" href="Scoped.html#6299" class="Datatype">ScopedTm</a> <a id="10713" href="Scoped.html#10688" class="Bound">w</a> <a id="10715" class="Symbol">→</a> <a id="10717" href="Raw.html#1138" class="Datatype">RawTm</a>
<a id="10723" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="10738" class="Symbol">(</a><a id="10739" href="Scoped.html#6340" class="InductiveConstructor">`</a> <a id="10741" href="Scoped.html#10741" class="Bound">x</a><a id="10742" class="Symbol">)</a> <a id="10744" class="Symbol">=</a> <a id="10746" href="Raw.html#1158" class="InductiveConstructor">`</a> <a id="10748" class="Symbol">(</a><a id="10749" href="Scoped.html#2532" class="Function">WeirdFintoℕ</a> <a id="10761" href="Scoped.html#10741" class="Bound">x</a><a id="10762" class="Symbol">)</a>
<a id="10764" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="10779" class="Symbol">(</a><a id="10780" href="Scoped.html#6376" class="InductiveConstructor">Λ</a> <a id="10782" href="Scoped.html#10782" class="Bound">K</a> <a id="10784" href="Scoped.html#10784" class="Bound">t</a><a id="10785" class="Symbol">)</a> <a id="10787" class="Symbol">=</a> <a id="10789" href="Raw.html#1186" class="InductiveConstructor">Λ</a> <a id="10791" class="Symbol">(</a><a id="10792" href="Scoped.html#9515" class="Function">unDeBruijnifyK</a> <a id="10807" href="Scoped.html#10782" class="Bound">K</a><a id="10808" class="Symbol">)</a> <a id="10810" class="Symbol">(</a><a id="10811" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="10826" href="Scoped.html#10784" class="Bound">t</a><a id="10827" class="Symbol">)</a>
<a id="10829" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="10844" class="Symbol">(</a><a id="10845" href="Scoped.html#10845" class="Bound">t</a> <a id="10847" href="Scoped.html#6423" class="InductiveConstructor Operator">·⋆</a> <a id="10850" href="Scoped.html#10850" class="Bound">A</a><a id="10851" class="Symbol">)</a> <a id="10853" class="Symbol">=</a> <a id="10855" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="10870" href="Scoped.html#10845" class="Bound">t</a> <a id="10872" href="Raw.html#1228" class="InductiveConstructor Operator">·⋆</a> <a id="10875" href="Scoped.html#10165" class="Function">extricateScopeTy</a> <a id="10892" href="Scoped.html#10850" class="Bound">A</a>
<a id="10894" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="10909" class="Symbol">(</a><a id="10910" href="Scoped.html#6472" class="InductiveConstructor">ƛ</a> <a id="10912" href="Scoped.html#10912" class="Bound">A</a> <a id="10914" href="Scoped.html#10914" class="Bound">t</a><a id="10915" class="Symbol">)</a> <a id="10917" class="Symbol">=</a> <a id="10919" href="Raw.html#1268" class="InductiveConstructor">ƛ</a> <a id="10921" class="Symbol">(</a><a id="10922" href="Scoped.html#10165" class="Function">extricateScopeTy</a> <a id="10939" href="Scoped.html#10912" class="Bound">A</a><a id="10940" class="Symbol">)</a> <a id="10942" class="Symbol">(</a><a id="10943" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="10958" href="Scoped.html#10914" class="Bound">t</a><a id="10959" class="Symbol">)</a>
<a id="10961" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="10976" class="Symbol">(</a><a id="10977" href="Scoped.html#10977" class="Bound">t</a> <a id="10979" href="Scoped.html#6525" class="InductiveConstructor Operator">·</a> <a id="10981" href="Scoped.html#10981" class="Bound">u</a><a id="10982" class="Symbol">)</a> <a id="10984" class="Symbol">=</a> <a id="10986" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="11001" href="Scoped.html#10977" class="Bound">t</a> <a id="11003" href="Raw.html#1308" class="InductiveConstructor Operator">·</a> <a id="11005" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="11020" href="Scoped.html#10981" class="Bound">u</a>
<a id="11022" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="11037" class="Symbol">(</a><a id="11038" href="Scoped.html#6574" class="InductiveConstructor">con</a> <a id="11042" href="Scoped.html#11042" class="Bound">c</a><a id="11043" class="Symbol">)</a> <a id="11045" class="Symbol">=</a> <a id="11047" href="Raw.html#1348" class="InductiveConstructor">con</a> <a id="11051" class="Symbol">(</a><a id="11052" href="Scoped.html#9859" class="Function">unDeBruijnifyC</a> <a id="11067" href="Scoped.html#11042" class="Bound">c</a><a id="11068" class="Symbol">)</a>
<a id="11070" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="11085" class="Symbol">(</a><a id="11086" href="Scoped.html#6607" class="InductiveConstructor">error</a> <a id="11092" href="Scoped.html#11092" class="Bound">A</a><a id="11093" class="Symbol">)</a> <a id="11095" class="Symbol">=</a> <a id="11097" href="Raw.html#1385" class="InductiveConstructor">error</a> <a id="11103" class="Symbol">(</a><a id="11104" href="Scoped.html#10165" class="Function">extricateScopeTy</a> <a id="11121" href="Scoped.html#11092" class="Bound">A</a><a id="11122" class="Symbol">)</a>
<a id="11124" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="11139" class="Symbol">(</a><a id="11140" href="Scoped.html#6643" class="InductiveConstructor">ibuiltin</a> <a id="11149" href="Scoped.html#11149" class="Bound">bn</a><a id="11151" class="Symbol">)</a> <a id="11153" class="Symbol">=</a> <a id="11155" href="Raw.html#1417" class="InductiveConstructor">builtin</a> <a id="11163" href="Scoped.html#11149" class="Bound">bn</a>
<a id="11166" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="11181" class="Symbol">(</a><a id="11182" href="Scoped.html#6683" class="InductiveConstructor">wrap</a> <a id="11187" href="Scoped.html#11187" class="Bound">pat</a> <a id="11191" href="Scoped.html#11191" class="Bound">arg</a> <a id="11195" href="Scoped.html#11195" class="Bound">t</a><a id="11196" class="Symbol">)</a> <a id="11198" class="Symbol">=</a>
  <a id="11202" href="Raw.html#1451" class="InductiveConstructor">wrap</a> <a id="11207" class="Symbol">(</a><a id="11208" href="Scoped.html#10165" class="Function">extricateScopeTy</a> <a id="11225" href="Scoped.html#11187" class="Bound">pat</a><a id="11228" class="Symbol">)</a> <a id="11230" class="Symbol">(</a><a id="11231" href="Scoped.html#10165" class="Function">extricateScopeTy</a> <a id="11248" href="Scoped.html#11191" class="Bound">arg</a><a id="11251" class="Symbol">)</a> <a id="11253" class="Symbol">(</a><a id="11254" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="11269" href="Scoped.html#11195" class="Bound">t</a><a id="11270" class="Symbol">)</a>
<a id="11272" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="11287" class="Symbol">(</a><a id="11288" href="Scoped.html#6745" class="InductiveConstructor">unwrap</a> <a id="11295" href="Scoped.html#11295" class="Bound">t</a><a id="11296" class="Symbol">)</a> <a id="11298" class="Symbol">=</a> <a id="11300" href="Raw.html#1499" class="InductiveConstructor">unwrap</a> <a id="11307" class="Symbol">(</a><a id="11308" href="Scoped.html#10666" class="Function">extricateScope</a> <a id="11323" href="Scoped.html#11295" class="Bound">t</a><a id="11324" class="Symbol">)</a>
<a id="11326" class="Markup">\end{code}</a><a id="11336" class="Background">

-- UGLY PRINTING

</a><a id="11356" class="Markup">\begin{code}</a>
<a id="11369" class="Keyword">open</a> <a id="11374" class="Keyword">import</a> <a id="11381" href="Data.String.html" class="Module">Data.String</a>

<a id="uglyWeirdFin"></a><a id="11394" href="Scoped.html#11394" class="Function">uglyWeirdFin</a> <a id="11407" class="Symbol">:</a> <a id="11409" class="Symbol">∀{</a><a id="11411" href="Scoped.html#11411" class="Bound">n</a><a id="11412" class="Symbol">}{</a><a id="11414" href="Scoped.html#11414" class="Bound">w</a> <a id="11416" class="Symbol">:</a> <a id="11418" href="Scoped.html#1938" class="Datatype">Weirdℕ</a> <a id="11425" href="Scoped.html#11411" class="Bound">n</a><a id="11426" class="Symbol">}</a> <a id="11428" class="Symbol">→</a> <a id="11430" href="Scoped.html#2069" class="Datatype">WeirdFin</a> <a id="11439" href="Scoped.html#11414" class="Bound">w</a> <a id="11441" class="Symbol">→</a> <a id="11443" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="11450" href="Scoped.html#11394" class="Function">uglyWeirdFin</a> <a id="11463" href="Scoped.html#2110" class="InductiveConstructor">Z</a> <a id="11465" class="Symbol">=</a> <a id="11467" class="String">&quot;0&quot;</a>
<a id="11471" href="Scoped.html#11394" class="Function">uglyWeirdFin</a> <a id="11484" class="Symbol">(</a><a id="11485" href="Scoped.html#2207" class="InductiveConstructor">T</a> <a id="11487" href="Scoped.html#11487" class="Bound">x</a><a id="11488" class="Symbol">)</a> <a id="11490" class="Symbol">=</a> <a id="11492" class="String">&quot;(T &quot;</a> <a id="11498" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="11501" href="Scoped.html#11394" class="Function">uglyWeirdFin</a> <a id="11514" href="Scoped.html#11487" class="Bound">x</a> <a id="11516" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="11519" class="String">&quot;)&quot;</a>
<a id="11523" href="Scoped.html#11394" class="Function">uglyWeirdFin</a> <a id="11536" class="Symbol">(</a><a id="11537" href="Scoped.html#2152" class="InductiveConstructor">S</a> <a id="11539" href="Scoped.html#11539" class="Bound">x</a><a id="11540" class="Symbol">)</a> <a id="11542" class="Symbol">=</a> <a id="11544" class="String">&quot;(S &quot;</a> <a id="11550" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="11553" href="Scoped.html#11394" class="Function">uglyWeirdFin</a> <a id="11566" href="Scoped.html#11539" class="Bound">x</a> <a id="11568" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="11571" class="String">&quot;)&quot;</a>

<a id="uglyTermCon"></a><a id="11576" href="Scoped.html#11576" class="Function">uglyTermCon</a> <a id="11588" class="Symbol">:</a> <a id="11590" href="Scoped.html#6032" class="Datatype">TermCon</a> <a id="11598" class="Symbol">→</a> <a id="11600" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="11607" href="Scoped.html#11576" class="Function">uglyTermCon</a> <a id="11619" class="Symbol">(</a><a id="11620" href="Scoped.html#6054" class="InductiveConstructor">integer</a> <a id="11628" href="Scoped.html#11628" class="Bound">x</a><a id="11629" class="Symbol">)</a> <a id="11631" class="Symbol">=</a> <a id="11633" class="String">&quot;(integer &quot;</a> <a id="11645" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="11648" href="Data.Integer.html#784" class="Function">Data.Integer.show</a> <a id="11666" href="Scoped.html#11628" class="Bound">x</a> <a id="11668" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="11671" class="String">&quot;)&quot;</a>
<a id="11675" href="Scoped.html#11576" class="Function">uglyTermCon</a> <a id="11687" class="Symbol">(</a><a id="11688" href="Scoped.html#6087" class="InductiveConstructor">bytestring</a> <a id="11699" href="Scoped.html#11699" class="Bound">x</a><a id="11700" class="Symbol">)</a> <a id="11702" class="Symbol">=</a> <a id="11704" class="String">&quot;bytestring&quot;</a>
<a id="11717" href="Scoped.html#11576" class="CatchallClause Function">uglyTermCon</a><a id="11728" class="CatchallClause"> </a><a id="11729" href="Scoped.html#11729" class="CatchallClause Bound">size</a> <a id="11734" class="Symbol">=</a> <a id="11736" class="String">&quot;size&quot;</a>

<a id="11744" class="Keyword">postulate</a> <a id="showNat"></a><a id="11754" href="Scoped.html#11754" class="Postulate">showNat</a> <a id="11762" class="Symbol">:</a> <a id="11764" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="11766" class="Symbol">→</a> <a id="11768" href="Agda.Builtin.String.html#274" class="Postulate">String</a>

<a id="11776" class="Symbol">{-#</a> <a id="11780" class="Keyword">FOREIGN</a> <a id="11788" class="Pragma">GHC</a> <a id="11792" class="Pragma">import</a> <a id="11799" class="Pragma">qualified</a> <a id="11809" class="Pragma">Data.Text</a> <a id="11819" class="Pragma">as</a> <a id="11822" class="Pragma">T</a> <a id="11824" class="Symbol">#-}</a>
<a id="11828" class="Symbol">{-#</a> <a id="11832" class="Keyword">COMPILE</a> <a id="11840" class="Keyword">GHC</a> <a id="11844" href="Scoped.html#11754" class="Postulate">showNat</a> <a id="11852" class="Pragma">=</a> <a id="11854" class="Pragma">T.pack</a> <a id="11861" class="Pragma">.</a> <a id="11863" class="Pragma">show</a> <a id="11868" class="Symbol">#-}</a>

<a id="uglyBuiltin"></a><a id="11873" href="Scoped.html#11873" class="Function">uglyBuiltin</a> <a id="11885" class="Symbol">:</a> <a id="11887" href="Builtin.html#41" class="Datatype">Builtin</a> <a id="11895" class="Symbol">→</a> <a id="11897" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="11904" href="Scoped.html#11873" class="Function">uglyBuiltin</a> <a id="11916" href="Builtin.html#63" class="InductiveConstructor">addInteger</a> <a id="11927" class="Symbol">=</a> <a id="11929" class="String">&quot;addInteger&quot;</a>
<a id="11942" href="Scoped.html#11873" class="CatchallClause Function">uglyBuiltin</a><a id="11953" class="CatchallClause"> </a><a id="11954" class="CatchallClause Symbol">_</a> <a id="11956" class="Symbol">=</a> <a id="11958" class="String">&quot;other&quot;</a>
<a id="ugly"></a><a id="11966" href="Scoped.html#11966" class="Function">ugly</a> <a id="11971" class="Symbol">:</a> <a id="11973" class="Symbol">∀{</a><a id="11975" href="Scoped.html#11975" class="Bound">n</a><a id="11976" class="Symbol">}{</a><a id="11978" href="Scoped.html#11978" class="Bound">w</a> <a id="11980" class="Symbol">:</a> <a id="11982" href="Scoped.html#1938" class="Datatype">Weirdℕ</a> <a id="11989" href="Scoped.html#11975" class="Bound">n</a><a id="11990" class="Symbol">}</a> <a id="11992" class="Symbol">→</a> <a id="11994" href="Scoped.html#6299" class="Datatype">ScopedTm</a> <a id="12003" href="Scoped.html#11978" class="Bound">w</a> <a id="12005" class="Symbol">→</a> <a id="12007" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="12014" href="Scoped.html#11966" class="Function">ugly</a> <a id="12019" class="Symbol">(</a><a id="12020" href="Scoped.html#6340" class="InductiveConstructor">`</a> <a id="12022" href="Scoped.html#12022" class="Bound">x</a><a id="12023" class="Symbol">)</a> <a id="12025" class="Symbol">=</a> <a id="12027" class="String">&quot;(` &quot;</a> <a id="12033" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="12036" href="Scoped.html#11394" class="Function">uglyWeirdFin</a> <a id="12049" href="Scoped.html#12022" class="Bound">x</a> <a id="12051" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="12054" class="String">&quot;)&quot;</a>
<a id="12058" href="Scoped.html#11966" class="Function">ugly</a> <a id="12063" class="Symbol">(</a><a id="12064" href="Scoped.html#6472" class="InductiveConstructor">ƛ</a> <a id="12066" class="Symbol">_</a> <a id="12068" href="Scoped.html#12068" class="Bound">t</a><a id="12069" class="Symbol">)</a> <a id="12071" class="Symbol">=</a> <a id="12073" class="String">&quot;(ƛ &quot;</a> <a id="12079" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="12082" href="Scoped.html#11966" class="Function">ugly</a> <a id="12087" href="Scoped.html#12068" class="Bound">t</a> <a id="12089" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="12092" class="String">&quot;)&quot;</a>
<a id="12096" href="Scoped.html#11966" class="Function">ugly</a> <a id="12101" class="Symbol">(</a><a id="12102" href="Scoped.html#12102" class="Bound">t</a> <a id="12104" href="Scoped.html#6525" class="InductiveConstructor Operator">·</a> <a id="12106" href="Scoped.html#12106" class="Bound">u</a><a id="12107" class="Symbol">)</a> <a id="12109" class="Symbol">=</a> <a id="12111" class="String">&quot;( &quot;</a> <a id="12116" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="12119" href="Scoped.html#11966" class="Function">ugly</a> <a id="12124" href="Scoped.html#12102" class="Bound">t</a> <a id="12126" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="12129" class="String">&quot; · &quot;</a> <a id="12135" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="12138" href="Scoped.html#11966" class="Function">ugly</a> <a id="12143" href="Scoped.html#12106" class="Bound">u</a> <a id="12145" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="12148" class="String">&quot;)&quot;</a>
<a id="12152" href="Scoped.html#11966" class="Function">ugly</a> <a id="12157" class="Symbol">(</a><a id="12158" href="Scoped.html#6376" class="InductiveConstructor">Λ</a> <a id="12160" class="Symbol">_</a> <a id="12162" href="Scoped.html#12162" class="Bound">t</a><a id="12163" class="Symbol">)</a> <a id="12165" class="Symbol">=</a> <a id="12167" class="String">&quot;(Λ &quot;</a> <a id="12173" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="12176" href="Scoped.html#11966" class="Function">ugly</a> <a id="12181" href="Scoped.html#12162" class="Bound">t</a> <a id="12183" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="12186" class="String">&quot;)&quot;</a>
<a id="12190" href="Scoped.html#11966" class="Function">ugly</a> <a id="12195" class="Symbol">(</a><a id="12196" href="Scoped.html#12196" class="Bound">t</a> <a id="12198" href="Scoped.html#6423" class="InductiveConstructor Operator">·⋆</a> <a id="12201" href="Scoped.html#12201" class="Bound">A</a><a id="12202" class="Symbol">)</a> <a id="12204" class="Symbol">=</a> <a id="12206" class="String">&quot;( &quot;</a> <a id="12211" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="12214" href="Scoped.html#11966" class="Function">ugly</a> <a id="12219" href="Scoped.html#12196" class="Bound">t</a> <a id="12221" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="12224" class="String">&quot; ·⋆ &quot;</a> <a id="12231" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="12234" class="String">&quot;TYPE&quot;</a> <a id="12241" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="12244" class="String">&quot;)&quot;</a>

<a id="12249" href="Scoped.html#11966" class="Function">ugly</a> <a id="12254" class="Symbol">(</a><a id="12255" href="Scoped.html#6574" class="InductiveConstructor">con</a> <a id="12259" href="Scoped.html#12259" class="Bound">c</a><a id="12260" class="Symbol">)</a> <a id="12262" class="Symbol">=</a> <a id="12264" class="String">&quot;(con &quot;</a> <a id="12272" class="Comment">-- ++ uglyTermCon c ++ &quot;)&quot;</a>
<a id="12299" href="Scoped.html#11966" class="Function">ugly</a> <a id="12304" class="Symbol">(</a><a id="12305" href="Scoped.html#6643" class="InductiveConstructor">ibuiltin</a> <a id="12314" href="Scoped.html#12314" class="Bound">b</a><a id="12315" class="Symbol">)</a> <a id="12317" class="Symbol">=</a> <a id="12319" class="String">&quot;builtin &quot;</a> <a id="12330" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="12333" href="Scoped.html#11873" class="Function">uglyBuiltin</a> <a id="12345" href="Scoped.html#12314" class="Bound">b</a>
<a id="12347" class="Comment">{-  &quot;(builtin &quot; ++
  uglyBuiltin b ++
  &quot; &quot; ++
  Data.Integer.show (Data.Integer.ℤ.pos (Data.List.length As)) ++
  &quot; &quot; ++
  Data.Integer.show (Data.Integer.ℤ.pos (Data.List.length ts))
  ++ &quot;)&quot; -}</a>
<a id="12544" href="Scoped.html#11966" class="Function">ugly</a> <a id="12549" class="Symbol">(</a><a id="12550" href="Scoped.html#6607" class="InductiveConstructor">error</a> <a id="12556" class="Symbol">_)</a> <a id="12559" class="Symbol">=</a> <a id="12561" class="String">&quot;error _&quot;</a>
<a id="12571" href="Scoped.html#11966" class="Function">ugly</a> <a id="12576" class="Symbol">(</a><a id="12577" href="Scoped.html#6683" class="InductiveConstructor">wrap</a> <a id="12582" class="Symbol">_</a> <a id="12584" class="Symbol">_</a> <a id="12586" href="Scoped.html#12586" class="Bound">t</a><a id="12587" class="Symbol">)</a> <a id="12589" class="Symbol">=</a> <a id="12591" class="String">&quot;(wrap &quot;</a> <a id="12600" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="12603" href="Scoped.html#11966" class="Function">ugly</a> <a id="12608" href="Scoped.html#12586" class="Bound">t</a> <a id="12610" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="12613" class="String">&quot;)&quot;</a>
<a id="12617" href="Scoped.html#11966" class="Function">ugly</a> <a id="12622" class="Symbol">(</a><a id="12623" href="Scoped.html#6745" class="InductiveConstructor">unwrap</a> <a id="12630" href="Scoped.html#12630" class="Bound">t</a><a id="12631" class="Symbol">)</a> <a id="12633" class="Symbol">=</a> <a id="12635" class="String">&quot;(unwrap &quot;</a> <a id="12646" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="12649" href="Scoped.html#11966" class="Function">ugly</a> <a id="12654" href="Scoped.html#12630" class="Bound">t</a> <a id="12656" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="12659" class="String">&quot;)&quot;</a>
<a id="12663" class="Markup">\end{code}</a><a id="12673" class="Background">
</a></pre></body></html>